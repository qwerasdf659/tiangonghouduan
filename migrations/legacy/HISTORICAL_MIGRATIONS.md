# 历史迁移记录（V2.0 Baseline 之前）

## 决策说明（2026-01-04拍板）
- 这些迁移已在生产环境执行
- **不补齐缺失的迁移文件**（89条）
- 新环境不再重放这些迁移
- 仅作审计和追溯用途

## 总计：197 条

## 迁移清单

1. 20250110_add_idempotency_index.js
2. 20250121000000-fix-field-inconsistencies.js
3. 20250121000001-exchange-records-to-exchange-id.js
4. 20250121120000-fix-null-constraints-comprehensive.js
5. 20250121180713-create-prize-distribution-table.js
6. 20250121200000-create-admin-security-tables.js
7. 20250123-simplify-image-resources.js
8. 20250128000000-fix-database-consistency.js
9. 20250130000000-unify-primary-keys.js
10. 20250804215008-upgrade-products-table.js
11. 20250804215013-create-exchange-records.js
12. 20250805154928-add-consecutive-fail-count-to-users.js
13. 20250811211941-create-chat-system-tables.js
14. 20250814154700-add-message-source-to-chat-messages.js
15. 20250814211437-add-history-total-points-and-update-premium-config.js
16. 20250819173637-create-new-separated-architecture.js
17. 20250819211009-fix-null-constraints-v3.js
18. 20250819225427-create-analytics-tables.js
19. 20250820175943-fix-database-consistency-v3-correct.js
20. 20250820180135-cleanup-duplicate-indexes-v3.js
21. 20250820183819-cleanup-all-duplicate-indexes.js
22. 20250820190000-fix-null-constraints-comprehensive.js
23. 20250820192700-fix-user-points-redundancy.js
24. 20250821201735-add-pool-support-to-campaigns.js
25. 20250821201919-create-collection-system-tables.js
26. 20250822113830-create-social-lottery-and-task-system.js
27. 20250822122417-add-social-lottery-room-tables.js
28. 20250822125208-create-scheduled-tasks-table.js
29. 20250822135133-create-synthesis-system.js
30. 20250824150725-add-missing-timestamp-fields.js
31. 20250824193102-remove-redundant-draw-types.js
32. 20250910164901-create-unified-engine-tables.js
33. 20250912000306-create-user-specific-prize-queues.js
34. 20250912182559-remove-unused-collection-tables.js
35. 20250915204909-comprehensive-status-enum-standardization.js
36. 20250915204909-update-user-specific-prize-queue-status-enum.js
37. 20250915221255-update-prize-distribution-status-enum.js
38. 20250915221355-update-exchange-records-status-enum.js
39. 20250916234942-fix-decision-record-field-standard.js
40. 20250917114041-remove-legacy-draw-result-field.js
41. 20250917163026-comprehensive-field-standardization.js
42. 20250917163026-rename-awarded-at-to-distributed-at.js
43. 20250917163209-fix-user-specific-prize-queue-status-enum.js
44. 20250917164650-add-expires-at-field.js
45. 20250917165558-add-performance-indexes-fixed.js
46. 20250917165558-comprehensive-performance-indexes.js
47. 20250917172238-fix-missing-foreign-keys.js
48. 20250917172316-add-final-performance-index.js
49. 20250917182946-fix-status-field-standardization.js
50. 20250917183118-add-missing-database-indexes.js
51. 20250918182055-add-strategy-type-to-decision-records.js
52. 20250918182055-comprehensive-decision-records-enhancement.js
53. 20250918182235-add-json-fields-to-decision-records.js
54. 20250918182356-add-updated-at-to-decision-records.js
55. 20250919191714-remove-avatar-url-field.js
56. 20250923181047-remove-redundant-fields-from-image-resources.js
57. 20250923205044-add-icon-field-to-user-inventory.js
58. 20250925120051-remove-over-designed-fields.js
59. 20250925120608-remove-user-agent-risk-level-behavior-analysis-fields.js
60. 20250925123254-rename-fee-net-fields-to-points.js
61. 20250925130804-rename-lottery-records-to-lottery-draws.js
62. 20250929153227-create-system-announcements-and-feedbacks.js
63. 20250929165731-add-market-fields-to-user-inventory.js
64. 20250930162100-fix-chat-messages-session-id-type.js
65. 20250930170352-remove-verification-status-from-trade-records.js
66. 20250930173932-add-audit-fields-to-exchange-records.js
67. 20250930174644-add-audit-fields-to-exchange-records.js
68. 20251001000001-rename-commodity-id-to-product-id.js
69. 20251009194221-fix-user-roles-foreign-keys.js
70. 20251011204130-create-audit-records-table.js
71. 20251011211827-allow-null-sender-id-for-system-messages.js
72. 20251012140836-create-audit-logs.js
73. 20251013120000-alter-table-user-roles.js
74. 20251014000000-baseline-v1.0.0-explicit.js
75. 20251014181055-rename-table-model-tables-for-clarity.js
76. 20251014183000-drop-index-duplicate-indexes-cleanup.js
77. 20251029202110-add-frozen-points-consumption-audit-tables.js
78. 20251030000000-refactor-consumption-records-table.js
79. 20251030000001-extend-points-transactions-business-type.js
80. 20251030120000-add-reference-fields-to-points-transactions.js
81. 20251030120001-add-consumption-records-foreign-keys.js
82. 20251030180000-alter-column-consumption-records-record-id.js
83. 20251030180000-fix-consumption-records-record-id-auto-increment.js
84. 20251030180501-remove-old-photo-upload-business.js
85. 20251102123636-create-user-premium-status-table.js
86. 20251102124500-add-premium-unlock-to-business-type.js
87. 20251102145944-add-soft-delete-fields-to-records.js
88. 20251107000000-extend-trade-records-inventory-transfer.js
89. 20251107120000-create-table-hierarchy-system.js
90. 20251108000000-create-lottery-management-settings-table.js
91. 20251108120000-add-close-fields-to-customer-service-sessions.js
92. 20251108182751-create-websocket-startup-logs-table.js
93. 20251108204822-standardize-points-amount-to-positive.js
94. 20251108210000-add-session-assign-operation-type.js
95. 20251108210100-add-closed-by-foreign-key.js
96. 20251108234905-add-column-withdraw-fields-to-user-inventory.js
97. 20251109120406-add-indexes-system-announcements-performance.js
98. 20251109152918-add-operator-id-to-user-inventory.js
99. 20251109202000-add-feedbacks-performance-indexes.js
100. 20251109234220-add-transfer-tracking-fields-to-user-inventory.js
101. 20251109234500-cleanup-users-table-duplicate-indexes.js
102. 20251109234600-cleanup-user-inventory-duplicate-verification-code-indexes.js
103. 20251110000000-create-index-sort-order-unique-constraint.js
104. 20251110003857-add-restore-audit-fields-to-points-transactions.js
105. 20251110042300-remove-frozen-points-from-user-points-accounts.js
106. 20251110205549-add-batch-draw-id-to-lottery-draws.js
107. 20251123195500-create-system-settings-table.js
108. 20251126201553-add-activity-conditions.js
109. 20251208234550-remove-price-type-points-mixed.js
110. 20251209002100-remove-payment-type-points-mixed-from-records.js
111. 20251209224900-add-inventory-consumption-audit-operation-types.js
112. 20251211000000-add-role-change-operation-type.js
113. 20251211161534-add-prize-stock-adjust-operation-type.js
114. 20251211170000-add-inventory-transfer-operation-type.js
115. 20251211180000-add-business-id-to-consumption-records.js
116. 20251211190000-add-business-id-to-lottery-draws.js
117. 20251212000000-add-exchange-market-records-business-id.js
118. 20251215080000-add-market-purchase-to-trade-records.js
119. 20251215080100-create-user-asset-accounts-table.js
120. 20251215080200-create-asset-transactions-table.js
121. 20251215160000-create-accounts-table.js
122. 20251215160100-create-account-asset-balances-table.js
123. 20251215160200-upgrade-asset-transactions-add-account-fields.js
124. 20251215160300-migrate-user-asset-accounts-to-account-balances.js
125. 20251215165620-create-material-asset-types.js
126. 20251215165621-create-user-material-balances.js
127. 20251215165622-create-material-conversion-rules.js
128. 20251215165623-create-material-transactions.js
129. 20251215165624-create-user-diamond-accounts.js
130. 20251215165625-create-diamond-transactions.js
131. 20251215170000-add-selling-asset-fields-to-user-inventory.js
132. 20251215170000-phase4-set-old-material-tables-readonly.js
133. 20251215170001-set-old-material-diamond-tables-readonly.js
134. 20251215170100-add-reconciliation-fields-to-trade-records.js
135. 20251215170200-migrate-selling-points-to-selling-amount.js
136. 20251215170300-seed-material-asset-types-and-rules.js
137. 20251215180000-add-cost-asset-fields-to-exchange-items.js
138. 20251215180000-add-material-fields-to-lottery-prizes.js
139. 20251215180000-create-market-listings-table.js
140. 20251215180000-phase4-drop-old-material-diamond-tables.js
141. 20251215180100-add-pay-asset-fields-to-exchange-market-records.js
142. 20251215180100-create-trade-orders-table.js
143. 20251215220000-create-material-asset-types-table.js
144. 20251215220100-create-material-conversion-rules-table.js
145. 20251215220101-create-item-instances-table.js
146. 20251215220102-migrate-user-inventory-to-item-instances.js
147. 20251215220103-update-market-listings-foreign-key-to-item-instances.js
148. 20251215230000-alter-column-asset-transactions-user-id-nullable.js
149. 20251215230000-fix-asset-transactions-user-id-nullable.js
150. 20251215230100-add-column-market-listings-business-id-idempotency.js
151. 20251216000100-fix-asset-transactions-duplicate-foreign-keys.js
152. 20251217000000-add-user-uuid-to-users.js
153. 20251217010000-create-redemption-orders-table.js
154. 20251217160809-rename-user-inventory-to-deprecated.js
155. 20251218124157-add-market-listing-idempotency-constraint.js
156. 20251218153523-remove-duplicate-foreign-key-asset-transactions-user-id.js
157. 20251218230000-migrate-virtual-price-to-material-cost.js
158. 20251219000000-final-cleanup-virtual-points-fields.js
159. 20251219010000-add-not-null-constraints-material-asset-fields.js
160. 20251220190000-phase6-business-id-constraints.js
161. 20251220190100-phase6-system-accounts.js
162. 20251220190200-drop-legacy-tables.js
163. 20251220190200-phase6-drop-legacy-tables.js
164. 20251220190210-phase6-drop-legacy-fields.js
165. 20251220190300-drop-legacy-fields.js
166. 20251220190400-tighten-constraints.js
167. 20251220190500-delete-legacy-tables.js
168. 20251220190500-drop-table-legacy-tables.js
169. 20251220190510-delete-legacy-fields.js
170. 20251220190510-drop-column-legacy-fields.js
171. 20251220190520-modify-asset-transactions-account-id-not-null.js
172. 20251220190600-fix-balance-before-not-null.js
173. 20251221213617-rename-exchange-market-records-to-exchange-records.js
174. 20251221230609-create-popup-banners-table.js
175. 20251222000100-drop-column-asset-transactions-user-id.js
176. 20251223000100-add-idempotency-constraints-p1-fix.js
177. 20251223100000-create-missing-points-tables.js
178. 20251223200000-create-lottery-draw-quota-tables.js
179. 20251226100000-add-idempotency-key-lottery-session-id-to-asset-transactions.js
180. 20251226150000-breaking-upgrade-idempotency-architecture-standard.js
181. 20251226203441-remove_probability_column.js
182. 20251228212949-unified-asset-domain-phase1-cleanup-credits.js
183. 20251228215703-create-item-template-aliases.js
184. 20251229184339-create-merchant-points-reviews-table.js
185. 20251230200000-drop-deprecated-points-tables.js
186. 20251231002916-add-lottery-prizes-index-and-fk.js
187. 20260101000001-semantic-cleanup-remove-is-winner-add-reward-tier.js
188. 20260101211702-data-cleanup-and-reward-tier-fix.js
189. 20260101222406-fix-empty-prize-type-and-cleanup-enum.js
190. 20260102000000-breaking-rename-business-id-to-idempotency-key.js
191. 20260102100000-rename-item-instance-events-business-id.js
192. 20260102190811-add-locks-json-to-item-instances.js
193. 20260102200000-fix-item-instance-events-idempotency-not-null.js
194. 20260102300000-fix-market-listings-index-name.js
195. 20260102400000-add-composite-indexes-query-optimization.js
196. 20260102500000-cleanup-redundant-indexes-audit.js

## 说明

以上迁移记录来自数据库 `sequelizemeta` 表。其中：
- 仓库顶层 .js 迁移文件：89 个
- DB 已记录但仓库顶层缺失：107 条
- DB 已记录且文件在 archived/：18 条

这些历史迁移仅作审计存档，不再用于新环境重放。
新环境部署请使用：`20260104000000-baseline-v2.0.0-from-production.js` + 后续增量迁移。
