<%# ‰æßËæπÊ†èÂØºËà™Ê®°Êùø - Ê∑±ËìùÁßëÊäÄÈ£é %>
<aside 
  class="admin-sidebar"
  :class="{ 'collapsed': collapsed, 'mobile-open': mobileOpen }"
  x-data="sidebarNav()"
>
  <!-- Logo Âå∫Âüü + P0-5: ÂÅ•Â∫∑Â∫¶ÊåáÁ§∫ÁÅØ -->
  <div class="sidebar-logo">
    <span class="logo-icon">üé∞</span>
    <span class="logo-text">ÊäΩÂ•ñÁÆ°ÁêÜÂêéÂè∞</span>
    <!-- P0-5: ÂÅ•Â∫∑Â∫¶ÊåáÁ§∫ÁÅØ -->
    <span 
      class="ml-2 w-3 h-3 rounded-full"
      :class="getHealthIndicatorClass()"
      :title="'Á≥ªÁªüÂÅ•Â∫∑Â∫¶: ' + healthScore + 'ÂàÜ - ' + (healthStatus === 'healthy' ? 'Ê≠£Â∏∏' : healthStatus === 'warning' ? 'ÈúÄÂÖ≥Ê≥®' : 'ÈúÄÂ§ÑÁêÜ')"
    ></span>
  </div>

  <!-- ÂØºËà™ËèúÂçï -->
  <nav class="sidebar-nav scrollbar-thin">
    <template x-for="group in navGroups" :key="group.id">
      <!-- ‰ΩøÁî® div ÂåÖË£ÖÂô®Á°Æ‰øù Alpine.js Ê≠£Á°ÆÂ§ÑÁêÜÂ§ö‰∏™Êù°‰ª∂ÂàÜÊîØ -->
      <div class="nav-menu-item">
        <!-- ÂçïÈ°πËèúÂçïÔºàÂ¶ÇÂ∑•‰ΩúÂè∞Ôºâ -->
        <a 
          x-show="group.type === 'single'"
          class="nav-single"
          :class="{ 'active': isItemActive(group.url) }"
          @click.prevent="navigateTo(group.url, group.id, group.name, group.icon)"
          href="javascript:;"
        >
          <span class="nav-icon" x-text="group.icon"></span>
          <span class="nav-text" x-text="group.name"></span>
        </a>

        <!-- ÂàÜÁªÑËèúÂçïÔºà‰∫åÁ∫ßÔºâ- Êúâ items ‰ΩÜÊ≤°Êúâ subGroups -->
        <div 
          x-show="group.type !== 'single' && group.items && group.items.length > 0 && (!group.subGroups || group.subGroups.length === 0)"
          class="nav-group"
          :class="{ 'expanded': isGroupExpanded(group.id) }"
        >
          <!-- ÂàÜÁªÑÊ†áÈ¢ò -->
          <div 
            class="nav-group-title"
            @click="toggleGroup(group.id)"
          >
            <span class="nav-icon" x-text="group.icon"></span>
            <span class="nav-text" x-text="group.name"></span>
            <span class="toggle-icon">‚ñº</span>
          </div>

          <!-- ÂàÜÁªÑÂ≠êÈ°π -->
          <div class="nav-group-items">
            <template x-for="item in (group.items || [])" :key="item.id">
              <a 
                class="nav-item"
                :class="{ 'active': isItemActive(item.url) }"
                @click.prevent="navigateTo(item.url, item.id, item.name, group.icon)"
                href="javascript:;"
              >
                <span x-text="item.name"></span>
                <template x-if="item.badgeKey && $data[item.badgeKey] > 0">
                  <span class="ml-auto flex items-center">
                    <span class="w-2 h-2 bg-red-500 rounded-full animate-pulse"></span>
                    <span class="ml-1 text-xs text-red-400" x-text="$data[item.badgeKey] > 99 ? '99+' : $data[item.badgeKey]"></span>
                  </span>
                </template>
              </a>
            </template>
          </div>
        </div>

        <!-- ‰∏âÁ∫ßÂàÜÁªÑËèúÂçïÔºàÂ¶ÇÁ≥ªÁªüËÆæÁΩÆÔºâ- Êúâ subGroups -->
        <div 
          x-show="group.subGroups && group.subGroups.length > 0"
          class="nav-group nav-group-3level"
          :class="{ 'expanded': isGroupExpanded(group.id) }"
          :data-group-id="group.id"
        >
          <!-- ‰∏ÄÁ∫ßÂàÜÁªÑÊ†áÈ¢ò -->
          <div 
            class="nav-group-title"
            @click="toggleGroup(group.id)"
          >
            <span class="nav-icon" x-text="group.icon"></span>
            <span class="nav-text" x-text="group.name"></span>
            <span class="toggle-icon">‚ñº</span>
          </div>

          <!-- ‰∫åÁ∫ßÂ≠êÂàÜÁªÑ -->
          <div class="nav-group-items">
            <template x-for="subGroup in (group.subGroups || [])" :key="subGroup.id">
              <div class="nav-subgroup" :class="{ 'expanded': isSubGroupExpanded(subGroup.id) }">
                <!-- Â≠êÂàÜÁªÑÊ†áÈ¢ò -->
                <div 
                  class="nav-subgroup-title"
                  @click="toggleSubGroup(subGroup.id)"
                >
                  <span class="nav-subicon" x-text="subGroup.icon || 'üìÅ'"></span>
                  <span x-text="subGroup.name"></span>
                  <span class="toggle-icon text-xs">‚ñº</span>
                </div>
                <!-- Â≠êÂàÜÁªÑËèúÂçïÈ°π -->
                <div class="nav-subgroup-items">
                  <template x-for="item in (subGroup.items || [])" :key="item.id">
                    <a 
                      class="nav-item nav-item-nested"
                      :class="{ 'active': isItemActive(item.url) }"
                      @click.prevent="navigateTo(item.url, item.id, item.name, subGroup.icon || group.icon)"
                      href="javascript:;"
                    >
                      <span x-text="item.name"></span>
                    </a>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>
    </template>
  </nav>

  <!-- ‰æßËæπÊ†èÂ∫ïÈÉ® -->
  <div class="sidebar-footer">
    <button 
      class="collapse-btn"
      @click="toggleCollapse()"
      :title="collapsed ? 'Â±ïÂºÄËèúÂçï' : 'ÊäòÂè†ËèúÂçï'"
    >
      <span x-show="!collapsed">‚óÄ ÊäòÂè†ËèúÂçï</span>
      <span x-show="collapsed">‚ñ∂</span>
    </button>
  </div>
</aside>
