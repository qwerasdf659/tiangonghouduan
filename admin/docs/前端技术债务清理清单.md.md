# å‰ç«¯å­—æ®µæ˜ å°„ä¸å‘åå…¼å®¹ä»£ç æ¸…å•

> **ç”Ÿæˆæ—¥æœŸ**: 2026-01-29  
> **é¡¹ç›®**: admin (Webç«¯åå°ç®¡ç†å‰ç«¯)  
> **ç”¨é€”**: æŠ€æœ¯å€ºåŠ¡è¿½è¸ªï¼ŒæŒ‡å¯¼ä»£ç æ¸…ç†å·¥ä½œ

---

## ğŸš¨ æ ¸å¿ƒåŸåˆ™ï¼ˆå¼ºåˆ¶æ‰§è¡Œï¼‰

> **ä»¥åç«¯æ•°æ®åº“æä¾›çš„åŠŸèƒ½ä¸ºå‡†ï¼Œä½œä¸ºæ ¸å¿ƒæƒå¨**  
> **ä¸å‘åå…¼å®¹æ—§ Web ç«¯ç®¡ç†å¹³å°å‰ç«¯çš„å†…å®¹**  
> **ä»¥åç«¯ä¸ºå‡†ï¼Œä¿®æ”¹å‰ç«¯é€‚é…åç«¯**

### æ‰§è¡Œæ ‡å‡†

1. **ç›´æ¥ä½¿ç”¨åç«¯å­—æ®µå** - å‰ç«¯ä»£ç ç›´æ¥ä½¿ç”¨åç«¯è¿”å›çš„å­—æ®µåï¼Œä¸åšå¤æ‚æ˜ å°„
2. **ç»Ÿä¸€ä½¿ç”¨ snake_case** - å­—æ®µå‘½åè·Ÿåç«¯ä¿æŒä¸€è‡´ï¼Œä½¿ç”¨ `user_id` è€Œé `userId`
3. **åˆ é™¤è€Œéå…¼å®¹** - åºŸå¼ƒçš„å­—æ®µ/æ–¹æ³•ç›´æ¥åˆ é™¤ï¼Œä¸ä¿ç•™å…¼å®¹å±‚
4. **ä¿®æ”¹ HTML é€‚é… JS** - å¦‚æœ HTML æ¨¡æ¿ä½¿ç”¨äº†åˆ«åï¼Œä¿®æ”¹ HTML ä½¿ç”¨çœŸå®å­—æ®µå
5. **ç¦æ­¢åˆ›å»ºåˆ«å** - ä¸å…è®¸ä¸ºäº† HTML æ¨¡æ¿æ–¹ä¾¿è€Œåœ¨ JS ä¸­åˆ›å»ºåˆ«åå±æ€§/æ–¹æ³•

### å‘½åé£æ ¼è§„èŒƒ

> **å†³ç­–**ï¼šç»Ÿä¸€ä½¿ç”¨ **snake_case**ï¼ˆåç«¯å­—æ®µåï¼‰ï¼Œä¸åš camelCase è½¬æ¢

| åœºæ™¯ | æ­£ç¡®ç¤ºä¾‹ | é”™è¯¯ç¤ºä¾‹ |
|------|----------|----------|
| è¿‡æ»¤å™¨å­—æ®µ | `user_id`, `start_date` | ~~`userId`~~, ~~`startDate`~~ |
| API å‚æ•° | `page_size`, `order_by` | ~~`pageSize`~~, ~~`orderBy`~~ |
| æ•°æ®å±æ€§ | `created_at`, `updated_at` | ~~`createdAt`~~, ~~`updatedAt`~~ |

**ç†ç”±**ï¼š
- âœ… ç¬¦åˆã€Œä»¥åç«¯ä¸ºå‡†ã€æ ¸å¿ƒåŸåˆ™
- âœ… å‰åç«¯å­—æ®µåä¸€è‡´ï¼Œæ— éœ€è½¬æ¢å±‚
- âœ… å‡å°‘ä»£ç é‡å’Œç»´æŠ¤æˆæœ¬
- âœ… è°ƒè¯•æ—¶æ—¥å¿—å­—æ®µåä¸€è‡´ï¼Œæ˜“äºæ’æŸ¥

### snake_case å®‰å…¨æ€§è¯„ä¼°

> **ç»“è®º**ï¼šåœ¨æœ¬é¡¹ç›®ä¸­ä½¿ç”¨ snake_case **ä¸ä¼šé€ æˆéšæ‚£** âœ…

#### å‰ç«¯é¡¹ç›®é…ç½®æ£€æŸ¥

| é…ç½®é¡¹ | çŠ¶æ€ | å½±å“ |
|--------|------|------|
| ESLint | âŒ å‰ç«¯æœªå®‰è£… | ä¸ä¼šæœ‰ `camelcase` è§„åˆ™è­¦å‘Š |
| Prettier | âœ… ä»…æ ¼å¼åŒ– | ä¸æ£€æŸ¥å‘½åé£æ ¼ |

> æ³¨ï¼šåç«¯é¡¹ç›®æœ‰ ESLintï¼Œä½†å‰ç«¯é¡¹ç›®ï¼ˆ`/admin`ï¼‰æ²¡æœ‰å®‰è£…ã€‚

#### æ½œåœ¨éšæ‚£è¯„ä¼°

| éšæ‚£ç±»å‹ | é£é™©ç­‰çº§ | è¯´æ˜ |
|----------|----------|------|
| JavaScript è¯­æ³• | âœ… æ— é£é™© | `user_id` æ˜¯åˆæ³•çš„å˜é‡å |
| ESLint è­¦å‘Š | âœ… æ— é£é™© | å‰ç«¯æ²¡æœ‰ ESLint |
| Alpine.js å…¼å®¹æ€§ | âœ… æ— é£é™© | å®Œå…¨æ”¯æŒ snake_case |
| IDE è‡ªåŠ¨è¡¥å…¨ | âš ï¸ ä½é£é™© | VSCode æ”¯æŒè‰¯å¥½ |
| JSON è§£æ | âœ… æ— é£é™© | JavaScript åŸç”Ÿæ”¯æŒ |
| ç¬¬ä¸‰æ–¹åº“å…¼å®¹ | âœ… æ— é£é™© | Alpine/ECharts/Socket.io å‡æ— å½±å“ |

#### ä½¿ç”¨ snake_case çš„æ³¨æ„äº‹é¡¹

**1. å¯¹è±¡è§£æ„æ—¶å­—æ®µåè¦å¯¹åº”**
```javascript
// âœ… æ­£ç¡®
const { user_id, created_at } = response.data

// âŒ é”™è¯¯ï¼ˆå­—æ®µåä¸åŒ¹é…ä¼šå¾—åˆ° undefinedï¼‰
const { userId, createdAt } = response.data
```

**2. ä¿®æ”¹æ—¶ HTML å’Œ JS è¦åŒæ­¥**
```javascript
// JS æ–‡ä»¶
consumptionFilters: {
  user_id: '',  // snake_case
}
```
```html
<!-- HTML æ–‡ä»¶ä¹Ÿè¦æ”¹ -->
<input x-model="consumptionFilters.user_id">  <!-- ä¸æ˜¯ userId -->
```

**3. å¦‚æœæœªæ¥è¦åŠ  ESLint**

> æ³¨ï¼šåç«¯é¡¹ç›®ï¼ˆ`/project/`ï¼‰å·²æœ‰ ESLintï¼Œå‰ç«¯é¡¹ç›®ï¼ˆ`/admin/`ï¼‰æœ‰ç‹¬ç«‹çš„ `package.json`ï¼Œåº”åœ¨ `admin` ç›®å½•ä¸‹ç‹¬ç«‹å®‰è£…ã€‚

**å®‰è£…æ­¥éª¤**ï¼š
```bash
cd /home/devbox/project/admin
npm install -D eslint
```

**æ¨èé…ç½®** `admin/.eslintrc.js`ï¼š
```javascript
module.exports = {
  env: {
    browser: true,
    es2021: true
  },
  extends: ['eslint:recommended'],
  parserOptions: {
    ecmaVersion: 'latest',
    sourceType: 'module'
  },
  globals: {
    Alpine: 'readonly'
  },
  rules: {
    // âœ… å…è®¸ snake_caseï¼ˆå…³é”®é…ç½®ï¼‰
    'camelcase': 'off',
    
    // å…¶ä»–å¸¸ç”¨è§„åˆ™
    'no-unused-vars': 'warn',
    'no-console': 'off'
  }
}
```

**æ·»åŠ  npm script**ï¼ˆ`admin/package.json`ï¼‰ï¼š
```json
{
  "scripts": {
    "lint": "eslint src/**/*.js",
    "lint:fix": "eslint src/**/*.js --fix"
  }
}
```

### ç¦æ­¢çš„æ¨¡å¼

```javascript
// âŒ ç¦æ­¢ï¼šä¸º HTML æ¨¡æ¿åˆ›å»ºåˆ«å
this.assets = this.orphanList  // åˆ é™¤ï¼ŒHTML ç›´æ¥ç”¨ orphanList

// âŒ ç¦æ­¢ï¼šæ–¹æ³•åˆ«å
searchUser() { return this.handleSearch() }  // åˆ é™¤ï¼ŒHTML ç›´æ¥è°ƒ handleSearch()

// âŒ ç¦æ­¢ï¼šcamelCase å­—æ®µåˆ«å
userId: '',        // åˆ é™¤ï¼Œç›´æ¥ç”¨ user_id
startDate: '',     // åˆ é™¤ï¼Œç›´æ¥ç”¨ start_date
pageSize: 20,      // åˆ é™¤ï¼Œç›´æ¥ç”¨ page_size
```

### æ­£ç¡®çš„æ¨¡å¼

```javascript
// âœ… æ­£ç¡®ï¼šç›´æ¥ä½¿ç”¨åç«¯å­—æ®µå
this.orphanList = response.data.orphan_items

// âœ… æ­£ç¡®ï¼šHTML ç›´æ¥å¼•ç”¨
// <div x-for="item in orphanList">
```

---

## ğŸ“Š ç»Ÿè®¡æ¦‚è§ˆ

| ç±»å‹ | æ•°é‡ | ä¼˜å…ˆçº§ | çŠ¶æ€ |
|------|------|--------|------|
| API è½¬å‘/å…¼å®¹æ¨¡å— | ~~6å¤„~~ â†’ 0å¤„ | P0 | âœ… å·²æ¸…ç† |
| HTML æ¨¡æ¿ç©ºå£³åˆ«å | 10å¤„ | P1 | ğŸ”´ å¾…æ¸…ç† |
| æ•°æ®è½¬æ¢å±‚ï¼ˆæœ‰é€»è¾‘ï¼‰ | 8å¤„ | - | âœ… ä¿ç•™ |
| æ¶æ„é—®é¢˜ï¼ˆåŒé‡çŠ¶æ€ï¼‰ | 1å¤„ | P2 | ğŸ“‹ æœ‰æ–¹æ¡ˆ |
| Mixin/ç»„ä»¶å…¼å®¹ | 3å¤„ | P1 | ğŸ”´ å¾…è¯„ä¼° |

---

## 1ï¸âƒ£ API è½¬å‘/å‘åå…¼å®¹æ¨¡å—

### 1.1 æ¨¡å—èšåˆå…¥å£ï¼ˆæ ‡å‡†æ¶æ„æ¨¡å¼ï¼‰

> **è¯´æ˜**ï¼šä»¥ä¸‹æ˜¯æ¨¡å—æ‹†åˆ†åçš„èšåˆå…¥å£ï¼Œå±äº**æ ‡å‡†æ¶æ„æ¨¡å¼**ï¼Œéå‘åå…¼å®¹ä»£ç ã€‚

| æ–‡ä»¶ | ç±»å‹ | è¯´æ˜ | å¤„ç†å»ºè®® |
|------|------|------|----------|
| `api/system/index.js` | èšåˆå¯¼å‡º | åˆå¹¶ `core.js` å’Œ `admin.js`ï¼Œæä¾›ç»Ÿä¸€å¯¼å…¥å…¥å£ | **ä¿ç•™** - æ ‡å‡†èšåˆæ¨¡å¼ |
| `api/lottery/index.js` | èšåˆå¯¼å‡º | åˆå¹¶ `core.js` å’Œ `advanced.js`ï¼Œæä¾›ç»Ÿä¸€å¯¼å…¥å…¥å£ | **ä¿ç•™** - æ ‡å‡†èšåˆæ¨¡å¼ |
| `api/market/index.js` | èšåˆå¯¼å‡º | åˆå¹¶ `exchange.js` å’Œ `trade.js`ï¼Œæä¾›ç»Ÿä¸€å¯¼å…¥å…¥å£ | **ä¿ç•™** - æ ‡å‡†èšåˆæ¨¡å¼ |

### 1.2 å†—ä½™è½¬å‘æ¨¡å—ï¼ˆåº”åˆ é™¤ï¼‰

> **é—®é¢˜**ï¼š`api/system.js` æ˜¯å¤šä½™çš„è½¬å‘å±‚ï¼Œä¸ lottery/market æ¨¡å—å¤„ç†æ–¹å¼ä¸ä¸€è‡´ã€‚

| æ–‡ä»¶ | é—®é¢˜ | å½±å“èŒƒå›´ | å¤„ç†å»ºè®® |
|------|------|----------|----------|
| `api/system.js` | ä»…è½¬å‘ `system/index.js`ï¼Œæ— ä»»ä½•é¢å¤–é€»è¾‘ | 9ä¸ªæ–‡ä»¶å¼•ç”¨ | **P0 åˆ é™¤** |

**ä¸ä¸€è‡´æ€§å¯¹æ¯”**ï¼š

| æ¨¡å— | ç›®å½•å…¥å£ | è½¬å‘æ–‡ä»¶ | ä¸šåŠ¡æ¨¡å—å¯¼å…¥æ–¹å¼ |
|------|----------|----------|------------------|
| lottery | `lottery/index.js` âœ… | âŒ æ—  | `api/lottery/index.js` |
| market | `market/index.js` âœ… | âŒ æ—  | `api/market/index.js` |
| system | `system/index.js` âœ… | `system.js` âš ï¸ å¤šä½™ | `api/system.js` â† ä¸ä¸€è‡´ |

**éœ€è¦ä¿®æ”¹çš„9ä¸ªæ–‡ä»¶**ï¼ˆæ”¹ç”¨ `api/system/index.js`ï¼‰ï¼š

1. `modules/system/composables/config.js`
2. `modules/system/composables/audit-logs.js`
3. `modules/system/composables/dict.js`
4. `modules/system/composables/feature-flags.js`
5. `modules/system/pages/risk-alerts.js`
6. `modules/system/pages/config-tools.js`
7. `modules/store/pages/store-management.js`
8. `modules/analytics/pages/statistics.js`
9. `modules/content/pages/content-management.js`

### 1.3 API åˆ«åå’Œå…¼å®¹æ–¹æ³•

| æ–‡ä»¶ | è¡Œå· | å†…å®¹ | å¤„ç†å»ºè®® |
|------|------|------|----------|
| `api/lottery/advanced.js` | 44 | `STRATEGY_STATS_OVERVIEW` ä¸ `STRATEGY_STATS_REALTIME`(è¡Œ45) æŒ‡å‘åŒä¸€URLï¼Œä¸ºå†—ä½™åˆ«å | **å¾…æ¸…ç†** - ä½¿ç”¨å¤„1å¤„(`analytics.js:512`)ï¼Œæ”¹ç”¨ `REALTIME` ååˆ é™¤ |
| `api/system/admin.js` | 98 | å­—å…¸ç®¡ç†å…¼å®¹åˆ«å | **å¾…è¯„ä¼°** |
| `api/user.js` | 325 | é£æ§é…ç½®æ‰©å±•ï¼ˆå…¼å®¹åˆ«åï¼‰ | **å¾…è¯„ä¼°** |
| `api/user.js` | 337 | ç”¨æˆ·å±‚çº§æ‰©å±•ï¼ˆå…¼å®¹åˆ«åï¼‰ | **å¾…è¯„ä¼°** |

### 1.4 @deprecated æ–¹æ³•ï¼ˆåº”åˆ é™¤ï¼‰

| æ–‡ä»¶ | è¡Œå· | æ–¹æ³•å | æ›¿ä»£æ–¹æ¡ˆ | å¤„ç†å»ºè®® |
|------|------|--------|----------|----------|
| `api/asset.js` | 414 | `adjustPoints()` | ä½¿ç”¨ `adjustAsset()` ç»Ÿä¸€å…¥å£ | **P0 åˆ é™¤** |
| `api/asset.js` | 492 | `adjustDiamond()` | ä½¿ç”¨ `adjustAsset({ asset_code: 'DIAMOND', ... })` | **P0 åˆ é™¤** |

---

## 2ï¸âƒ£ HTML æ¨¡æ¿å…¼å®¹/åˆ«åï¼ˆæœ€å¤§é—®é¢˜åŒºåŸŸï¼‰

### 2.1 é—®é¢˜è¯´æ˜

å½“å‰å­˜åœ¨å¤§é‡ä¸ºäº†åŒ¹é… HTML æ¨¡æ¿ä¸­ä½¿ç”¨çš„å˜é‡åè€Œåˆ›å»ºçš„**åˆ«åå±æ€§/æ–¹æ³•**ï¼Œå¯¼è‡´ï¼š
- ä»£ç å†—ä½™ï¼ŒåŒä¸€æ•°æ®æœ‰å¤šä¸ªå¼•ç”¨å
- ç»´æŠ¤å›°éš¾ï¼Œä¿®æ”¹éœ€åŒæ­¥å¤šå¤„
- ç†è§£æˆæœ¬é«˜ï¼Œæ–°äººéš¾ä»¥åŒºåˆ†å“ªä¸ªæ˜¯çœŸå®æ•°æ®æº

### 2.2 è¯¦ç»†æ¸…å•

#### `modules/asset/pages/asset-adjustment.js`

| è¡Œå· | åˆ«å | å®é™…æ•°æ®/æ–¹æ³• | è¯´æ˜ |
|------|------|---------------|------|
| 179 | `records` | è°ƒè´¦è®°å½•åˆ—è¡¨ | HTMLæ¨¡æ¿åˆ«å |
| 191 | `materialTypes` | ææ–™ç±»å‹åˆ—è¡¨ | HTMLæ¨¡æ¿åˆ«å |
| 243 | `adjustForm` | è°ƒæ•´è¡¨å•æ•°æ® | æ—§ç‰ˆæœ¬å…¼å®¹ |
| 883 | `formatDate()` | æ ¼å¼åŒ–æ—¥æœŸ | HTMLæ¨¡æ¿åˆ«å |
| 956 | `searchUser()` | `handleSearch()` çš„åˆ«å | HTMLæ¨¡æ¿è°ƒç”¨ |
| 1075 | `getAssetTypeText()` | è·å–èµ„äº§ç±»å‹æ–‡æœ¬ | HTMLæ¨¡æ¿éœ€è¦ |

#### `modules/system/pages/orphan-frozen.js`

| è¡Œå· | åˆ«å | å®é™…æ•°æ®/æ–¹æ³• | è¯´æ˜ |
|------|------|---------------|------|
| 79-82 | `orphanCount`, `frozenCount`, `totalValue`, `processedCount` | ç»Ÿè®¡å­—æ®µ | HTMLæ¨¡æ¿å…¼å®¹ |
| 127 | `assets` | `orphanList` | HTMLæ¨¡æ¿ä½¿ç”¨çš„åˆ«å |
| 152 | `selectedAsset` | å½“å‰é€‰ä¸­èµ„äº§ | HTMLæ¨¡æ¿å…¼å®¹ |
| 269 | `this.assets = this.orphanList` | åŒæ­¥èµ‹å€¼ | HTMLæ¨¡æ¿åˆ«ååŒæ­¥ |
| 609 | `loadAssets()` | åŠ è½½èµ„äº§åˆ—è¡¨ | HTMLæ¨¡æ¿å…¼å®¹åˆ«å |
| 620 | `scanOrphanAssets()` | æ‰«æå­¤å„¿èµ„äº§ | HTMLæ¨¡æ¿å…¼å®¹åˆ«å |
| 760 | `processAsset()` | å¤„ç†èµ„äº§ | HTMLæ¨¡æ¿å…¼å®¹åˆ«å |

#### `modules/lottery/pages/presets.js`

| è¡Œå· | å†…å®¹ | è¯´æ˜ |
|------|------|------|
| 626 | `getStatusText()` | HTMLæ¨¡æ¿é€šç”¨å‡½æ•°ï¼Œå°†çŠ¶æ€ä»£ç è½¬æ¢ä¸ºä¸­æ–‡æ˜¾ç¤º |
| 642-644 | `loadData()` | ä¸ºHTMLæ¨¡æ¿æä¾›çš„ `loadInterventions()` æ–¹æ³•åˆ«å |

#### `modules/system/pages/risk-alerts.js`

| è¡Œå· | åˆ«åæ–¹æ³• | è¯´æ˜ |
|------|----------|------|
| 641 | `selectAlert()` | é€‰æ‹©å‘Šè­¦ï¼ˆå…¼å®¹åˆ«åæ–¹æ³•ï¼‰ |
| 856 | å¤šä¸ªè¾…åŠ©æ–¹æ³• | åŸæœ‰è¾…åŠ©æ–¹æ³•ï¼ˆå‘åå…¼å®¹ï¼‰ |
| 917 | `getAlertTypeLabel()` | è·å–å‘Šè­¦ç±»å‹æ ‡ç­¾ï¼ˆå…¼å®¹åˆ«åï¼‰ |
| 980 | `getStatusLabel()` | è·å–çŠ¶æ€æ ‡ç­¾æ–‡æœ¬ï¼ˆå…¼å®¹åˆ«åï¼‰ |
| 1033 | `formatDateTime()` | æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´ï¼ˆå…¼å®¹åˆ«åï¼‰ |

#### `modules/market/pages/exchange-market.js`

| è¡Œå· | å†…å®¹ | è¯´æ˜ |
|------|------|------|
| 102 | HTML æ¨¡æ¿å…¼å®¹å±æ€§ | å¤šä¸ªå…¼å®¹å±æ€§å®šä¹‰ |
| 146 | `updateMarketStats()` | æ›´æ–° marketStatsï¼ˆHTML æ¨¡æ¿å…¼å®¹ï¼‰ |
| 195 | HTML æ¨¡æ¿å…¼å®¹æ–¹æ³• | æ–¹æ³•å®šä¹‰åŒºåŸŸ |
| 198 | `deleteItem()` | åˆ é™¤å•†å“ï¼ˆå…¼å®¹ HTML æ¨¡æ¿ä¼ å…¥ item å¯¹è±¡ï¼‰ |

#### `modules/user/composables/users.js`

> âš ï¸ **æ¶æ„é—®é¢˜ï¼šåŒé‡çŠ¶æ€** - éœ€é‡‡ç”¨ã€Œå•ä¸€å¯¹è±¡ + Getterã€æ–¹æ¡ˆé‡æ„ï¼ˆè§ä¸‹æ–¹è¯¦ç»†æ–¹æ¡ˆï¼‰

| è¡Œå· | å˜é‡ | è¯´æ˜ | å¤„ç†å»ºè®® |
|------|------|------|----------|
| 42-43 | `pagination` å¯¹è±¡ | åˆ†é¡µå¯¹è±¡ - ä¸ç‹¬ç«‹å±æ€§é‡å¤ | **ä¿ç•™** - ä½œä¸ºå”¯ä¸€æ•°æ®æº |
| Mixin | `page`, `total`, `totalPages` | ç‹¬ç«‹å±æ€§ - ä¸ pagination å†—ä½™ | **åˆ é™¤** - ç»Ÿä¸€ä½¿ç”¨ pagination |
| 106-109 | `pagination` åŒæ­¥ä»£ç  | æ¯æ¬¡æ‰‹åŠ¨åŒæ­¥ï¼Œæ˜“é—æ¼å‡ºé”™ | **åˆ é™¤** - æ”¹ç”¨ getter è‡ªåŠ¨è®¡ç®— |
| 44 | `selectedUser` | é€‰ä¸­çš„ç”¨æˆ· | âœ… ä¿ç•™ - ä¸»æ•°æ®å±æ€§ |
| 46-47 | `editUserForm` | ç¼–è¾‘ç”¨æˆ·è¡¨å• | âœ… ä¿ç•™ - ä¸»æ•°æ®å±æ€§ |
| 50-51 | `assignRoleForm` | åˆ†é…è§’è‰²è¡¨å• | âœ… ä¿ç•™ - ä¸»æ•°æ®å±æ€§ |
| 52-53 | `selectedRoleCode` | é€‰ä¸­çš„è§’è‰²ä»£ç  | âœ… ä¿ç•™ - x-model ç»‘å®š |

#### `modules/asset/pages/assets-portfolio.js`

| è¡Œå· | å†…å®¹ | è¯´æ˜ |
|------|------|------|
| 23 | `overview` | èµ„äº§æ€»è§ˆç»Ÿè®¡ - åŒ¹é…HTMLæ¨¡æ¿ |
| 31 | `assets` | èµ„äº§åˆ—è¡¨ - åŒ¹é…HTMLæ¨¡æ¿çš„ assets |
| 37 | `searchForm` | æœç´¢è¡¨å• - åŒ¹é…HTMLæ¨¡æ¿ |
| 205 | æ•°æ®è½¬æ¢ | è½¬æ¢ä¸ºå‰ç«¯æœŸæœ›çš„æ ¼å¼ |

#### `modules/analytics/composables/consumption.js`

| è¡Œå· | å†…å®¹ | è¯´æ˜ | å¤„ç†å»ºè®® |
|------|------|------|----------|
| 25 | `userId` | camelCase åˆ«åï¼ˆä¸ `user_id` é‡å¤ï¼‰ | **åˆ é™¤** - ç»Ÿä¸€ç”¨ `user_id` |
| 49 | `loadConsumption()` | ç©ºå£³æ–¹æ³•ï¼ˆåªè°ƒç”¨ `loadConsumptions()`ï¼‰ | **åˆ é™¤** - HTML ç›´æ¥è°ƒåŸæ–¹æ³• |
| 85 | å­—æ®µæ˜ å°„ | æ˜ å°„å­—æ®µä»¥å…¼å®¹ HTML æ¨¡æ¿ | âœ… ä¿ç•™ - æœ‰è½¬æ¢é€»è¾‘ |

#### `modules/system/pages/sessions.js`

| è¡Œå· | å†…å®¹ | è¯´æ˜ |
|------|------|------|
| 58 | `session_id` | ä¼šè¯IDåˆ«å |
| 697 | `getPageNumbers()` | è·å–åˆ†é¡µé¡µç æ•°ç»„ï¼ˆHTMLæ¨¡æ¿å…¼å®¹æ–¹æ³•ï¼‰ |

#### `modules/market/pages/trade-management.js`

| è¡Œå· | å†…å®¹ | è¯´æ˜ |
|------|------|------|
| 638 | `selectedTrade` | æ—§ç‰ˆå…¼å®¹ï¼šé€‰ä¸­çš„äº¤æ˜“ï¼ˆç”¨äºæ—§ç‰ˆæ¨¡æ€æ¡†ï¼‰ |

---

## 3ï¸âƒ£ æ•°æ®è½¬æ¢å±‚ï¼ˆåç«¯â†”å‰ç«¯å­—æ®µæ˜ å°„ï¼‰

### 3.1 è¯´æ˜

ä»¥ä¸‹æ˜¯**åˆç†çš„**å‰åç«¯æ•°æ®æ ¼å¼è½¬æ¢ï¼Œå› ä¸šåŠ¡éœ€è¦è€Œå­˜åœ¨ï¼Œå»ºè®®**ä¿ç•™**ã€‚

### 3.2 è¯¦ç»†æ¸…å•

| æ–‡ä»¶ | è¡Œå· | è½¬æ¢å†…å®¹ | åŸå›  |
|------|------|----------|------|
| `modules/system/composables/dict.js` | 22-26 | å­—æ®µæ˜ å°„é…ç½®ï¼ˆåç«¯å­—æ®µå â†’ å‰ç«¯ä½¿ç”¨ï¼‰ | æ¸…æ™°çš„æ˜ å°„å®šä¹‰ |
| `modules/system/composables/config.js` | 74 | åç«¯ settings æ•°ç»„æ ¼å¼è½¬æ¢ä¸ºé”®å€¼å¯¹ | ä¸šåŠ¡éœ€è¦ |
| `modules/system/composables/config.js` | 130 | è½¬æ¢ä¸ºåç«¯æœŸæœ›çš„æ ¼å¼ | æäº¤æ•°æ®éœ€è¦ |
| `modules/lottery/composables/prizes.js` | 161 | `win_probability` è½¬æ¢ä¸ºç™¾åˆ†æ¯”æ˜¾ç¤º | å±•ç¤ºéœ€è¦ |
| `modules/lottery/composables/prizes.js` | 255 | `-1`ï¼ˆå‰ç«¯æ— é™åº“å­˜ï¼‰è½¬æ¢ä¸º `999999` | åç«¯è¦æ±‚æ­£æ•´æ•° |
| `modules/lottery/composables/quota.js` | 195 | `scope_type/scope_id` è½¬æ¢ä¸ºå‰ç«¯è¡¨å•å­—æ®µ | è¡¨å•å±•ç¤ºéœ€è¦ |
| `modules/system/pages/risk-alerts.js` | 417 | æ—¶é—´èŒƒå›´è½¬æ¢ä¸º `start_time`ï¼ˆåç«¯æ ¼å¼ï¼‰ | API å‚æ•°æ ¼å¼ |
| `modules/analytics/composables/campaign-budget.js` | 86 | åç«¯åµŒå¥—ç»“æ„è½¬æ¢ä¸ºæ‰å¹³ç»“æ„ | å‰ç«¯ä½¿ç”¨æ–¹ä¾¿ |
| `modules/asset/pages/asset-management.js` | 214 | å‚æ•°åè½¬æ¢ä¸ºåç«¯æ ¼å¼ | API è°ƒç”¨éœ€è¦ |

---

## 4ï¸âƒ£ Mixin/ç»„ä»¶å…¼å®¹

| æ–‡ä»¶ | è¡Œå· | å†…å®¹ | è¯´æ˜ |
|------|------|------|------|
| `alpine/mixins/async-data.js` | 113 | `submitting` | è¡¨å•æäº¤çŠ¶æ€åˆ«åï¼ˆå…¼å®¹æ—§ä»£ç ï¼‰ |
| `alpine/mixins/auth-guard.js` | 38 | `userInfo` | ç”¨æˆ·ä¿¡æ¯ï¼ˆå‘åå…¼å®¹åˆ«åï¼‰ |
| `alpine/mixins/auth-guard.js` | 79 | `this.userInfo = user` | å‘åå…¼å®¹èµ‹å€¼ |
| `alpine/index.js` | 151 | `show()` | é€šç”¨æ˜¾ç¤ºæ–¹æ³•ï¼ˆå…¼å®¹æ—§ä»£ç ï¼‰ |

---

## 5ï¸âƒ£ æ—§æ–¹æ³•åå…¼å®¹

| æ–‡ä»¶ | è¡Œå· | æ—§æ–¹æ³• | æ–°æ–¹æ³• | å¤„ç†å»ºè®® |
|------|------|--------|--------|----------|
| `modules/system/composables/config.js` | 327 | `loadPricingConfigs()` | `loadPointsConfigs()` | **å¾…åˆ é™¤** |

---

## ğŸ¯ å¤„ç†ä¼˜å…ˆçº§å»ºè®®

### P0 - ç«‹å³åˆ é™¤ï¼ˆ1å¤©ï¼‰

1. **åˆ é™¤å†—ä½™è½¬å‘æ¨¡å— `api/system.js`**
   - ä¿®æ”¹9ä¸ªå¼•ç”¨æ–‡ä»¶ï¼Œæ”¹ç”¨ `api/system/index.js`
   - åˆ é™¤ `api/system.js` è½¬å‘æ–‡ä»¶
   - ä¸ lottery/market æ¨¡å—ä¿æŒä¸€è‡´

2. **åˆ é™¤ @deprecated API æ–¹æ³•**
   - `api/asset.js` ä¸­çš„ `adjustPoints()` å’Œ `adjustDiamond()`
   - æœç´¢æ‰€æœ‰è°ƒç”¨å¤„ï¼Œæ›¿æ¢ä¸º `adjustAsset()`

3. **åˆ é™¤æ—§æ–¹æ³•åå…¼å®¹**
   - `modules/system/composables/config.js:327` çš„ `loadPricingConfigs()`

### P1 - çŸ­æœŸæ¸…ç†ï¼ˆ1-2å‘¨ï¼‰

1. **ç»Ÿä¸€ HTML æ¨¡æ¿ä¸ JS å˜é‡å**
   - é€‰æ‹©ä½¿ç”¨åç«¯å­—æ®µåæˆ–æ›´è¯­ä¹‰åŒ–çš„åç§°
   - ä¿®æ”¹ HTML æ¨¡æ¿ä¸­çš„å¼•ç”¨
   - åˆ é™¤ JS ä¸­çš„åˆ«å

2. **é‡ç‚¹æ¸…ç†æ–‡ä»¶**ï¼ˆæŒ‰å½±å“èŒƒå›´æ’åºï¼‰ï¼š
   - `orphan-frozen.js` - åˆ«åæœ€å¤š
   - `asset-adjustment.js` - åˆ«åè¾ƒå¤š
   - `risk-alerts.js` - åˆ«åè¾ƒå¤š

### P2 - ä¿ç•™ï¼ˆåˆç†çš„ä¸šåŠ¡è½¬æ¢ï¼‰

ä»¥ä¸‹å±äº**åˆç†çš„ä¸šåŠ¡æ•°æ®è½¬æ¢**ï¼Œéå‘åå…¼å®¹ä»£ç ï¼š

- æ•°æ®è½¬æ¢å±‚ä»£ç  - åç«¯è¿”å›æ ¼å¼ä¸å‰ç«¯å±•ç¤ºæ ¼å¼çš„åˆç†è½¬æ¢
- API èšåˆæ¨¡å— `*/index.js` - æ ‡å‡†æ¶æ„æ¨¡å¼ï¼ˆlottery/market/systemï¼‰
- ç™¾åˆ†æ¯”/æ•°å€¼è½¬æ¢ - å¦‚ `win_probability` ç™¾åˆ†æ¯”æ˜¾ç¤º

### âš ï¸ æ³¨æ„äº‹é¡¹

æ ¹æ®æ ¸å¿ƒåŸåˆ™ã€Œä»¥åç«¯ä¸ºå‡†ã€ï¼Œä»¥ä¸‹æƒ…å†µ**ä¸å±äº**ä¿ç•™èŒƒå›´ï¼š

- ä¸º HTML æ¨¡æ¿åˆ›å»ºçš„åˆ«åå±æ€§/æ–¹æ³• â†’ **å¿…é¡»åˆ é™¤**
- ä»…ä¸ºäº†"æ–¹ä¾¿"è€Œå­˜åœ¨çš„å­—æ®µæ˜ å°„ â†’ **å¿…é¡»åˆ é™¤**
- æ—§ç‰ˆæœ¬å…¼å®¹ä»£ç  â†’ **å¿…é¡»åˆ é™¤**

---

## ğŸ“ æ¸…ç†åŸåˆ™

1. **ä¿®æ”¹ HTML ä¼˜å…ˆäºä¿®æ”¹ JS**
   - HTML æ¨¡æ¿ä¸­çš„å˜é‡ååº”è¯¥ä¸ JS å®šä¹‰ä¸€è‡´
   - ä¸è¦ä¸ºäº† HTML æ¨¡æ¿åˆ›å»ºåˆ«å

2. **ä½¿ç”¨åç«¯å­—æ®µå**
   - ç›´æ¥ä½¿ç”¨åç«¯è¿”å›çš„å­—æ®µå
   - é¿å…å‰ç«¯é¢å¤–çš„å­—æ®µæ˜ å°„

3. **åˆ é™¤è€Œéæ³¨é‡Š**
   - åºŸå¼ƒçš„ä»£ç ç›´æ¥åˆ é™¤
   - ä¸è¦ç”¨æ³¨é‡Šä¿ç•™

4. **æµ‹è¯•éªŒè¯**
   - æ¯ä¸ªæ¸…ç†é¡¹å®Œæˆåé‡æ–°æ„å»ºæµ‹è¯•
   - ç¡®ä¿åŠŸèƒ½ä¸å—å½±å“

---

## âœ… å¾…æ¸…ç†ä»»åŠ¡æ¸…å•

### ç«‹å³æ‰§è¡Œï¼ˆP0ï¼‰

#### ~~åˆ é™¤å†—ä½™è½¬å‘æ¨¡å— `api/system.js`~~ âœ… å·²å®Œæˆ (2026-01-30)
- [x] `modules/system/composables/config.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/system/composables/audit-logs.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/system/composables/dict.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/system/composables/feature-flags.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/system/pages/risk-alerts.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/system/pages/config-tools.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/store/pages/store-management.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/analytics/pages/statistics.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] `modules/content/pages/content-management.js`: æ”¹ä¸º `from '../../../api/system/index.js'`
- [x] åˆ é™¤ `api/system.js` è½¬å‘æ–‡ä»¶

#### ~~åˆ é™¤ @deprecated API æ–¹æ³•~~ âœ… å·²å®Œæˆ (2026-01-30)
- [x] åˆ é™¤ `api/asset.js` çš„ `adjustUserMaterial()` æ–¹æ³•
- [x] åˆ é™¤ `api/asset.js` çš„ `adjustDiamond()` æ–¹æ³•
- [x] åˆ é™¤ `modules/system/composables/config.js` çš„ `loadPricingConfigs()` å’Œ `savePricingConfigs()` å…¼å®¹æ–¹æ³•
- [x] åˆ é™¤ `api/lottery/advanced.js` çš„ `STRATEGY_STATS_OVERVIEW` åˆ«åï¼ˆå·²å°† `analytics.js` æ”¹ç”¨ `STRATEGY_STATS_REALTIME`ï¼‰

### çŸ­æœŸæ¸…ç†ï¼ˆP1ï¼‰

#### orphan-frozen.js + orphan-frozen.html
- [ ] HTML ä¸­ `assets` â†’ `orphanList`
- [ ] åˆ é™¤ JS ä¸­ `this.assets = this.orphanList` åŒæ­¥
- [ ] åˆ é™¤ `loadAssets()` åˆ«åæ–¹æ³•
- [ ] åˆ é™¤ `scanOrphanAssets()` åˆ«åæ–¹æ³•
- [ ] åˆ é™¤ `processAsset()` åˆ«åæ–¹æ³•

#### asset-adjustment.js + asset-adjustment.html
- [ ] åˆ é™¤ `records` åˆ«åå±æ€§
- [ ] åˆ é™¤ `materialTypes` åˆ«åå±æ€§
- [ ] åˆ é™¤ `searchUser()` åˆ«åæ–¹æ³•ï¼ŒHTML ç›´æ¥è°ƒç”¨ `handleSearch()`
- [ ] åˆ é™¤ `formatDate()` åˆ«åæ–¹æ³•

#### risk-alerts.js + risk-alerts.html
- [ ] åˆ é™¤ `selectAlert()` åˆ«åæ–¹æ³•
- [ ] åˆ é™¤ `getAlertTypeLabel()` åˆ«åæ–¹æ³•
- [ ] åˆ é™¤ `getStatusLabel()` åˆ«åæ–¹æ³•
- [ ] åˆ é™¤ `formatDateTime()` åˆ«åæ–¹æ³•

#### consumption.js + ç›¸å…³ HTMLï¼ˆå‘½åé£æ ¼ç»Ÿä¸€ï¼‰
- [ ] åˆ é™¤ `userId` camelCase åˆ«å
- [ ] HTML ä¸­ `consumptionFilters.userId` â†’ `consumptionFilters.user_id`
- [ ] åˆ é™¤ `loadConsumption()` ç©ºå£³æ–¹æ³•
- [ ] HTML ä¸­ `loadConsumption()` â†’ `loadConsumptions()`

#### å…¶ä»–æ–‡ä»¶
- [ ] `trade-management.js`: åˆ é™¤ `selectedTrade` æ—§ç‰ˆå…¼å®¹

### æ¶æ„ä¼˜åŒ–ï¼ˆP2ï¼‰

#### users.js - åŒé‡çŠ¶æ€é‡æ„ï¼ˆå•ä¸€å¯¹è±¡ + Getter æ–¹æ¡ˆï¼‰

**é—®é¢˜æè¿°**ï¼š
```javascript
// âŒ å½“å‰ï¼šåŒé‡çŠ¶æ€ï¼Œéœ€æ‰‹åŠ¨åŒæ­¥
this.page = 1              // ç‹¬ç«‹å±æ€§
this.total = 0
this.totalPages = 1

this.pagination = {        // å¯¹è±¡å±æ€§ï¼ˆå†—ä½™ï¼‰
  page: 1, 
  total: 0, 
  totalPages: 1 
}

// æ¯æ¬¡éƒ½è¦æ‰‹åŠ¨åŒæ­¥ï¼Œå®¹æ˜“é—æ¼
this.pagination.total = this.total
this.pagination.page = this.page
```

**è§£å†³æ–¹æ¡ˆ**ï¼šé‡‡ç”¨ã€Œå•ä¸€å¯¹è±¡ + Getterã€æ–¹æ¡ˆ
```javascript
// âœ… é‡æ„åï¼šå•ä¸€æ•°æ®æº + è‡ªåŠ¨è®¡ç®—
export function useUsersState() {
  return {
    // åªä¿ç•™ pagination å¯¹è±¡
    pagination: {
      page: 1,
      pageSize: 20,
      total: 0
    },
    
    // æ´¾ç”Ÿæ•°æ®ç”¨ getterï¼Œè‡ªåŠ¨è®¡ç®—
    get totalPages() {
      return Math.ceil(this.pagination.total / this.pagination.pageSize) || 1
    },
    
    get hasNextPage() {
      return this.pagination.page < this.totalPages
    },
    
    get hasPrevPage() {
      return this.pagination.page > 1
    }
  }
}

export function useUsersMethods() {
  return {
    async loadUsers() {
      const { page, pageSize } = this.pagination
      const result = await UserAPI.getUsers({ page, page_size: pageSize })
      
      this.users = result.data.users
      this.pagination.total = result.data.total
      // âœ… ä¸éœ€è¦æ‰‹åŠ¨åŒæ­¥ï¼ŒtotalPages è‡ªåŠ¨è®¡ç®—
    },
    
    goToPage(page) {
      this.pagination.page = page
      this.loadUsers()
    }
  }
}
```

**HTML æ¨¡æ¿é€‚é…**ï¼š
```html
<!-- ä¿®æ”¹å‰ -->
<span x-text="pagination.totalPages"></span>

<!-- ä¿®æ”¹åï¼ˆä½¿ç”¨ getterï¼‰ -->
<span x-text="totalPages"></span>
```

**é‡æ„æ­¥éª¤**ï¼š
- [ ] åˆ é™¤ Mixin ä¸­çš„ç‹¬ç«‹å±æ€§ `page`, `total`, `totalPages`
- [ ] ä¿ç•™ `pagination` å¯¹è±¡ä½œä¸ºå”¯ä¸€æ•°æ®æº
- [ ] æ·»åŠ  getterï¼š`totalPages`, `hasNextPage`, `hasPrevPage`
- [ ] åˆ é™¤åŒæ­¥ä»£ç  `this.pagination.xxx = this.xxx`
- [ ] ä¿®æ”¹ HTML æ¨¡æ¿å¼•ç”¨
- [ ] æµ‹è¯•éªŒè¯åˆ†é¡µåŠŸèƒ½

---

## ğŸ“Œ ç›¸å…³æ–‡æ¡£

- [æŠ€æœ¯å€ºåŠ¡åˆ†ææŠ¥å‘Š](./æŠ€æœ¯å€ºåŠ¡åˆ†ææŠ¥å‘Š.md)
- [API æ¨¡å—æ‹†åˆ†è®°å½•](../src/api/system/index.js) - æŸ¥çœ‹æ–‡ä»¶å¤´éƒ¨æ³¨é‡Š

---

## ğŸ“‹ å˜æ›´è®°å½•

| æ—¥æœŸ | å˜æ›´å†…å®¹ |
|------|----------|
| 2026-01-29 | åˆå§‹ç”Ÿæˆï¼ŒåŸºäºä»£ç åˆ†æ |
| 2026-01-29 | æ·»åŠ æ ¸å¿ƒåŸåˆ™ï¼šä»¥åç«¯ä¸ºå‡†ï¼Œä¸å‘åå…¼å®¹ |
| 2026-01-30 | ä»£ç éªŒè¯ï¼šä¿®æ­£æ–‡ä»¶è·¯å¾„ `api/lottery.js` â†’ `api/lottery/index.js`ï¼ˆèšåˆæ¨¡å—ï¼‰ï¼›æ˜ç¡®èšåˆæ¨¡å—å±äºæ ‡å‡†æ¶æ„æ¨¡å¼éå…¼å®¹ä»£ç  |
| 2026-01-30 | æ–°å¢ï¼š`api/system.js` å†—ä½™è½¬å‘æ¨¡å—é—®é¢˜ï¼Œä¸ lottery/market ä¸ä¸€è‡´ï¼Œéœ€åˆ é™¤ï¼›æ·»åŠ 9ä¸ªæ–‡ä»¶çš„å¯¼å…¥è·¯å¾„ä¿®æ”¹ä»»åŠ¡ |
| 2026-01-30 | **P0 ä»»åŠ¡å…¨éƒ¨å®Œæˆ**ï¼šåˆ é™¤ `api/system.js` è½¬å‘æ–‡ä»¶ã€ä¿®æ”¹9ä¸ªå¯¼å…¥è·¯å¾„ã€åˆ é™¤åºŸå¼ƒ API æ–¹æ³•å’Œåˆ«åï¼Œæ„å»ºéªŒè¯é€šè¿‡ |
| 2026-01-30 | **æ–°å¢æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ**ï¼š`users.js` åŒé‡çŠ¶æ€é—®é¢˜é‡‡ç”¨ã€Œå•ä¸€å¯¹è±¡ + Getterã€æ–¹æ¡ˆè§£å†³ï¼Œæ·»åŠ è¯¦ç»†é‡æ„æ­¥éª¤ |
| 2026-01-30 | **æ–°å¢å‘½åé£æ ¼è§„èŒƒ**ï¼šç»Ÿä¸€ä½¿ç”¨ snake_caseï¼ˆåç«¯å­—æ®µåï¼‰ï¼Œç¦æ­¢ camelCase åˆ«åï¼›æ›´æ–° `consumption.js` æ¸…ç†ä»»åŠ¡ |
| 2026-01-30 | **æ–°å¢å®‰å…¨æ€§è¯„ä¼°**ï¼šåˆ†æ snake_case åœ¨æœ¬é¡¹ç›®ä¸­çš„å…¼å®¹æ€§ï¼Œç»“è®ºæ˜¯ä¸ä¼šé€ æˆéšæ‚£ï¼›æ·»åŠ ä½¿ç”¨æ³¨æ„äº‹é¡¹ |

---

*æœ¬æ–‡æ¡£ç”±ä»£ç åˆ†æè‡ªåŠ¨ç”Ÿæˆï¼Œéµå¾ªã€Œä»¥åç«¯æ•°æ®åº“ä¸ºå‡†ï¼Œä¿®æ”¹å‰ç«¯é€‚é…åç«¯ã€åŸåˆ™ã€‚*

