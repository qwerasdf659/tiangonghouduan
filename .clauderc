{
  "rules": [
    "始终使用简体中文回答和编写代码注释 (Always respond in Chinese-simplified)",
    "代码要有详细注释，说明功能和逻辑",
    "编写最小化、实用主义的代码实现",
    "优先编辑现有文件而不是创建新文件",
    "遵循项目现有的命名规范（snake_case for files, camelCase for JS）",
    "不自动添加测试代码，除非明确要求",
    "保持代码简洁，避免过度工程化",
    "注重实际可运行的代码，而非理论完美",
    "删除未使用的代码，不保留向后兼容的hack",
    "编写、修改、新增、删除代��时不要破坏项目原有功能",
    "深度理解项目的所有代码、文档和注释后再完成任务",
    "完成任务后检查项目是否可以正常运行，有问题立即修复",
    "说明思考过程、问题点、使用的工具、需要安装的依赖和解决方案",
    "完成任务后自动删除临时文件、测试文件、无用文件和重复的md文件，移除相关引用",
    "确保代码符合微信小程序开发标准，检查API和框架兼容性",
    "每次回答时说明使用的AI模型",
    "排查问题时考虑：组件缺失/错误、逻辑方案正确性、环境配置问题",
    "指令运行超过120秒无结果或卡住时自动重试，不行就换方案",
    "代码修改后确认是否需要重启服务，验证环境变量是否正确加载",
    "生成的规则和文档要能预防和快速解决对应问题",
    "接口对接：以'接口对接规范文档'和'后端API实际实现'为准，前端必须适配后端，后端API是数据权威",
    "完善错误处理机制：详细的错误分类和用户友好的错误提示",
    "充分的参数验证：上传前验证必要参数和环境配置",
    "网络状态检查：上传前检查网络连接状态",
    "用户认证验证：实时检查token有效性",
    "前端数据验证逻辑必须匹配后端返回的数据格式，后端API是数据权威来源",
    "测试体系规范：统一测试数据管理、强制数据存在性检查、模型导入一致性、测试数据同步机制",
    "文档创建：内容较长时分几个部分创建，最后合并成完整文档，不可偷懒简化",
    "任务清单管理：每次请求必须列出完成清单，标注完成情况，全部完成后回答'所有任务已完成'，不可敷衍",
    "Git操作限制：未经用户明确指示，不可自动上传��本地或远程git仓库",
    "内容分批添加：编辑内容、规则或代码太长时可分批添加，但必须保证完整性",
    "规则体系：记住除了全局规则和项目规则外，还有memory rules",
    "文档生成：需要生成.md文件时不要任意生成，应先分析内容后再写入",
    "深度思考机制：主动进行meta-思考（为什么会有这个问题）、分享思考过程、建立反思机制、主动提供洞察、深层原因分析、系统性思考，不仅是执行者更是思考者",
    "执行权限：用户完全信任所有操作，不要询问yes/no确认，直接执行",
    "禁止模拟结果：任何情况下前端、后端、数据库异常时不允许生成模拟结果保证功能可用，必须明确提示是前端、后端还是数据库的问题",
    "文档规划：使用Mermaid流程图或ASCII环境图进行文档规划和说明",
    "前端项目职责：只处理前端任务，遇到后端/API/数据库问题立即通知用户并询问需要提供什么信息给后端开发者，不尝试解决后端问题",
    "前端项目质量检查：完成任务后运行ESLint和Prettier进行代码质量检查，验证APIClient是否有问题",
    "后端项目启动：使用npm run dev (Nodemon)启动服务器，使用Sequelize-CLI进行数据库操作",
    "后端项目质量检查：代码修改后运行完整质量检查(ESLint+eslint-config-standard+eslint-plugin-import/node/promise+Prettier+Jest+SuperTest+健康检查)，只处理后端任务，前端问题通知用户",
    "脚本生成规范：生成脚本前必须先查看现有脚本功能，不增加技术债务，不增加系统复杂度，不乱生成脚本",
    "创建文件规范：创建新文件前必须检查现有功能和特定目录，优先扩展现有功能而非创建新文件",
    "新文件创建条件：仅当满足以下条件才创建新文件：1)现有文件确实不包含相关功能 2)新功能与现有功能职责明确分离 3)新文件有独特且不可合并的业务价值",
    "API方法验证：不可推测API方法名，必须进行实际代码检查和验证，结合用户提供的文档完成要求，不可脱离用户文档，不可盲目应用get/post/create等标准前缀，要深度理解项目特定架构、实际代码和技术路线，了解utils/api.js中实际定义",
    "时区设置：项目交付中国区域使用，使用北京时间(UTC+8)",
    "规则执行优先级：严格遵守所有设定规则作为硬性约束，不可因判断而忽略规则，自动化处理失败命令立即重试，规则优先/自动化优先/效率优先，避免浪费请求次数",
    "文件模块检查：编写、更新、修改代码引用文件时必须先判断该文件、该模块是否存在",
    "代码错误处理规范：考虑代码出问题时不显示空白页面，必须有友好提示、加载状态显示、详细错误信息（具体原因和解决建议）",
    "禁止模拟数据：项目中除临时测试外任何操作不准使用模拟数据、mock数据，只准使用后端真实数据，仅手机号验证登录环节可使用万能验证码123456（仅限开发测试环境）",
    "错误提示规范：出现问题必须在页面准确提醒具体哪里有问题，不可乱提示或无提示，必须有相应保护措施",
    "命令语法适配：根据操作系统环境调整命令语法，Windows PowerShell使用分号(;)而非&&，避免使用过长复合命令",
    "文档生成限制：未经要求不得额外生成文档",
    "文档日期真实性：文档中的日期必须真实准确，更新文档时间时使用终端命令(date)获取当前时间，不依赖用户提供时间",
    "数据库表结构变更：禁止在生产环境频繁使用sequelize.sync({ alter: true })或force: true，表结构变更必须通过手动SQL脚本或迁移工具完成",
    "数据库索引管理：每张表的索��总数不得超过MySQL的64个限制，如需新增索引必须先评估和清理无用索引",
    "数据库初始化脚本：必须加超时和详细日志，如遇长时间无响应需立即排查数据库连接和表结构问题，运行超过2分钟时应检查数据库状态和表结构，使用timeout命令限制脚本运行时间",
    "数据库批量操作：大批量数据插入必须分批处理，每批不超过100条，避免单次SQL阻塞",
    "数据库变更审查：所有表结构和索引变更需在代码评审时重点检查，防止上线后阻塞数据库",
    "测试数据统一管理：所有测试用户数据必须定义在统一的配置文件中（如config/test-data.js），禁止在多个文件中硬编码相同的测试数据，初始化脚本和测试脚本必须引用同一个数据源",
    "测试脚本命名规��：只保留一个主要的初始化脚本，其他过时脚本必须删除或明确标记，测试脚本必须包含数据存在性检查，所有数据库操作前必须验证依赖数据是否存在",
    "测试模型导入���致性：所有测试文件的模型导入路径必须一致，使用相对路径时必须确保从当前文件位置正确导入，添加模型导入失败的错误处理",
    "测试数据同步检查：每次修改初始化脚本时必须同步更新相关的测试脚本，在CI/CD中添加测试数据一致性检查，测试失败时输出明确的错误信息包含期望数据和实际数据",
    "测试错误处理强化：所有数据库查询必须检查返回结果是否为null/undefined，使用try-catch包装可能失败的操作，提供有意义的错误消息便于快速定位问题",
    "Node.js内存管理：开发环境必须设置合理的内存限制避免超过80%，使用NODE_OPTIONS='--max-old-space-size=512'控制堆内存，PM2配置max_memory_restart低于实际内存限制，超过75%时自动重启，避免开发环境使用集群模式优先fork模式",
    "API路径规范：健康检查端点必须同时提供/health和/api/health两个路径，所有API端点必须有错误处理机制，路径变更时必须同步更新文档和测试用例，实施API版本控制和向后兼容策略",
    "服务监控规范：所有服务组件必须实现isHealthy()方法，WebSocket等实时服务需要实现连接计数和状态检查，健康检查端点必须返回详细的服务状态信息，实施服务依赖检查和故障隔离机制",
    "Node.js进程管理：开发环境使用单进程模式生产环境可使用集群模式，配置合理的进程重启策略和超时时间，实施优雅关闭机制确保数据一致性，配置日志轮转和存储策略",
    "Node.js资源优化：启动参数必须根据环境进行优化，避免使用不支持的启动参数组合，实施资源使用监控和告警机制，定期进行性能分析和优化",
    "Node.js错误处理：所有异步操作必须有错误处理，实施全局错误捕获和处理机制，错误信息必须包含上下文和解决建议，建立错误分类和优先级体系",
    "Node.js部署配置：环境配置必须区分开发测试生产环境，敏感信息必须通过环境变量管理，实施配置验证和兼容性检查，建立配置变更追踪机制",
    "端口占用管理：启动应用前必须检查端口占用状态netstat -tlnp，发现占用时先终止进程pkill -f，应用重启必须等待前一进程完全终止至少2秒间隔，使用PM2时检查进程状态，开发环境建议使用nodemon等热重载工具",
    "系统工具检查：使用系统工具前必须先检查命令可用性which command_name，常用调试工具优先级od>xxd>hexdump>file，建立标准工具替代方案映射，批量检查系统工具可用性避免逐一尝试失败",
    "编码问题诊断：使用od -c检查文件开头字符，使用python3脚本检查编码和BOM标记，并行检查文件大小和字符统计，根据诊断结果选择修复策略，禁止使用多种方法重复分析同一个编码问题，诊断不得超过3次工具调用",
    "文件大小与工具选择：文件<1KB使用任意工具，1KB-10KB优先search_replace或edit_file，10KB-50KB仅使用edit_file分段处理，>50KB使用grep_search定位+分段edit_file，中文文档编码问题优先使用python脚本修复后再编辑",
    "Cursor规则文件管理：处理cursor规则时必须首先检查.cursor/rules/目录，发现现有规则文件时禁止在根目录创建同名文件，所有cursor规则更新必须直接修改.cursor/rules/下的文件，规则更新后必须验证Cursor编辑器是否正确识别",
    "Git分支冲突处理：Git操作前必须先检查本地和远程分支状态git status和git remote -v，发现分支分歧时优先评估冲突程度选择合适策略，开发分支优先merge策略git config pull.rebase false，功能分支可考虑rebase策略，强制推送仅在确认不影响其他开发者时使用git push --force-with-lease",
    "Git命令执行优化：长输出命令必须添加限制参数git log --oneline -10，查看提交历史使用格式化输出，避免产生大量输出的命令，中文内容查看使用合适编码设置git config --global core.quotepath false，大型仓库操作设置合适超时timeout 60s",
    "Git文件管理：提交前必须检查.gitignore完整性，临时文件和构建产物必须明确排除，删除临时文件标准流程检查类型大小确认不在版本控制中批量删除，中文文件名处理使用引号包围",
    "Git远程仓库同步：推送前必须确认远程仓库状态和权限，大型推送使用进度显示git push --progress，网络不稳定环境设置重试机制最多3次，推送完成后验证远程仓库状态git ls-remote origin",
    "用户授权确认机制：任何git push/commit/merge等操作必须明确征得用户同意，删除移动重命名重要文件前必须确认，外部网络操作需要用户授权，修改.env/package.json等关键配置文件前确认，启动停止重启服务前征得同意",
    "操作范围边界控制：开始复杂任务前明确确认具体范围和边界，发现操作可能超出用户预期时立即停止并询问，建立操作风险等级分类高风险操作强制确认，对于可能产生重大影响的操作进行二次确认",
    "Cursor规则文件格式：所有cursor规则文档必须使用.mdc格式禁止使用.md格式，创建规则文档前必须检查现有文件格式ls -la .cursor/rules/*.mdc，规则文档创建后立即验证格式file .cursor/rules/新文档.mdc，发现格式错误时立即修正",
    "文件创建工具选择：新文件创建优先级cat命令>edit_file>search_replace，大文件编辑优先级edit_file分段>search_replace精确替换，中文内容文件优先使用cat命令或echo重定向，cursor规则文件强制使用cat命令创建避免edit_file异常",
    "文件操作强制验证：每次文件创建后立即检查文件大小和内容开头，使用head/tail命令验证文件内容正确性，确认文件格式符合预期，确认文件权限设置正确，发现异常立即删除重新创建",
    "重复请求识别处理：识别用户提出的重复或相似问题请求，记录已完成的任务和生成的规则，对重复请求提供简洁的状态确认而非重复执行，引用之前的分析结果和已完成的工作，仅对新发现的问题进行分析和规则生成",
    "任务完成状态管理：清晰标识哪些任务已完成，记录已生成的规则类型和覆盖范围，验证规则文档的更新完成状态，确认项目运行正常且无新问题，明确告知用户任务完成情况",
    "会话效率优化：缓存已检查的系统状态和配置信息，避免执行已完成的检查和分析，根据会话历史优化后续操作，避免不必要的重复计算和工具调用，提供清晰的任务进度和完成状态",
    "API路由验证：在访问任何API端点前必须先检查实际路由定义，使用grep -r确认路由存在，健康检查优先使用/health路径如404则尝试/api/health，避免盲目重复访问不存在的端点浪费请求次数",
    "命令执行超时控制：所有可能长时间运行的命令必须使用timeout限制，PM2日志查看timeout 10s pm2 logs --lines 10，网络请求curl -m 30或timeout 10s curl，文件搜索timeout 30s find或timeout 20s grep -r，超时时间设置原则简单操作10s复杂操作30-60s",
    "终端环境兼容性：识别和处理screen size bogus类型警告，设置合适的终端尺寸参数，确保命令输出在不同终端环境下正常显示，过滤不影响功能的终端警告信息，适配不同的终端和SSH环境",
    "进程数量监控：建立正常进程数量的基准值，定期检查Node.js和PM2相关进程数量，识别和处理异常或冗余的进程，优化进程配置以减少资源占用，建立定期的进程清理和优化流程",
    "数据库迁移规范：所有表结构变更必须通过迁移脚本完成禁止直接修改数据库，迁移脚本必须包含up和down操作支持回滚，重要迁移操作前必须备份数据库，迁移脚本执行前必须在测试环境验证，迁移操作必须在维护窗口期间执行避免影响正常业务",
    "数据库初始化幂等性：保持初始化脚本的幂等性可重复执行不产生副作用，初始化脚本必须包含完整的错误处理和日志记录，使用事务确保数据的一致性失败时自动回滚，初始化脚本运行时间监控超过预期时间自动报警",
    "数据库性能优化：定期分析查询性能识别和优化慢查询，合理设计索引策略避免过度索引和索引冗余，监控数据库连接池状态避免连接泄漏，实施数据库连接超时和重试机制，定期清理无用数据和日志控制数据库大小",
    "数据库表结构变更策略：优先使用ALTER TABLE而不是DROP TABLE处理表结构变更，避免在生产环境使用force模式重建数据库，表结构变更必须在代码评审时重点检查防止上线后阻塞数据库",
    "部署流程标准化：建立自动化的持续集成持续部署流程，部署前进行完整的回归测试，配置蓝绿部署或滚动发布策略，建立快速回滚机制",
    "监控和告警体系：实施全方位的应用性能监控，配置关键指标的告警机制，建立日志聚合和分析系统，实施健康检查和故障自愈机制",
    "Git操作授权控制：禁止未经授权的git push/commit/merge/rebase等操作前必须明确征得用户同意，执行前说明操作可能的影响范围和潜在风险，严格按照用户明确授权的范围执行git操作，高风险操作强制确认中风险操作建议确认低风险和只读操作可直接执行",
    "Git提交信息规范：提交信息必须使用有意义的描述，中文提交信息格式功能模块:具体修改内容，批量修改时提供详细的变更清单，重要功能变更必须在提交信息中说明影响范围",
    "中文文件名标准化：所有中文文件名必须使用UTF-8编码，避免使用特殊字符和空格优先使用连字符或下划线，文件名操作前必须验证编码，中文文件名在命令行操作时必须使用引号包围，避免在自动化脚本中直接处理包含中文的文件名",
    "UTF-8编码标准化：所有文档文件必须使用UTF-8无BOM编码，创建新文档时强制指定编码，禁止使用带BOM的UTF-8编码避免解析器异常，文档保存时验证编码格式file -i",
    "BOM标记检测清理：使用python3脚本检测BOM标记，清理BOM标记避免解析异常，批量BOM检测find配合python3脚本，新建文档时禁用BOM优先使用编程方式创建文档",
    "编码转换标准流程：使用chardet检测文档编码，GBK转UTF-8使用python3脚本处理，批量编码转换分文件类型处理避免二进制文件损坏，转换后验证对比转���前后的文档内容完整性",
    "跨平台编码兼容：Windows环境强制使用UTF-8，Linux环境验证locale设置grep UTF-8，跨平台文件传输时验证编码一致性，避免使用平台特定的编码格式如Windows-1252",
    "Git编码配置：设置git config --global core.quotepath false，设置i18n.commitencoding utf-8，设置i18n.logoutputencoding utf-8，.gitattributes配置*.md text eol=lf",
    "终端编码环境：设置export LANG=zh_CN.UTF-8，验证终端编码支持echo中文测试|od -c，配置终端字体支持中文显示，SSH连接时保持编码环境一致性",
    "编码问题快速诊断：第一步file -i检查文件编码类型，第二步od -c检查BOM标记，第三步chardet检测内容编码，第四步cat验证终端显示，禁止使用多种方法重复分析同一个编码问题",
    "编码修复标准流程：BOM问题使用Python脚本自动清理，编码转换先备份原文件再执行转换，文件名问题重命名为英文在文档内标注中文标题，跨平台问题统一使用UTF-8无BOM+LF换行",
    "大文件删除操作规范：删除大文件内容前必须分段审查每个章节的价值，禁止使用head/tail等命令一次性删除大范围内容，必须逐章节检查内容不能只看标题，删除范围超过100行时必须先读取内容确认无重要信息，技术文档删除时优先保留字段说明、业务逻辑、技术实现等核心内容",
    "文档内容分类保护：技术规范类内容（字段名、API参数、数据结构）必须保留，业务逻辑说明（业务场景、使用场景、技术实现）必须保留，开发指南类内容（错误处理、性能优化、最佳实践）必须保留，冗余说明性内容（文档特色、更新总结、维护建议）可以删除",
    "文档删除前验证机制：删除前使用grep检查是否包含关键技术术语，删除后立即验证关键内容是否保留，发现误删立即恢复重要内容，大文件操作采用分段处理+精确删除策略"
  ]
}
