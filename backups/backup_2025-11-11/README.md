# æ•°æ®åº“å®Œæ•´å¤‡ä»½ - 2025å¹´11æœˆ11æ—¥

## ğŸ“‹ å¤‡ä»½ä¿¡æ¯

- **å¤‡ä»½æ—¥æœŸ**: 2025å¹´11æœˆ11æ—¥ 00:13:27 (åŒ—äº¬æ—¶é—´)
- **æ•°æ®åº“ç‰ˆæœ¬**: MySQL 8.0.30
- **å¤‡ä»½å·¥å…·**: backup-toolkit.js v2.0
- **å¤‡ä»½ç±»å‹**: å®Œæ•´æ•°æ®åº“å¤‡ä»½ï¼ˆSQL + JSONåŒæ ¼å¼ + è¡¥å……å¤‡ä»½ï¼‰

## ğŸ“Š å¤‡ä»½ç»Ÿè®¡

### ä¸»å¤‡ä»½
- **æˆåŠŸå¤‡ä»½è¡¨æ•°**: 23/23 (100%)
- **æ€»è®°å½•æ•°**: 2,596æ¡
- **SQLæ–‡ä»¶å¤§å°**: 1.35 MB
- **JSONæ–‡ä»¶å¤§å°**: 2.30 MB

### è¡¥å……å¤‡ä»½ï¼ˆç¼ºå¤±çš„8å¼ è¡¨ï¼‰
- **è¡¥å……è¡¨æ•°**: 8å¼ 
- **è¡¥å……è®°å½•æ•°**: 248æ¡
- **JSONæ–‡ä»¶å¤§å°**: ~50 KB

### æ€»è®¡
- **æ€»è¡¨æ•°**: 31/31 (100%) âœ…
- **æ€»è®°å½•æ•°**: 2,844æ¡
- **æ€»æ–‡ä»¶å¤§å°**: ~3.7 MB

## ğŸ“¦ å¤‡ä»½å†…å®¹

### æ ¸å¿ƒä¸šåŠ¡è¡¨ (7å¼ è¡¨)
- `users` - 18æ¡è®°å½•
- `user_points_accounts` - 1æ¡è®°å½•  
- `points_transactions` - 4æ¡è®°å½•
- `lottery_draws` - 1,938æ¡è®°å½•
- `lottery_prizes` - 9æ¡è®°å½•
- `lottery_campaigns` - 1æ¡è®°å½•
- `lottery_presets` - 2æ¡è®°å½•

### äº¤æ˜“å’Œåº“å­˜è¡¨ (4å¼ è¡¨)
- `exchange_records` - 18æ¡è®°å½•
- `trade_records` - 1æ¡è®°å½•
- `user_inventory` - 3æ¡è®°å½•
- `products` - 49æ¡è®°å½•

### å®¢æœå’Œåé¦ˆè¡¨ (4å¼ è¡¨)
- `customer_service_sessions` - 3æ¡è®°å½•
- `chat_messages` - 53æ¡è®°å½•
- `feedbacks` - 25æ¡è®°å½•
- `content_review_records` - 32æ¡è®°å½•

### ç³»ç»Ÿé…ç½®è¡¨ (6å¼ è¡¨)
- `roles` - 6æ¡è®°å½•
- `user_roles` - 11æ¡è®°å½•
- `system_announcements` - 1æ¡è®°å½•
- `admin_operation_logs` - 295æ¡è®°å½•
- `authentication_sessions` - 0æ¡è®°å½• (ç©ºè¡¨)
- `sequelizemeta` - 107æ¡è®°å½•

### èµ„æºè¡¨ (1å¼ è¡¨)
- `image_resources` - 3æ¡è®°å½•

### å¤‡ä»½è¡¨ (1å¼ è¡¨)
- `user_roles_backup_20251009` - 16æ¡è®°å½•

### è¡¥å……å¤‡ä»½è¡¨ (8å¼ è¡¨)
- `audit_records` - 0æ¡è®°å½• (ç©ºè¡¨)
- `consumption_records` - 32æ¡è®°å½•
- `lottery_management_settings` - 19æ¡è®°å½•
- `role_change_logs` - 0æ¡è®°å½• (ç©ºè¡¨)
- `stores` - 0æ¡è®°å½• (ç©ºè¡¨)
- `user_hierarchy` - 0æ¡è®°å½• (ç©ºè¡¨)
- `user_premium_status` - 1æ¡è®°å½•
- `websocket_startup_logs` - 196æ¡è®°å½•

## ğŸ“ å¤‡ä»½æ–‡ä»¶

### SQLå¤‡ä»½
- **æ–‡ä»¶å**: `full_backup_2025-11-11_00-13-27-425+.sql`
- **MD5**: `5b5c741d3f1b822b92dca0ae7fb3449d`
- **æ ¼å¼**: SQL DDL + INSERTè¯­å¥
- **åŒ…å«å†…å®¹**:
  - è¡¨ç»“æ„ (CREATE TABLEè¯­å¥)
  - å®Œæ•´æ•°æ® (INSERTè¯­å¥)
  - ç´¢å¼•å®šä¹‰
  - å¤–é”®çº¦æŸ
  - å­—ç¬¦é›†è®¾ç½® (UTF-8)

### JSONå¤‡ä»½
- **æ–‡ä»¶å**: `full_backup_2025-11-11_00-13-27-425+.json`
- **MD5**: `60abc55cda09336c0fdaf38d2c7d98ec`
- **æ ¼å¼**: JSONç»“æ„åŒ–æ•°æ®
- **åŒ…å«å†…å®¹**:
  - è¡¨ç»“æ„ä¿¡æ¯
  - åˆ—å®šä¹‰ (å­—æ®µç±»å‹ã€é•¿åº¦ã€é»˜è®¤å€¼)
  - ç´¢å¼•ä¿¡æ¯
  - å®Œæ•´æ•°æ®
  - è¡¨ç»Ÿè®¡ä¿¡æ¯ (è¡Œæ•°ã€æ•°æ®é•¿åº¦ã€ç´¢å¼•é•¿åº¦)

### è¡¥å……å¤‡ä»½ï¼ˆJSONæ ¼å¼ï¼‰
- **æ–‡ä»¶å**: `supplement_backup_missing_tables.json`
- **MD5**: `626ac238157c21effe50241e5fa2303d`
- **æ ¼å¼**: JSONç»“æ„åŒ–æ•°æ®
- **åŒ…å«å†…å®¹**:
  - 8å¼ ç¼ºå¤±è¡¨çš„å®Œæ•´ç»“æ„å’Œæ•°æ®
  - `consumption_records` (32æ¡è®°å½•)
  - `lottery_management_settings` (19æ¡è®°å½•)
  - `user_premium_status` (1æ¡è®°å½•)
  - `websocket_startup_logs` (196æ¡è®°å½•)
  - 4å¼ ç©ºè¡¨çš„å®Œæ•´ç»“æ„

## âœ… å¤‡ä»½å®Œæ•´æ€§éªŒè¯

### æ•°æ®å®Œæ•´æ€§
- âœ… ä¸»å¤‡ä»½ï¼š23å¼ è¡¨å¤‡ä»½æˆåŠŸ
- âœ… è¡¥å……å¤‡ä»½ï¼š8å¼ è¡¨å¤‡ä»½æˆåŠŸ
- âœ… **æ€»è®¡ï¼š31/31å¼ è¡¨ (100%å®Œæ•´)** 
- âœ… åŒ…å«æ‰€æœ‰ç©ºè¡¨ï¼ˆ5å¼ ç©ºè¡¨çš„ç»“æ„å®Œæ•´ä¿å­˜ï¼‰
- âœ… è¡¨ç»“æ„å®Œæ•´ (å­—æ®µã€ç´¢å¼•ã€å¤–é”®çº¦æŸ)
- âœ… æ•°æ®è®°å½•å®Œæ•´ (2,844æ¡è®°å½•)

### ç‰ˆæœ¬å…¼å®¹æ€§
- âœ… MySQL 8.0.30 å…¼å®¹
- âœ… å­—ç¬¦é›†: UTF-8 (utf8mb4)
- âœ… æ—¶åŒº: +08:00 (åŒ—äº¬æ—¶é—´)

### æ–‡ä»¶å®Œæ•´æ€§
- âœ… SQLæ–‡ä»¶MD5æ ¡éªŒ: `5b5c741d3f1b822b92dca0ae7fb3449d`
- âœ… JSONä¸»å¤‡ä»½MD5æ ¡éªŒ: `60abc55cda09336c0fdaf38d2c7d98ec`
- âœ… JSONè¡¥å……å¤‡ä»½MD5æ ¡éªŒ: `626ac238157c21effe50241e5fa2303d`

## ğŸ”„ å¦‚ä½•æ¢å¤å¤‡ä»½

### å®Œæ•´æ¢å¤ï¼ˆæ¨èï¼‰

**æ­¥éª¤1ï¼šæ¢å¤ä¸»å¤‡ä»½ï¼ˆ23å¼ è¡¨ï¼‰**
```bash
# ä½¿ç”¨JSONæ¢å¤
node scripts/database/backup-toolkit.js --action=restore --file=backups/backup_2025-11-11/full_backup_2025-11-11_00-13-27-425+.json

# æˆ–ä½¿ç”¨SQLæ¢å¤
mysql -h dbconn.sealosbja.site -P 42569 -u root -p restaurant_points_dev < backups/backup_2025-11-11/full_backup_2025-11-11_00-13-27-425+.sql
```

**æ­¥éª¤2ï¼šæ¢å¤è¡¥å……å¤‡ä»½ï¼ˆ8å¼ è¡¨ï¼‰**
```bash
node scripts/database/backup-toolkit.js --action=restore --file=backups/backup_2025-11-11/supplement_backup_missing_tables.json
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ¢å¤å‰å¿…é¡»å¤‡ä»½**: æ¢å¤æ“ä½œä¼šè¦†ç›–å½“å‰æ•°æ®ï¼Œè¯·å…ˆå¤‡ä»½ç°æœ‰æ•°æ®
2. **éªŒè¯MD5**: æ¢å¤å‰è¯·éªŒè¯æ–‡ä»¶MD5ï¼Œç¡®ä¿æ–‡ä»¶å®Œæ•´æ€§
3. **ç¯å¢ƒä¸€è‡´æ€§**: ç¡®ä¿ç›®æ ‡æ•°æ®åº“ç‰ˆæœ¬å…¼å®¹ (MySQL 8.0+)
4. **æƒé™æ£€æŸ¥**: ç¡®ä¿æ•°æ®åº“ç”¨æˆ·æœ‰è¶³å¤Ÿçš„æƒé™ (CREATE, DROP, INSERT)
5. **å­˜å‚¨ç©ºé—´**: ç¡®ä¿ç›®æ ‡æ•°æ®åº“æœ‰è¶³å¤Ÿçš„å­˜å‚¨ç©ºé—´ (è‡³å°‘3 MB)

## ğŸ“ å¤‡ä»½è¯´æ˜

è¿™æ˜¯ä¸€ä¸ª**å®Œæ•´ä¸”æ­£ç¡®**çš„æ•°æ®åº“å¤‡ä»½ï¼ŒåŒ…å«ï¼š
- âœ… å½“å‰æ•°æ®åº“**æ‰€æœ‰31å¼ è¡¨** (ä¸»å¤‡ä»½23å¼  + è¡¥å……å¤‡ä»½8å¼ )
- âœ… å®Œæ•´çš„è¡¨ç»“æ„å®šä¹‰ï¼ˆåŒ…æ‹¬CREATE TABLEè¯­å¥ï¼‰
- âœ… æ‰€æœ‰æ•°æ®è®°å½•ï¼ˆ2,844æ¡ï¼ŒåŒ…æ‹¬5å¼ ç©ºè¡¨çš„ç»“æ„ï¼‰
- âœ… ç´¢å¼•å’Œå¤–é”®çº¦æŸå®Œæ•´ä¿å­˜
- âœ… å­—ç¬¦é›†å’Œæ—¶åŒºé…ç½®ï¼ˆUTF-8, +08:00ï¼‰
- âœ… ç‰ˆæœ¬å…¼å®¹æ€§ä¿¡æ¯ï¼ˆMySQL 8.0.30ï¼‰

### å¤‡ä»½ç»„æˆ

1. **ä¸»å¤‡ä»½** (`full_backup_2025-11-11_00-13-27-425+.*`)
   - SQLæ ¼å¼ï¼šå®Œæ•´çš„DDLå’ŒDMLè¯­å¥
   - JSONæ ¼å¼ï¼šç»“æ„åŒ–æ•°æ®ï¼Œä¾¿äºç¨‹åºè¯»å–

2. **è¡¥å……å¤‡ä»½** (`supplement_backup_missing_tables.json`)
   - åŒ…å«ä¸»å¤‡ä»½ä¸­é—æ¼çš„8å¼ è¡¨
   - å…±248æ¡æ•°æ®è®°å½•
   - 4å¼ ç©ºè¡¨çš„å®Œæ•´ç»“æ„

### æ•°æ®æ—¶é—´ç‚¹

æœ¬å¤‡ä»½æ–‡ä»¶å¯ä»¥å®Œæ•´æ¢å¤æ•°æ®åº“åˆ°**2025å¹´11æœˆ11æ—¥ 00:13:27**ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰çš„çŠ¶æ€ã€‚

### é‡è¦æ€§è¯´æ˜

âš ï¸ **è¡¥å……å¤‡ä»½æ–‡ä»¶åŒæ ·é‡è¦**ï¼ŒåŒ…å«ï¼š
- æ¶ˆè´¹è®°å½•è¡¨ï¼ˆ32æ¡ï¼‰
- æŠ½å¥–ç®¡ç†è®¾ç½®ï¼ˆ19æ¡ï¼‰
- ç”¨æˆ·ä¼šå‘˜çŠ¶æ€ï¼ˆ1æ¡ï¼‰
- WebSocketå¯åŠ¨æ—¥å¿—ï¼ˆ196æ¡ï¼‰

æ¢å¤æ•°æ®åº“æ—¶**å¿…é¡»åŒæ—¶æ¢å¤ä¸»å¤‡ä»½å’Œè¡¥å……å¤‡ä»½**æ‰èƒ½ç¡®ä¿æ•°æ®å®Œæ•´æ€§ï¼

