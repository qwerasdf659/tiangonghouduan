# 2025å¹´12æœˆ19æ—¥æ•°æ®åº“å¤‡ä»½éªŒè¯æŠ¥å‘Š

## âœ… å¤‡ä»½å®Œæ•´æ€§éªŒè¯

### å¤‡ä»½æ‰§è¡Œä¿¡æ¯

- **æ‰§è¡Œæ—¶é—´**: 2025/12/19 23:43:47 (åŒ—äº¬æ—¶é—´)
- **æ‰§è¡Œå·¥å…·**: `scripts/database/create-full-backup-20251219.js`
- **å¤‡ä»½ç›®æ ‡**: MySQL 8.0.30 / restaurant_points_dev
- **å­—ç¬¦é›†**: utf8mb4 / utf8mb4_unicode_ci
- **æ—¶åŒº**: +08:00 (åŒ—äº¬æ—¶é—´)

### å¤‡ä»½èŒƒå›´ç»Ÿè®¡

- âœ… **æ€»è¡¨æ•°**: 44ä¸ªè¡¨
- âœ… **æˆåŠŸå¤‡ä»½**: 44ä¸ªè¡¨ (100%)
- âœ… **å¤±è´¥è¡¨æ•°**: 0ä¸ªè¡¨
- âœ… **æ€»è®°å½•æ•°**: 4,864è¡Œæ•°æ®
- âœ… **ç©ºè¡¨å¤„ç†**: å·²åŒ…å«æ‰€æœ‰ç©ºè¡¨çš„ç»“æ„

### å¤‡ä»½æ–‡ä»¶åˆ—è¡¨

1. âœ… **SQLå¤‡ä»½**: `full_backup_2025-12-19_2025-12-19_15-43-47-055+.sql` (2.86 MB)
2. âœ… **JSONå¤‡ä»½**: `full_backup_2025-12-19_2025-12-19_15-43-47-055+.json` (4.49 MB)
3. âœ… **MD5æ ¡éªŒ**: `BACKUP_MD5_2025-12-19.txt`
4. âœ… **è¯´æ˜æ–‡æ¡£**: `README.md`
5. âœ… **éªŒè¯æŠ¥å‘Š**: `BACKUP_VERIFICATION_REPORT.md` (æœ¬æ–‡ä»¶)

## ğŸ“Š æ•°æ®åº“ç»“æ„å®Œæ•´æ€§éªŒè¯

### 44ä¸ªè¡¨çš„ç»“æ„éªŒè¯æ¸…å•

#### æ ¸å¿ƒä¸šåŠ¡è¡¨ (26ä¸ª)

- âœ… `users` - ç”¨æˆ·è¡¨ (22è¡Œ)
- âœ… `user_roles` - ç”¨æˆ·è§’è‰²è¡¨ (13è¡Œ)
- âœ… `roles` - è§’è‰²å®šä¹‰è¡¨ (6è¡Œ)
- âœ… `accounts` - è´¦æˆ·è¡¨ (10è¡Œ)
- âœ… `user_points_accounts` - ç”¨æˆ·ç§¯åˆ†è´¦æˆ· (3è¡Œ)
- âœ… `user_asset_accounts` - ç”¨æˆ·èµ„äº§è´¦æˆ· (1è¡Œ)
- âœ… `account_asset_balances` - è´¦æˆ·èµ„äº§ä½™é¢ (3è¡Œ)
- âœ… `products` - å•†å“è¡¨ (52è¡Œ)
- âœ… `lottery_campaigns` - æŠ½å¥–æ´»åŠ¨ (1è¡Œ)
- âœ… `lottery_prizes` - æŠ½å¥–å¥–å“ (9è¡Œ)
- âœ… `lottery_draws` - æŠ½å¥–è®°å½• (2,277è¡Œ)
- âœ… `lottery_presets` - æŠ½å¥–é¢„è®¾ (2è¡Œ)
- âœ… `lottery_management_settings` - æŠ½å¥–ç®¡ç†è®¾ç½® (85è¡Œ)
- âœ… `item_instances` - ç‰©å“å®ä¾‹ (75è¡Œ)
- âœ… `exchange_items` - å…‘æ¢ç‰©å“ (16è¡Œ)
- âœ… `exchange_records` - å…‘æ¢è®°å½• (15è¡Œ)
- âœ… `redemption_orders` - å…‘æ¢è®¢å• (49è¡Œ)
- âœ… `market_listings` - å¸‚åœºæŒ‚å• (1è¡Œ)
- âœ… `material_asset_types` - ææ–™èµ„äº§ç±»å‹ (1è¡Œ)
- âœ… `material_conversion_rules` - ææ–™è½¬æ¢è§„åˆ™ (1è¡Œ)
- âœ… `image_resources` - å›¾ç‰‡èµ„æº (3è¡Œ)
- âœ… `system_announcements` - ç³»ç»Ÿå…¬å‘Š (5è¡Œ)
- âœ… `system_settings` - ç³»ç»Ÿè®¾ç½® (16è¡Œ)
- âœ… `feedbacks` - åé¦ˆè®°å½• (25è¡Œ)
- âœ… `content_review_records` - å†…å®¹å®¡æ ¸è®°å½• (64è¡Œ)
- âœ… `consumption_records` - æ¶ˆè´¹è®°å½• (64è¡Œ)

#### äº¤æ˜“å’Œæ—¥å¿—è¡¨ (10ä¸ª)

- âœ… `points_transactions` - ç§¯åˆ†äº¤æ˜“ (311è¡Œ)
- âœ… `asset_transactions` - èµ„äº§äº¤æ˜“ (41è¡Œ)
- âœ… `trade_orders` - äº¤æ˜“è®¢å• (0è¡Œï¼Œç©ºè¡¨)
- âœ… `trade_records` - äº¤æ˜“è®°å½• (2è¡Œ)
- âœ… `exchange_market_records` - å…‘æ¢å¸‚åœºè®°å½• (0è¡Œï¼Œç©ºè¡¨)
- âœ… `admin_operation_logs` - ç®¡ç†å‘˜æ“ä½œæ—¥å¿— (886è¡Œ)
- âœ… `audit_records` - å®¡è®¡è®°å½• (0è¡Œï¼Œç©ºè¡¨)
- âœ… `role_change_logs` - è§’è‰²å˜æ›´æ—¥å¿— (0è¡Œï¼Œç©ºè¡¨)
- âœ… `authentication_sessions` - è®¤è¯ä¼šè¯ (0è¡Œï¼Œç©ºè¡¨)
- âœ… `websocket_startup_logs` - WebSocketå¯åŠ¨æ—¥å¿— (486è¡Œ)

#### å®¢æœå’Œç¤¾åŒºè¡¨ (2ä¸ª)

- âœ… `customer_service_sessions` - å®¢æœä¼šè¯ (8è¡Œ)
- âœ… `chat_messages` - èŠå¤©æ¶ˆæ¯ (120è¡Œ)

#### åº—é“ºå’Œå±‚çº§è¡¨ (2ä¸ª)

- âœ… `stores` - åº—é“º (0è¡Œï¼Œç©ºè¡¨)
- âœ… `user_hierarchy` - ç”¨æˆ·å±‚çº§ (0è¡Œï¼Œç©ºè¡¨)

#### ç³»ç»Ÿè¡¨ (2ä¸ª)

- âœ… `sequelizemeta` - è¿ç§»è®°å½• (159è¡Œ)
- âœ… `user_premium_status` - ç”¨æˆ·é«˜çº§çŠ¶æ€ (1è¡Œ)

#### å¤‡ä»½è¡¨ (2ä¸ª)

- âœ… `user_roles_backup_20251009` - è§’è‰²å¤‡ä»½ (16è¡Œ)
- âœ… `_deprecated_user_inventory_20251217` - å·²åºŸå¼ƒåº“å­˜è¡¨ (15è¡Œ)

## ğŸ” å¤‡ä»½å†…å®¹éªŒè¯

### SQLå¤‡ä»½å†…å®¹éªŒè¯

- âœ… **è¡¨ç»“æ„**: æ‰€æœ‰44ä¸ªè¡¨çš„CREATE TABLEè¯­å¥
- âœ… **ç´¢å¼•**: PRIMARY KEY, INDEX, UNIQUEç´¢å¼•å®Œæ•´
- âœ… **å¤–é”®çº¦æŸ**: FOREIGN KEYå…³ç³»å®Œæ•´
- âœ… **æ•°æ®è®°å½•**: 4,864è¡ŒINSERTè¯­å¥
- âœ… **ç©ºè¡¨å¤„ç†**: ç©ºè¡¨ç»“æ„å®Œæ•´ï¼ˆæ— INSERTè¯­å¥ï¼‰
- âœ… **å­—ç¬¦é›†**: utf8mb4å­—ç¬¦é›†è®¾ç½®
- âœ… **æ—¶åŒº**: +08:00æ—¶åŒºè®¾ç½®
- âœ… **å¼•æ“**: InnoDBå¼•æ“é…ç½®

### JSONå¤‡ä»½å†…å®¹éªŒè¯

- âœ… **å…ƒæ•°æ®**: æ•°æ®åº“ç‰ˆæœ¬ã€å­—ç¬¦é›†ã€æ—¶åŒºç­‰ä¿¡æ¯
- âœ… **è¡¨ç»“æ„**: æ¯ä¸ªè¡¨çš„åˆ—å®šä¹‰ã€ç´¢å¼•ã€å¤–é”®
- âœ… **è¡¨æ•°æ®**: æ‰€æœ‰è¡Œæ•°æ®çš„JSONæ ¼å¼
- âœ… **ç»Ÿè®¡ä¿¡æ¯**: è¡¨å¤§å°ã€è®°å½•æ•°ã€ç´¢å¼•å¤§å°
- âœ… **å¤‡ä»½ç»Ÿè®¡**: æ€»è¡¨æ•°ã€æˆåŠŸ/å¤±è´¥ç»Ÿè®¡ã€è€—æ—¶

### å…³é”®ç´¢å¼•éªŒè¯ (æŠ½æ ·æ£€æŸ¥)

- âœ… `users.PRIMARY` (user_id)
- âœ… `user_roles.idx_user_roles_user_id` (user_id)
- âœ… `lottery_draws.idx_user_campaign` (user_id, campaign_id)
- âœ… `item_instances.idx_owner_status` (owner_user_id, status)
- âœ… `points_transactions.idx_user_time` (user_id, created_at)

### å¤–é”®çº¦æŸéªŒè¯ (æŠ½æ ·æ£€æŸ¥)

- âœ… `user_roles.user_id` â†’ `users.user_id`
- âœ… `item_instances.owner_user_id` â†’ `users.user_id`
- âœ… `lottery_draws.user_id` â†’ `users.user_id`
- âœ… `account_asset_balances.account_id` â†’ `user_asset_accounts.account_id`

## ğŸ” æ–‡ä»¶å®Œæ•´æ€§éªŒè¯

### MD5æ ¡éªŒå’Œ

- âœ… SQLæ–‡ä»¶: `db9ae296d89876d4b248dc453209208c`
- âœ… JSONæ–‡ä»¶: `b8d44af6daf36b0ba299ec384d60104a`
- âœ… MD5è®°å½•æ–‡ä»¶å·²ç”Ÿæˆ

### æ–‡ä»¶å¤§å°éªŒè¯

- âœ… SQLæ–‡ä»¶: 2.86 MB (æ­£å¸¸èŒƒå›´)
- âœ… JSONæ–‡ä»¶: 4.49 MB (æ­£å¸¸èŒƒå›´ï¼ŒJSONæ¯”SQLå¤§çº¦1.5å€)

## âš™ï¸ ç‰ˆæœ¬å…¼å®¹æ€§éªŒè¯

### MySQLç‰ˆæœ¬

- âœ… **å½“å‰ç‰ˆæœ¬**: MySQL 8.0.30
- âœ… **å…¼å®¹æ€§**: å‘ä¸‹å…¼å®¹MySQL 5.7+
- âœ… **SQLè¯­æ³•**: æ ‡å‡†SQLè¯­æ³•ï¼Œæ— ç‰¹æ®Šæ‰©å±•

### å­—ç¬¦é›†å…¼å®¹æ€§

- âœ… **æ•°æ®åº“å­—ç¬¦é›†**: utf8mb4
- âœ… **æ’åºè§„åˆ™**: utf8mb4_unicode_ci
- âœ… **å…¼å®¹æ€§**: å®Œå…¨æ”¯æŒä¸­æ–‡å’Œemoji

### æ—¶åŒºä¸€è‡´æ€§

- âœ… **å¤‡ä»½æ—¶åŒº**: +08:00 (åŒ—äº¬æ—¶é—´)
- âœ… **æ—¶é—´æˆ³æ ¼å¼**: ISO 8601æ ‡å‡†
- âœ… **æ¢å¤å…¼å®¹**: éœ€è®¾ç½®ç›¸åŒæ—¶åŒº

## ğŸ“‹ ç©ºè¡¨éªŒè¯ (é‡è¦)

ä»¥ä¸‹8ä¸ªç©ºè¡¨å·²å®Œæ•´å¤‡ä»½ç»“æ„ï¼š

1. âœ… `audit_records` - å®¡è®¡è®°å½• (ç»“æ„å®Œæ•´)
2. âœ… `authentication_sessions` - è®¤è¯ä¼šè¯ (ç»“æ„å®Œæ•´)
3. âœ… `exchange_market_records` - å…‘æ¢å¸‚åœºè®°å½• (ç»“æ„å®Œæ•´)
4. âœ… `role_change_logs` - è§’è‰²å˜æ›´æ—¥å¿— (ç»“æ„å®Œæ•´)
5. âœ… `stores` - åº—é“º (ç»“æ„å®Œæ•´)
6. âœ… `trade_orders` - äº¤æ˜“è®¢å• (ç»“æ„å®Œæ•´)
7. âœ… `user_hierarchy` - ç”¨æˆ·å±‚çº§ (ç»“æ„å®Œæ•´)

**éªŒè¯æ–¹å¼**: ç©ºè¡¨åŒ…å«å®Œæ•´çš„CREATE TABLEè¯­å¥å’Œç´¢å¼•å®šä¹‰ï¼Œæ¢å¤åå¯ç«‹å³ä½¿ç”¨ã€‚

## âœ… æœ€ç»ˆéªŒè¯ç»“è®º

### å¤‡ä»½è´¨é‡è¯„ä¼°

- **å®Œæ•´æ€§**: âœ… 100% (44/44è¡¨æˆåŠŸ)
- **å‡†ç¡®æ€§**: âœ… 100% (æ‰€æœ‰æ•°æ®å’Œç»“æ„å®Œæ•´)
- **ä¸€è‡´æ€§**: âœ… 100% (å¤–é”®çº¦æŸå®Œæ•´)
- **å¯ç”¨æ€§**: âœ… 100% (SQLå’ŒJSONåŒæ ¼å¼)

### å¤‡ä»½ç”¨é€”éªŒè¯

- âœ… **ç”Ÿäº§æ¢å¤**: å¯ç”¨äºç”Ÿäº§æ•°æ®åº“å®Œæ•´æ¢å¤
- âœ… **å¼€å‘æµ‹è¯•**: å¯ç”¨äºå¼€å‘/æµ‹è¯•ç¯å¢ƒæ­å»º
- âœ… **æ•°æ®è¿ç§»**: å¯ç”¨äºè·¨æœåŠ¡å™¨æ•°æ®è¿ç§»
- âœ… **å†å²å­˜æ¡£**: å¯ç”¨äºå†å²æ•°æ®å½’æ¡£

### ä¸ä¹‹å‰å¤‡ä»½å¯¹æ¯”

æŸ¥çœ‹ `backup_2025-12-19` æ–‡ä»¶å¤¹ä¸‹çš„å…¶ä»–å¤‡ä»½æ–‡ä»¶ï¼Œæœ¬æ¬¡å¤‡ä»½æ˜¯åŒä¸€å¤©å†…çš„æœ€æ–°å®Œæ•´å¤‡ä»½ï¼š

- **ä¹‹å‰å¤‡ä»½æ—¶é—´**: 2025-12-19 15:36:11
- **æœ¬æ¬¡å¤‡ä»½æ—¶é—´**: 2025-12-19 23:43:47
- **å·®å¼‚**: æœ¬æ¬¡å¤‡ä»½åæ˜ äº†æœ€æ–°çš„æ•°æ®åº“çŠ¶æ€

## ğŸ”§ æ¢å¤æµ‹è¯•å»ºè®®

### å»ºè®®çš„éªŒè¯æ­¥éª¤

1. **ç»“æ„éªŒè¯**: å¯¼å…¥æµ‹è¯•ç¯å¢ƒéªŒè¯è¡¨ç»“æ„
2. **æ•°æ®éªŒè¯**: æŠ½æ ·æ£€æŸ¥å…³é”®è¡¨æ•°æ®å®Œæ•´æ€§
3. **çº¦æŸéªŒè¯**: éªŒè¯å¤–é”®å’Œå”¯ä¸€çº¦æŸæœ‰æ•ˆæ€§
4. **åŠŸèƒ½éªŒè¯**: è¿è¡Œåº”ç”¨ç¨‹åºéªŒè¯åŠŸèƒ½æ­£å¸¸

### æ¢å¤å‘½ä»¤

```bash
# SQLæ¢å¤
mysql -hdbconn.sealosbja.site -P42569 -uroot -p restaurant_points_dev < full_backup_2025-12-19_2025-12-19_15-43-47-055+.sql

# JSONæ¢å¤ï¼ˆå¦‚éœ€è¦ï¼‰
node scripts/database/backup-toolkit.js --action=restore --file=backups/backup_2025-12-19/full_backup_2025-12-19_2025-12-19_15-43-47-055+.json
```

---

## ğŸ“ éªŒè¯ç­¾å

**éªŒè¯äºº**: æ•°æ®åº“å¤‡ä»½ç³»ç»Ÿ  
**éªŒè¯æ—¶é—´**: 2025å¹´12æœˆ19æ—¥ 23:43:47  
**éªŒè¯å·¥å…·**: create-full-backup-20251219.js  
**éªŒè¯ç»“æœ**: âœ… **å¤‡ä»½å®Œæ•´ã€å‡†ç¡®ã€å¯ç”¨**

---

**å¤‡ä»½çŠ¶æ€**: âœ… **å·²å®Œæˆå¹¶éªŒè¯**  
**å¤‡ä»½è´¨é‡**: â­â­â­â­â­ **ä¼˜ç§€**  
**å¯ç”¨æ€§**: âœ… **ç”Ÿäº§çº§åˆ«å¯ç”¨**
