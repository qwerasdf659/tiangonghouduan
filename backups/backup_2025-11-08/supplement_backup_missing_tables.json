{
  "timestamp": "2025-11-07T22:07:50.857Z",
  "timestamp_locale": "2025/11/8 06:07:50",
  "backup_type": "supplement",
  "tables": {
    "audit_records": {
      "structure": {
        "create_table": "CREATE TABLE `audit_records` (\n  `audit_id` bigint NOT NULL AUTO_INCREMENT COMMENT '审核记录唯一标识',\n  `record_id` bigint NOT NULL,\n  `auditor_id` int NOT NULL COMMENT '审核人员ID（平台工作人员）',\n  `audit_result` enum('approved','rejected') COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '审核结果（approved-通过，rejected-拒绝）',\n  `audit_opinion` text COLLATE utf8mb4_unicode_ci COMMENT '审核意见（拒绝时必填）',\n  `rejection_reason` enum('amount_mismatch','invalid_receipt','duplicate_submission','fraud_suspected','merchant_error','other') COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '拒绝原因分类（拒绝时必填）',\n  `audit_details` json DEFAULT NULL COMMENT '审核详细信息JSON（如审核过程中的检查项）',\n  `audited_at` datetime NOT NULL COMMENT '审核完成时间（北京时间）',\n  `audit_duration` int DEFAULT NULL COMMENT '审核耗时（从提交到审核完成的秒数）',\n  `client_ip` varchar(45) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '审核人员IP地址',\n  `created_at` datetime NOT NULL COMMENT '创建时间（北京时间）',\n  `updated_at` datetime NOT NULL COMMENT '更新时间（北京时间）',\n  PRIMARY KEY (`audit_id`),\n  KEY `idx_ar_consumption_id` (`record_id`),\n  KEY `idx_ar_auditor_id` (`auditor_id`),\n  KEY `idx_ar_audit_result` (`audit_result`),\n  KEY `idx_ar_audited_at` (`audited_at`),\n  CONSTRAINT `audit_records_ibfk_2` FOREIGN KEY (`auditor_id`) REFERENCES `users` (`user_id`) ON DELETE RESTRICT ON UPDATE CASCADE\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='审核记录表 - 记录平台工作人员对消费记录的审核结果'",
        "engine": "InnoDB",
        "collation": "utf8mb4_unicode_ci"
      },
      "data": [],
      "stats": {
        "row_count": 0
      }
    },
    "consumption_records": {
      "structure": {
        "create_table": "CREATE TABLE `consumption_records` (\n  `record_id` bigint NOT NULL AUTO_INCREMENT COMMENT '消费记录ID（主键，自增）',\n  `user_id` int NOT NULL COMMENT '消费用户ID',\n  `merchant_id` int DEFAULT NULL COMMENT '商家ID（录入人，可为空）',\n  `consumption_amount` decimal(10,2) NOT NULL COMMENT '消费金额（元）',\n  `points_to_award` int NOT NULL COMMENT '预计奖励积分数（单位：分），计算规则：Math.round(consumption_amount)，即1元=1分，四舍五入',\n  `status` enum('pending','approved','rejected','expired') COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'pending' COMMENT '状态：pending-待审核，approved-已通过，rejected-已拒绝，expired-已过期',\n  `qr_code` varchar(100) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '用户固定身份码（格式：QR_{user_id}_{signature}）',\n  `merchant_notes` text COLLATE utf8mb4_unicode_ci,\n  `created_at` datetime NOT NULL COMMENT '创建时间（北京时间）',\n  `updated_at` datetime NOT NULL COMMENT '更新时间（北京时间）',\n  `admin_notes` text COLLATE utf8mb4_unicode_ci COMMENT '平台审核备注（审核员填写）',\n  `reviewed_by` int DEFAULT NULL COMMENT '审核员ID（谁审核的？可为空）',\n  `reviewed_at` datetime DEFAULT NULL COMMENT '审核时间（什么时候审核的？），时区：北京时间（GMT+8）',\n  `is_deleted` tinyint(1) NOT NULL DEFAULT '0' COMMENT '软删除标记：0=未删除，1=已删除',\n  `deleted_at` datetime(3) DEFAULT NULL COMMENT '删除时间',\n  PRIMARY KEY (`record_id`),\n  KEY `idx_user_status` (`user_id`,`status`,`created_at`),\n  KEY `idx_merchant_time` (`merchant_id`,`created_at`),\n  KEY `idx_status_created` (`status`,`created_at`),\n  KEY `idx_qr_code` (`qr_code`),\n  KEY `idx_reviewed` (`reviewed_by`,`reviewed_at`),\n  KEY `idx_consumption_is_deleted` (`is_deleted`),\n  CONSTRAINT `fk_consumption_records_merchant_id` FOREIGN KEY (`merchant_id`) REFERENCES `users` (`user_id`) ON DELETE SET NULL ON UPDATE CASCADE,\n  CONSTRAINT `fk_consumption_records_reviewed_by` FOREIGN KEY (`reviewed_by`) REFERENCES `users` (`user_id`) ON DELETE SET NULL ON UPDATE CASCADE,\n  CONSTRAINT `fk_consumption_records_user_id` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB AUTO_INCREMENT=23 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户消费记录表 - 记录用户通过商家扫码提交的消费信息'",
        "engine": "InnoDB",
        "collation": "utf8mb4_unicode_ci"
      },
      "data": [
        {
          "record_id": "8",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "pending",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-10-31 02:54:25",
          "updated_at": "2025-11-02 23:46:24",
          "admin_notes": null,
          "reviewed_by": null,
          "reviewed_at": null,
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "9",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "pending",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-10-31 03:19:14",
          "updated_at": "2025-10-31 03:19:14",
          "admin_notes": null,
          "reviewed_by": null,
          "reviewed_at": null,
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "10",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "123.50",
          "points_to_award": 124,
          "status": "pending",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试积分冻结功能",
          "created_at": "2025-10-31 03:23:34",
          "updated_at": "2025-10-31 03:23:34",
          "admin_notes": null,
          "reviewed_by": null,
          "reviewed_at": null,
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "11",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "150.00",
          "points_to_award": 150,
          "status": "pending",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试积分冻结功能-Final",
          "created_at": "2025-10-31 03:27:33",
          "updated_at": "2025-10-31 03:27:33",
          "admin_notes": null,
          "reviewed_by": null,
          "reviewed_at": null,
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "12",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-10-31 03:41:04",
          "updated_at": "2025-10-31 03:41:04",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-10-31 03:41:04",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "13",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-10-31 03:44:36",
          "updated_at": "2025-10-31 03:44:36",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-10-31 03:44:36",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "14",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-10-31 08:22:25",
          "updated_at": "2025-10-31 08:22:25",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-10-31 08:22:25",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "15",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-10-31 08:26:15",
          "updated_at": "2025-10-31 08:26:15",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-10-31 08:26:15",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "16",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "pending",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-11-01 04:38:45",
          "updated_at": "2025-11-01 04:38:45",
          "admin_notes": null,
          "reviewed_by": null,
          "reviewed_at": null,
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "17",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-11-01 05:16:18",
          "updated_at": "2025-11-01 05:16:18",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-11-01 05:16:18",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "18",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "pending",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-11-01 05:22:08",
          "updated_at": "2025-11-01 05:22:08",
          "admin_notes": null,
          "reviewed_by": null,
          "reviewed_at": null,
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "19",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-11-01 05:33:01",
          "updated_at": "2025-11-01 05:33:01",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-11-01 05:33:01",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "20",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-11-08 01:05:26",
          "updated_at": "2025-11-08 01:05:27",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-11-08 01:05:27",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "21",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "88.50",
          "points_to_award": 89,
          "status": "approved",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": "测试消费：2份套餐",
          "created_at": "2025-11-08 01:50:11",
          "updated_at": "2025-11-08 01:50:11",
          "admin_notes": "测试审核通过，金额核实无误",
          "reviewed_by": 31,
          "reviewed_at": "2025-11-08 01:50:11",
          "is_deleted": 0,
          "deleted_at": null
        },
        {
          "record_id": "22",
          "user_id": 31,
          "merchant_id": 31,
          "consumption_amount": "25.00",
          "points_to_award": 25,
          "status": "pending",
          "qr_code": "QR_31_68b62a032f1115f69edd9979fb5bd588d6b0deb89b659922984c637d400204bf",
          "merchant_notes": null,
          "created_at": "2025-11-08 03:59:10",
          "updated_at": "2025-11-08 03:59:10",
          "admin_notes": null,
          "reviewed_by": null,
          "reviewed_at": null,
          "is_deleted": 0,
          "deleted_at": null
        }
      ],
      "stats": {
        "row_count": 15
      }
    },
    "user_premium_status": {
      "structure": {
        "create_table": "CREATE TABLE `user_premium_status` (\n  `id` bigint NOT NULL AUTO_INCREMENT COMMENT '自增主键（唯一标识，用于数据库内部索引，业务无关）',\n  `user_id` int NOT NULL COMMENT '用户ID（关联users表，唯一约束确保一个用户只有一条记录，用于查询用户解锁状态）',\n  `is_unlocked` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否已解锁高级空间（当前状态，TRUE=已解锁且在有效期内，FALSE=未解锁或已过期，用于前端权限判断）',\n  `unlock_time` datetime DEFAULT NULL COMMENT '最近一次解锁时间（北京时间，每次解锁时更新，用于计算过期时间和运营分析）',\n  `unlock_method` enum('points','exchange','vip','manual') COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT 'points' COMMENT '解锁方式（points=积分解锁100分，exchange=兑换码解锁，vip=VIP会员解锁，manual=管理员手动解锁，扩展性预留字段）',\n  `total_unlock_count` int NOT NULL DEFAULT '0' COMMENT '累计解锁次数（包括首次解锁和重新解锁，每次解锁+1，用于运营分析用户活跃度和付费意愿）',\n  `expires_at` datetime DEFAULT NULL COMMENT '过期时间（24小时有效期，unlock_time + 24小时，NULL表示未解锁或已过期，用于判断是否需要重新解锁，查询时WHERE expires_at > NOW()）',\n  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间（首次解锁时间，永不更新，用于历史追溯和用户分析）',\n  `updated_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间（每次解锁时自动更新，MySQL自动维护，用于追踪最后修改时间）',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `user_id` (`user_id`),\n  UNIQUE KEY `idx_user_id` (`user_id`),\n  KEY `idx_is_unlocked` (`is_unlocked`),\n  KEY `idx_expires_at` (`expires_at`),\n  CONSTRAINT `fk_ups_user_id` FOREIGN KEY (`user_id`) REFERENCES `users` (`user_id`) ON DELETE CASCADE ON UPDATE CASCADE\n) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户高级空间状态表（极简版，无自动续费字段，降低维护成本60%，适合数据量<1000的小项目）'",
        "engine": "InnoDB",
        "collation": "utf8mb4_unicode_ci"
      },
      "data": [
        {
          "id": "1",
          "user_id": 31,
          "is_unlocked": 1,
          "unlock_time": "2025-11-02 21:12:02",
          "unlock_method": "points",
          "total_unlock_count": 1,
          "expires_at": "2025-11-03 21:12:02",
          "created_at": "2025-11-02 21:12:02",
          "updated_at": "2025-11-02 21:12:02"
        }
      ],
      "stats": {
        "row_count": 1
      }
    }
  }
}