{
  "name": "restaurant-lottery-system-v4-unified",
  "version": "4.0.0",
  "description": "餐厅积分抽奖系统 - V4 RESTful API架构（扁平化资源导向设计）",
  "main": "app.js",
  "author": "Restaurant Lottery Team",
  "license": "MIT",
  "engines": {
    "node": ">=20.18.0",
    "npm": ">=8.0.0"
  },
  "scripts": {
    "start": "node app.js",
    "dev": "nodemon app.js",
    "admin:install": "cd admin && npm install",
    "admin:dev": "cd admin && npm run dev",
    "admin:build": "cd admin && npm run build",
    "admin:preview": "cd admin && npm run preview",
    "test": "jest",
    "test:coverage": "jest --coverage",
    "lint": "eslint . --ext .js",
    "lint:fix": "eslint . --ext .js --fix",
    "check:circular": "node scripts/check-circular-deps.js",
    "check:code": "eslint . --ext .js && node scripts/check-circular-deps.js",
    "monitor:db": "node scripts/validation/check_db_connections.js",
    "monitor:pool": "node scripts/monitoring/pool_monitor.js",
    "monitor:pool:once": "node scripts/monitoring/pool_monitor.js --once",
    "monitor:system": "node scripts/monitoring/lightweight_monitor.js",
    "monitor:system:once": "node scripts/monitoring/lightweight_monitor.js --once",
    "monitor:redis": "bash scripts/monitoring/redis_persistence_setup.sh",
    "db:migrate": "npx sequelize-cli db:migrate",
    "db:migrate:undo": "npx sequelize-cli db:migrate:undo",
    "db:seed": "npx sequelize-cli db:seed:all",
    "db:reset": "npx sequelize-cli db:migrate:undo:all && npx sequelize-cli db:migrate && npx sequelize-cli db:seed:all",
    "migration:toolkit": "node scripts/database/migration_toolkit.js",
    "migration:create": "node scripts/database/migration_toolkit.js create",
    "migration:verify": "node scripts/database/migration_toolkit.js verify",
    "migration:up": "npm run migration:verify && npx sequelize-cli db:migrate",
    "migration:down": "npx sequelize-cli db:migrate:undo",
    "migration:status": "npx sequelize-cli db:migrate:status",
    "db:toolkit": "node scripts/database/database_toolkit.js",
    "db:check": "node scripts/database/database_toolkit.js --action=check",
    "db:validate": "node scripts/database/validation_toolkit.js",
    "diagnostic:503-error": "bash scripts/diagnostic/diagnose_503_error.sh",
    "maintenance:toolkit": "node scripts/maintenance/business_toolkit.js",
    "maintenance:analyze": "node scripts/maintenance/business_toolkit.js analyze",
    "prestart": "npm run migration:verify",
    "deploy:check": "npm run lint && npm run test",
    "health:check": "node scripts/system/final_quality_check.js",
    "check:config-conflicts": "node scripts/check_config_conflicts.js",
    "check:validators": "node scripts/check_validators.js",
    "check:prevention": "npm run check:config-conflicts && npm run check:validators",
    "quality:check": "node scripts/system/final_quality_check.js",
    "quality:business-semantic": "node eslint-rules/test-implementation-consistency.js",
    "quality:test-standards": "node tests/helpers/test-quality-reporter.js",
    "check:sequelize-init": "node scripts/validation/check_sequelize_initialization.js",
    "validate:routes": "node scripts/validation/route_validator.js",
    "validate:prestart": "CHECK_DATABASE=false node scripts/validation/pre_start_check.js && node scripts/validation/check_sequelize_initialization.js",
    "validate:full": "node scripts/validation/pre_start_check.js && node scripts/validation/check_sequelize_initialization.js",
    "check:dom": "node scripts/check_dom_consistency.js",
    "check:api": "node scripts/check_api_consistency.js",
    "check:resources": "node scripts/frontend/check_static_resources.js",
    "check:resources:verbose": "node scripts/frontend/check_static_resources.js --verbose",
    "check:frontend": "npm run check:dom && npm run check:api && npm run check:resources",
    "check:all": "node scripts/comprehensive_check.js && npm run check:resources",
    "quality:full": "npm run lint && npm run quality:check && npm run quality:business-semantic",
    "security:html": "node scripts/check_html_security.js",
    "security:full": "npm run security:html",
    "test:timezone": "node scripts/toolkit/timezone_toolkit.js --check",
    "test:database": "node scripts/database/database_toolkit.js --action=check",
    "test:db-fix": "node scripts/database/database_toolkit.js --action=fix-foreign-keys --dry-run",
    "test:system": "./scripts/system/process_manager.sh status",
    "test:contracts": "jest tests/api-contracts --config jest.config.js",
    "test:full": "npm run test:timezone && npm run test:database && npm run test:points",
    "pm:status": "./scripts/system/process_manager.sh status",
    "pm:start": "./scripts/system/process_manager.sh start",
    "pm:start:pm2": "./scripts/system/process_manager.sh start pm2",
    "pm:start:dev": "./scripts/system/process_manager.sh start dev",
    "pm:restart": "./scripts/system/process_manager.sh restart",
    "pm:stop": "./scripts/system/process_manager.sh stop",
    "pm:cleanup": "./scripts/system/process_manager.sh cleanup",
    "pm:logs": "./scripts/system/process_manager.sh logs",
    "pm:show": "./scripts/system/process_manager.sh show",
    "pm:flush-logs": "./scripts/system/process_manager.sh flush-logs",
    "pm:reload-env": "./scripts/system/process_manager.sh reload-env",
    "pm:health": "./scripts/system/process_manager.sh health",
    "pm:help": "./scripts/system/process_manager.sh help",
    "frontend:verify": "bash scripts/frontend/verify_resources.sh && bash scripts/frontend/verify_csp.sh",
    "frontend:verify:resources": "bash scripts/frontend/verify_resources.sh",
    "frontend:verify:csp": "bash scripts/frontend/verify_csp.sh",
    "frontend:verify:websocket": "bash scripts/frontend/verify_websocket_events.sh",
    "frontend:audit": "bash scripts/frontend/full_audit.sh",
    "backend:audit:websocket": "bash scripts/backend/audit_websocket.sh",
    "system:check": "node scripts/system/final_quality_check.js",
    "system:process": "./scripts/system/process_manager.sh status",
    "system:env": "node scripts/check_environment.js",
    "toolkit:timezone": "node scripts/toolkit/timezone_toolkit.js",
    "toolkit:api-docs": "node scripts/toolkit/generate_api_docs.js",
    "toolkit:analyzer": "node scripts/toolkit/js_module_analyzer.js",
    "sealos:list-orphans": "node scripts/sealos/list_orphan_sealos_files.js",
    "sealos:cleanup-orphans": "node scripts/sealos/cleanup_orphan_sealos_files.js",
    "sealos:test-upload": "bash scripts/sealos/test_sealos_upload.sh",
    "sealos:diagnose-db": "bash scripts/sealos/diagnose_sealos_database.sh",
    "sealos:setup": "bash scripts/sealos/setup_sealos.sh",
    "check:cache": "node scripts/check-cache-config.js",
    "check:env": "node -e \"require('./config/environment').validateConfig()\"",
    "check:config": "npm run check:cache && npm run check:env",
    "cleanup:idempotency": "node scripts/maintenance/cleanup_expired_idempotency.js"
  },
  "dependencies": {
    "aws-sdk": "^2.1691.0",
    "axios": "^1.11.0",
    "compression": "^1.7.4",
    "cookie-parser": "^1.4.7",
    "cors": "^2.8.5",
    "dotenv": "^16.3.1",
    "express": "^4.18.2",
    "express-rate-limit": "^7.1.5",
    "helmet": "^7.1.0",
    "inquirer": "^8.2.7",
    "ioredis": "^5.7.0",
    "joi": "^17.11.0",
    "jsonwebtoken": "^9.0.2",
    "lodash": "^4.17.21",
    "multer": "^1.4.5-lts.1",
    "mysql2": "^3.6.5",
    "node-cron": "^3.0.3",
    "qrcode": "^1.5.4",
    "sequelize": "^6.35.2",
    "sharp": "^0.34.5",
    "socket.io": "^4.8.1",
    "uuid": "^9.0.1",
    "winston": "^3.11.0",
    "xlsx": "^0.18.5"
  },
  "devDependencies": {
    "ajv-formats": "^3.0.1",
    "eslint": "^8.55.0",
    "eslint-config-standard": "^17.1.0",
    "eslint-plugin-import": "^2.29.0",
    "eslint-plugin-local-rules": "^3.0.2",
    "eslint-plugin-node": "^11.1.0",
    "eslint-plugin-promise": "^6.1.1",
    "glob": "^11.0.3",
    "husky": "^8.0.3",
    "jest": "^29.7.0",
    "lint-staged": "^15.2.0",
    "nodemon": "^3.0.2",
    "prettier": "^3.1.1",
    "sequelize-cli": "^6.6.2",
    "socket.io-client": "^4.8.3",
    "supertest": "^6.3.4"
  },
  "keywords": [
    "restaurant",
    "lottery",
    "points",
    "storage",
    "layered-architecture",
    "multi-business",
    "image-management",
    "sealos",
    "express",
    "sequelize",
    "mysql"
  ],
  "repository": {
    "type": "git",
    "url": "https://github.com/your-org/restaurant-lottery-system-v4.git"
  },
  "bugs": {
    "url": "https://github.com/your-org/restaurant-lottery-system-v4/issues"
  },
  "homepage": "https://github.com/your-org/restaurant-lottery-system-v4#readme",
  "eslintConfig": {
    "env": {
      "node": true,
      "es2021": true,
      "jest": true
    },
    "extends": [
      "standard"
    ],
    "parserOptions": {
      "ecmaVersion": 12,
      "sourceType": "module"
    },
    "rules": {
      "no-console": "off",
      "camelcase": "off",
      "no-unused-vars": [
        "error",
        {
          "argsIgnorePattern": "^_"
        }
      ]
    }
  },
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged",
      "pre-push": "npm test",
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }
  },
  "lint-staged": {
    "*.js": [
      "eslint --fix",
      "prettier --write",
      "git add"
    ],
    "*.{json,md}": [
      "prettier --write",
      "git add"
    ]
  },
  "architecture": {
    "name": "V4 RESTful API Architecture",
    "version": "4.0.0",
    "description": "完全扁平化的RESTful API设计，符合腾讯云、微信支付等行业标准",
    "apiDesign": "RESTful资源导向（Resource-Oriented Design）",
    "pathStyle": "扁平化（/api/v4/{resource}）",
    "coreAPIs": {
      "auth": "/api/v4/auth - 用户认证系统",
      "lottery": "/api/v4/lottery - 抽奖系统",
      "points": "/api/v4/points - 积分管理系统",
      "console": "/api/v4/console - 管理后台系统"
    },
    "techStack": [
      "Node.js 20+ + Express",
      "MySQL + Sequelize ORM",
      "Redis缓存 + 分布式锁",
      "JWT认证 + RBAC权限",
      "北京时间全链路"
    ]
  },
  "performance": {
    "targetMetrics": {
      "apiResponseTime": "< 100ms",
      "fileUploadTime": "< 2s",
      "databaseQueryTime": "< 50ms",
      "systemAvailability": "> 99.95%",
      "concurrentUsers": "1000+",
      "storageCapacity": "20M+ images"
    },
    "optimizations": [
      "数据库索引优化",
      "图片缓存机制",
      "智能存储分层",
      "批量操作优化",
      "连接池管理",
      "压缩和CDN加速"
    ]
  },
  "deployment": {
    "environments": [
      "development",
      "testing",
      "staging",
      "production"
    ],
    "containerization": {
      "docker": "支持Docker容器化部署",
      "kubernetes": "支持Kubernetes集群部署",
      "sealos": "原生支持Sealos云平台部署"
    },
    "monitoring": [
      "健康检查端点 /health",
      "性能指标监控",
      "错误日志记录",
      "业务数据统计"
    ]
  },
  "security": {
    "authentication": "JWT Bearer Token",
    "authorization": "基于角色的权限控制 (RBAC)",
    "dataProtection": [
      "BCrypt密码加密",
      "文件类型验证",
      "文件大小限制",
      "SQL注入防护",
      "XSS防护",
      "CORS配置"
    ],
    "rateLimit": "API请求频率限制",
    "helmet": "HTTP安全头设置"
  }
}
