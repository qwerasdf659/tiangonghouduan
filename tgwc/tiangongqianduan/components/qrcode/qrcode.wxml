<!-- components/qrcode/qrcode.wxml - ç”¨æˆ·èº«ä»½äºŒç»´ç ç»„ä»¶æ¨¡æ¿ -->

<view class="qrcode-container">
  <!-- äºŒç»´ç æ ‡é¢˜ -->
  <view class="qrcode-header" wx:if="{{showTitle}}">
    <text class="qrcode-title">{{title}}</text>
  </view>

  <!-- äºŒç»´ç æ˜¾ç¤ºåŒºåŸŸ -->
  <view class="qrcode-wrapper">
    <!-- åŠ è½½ä¸­çŠ¶æ€ -->
    <view class="qrcode-loading" wx:if="{{loading}}">
      <text class="loading-text">ç”Ÿæˆä¸­...</text>
    </view>

    <!-- äºŒç»´ç å›¾ç‰‡ï¼ˆç”ŸæˆæˆåŠŸåæ˜¾ç¤ºï¼‰ -->
    <image class="qrcode-image" src="{{qrCodeImage}}" mode="aspectFit" wx:if="{{!loading && qrCodeImage}}"></image>

    <!-- Canvasç”»å¸ƒï¼ˆç”¨äºç”ŸæˆäºŒç»´ç ï¼Œç”Ÿæˆåéšè—ï¼‰ -->
    <canvas canvas-id="qrCanvas" id="qrCanvas" class="qrcode-canvas"
      style="width: {{size}}px; height: {{size}}px;"></canvas>

    <!-- é”™è¯¯æç¤º -->
    <view class="qrcode-error" wx:if="{{!loading && errorMessage}}">
      <text class="error-icon">âš ï¸</text>
      <text class="error-text">{{errorMessage}}</text>
    </view>
  </view>

  <!-- ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤ºï¼ˆå¯é€‰ï¼‰ -->
  <view class="qrcode-info" wx:if="{{showUserInfo && userInfo}}">
    <text class="info-item">ç”¨æˆ·ï¼š{{userInfo.nickname}}</text>
    <text class="info-item">ç§¯åˆ†ï¼š{{userInfo.points}}</text>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="qrcode-actions" wx:if="{{showActions && qrCodeImage}}">
    <button class="action-btn refresh-btn" bindtap="handleRefresh" size="mini">
      <text>ğŸ”„ åˆ·æ–°</text>
    </button>
    <button class="action-btn save-btn" bindtap="handleSave" size="mini">
      <text>ğŸ’¾ ä¿å­˜</text>
    </button>
  </view>
</view>