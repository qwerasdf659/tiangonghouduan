<!--pages/lottery/lottery.wxml - æŠ½å¥–é¡µé¢æ¨¡æ¿ - æ ¹æ®è¿ç§»æ–‡æ¡£v1.0.0é‡æ„-->

<view class="lottery-container {{showResult ? 'showing-result' : ''}}">
  <!-- é¡µé¢å¤´éƒ¨ -->
  <view class="header">
    <!-- ğŸ†• æ•´åˆå¸ƒå±€ï¼šç”¨æˆ·ä¿¡æ¯ + äºŒç»´ç æ¨ªå‘æ’åˆ— -->
    <view class="header-content">
      <!-- å·¦ä¾§ï¼šç”¨æˆ·ä¿¡æ¯å’Œç§¯åˆ†ï¼ˆæ¨ªå‘å¸ƒå±€ï¼‰ -->
      <view class="user-info-section">
        <!-- æ¬¢è¿è¯­ + å®¡æ ¸è®°å½•å¾½ç«  -->
        <view class="welcome-text">
          <text>æ¬¢è¿ï¼Œ{{userInfo.mobile || userInfo.phone || userInfo.nickname || 'ç”¨æˆ·'}}</text>
          
          <!-- ğŸ†• ç§¯åˆ†å®¡æ ¸è®°å½•æŸ¥è¯¢å¾½ç«  - ç´§è·Ÿæ‰‹æœºå·ç å -->
          <view class="audit-badge-container" bindtap="viewRecentAudits">
            <!-- åœ†å½¢å¾½ç«  -->
            <view class="audit-badge {{auditRecordsCount > 0 ? 'has-records' : 'no-records'}}">
              <text class="badge-icon">{{auditRecordsCount > 0 ? 'ğŸ“¬' : 'ğŸ“­'}}</text>
            </view>
            
            <!-- æ•°å­—è§’æ ‡ï¼ˆä»…å½“æœ‰è®°å½•æ—¶æ˜¾ç¤ºï¼‰ -->
            <view class="badge-number" wx:if="{{auditRecordsCount > 0}}">
              <text>{{auditRecordsCount}}</text>
            </view>
          </view>
        </view>

        <!-- ç§¯åˆ†æ¨ªå‘å®¹å™¨ -->
        <view class="points-row">
          <!-- å¯ç”¨ç§¯åˆ† - âœ… å“åº”å¼å­—ä½“ + åƒåˆ†ä½åˆ†éš”ç¬¦ -->
          <view class="points-item">
            <text class="points-label">å¯ç”¨ç§¯åˆ†</text>
            <view class="points-value">
              <text class="points-number {{pointsClass}}">{{pointsBalanceFormatted}}</text>
              <text class="points-icon">ğŸ’°</text>
            </view>
          </view>

          <!-- å†»ç»“ç§¯åˆ† - âœ… å“åº”å¼å­—ä½“ + åƒåˆ†ä½åˆ†éš”ç¬¦ -->
          <view class="points-item">
            <text class="points-label">å†»ç»“ç§¯åˆ†</text>
            <view class="points-value">
              <text class="points-number {{frozenClass}}">{{frozenPointsFormatted}}</text>
              <text class="points-icon">ğŸ”’</text>
            </view>
          </view>
        </view>
      </view>

      <!-- å³ä¾§ï¼šäºŒç»´ç åŒºåŸŸï¼ˆçº¯å‡€ç‰ˆï¼Œæ— æ–‡å­—ï¼‰ -->
      <view class="qrcode-section-inline">
        <!-- äºŒç»´ç å®¹å™¨ - ğŸ†• æ·»åŠ ç‚¹å‡»æ”¾å¤§åŠŸèƒ½ -->
        <view class="qrcode-container" bindtap="enlargeQRCode">
          <!-- åŠ è½½ä¸­çŠ¶æ€ -->
          <view class="qrcode-loading" wx:if="{{!qrCodeImage}}">
            <text class="loading-icon">â³</text>
            <text class="loading-text">ç”Ÿæˆä¸­...</text>
          </view>

          <!-- äºŒç»´ç å›¾ç‰‡ - æ­£æ–¹å½¢å›¾ç‰‡å®Œæ•´æ˜¾ç¤ºï¼ˆæœ‰ç•™ç™½ä½†å¯ä»¥çœ‹åˆ°å®Œæ•´äºŒç»´ç ï¼‰ -->
          <image class="qrcode-image" src="{{qrCodeImage}}" mode="aspectFit" wx:if="{{qrCodeImage}}"
            show-menu-by-longpress="{{true}}" />

          <!-- ğŸ†• ç‚¹å‡»æç¤ºå›¾æ ‡ -->
          <view class="qrcode-hint" wx:if="{{qrCodeImage}}">
            <text class="hint-icon">ğŸ”</text>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- ğŸ”´ ç®¡ç†å‘˜ä¸“å±åŠŸèƒ½æ¡ - ä»…ç®¡ç†å‘˜å¯è§ -->
  <view wx:if="{{isAdmin}}" class="admin-scan-bar">
    <!-- å·¦ä¾§ï¼šé™æ€æ–‡å­— -->
    <view class="admin-scan-label">
      <text>å•†å®¶æ‰«ç </text>
    </view>
    
    <!-- ä¸­é—´ï¼šæ‰«ä¸€æ‰«åŠŸèƒ½ -->
    <view class="admin-scan-button" bindtap="onScanTap">
      <text class="scan-icon">ğŸ“·</text>
      <text class="scan-text">æ‰«ä¸€æ‰«</text>
    </view>
    
    <!-- å³ä¾§ï¼šå®¡æ ¸è¯¦æƒ…è·³è½¬ -->
    <view class="admin-audit-button" bindtap="onAuditTap">
      <text class="audit-text">å®¡æ ¸è¯¦æƒ…</text>
      <text class="arrow-icon">â†’</text>
    </view>
  </view>

  <!-- åŒºåŸŸè½®æµå‘äº®æŠ½å¥–åŒºåŸŸ -->
  <view class="lottery-grid-section">
    <view class="lottery-grid {{highlightAnimation ? 'animating' : ''}}">
      <!-- 3x3ç½‘æ ¼å¸ƒå±€ï¼Œä¸­å¿ƒä¸ºæŠ½å¥–æŒ‰é’® -->
      <view class="prize-grid">
        <!-- å¥–å“åŒºåŸŸ0 - å·¦ä¸Šè§’ -->
        <view class="prize-area {{currentHighlight === 0 ? 'highlighted' : ''}} {{winningIndex === 0 ? 'winning' : ''}}"
          data-index="0">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[0].icon || 'ğŸ«'}}</text>
            <view class="prize-text-container {{prizes[0].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[0].displayText.isMultiLine}}">
                {{prizes[0].displayText.fullText || prizes[0].prizeName || 'å¥–å“1'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[0].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[0].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[0].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- å¥–å“åŒºåŸŸ1 - ä¸­ä¸Š -->
        <view class="prize-area {{currentHighlight === 1 ? 'highlighted' : ''}} {{winningIndex === 1 ? 'winning' : ''}}"
          data-index="1">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[1].icon || 'ğŸ'}}</text>
            <view class="prize-text-container {{prizes[1].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[1].displayText.isMultiLine}}">
                {{prizes[1].displayText.fullText || prizes[1].prizeName || 'å¥–å“2'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[1].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[1].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[1].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- å¥–å“åŒºåŸŸ2 - å³ä¸Šè§’ -->
        <view class="prize-area {{currentHighlight === 2 ? 'highlighted' : ''}} {{winningIndex === 2 ? 'winning' : ''}}"
          data-index="2">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[2].icon || 'ğŸ†'}}</text>
            <view class="prize-text-container {{prizes[2].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[2].displayText.isMultiLine}}">
                {{prizes[2].displayText.fullText || prizes[2].prizeName || 'å¥–å“3'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[2].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[2].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[2].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- å¥–å“åŒºåŸŸ7 - å·¦ä¸­ -->
        <view class="prize-area {{currentHighlight === 7 ? 'highlighted' : ''}} {{winningIndex === 7 ? 'winning' : ''}}"
          data-index="7">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[7].icon || 'ğŸ’'}}</text>
            <view class="prize-text-container {{prizes[7].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[7].displayText.isMultiLine}}">
                {{prizes[7].displayText.fullText || prizes[7].prizeName || 'å¥–å“8'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[7].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[7].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[7].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- ä¸­å¤®æŠ½å¥–æŒ‰é’® -->
        <view class="lottery-center-button">
          <button class="center-draw-btn {{isLotteryInProgress ? 'drawing' : ''}}" disabled="{{isLotteryInProgress}}"
            bindtap="{{isLotteryInProgress ? '' : 'onSingleDraw'}}">
            <text class="btn-text">{{isLotteryInProgress ? 'æŠ½å¥–ä¸­...' : 'ğŸ° å¼€å§‹æŠ½å¥–'}}</text>
          </button>
        </view>

        <!-- å¥–å“åŒºåŸŸ3 - å³ä¸­ -->
        <view class="prize-area {{currentHighlight === 3 ? 'highlighted' : ''}} {{winningIndex === 3 ? 'winning' : ''}}"
          data-index="3">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[3].icon || 'ğŸª'}}</text>
            <view class="prize-text-container {{prizes[3].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[3].displayText.isMultiLine}}">
                {{prizes[3].displayText.fullText || prizes[3].prizeName || 'å¥–å“4'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[3].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[3].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[3].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- å¥–å“åŒºåŸŸ6 - å·¦ä¸‹è§’ -->
        <view class="prize-area {{currentHighlight === 6 ? 'highlighted' : ''}} {{winningIndex === 6 ? 'winning' : ''}}"
          data-index="6">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[6].icon || 'ğŸŠ'}}</text>
            <view class="prize-text-container {{prizes[6].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[6].displayText.isMultiLine}}">
                {{prizes[6].displayText.fullText || prizes[6].prizeName || 'å¥–å“7'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[6].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[6].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[6].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- å¥–å“åŒºåŸŸ5 - ä¸­ä¸‹ -->
        <view class="prize-area {{currentHighlight === 5 ? 'highlighted' : ''}} {{winningIndex === 5 ? 'winning' : ''}}"
          data-index="5">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[5].icon || 'ğŸ‰'}}</text>
            <view class="prize-text-container {{prizes[5].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[5].displayText.isMultiLine}}">
                {{prizes[5].displayText.fullText || prizes[5].prizeName || 'å¥–å“6'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[5].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[5].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[5].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>

        <!-- å¥–å“åŒºåŸŸ4 - å³ä¸‹è§’ -->
        <view class="prize-area {{currentHighlight === 4 ? 'highlighted' : ''}} {{winningIndex === 4 ? 'winning' : ''}}"
          data-index="4">
          <view class="prize-content">
            <text class="prize-icon">{{prizes[4].icon || 'ğŸˆ'}}</text>
            <view class="prize-text-container {{prizes[4].displayMode || 'single-line'}}">
              <text class="prize-name" wx:if="{{!prizes[4].displayText.isMultiLine}}">
                {{prizes[4].displayText.fullText || prizes[4].prizeName || 'å¥–å“5'}}
              </text>
              <view class="prize-name-multiline" wx:if="{{prizes[4].displayText.isMultiLine}}">
                <text class="prize-line">{{prizes[4].displayText.firstLine}}</text>
                <text class="prize-line">{{prizes[4].displayText.secondLine}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¤šè¿æŠ½æŒ‰é’®ç»„ -->
  <view class="multi-draw-section">
    <view class="multi-draw-grid">
      <view class="grid-row">
        <!-- ğŸ”´ ä¸‰è¿æŠ½ï¼šç§¯åˆ†æ˜¾ç¤ºä»åç«¯drawPricing.three.total_costè·å– -->
        <button class="grid-draw-btn triple-btn" bindtap="onTripleDraw" disabled="{{isLotteryInProgress}}">
          <view class="btn-content">
            <text class="btn-main-text">ä¸‰è¿æŠ½</text>
            <text class="btn-sub-text">{{drawPricing.three.total_cost || 300}}ç§¯åˆ†</text>
          </view>
        </button>
        <!-- ğŸ”´ äº”è¿æŠ½ï¼šç§¯åˆ†æ˜¾ç¤ºä»åç«¯drawPricing.five.total_costè·å– -->
        <button class="grid-draw-btn five-btn" bindtap="onFiveDraw" disabled="{{isLotteryInProgress}}">
          <view class="btn-content">
            <text class="btn-main-text">äº”è¿æŠ½</text>
            <text class="btn-sub-text">{{drawPricing.five.total_cost || 500}}ç§¯åˆ†</text>
          </view>
        </button>
      </view>
      <view class="grid-row">
        <!-- ğŸ”´ åè¿æŠ½ï¼šç§¯åˆ†æ˜¾ç¤ºä»åç«¯drawPricing.ten.total_costè·å–ï¼ˆå¯èƒ½æœ‰æŠ˜æ‰£ï¼‰-->
        <button class="grid-draw-btn ten-btn special full-width" bindtap="onTenDraw" disabled="{{isLotteryInProgress}}">
          <view class="btn-content">
            <text class="btn-main-text">åè¿æŠ½</text>
            <text class="btn-sub-text">{{drawPricing.ten.total_cost || 1000}}ç§¯åˆ†</text>
            <text class="btn-guarantee">ä¿åº•å¥½ç¤¼</text>
          </view>
        </button>
      </view>
    </view>
  </view>

  <!-- æŠ½å¥–ç»“æœå¼¹çª— - ğŸŒŸ å¡ç‰‡æ¸å˜æ–¹æ¡ˆ -->
  <view class="result-modal gradient-card-modal" wx:if="{{showResult}}">
    <view class="modal-content gradient-card-container">
      <!-- å³ä¸Šè§’å…³é—­æŒ‰é’® -->
      <view class="close-btn gradient-close" bindtap="closeResult">
        <text class="close-icon">âœ•</text>
      </view>

      <!-- å¼¹çª—å¤´éƒ¨ - å¡ç‰‡å¼è®¾è®¡ -->
      <view class="result-header gradient-header-card">
        <!-- ä¸­å¥–çŠ¶æ€æ ‡é¢˜å¡ç‰‡ -->
        <view class="title-card success-card" wx:if="{{!drawResult.isError && !drawResult.isNotWinning}}">
          <view class="title-icon">ğŸ‰</view>
          <view class="title-content">
            <text class="result-title">æ­å–œä¸­å¥–ï¼</text>
            <text class="result-subtitle" wx:if="{{drawResult.isMultiDraw}}">
              {{drawResult.drawCount}}è¿æŠ½è·å¾—ä»¥ä¸‹å¥–å“
            </text>
            <text class="result-subtitle" wx:else>
              å•æ¬¡æŠ½å¥–è·å¾—ç²¾ç¾å¥–å“
            </text>
          </view>
        </view>

        <!-- æœªä¸­å¥–çŠ¶æ€æ ‡é¢˜å¡ç‰‡ -->
        <view class="title-card not-winning-card" wx:if="{{drawResult.isNotWinning}}">
          <view class="title-icon not-winning-icon">ğŸ’¨</view>
          <view class="title-content">
            <text class="result-title not-winning-title">å¾ˆé—æ†¾ï¼Œæœªä¸­å¥–</text>
            <text class="result-subtitle not-winning-subtitle">
              å†æ¥å†å‰ï¼Œä¸‹æ¬¡å¥½è¿ï¼
            </text>
          </view>
        </view>

        <!-- é”™è¯¯çŠ¶æ€æ ‡é¢˜å¡ç‰‡ -->
        <view class="title-card error-card" wx:if="{{drawResult.isError}}">
          <view class="title-icon error-icon">âŒ</view>
          <view class="title-content">
            <text class="result-title error-title">{{drawResult.errorTitle}}</text>
            <text class="result-subtitle error-subtitle">
              {{drawResult.errorDescription}}
            </text>
          </view>
        </view>
      </view>

      <!-- å¼¹çª—ä¸»ä½“ - å¡ç‰‡ç½‘æ ¼å¸ƒå±€ -->
      <view class="result-body gradient-body-container">
        <!-- å•æ¬¡æŠ½å¥–å¥–å“å¡ç‰‡ï¼ˆä¸­å¥–ï¼‰ -->
        <view class="winning-prize-card single-prize-card"
          wx:if="{{!drawResult.isMultiDraw && !drawResult.isError && !drawResult.isNotWinning}}">
          <view class="prize-card-bg">
            <view class="prize-card-shine"></view>
            <view class="prize-card-content">
              <view class="winning-icon-container">
                <text class="winning-icon">ğŸ</text>
                <view class="icon-glow"></view>
              </view>
              <view class="winning-info">
                <text class="winning-name">{{drawResult.prize.name}}</text>
                <text class="winning-desc">{{drawResult.prize.description}}</text>
              </view>
              <view class="prize-card-decoration">
                <view class="decoration-dot"></view>
                <view class="decoration-dot"></view>
                <view class="decoration-dot"></view>
              </view>
            </view>
          </view>
        </view>

        <!-- æœªä¸­å¥–æç¤ºå¡ç‰‡ -->
        <view class="not-winning-card single-prize-card" wx:if="{{drawResult.isNotWinning}}">
          <view class="not-winning-card-bg">
            <view class="not-winning-icon-container">
              <text class="not-winning-icon-large">ğŸ’¨</text>
            </view>
            <view class="not-winning-info">
              <text class="not-winning-message">{{drawResult.prize.description}}</text>
              <text class="not-winning-encourage">ç»§ç»­åŠªåŠ›ï¼Œå¥½è¿å³å°†åˆ°æ¥ï¼</text>
            </view>
          </view>
        </view>

        <!-- å¤šè¿æŠ½å¥–å“å¡ç‰‡ç½‘æ ¼ -->
        <view class="multi-prize-grid" wx:if="{{drawResult.isMultiDraw && !drawResult.isError}}">
          <view class="prize-grid-header">
            <text class="grid-title">ä¸­å¥–æ¸…å•</text>
            <text class="grid-count">å…±{{drawResult.actualCount || drawResult.drawCount}}ä»¶</text>
          </view>
          <!-- æ»šåŠ¨æç¤º (ä»…å½“å¥–å“è¶…è¿‡4ä¸ªæ—¶æ˜¾ç¤º) -->
          <view class="scroll-hint" wx:if="{{drawResult.prizes.length > 4}}">
            <text class="scroll-hint-text">ğŸ‘† ä¸Šä¸‹æ»‘åŠ¨æŸ¥çœ‹æ›´å¤šå¥–å“</text>
          </view>
          <view class="prize-cards-container">
            <view class="prize-item-card" wx:for="{{drawResult.prizes}}" wx:key="index">
              <view class="prize-card-wrapper gradient-prize-{{(index % 4) + 1}}">
                <view class="prize-card-inner">
                  <view class="prize-number-badge">
                    <text class="prize-number">{{index + 1}}</text>
                  </view>
                  <view class="prize-card-body">
                    <view class="prize-icon-area">
                      <text class="prize-icon">ğŸ</text>
                      <view class="prize-sparkle"></view>
                    </view>
                    <view class="prize-text-area">
                      <text class="prize-name">{{item.name}}</text>
                      <text class="prize-subtitle">{{item.description}}</text>
                    </view>
                  </view>
                  <view class="prize-card-accent"></view>
                </view>
              </view>
            </view>
          </view>
        </view>

        <!-- é”™è¯¯ä¿¡æ¯å¡ç‰‡ -->
        <view class="error-info-card" wx:if="{{drawResult.isError}}">
          <view class="error-card-bg">
            <view class="error-icon-container">
              <text class="error-icon">âš ï¸</text>
            </view>
            <view class="error-content">
              <text class="error-message">{{drawResult.errorMessage}}</text>
              <text class="error-suggestion">è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•</text>
            </view>
          </view>
        </view>
      </view>

      <!-- å¼¹çª—åº•éƒ¨ - æ¸å˜æŒ‰é’® -->
      <view class="result-footer gradient-footer">
        <button class="confirm-btn gradient-confirm-btn" bindtap="closeResult">
          <view class="btn-content">
            <text class="btn-text">ç¡®è®¤æ”¶ä¸‹</text>
            <text class="btn-icon">âœ¨</text>
          </view>
        </button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-container" wx:if="{{loading}}">
    <text class="loading-text">æ­£åœ¨åŠ è½½æŠ½å¥–é…ç½®...</text>
  </view>

  <!-- ğŸ†• éšè—çš„Canvasç”¨äºç”Ÿæˆæ­£æ–¹å½¢é«˜åˆ†è¾¨ç‡äºŒç»´ç ï¼ˆæ–¹æ¡ˆBï¼š428Ã—428æ­£æ–¹å½¢ï¼‰ -->
  <canvas canvas-id="qrcodeCanvas" style="width: 428px; height: 428px; position: fixed; left: -9999px; top: -9999px;" />

  <!-- ğŸ†• æ”¾å¤§çš„äºŒç»´ç å¼¹çª— -->
  <view class="qrcode-enlarged-modal" wx:if="{{qrCodeEnlarged}}" bindtap="closeEnlargedQRCode">
    <view class="qrcode-enlarged-container" catchtap="{{''}}">
      <!-- å…³é—­æŒ‰é’® -->
      <view class="qrcode-close-btn" bindtap="closeEnlargedQRCode">
        <text class="close-icon">âœ•</text>
      </view>

      <!-- æ”¾å¤§çš„äºŒç»´ç  -->
      <view class="qrcode-enlarged-content">
        <!-- ğŸ”´ æ–¹æ¡ˆBï¼šæ­£æ–¹å½¢å®¹å™¨(500Ã—500) + æ­£æ–¹å½¢å›¾ç‰‡(428Ã—428) = å®Œç¾å¡«å…… -->
        <image class="qrcode-enlarged-image" src="{{qrCodeImage}}" mode="aspectFit" show-menu-by-longpress="{{true}}" />

        <!-- æç¤ºæ–‡å­— -->
        <view class="qrcode-enlarged-tips">
          <text class="enlarged-tip">ğŸ‘† é•¿æŒ‰ä¿å­˜äºŒç»´ç </text>
          <text class="enlarged-tip">æˆ–ä¾›å•†å®¶æ‰«ç éªŒè¯</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ğŸ†• å®¡æ ¸è®°å½•å¼¹çª— -->
  <view class="audit-modal" wx:if="{{showAuditModal}}" bindtap="closeAuditModal">
    <view class="audit-modal-content" catchtap="{{''}}">
      <!-- å…³é—­æŒ‰é’® -->
      <view class="audit-modal-close" bindtap="closeAuditModal">
        <text class="close-icon">âœ•</text>
      </view>
      
      <!-- å¼¹çª—æ ‡é¢˜ -->
      <view class="audit-modal-header">
        <text class="modal-title">ğŸ“‹ æœ€è¿‘5ç¬”ç§¯åˆ†å®¡æ ¸è®°å½•</text>
      </view>
      
      <!-- è®°å½•åˆ—è¡¨ -->
      <scroll-view class="audit-records-list" scroll-y="{{true}}">
        <view class="audit-record-card {{item.status}}" 
              wx:for="{{auditRecordsData}}" 
              wx:key="id">
          <!-- è®°å½•ç¼–å· + çŠ¶æ€ -->
          <view class="record-header">
            <text class="record-number">ğŸ¯ è®°å½• #{{index + 1}}</text>
            <view class="record-status" style="background: {{item.statusInfo.bgColor}}">
              <text class="status-icon">{{item.statusInfo.icon}}</text>
              <text class="status-text" style="color: {{item.statusInfo.color}}">
                {{item.statusInfo.text}}
              </text>
            </view>
          </view>
          
          <!-- æ¶ˆè´¹é‡‘é¢ -->
          <view class="record-row">
            <text class="row-icon">ğŸ’°</text>
            <text class="row-label">æ¶ˆè´¹é‡‘é¢ï¼š</text>
            <text class="row-value amount">Â¥{{item.formattedAmount}}</text>
          </view>
          
          <!-- é¢„è®¡ç§¯åˆ† -->
          <view class="record-row">
            <text class="row-icon">ğŸ</text>
            <text class="row-label">
              {{item.status === 'approved' ? 'å·²å¥–åŠ±ï¼š' : 'é¢„è®¡å¥–åŠ±ï¼š'}}
            </text>
            <text class="row-value points">+{{item.points_to_award}} ç§¯åˆ†</text>
          </view>
          
          <!-- å•†å®¶ä¿¡æ¯ -->
          <view class="record-row" wx:if="{{item.merchant_info}}">
            <text class="row-icon">ğŸª</text>
            <text class="row-label">å•†å®¶ï¼š</text>
            <text class="row-value">{{item.merchant_info.name || 'å¤©å·¥é¤å…'}}</text>
          </view>
          
          <!-- å•†å®¶å¤‡æ³¨ -->
          <view class="record-row" wx:if="{{item.merchant_notes}}">
            <text class="row-icon">ğŸ“</text>
            <text class="row-label">å¤‡æ³¨ï¼š</text>
            <text class="row-value">{{item.merchant_notes}}</text>
          </view>
          
          <!-- æäº¤æ—¶é—´ -->
          <view class="record-row">
            <text class="row-icon">ğŸ•</text>
            <text class="row-label">æäº¤æ—¶é—´ï¼š</text>
            <text class="row-value time">{{item.formattedTime}}</text>
          </view>
        </view>
      </scroll-view>
      
      <!-- åº•éƒ¨å…³é—­æŒ‰é’® -->
      <view class="audit-modal-footer">
        <button class="modal-close-btn" bindtap="closeAuditModal">
          å…³é—­
        </button>
      </view>
    </view>
  </view>
</view>