<!--pages/user/user.wxml - ç”¨æˆ·ä¸­å¿ƒé¡µé¢æ¨¡æ¿ï¼ˆæ ¹æ®æ—§é¡¹ç›®UIç»“æ„å®Œå–„ï¼‰-->
<!-- ğŸ—‘ï¸ V2.1æ›´æ–°ï¼šå·²ç§»é™¤VIPç­‰çº§æ˜¾ç¤ºå’Œæˆå°±ç³»ç»ŸUIæ¨¡å— -->

<view class="user-container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <view class="user-info-full" wx:if="{{isLoggedIn}}">
      <view class="user-name" bindtap="onPhoneTap">
        <text class="name-text">{{userInfo.mobile || userInfo.phone || 'ç‚¹å‡»ç™»å½•'}}</text>
        <text class="edit-phone">âœï¸</text>
      </view>
      <!-- ğŸ—‘ï¸ V2.1ï¼šå·²åˆ é™¤VIPç­‰çº§æ˜¾ç¤ºç³»ç»ŸUIï¼ˆLine 12-46ï¼‰ -->
    </view>

    <!-- æœªç™»å½•çŠ¶æ€ -->
    <view class="login-prompt" wx:else bindtap="redirectToAuth">
      <view class="login-avatar">ğŸ‘¤</view>
      <text class="login-text">ç‚¹å‡»ç™»å½•</text>
      <text class="login-desc">ç™»å½•åæŸ¥çœ‹å®Œæ•´åŠŸèƒ½</text>
    </view>
  </view>

  <!-- ç§¯åˆ†ä½™é¢å¡ç‰‡ -->
  <view class="points-card" bindtap="onPointsTap" wx:if="{{isLoggedIn}}">
    <view class="points-header">
      <text class="points-title">æˆ‘çš„ç§¯åˆ†</text>
      <view class="header-tips">
        <text class="points-tips">ç‚¹å‡»æŸ¥çœ‹æ˜ç»† ğŸ‘‡</text>
      </view>
    </view>
    <view class="points-amount">
      <text class="points-number">{{totalPoints}}</text>
      <text class="points-unit">åˆ†</text>
    </view>

    <!-- ç§¯åˆ†è¶‹åŠ¿ -->
    <view class="points-trend">
      <view class="trend-item">
        <text class="trend-label">ä»Šæ—¥è·å¾—</text>
        <text class="trend-value earned">+{{todayEarned || 0}}</text>
      </view>
      <view class="trend-item">
        <text class="trend-label">ä»Šæ—¥æ¶ˆè´¹</text>
        <text class="trend-value consumed">{{todayConsumed > 0 ? '-' : ''}}{{todayConsumed || 0}}</text>
      </view>
    </view>
  </view>

  <!-- ğŸ—‘ï¸ V2.1ï¼šå·²åˆ é™¤æˆå°±ç³»ç»ŸUIæ¨¡å—ï¼ˆLine 83-96ï¼‰ -->

  <!-- ç»Ÿè®¡æ•°æ® - ğŸ”´ 2x2ç½‘æ ¼å¸ƒå±€ï¼ˆä¸æ—§é¡¹ç›®ä¸€è‡´ï¼‰ -->
  <view class="statistics-section" wx:if="{{isLoggedIn && !loading}}">
    <view class="section-title">
      <text>ğŸ“Š æˆ‘çš„ç»Ÿè®¡</text>
      <button class="refresh-stats" bindtap="onRefreshStats">ğŸ”„</button>
    </view>
    <view class="stats-grid">
      <view class="stat-item">
        <text class="stat-number">{{statistics.totalLottery}}</text>
        <text class="stat-label">æŠ½å¥–æ¬¡æ•°</text>
        <text
          class="stat-trend {{statistics.lotteryTrend === 'â†‘' ? 'up' : (statistics.lotteryTrend === 'â†“' ? 'down' : 'stable')}}">{{statistics.lotteryTrend}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{statistics.totalExchange}}</text>
        <text class="stat-label">å…‘æ¢æ¬¡æ•°</text>
        <text
          class="stat-trend {{statistics.exchangeTrend === 'â†‘' ? 'up' : (statistics.exchangeTrend === 'â†“' ? 'down' : 'stable')}}">{{statistics.exchangeTrend}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{statistics.totalUpload}}</text>
        <text class="stat-label">ä¸Šä¼ æ¬¡æ•°</text>
        <text
          class="stat-trend {{statistics.uploadTrend === 'â†‘' ? 'up' : (statistics.uploadTrend === 'â†“' ? 'down' : 'stable')}}">{{statistics.uploadTrend}}</text>
      </view>
      <view class="stat-item">
        <text class="stat-number">{{statistics.thisMonthPoints}}</text>
        <text class="stat-label">æœ¬æœˆç§¯åˆ†</text>
        <text
          class="stat-trend {{statistics.pointsTrend === 'â†‘' ? 'up' : (statistics.pointsTrend === 'â†“' ? 'down' : 'stable')}}">{{statistics.pointsTrend}}</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-section">
    <view class="section-title">
      <text>ğŸ”§ åŠŸèƒ½èœå•</text>
    </view>
    <view class="menu-grid">
      <view class="menu-item" wx:for="{{menuItems}}" wx:key="id" bindtap="onMenuItemTap" data-item="{{item}}"
        style="border-left: 4rpx solid {{item.color}}">
        <view class="menu-icon" style="color: {{item.color}}">{{item.icon}}</view>
        <view class="menu-content">
          <text class="menu-name">{{item.name}}</text>
          <text class="menu-desc">{{item.description}}</text>
        </view>
        <text class="menu-arrow">â–¶</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-overlay" wx:if="{{loading}}">
    <view class="loading-content">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>
  </view>

  <!-- ğŸ”´ ç®¡ç†å‘˜åŠŸèƒ½å…¥å£æŒ‰é’® - æ”¾åœ¨é¡µé¢æœ€ä¸‹æ–¹ -->
  <view class="admin-entrance-section" wx:if="{{isLoggedIn && isAdmin}}">
    <view class="admin-entrance-card" bindtap="goToAdminDashboard">
      <view class="entrance-icon">
        <text class="icon-crown">ğŸ‘‘</text>
        <view class="icon-glow"></view>
      </view>
      <view class="entrance-content">
        <text class="entrance-title">ç®¡ç†å‘˜åŠŸèƒ½</text>
        <text class="entrance-desc">è¿›å…¥ç®¡ç†å‘˜æ§åˆ¶å°</text>
      </view>
      <view class="entrance-badge">
        <text class="badge-text">ADMIN</text>
      </view>
      <text class="entrance-arrow">â–¶</text>
    </view>
  </view>
</view>