<!-- pages/admin/consume-submit/consume-submit.wxml -->
<view class="consume-container">
  <!-- 页面标题 -->
  <view class="page-title">
    <text>消费录入</text>
  </view>

  <!-- 用户信息展示区域 -->
  <view class="user-info-section">
    <view class="section-title">
      <text>用户信息</text>
    </view>

    <!-- 加载状态 -->
    <view class="info-loading" wx:if="{{userInfoLoading}}">
      <text class="loading-icon">⏳</text>
      <text class="loading-text">正在加载用户信息...</text>
    </view>

    <!-- 用户信息展示 -->
    <view class="user-info-content" wx:if="{{!userInfoLoading && userInfo}}">
      <view class="info-row">
        <text class="info-icon">👤</text>
        <text class="info-label">昵称：</text>
        <text class="info-value">{{userInfo.nickname}}</text>
      </view>
      <view class="info-row">
        <text class="info-icon">📱</text>
        <text class="info-label">手机号码：</text>
        <text class="info-value">{{userInfo.mobile}}</text>
      </view>
    </view>

    <!-- 加载失败提示 -->
    <view class="info-error" wx:if="{{!userInfoLoading && !userInfo}}">
      <text class="error-icon">❌</text>
      <text class="error-text">用户信息加载失败，请重新扫码</text>
    </view>
  </view>

  <!-- 消费金额输入（必填） -->
  <view class="form-item">
    <view class="form-label required">消费金额（元）</view>
    <view class="input-wrapper">
      <text class="currency-symbol">¥</text>
      <input type="digit" class="amount-input" placeholder="请输入消费金额" value="{{consumeAmount}}"
        bindinput="onAmountInput" />
    </view>
    <view class="form-tips">（必填，范围：0.01-99999.99元）</view>
    <view class="form-hint">💡 积分规则：1元=1积分（四舍五入）</view>
  </view>

  <!-- 商家备注输入（可选） -->
  <view class="form-item">
    <view class="form-label">商家备注（可选）</view>
    <textarea class="notes-input" placeholder="请输入备注，如：消费2份套餐" value="{{merchantNotes}}" bindinput="onNotesInput"
      maxlength="200" auto-height />
    <view class="form-tips">（可选，用于记录消费详情，最多200字）</view>
  </view>

  <!-- 提交按钮 -->
  <view class="submit-wrapper">
    <button class="submit-button {{loading ? 'disabled' : ''}}" bindtap="onSubmit" disabled="{{loading || submitted}}">
      {{loading ? '提交中...' : (submitted ? '已提交' : '确认提交')}}
    </button>
  </view>

  <!-- 加载遮罩 -->
  <view class="loading-mask" wx:if="{{loading}}">
    <view class="loading-content">
      <view class="loading-icon"></view>
      <text>提交中，请稍候...</text>
    </view>
  </view>
</view>