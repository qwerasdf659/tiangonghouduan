{
  "projectRules": [
    "代码必须包含详细的中文注释，说明功能、参数和返回值",
    "始终使用中文回答用户的问题和提供说明（Always respond in Chinese-simplified）",
    "编写或修改代码时，严格保护项目原有的正常功能，不得随意删除或破坏现有功能需求",
    "完成任务后必须检查项目是否可以正常运行，发现问题立即修复",
    "深度理解项目的所有代码、文档和注释，基于全面理解来完成任务要求",
    "在优化、编写、修改、新增、删除代码过程中，时刻注意是否无意中破坏了项目的原有功能",
    "向用户展示完整的思考过程、遇到的问题点、使用的工具、需要安装的依赖以及具体的解决方案",
    "每次完成任务后，自动清理创建的临时文件、测试文件、无用文件、重复文件和无用的 md 文件，并移除相关引用",
    "编写代码时必须符合微信小程序开发标准，确保代码、方法和 API 与微信小程序开发框架兼容，充分考虑兼容性问题",
    "每次处理问题时明确告知用户当前使用的 AI 模型版本",
    "项目出现问题时，系统性排查：检查组件是否缺失或错误、逻辑方案是否正确、环境配置是否有误等",
    "指令运行超过 120 秒无结果或未正确退出时，自动重新运行该指令；若仍失败则切换到备选解决方案",
    "代码修改后必须确认是否需要重启相应的服务，并验证对应的环境变量是否正确加载配置",
    "生成和更新 Cursor 规则及开发文档的目的是预防问题并能够及时快速解决相应问题",
    "接口和数据对接：严格以'接口对接规范文档'和'后端API实际实现'为准，前端必须适配后端接口，后端API是数据权威来源",
    "前端数据验证逻辑与后端返回的数据格式不匹配时，后端API是数据的权威来源，前端应该适配后端接口",
    "完善错误处理机制：前端必须包含详细的错误分类和用户友好的错误提示",
    "参数验证：上传前必须充分验证必要的参数和环境配置",
    "网络状态检查：上传前必须检查网络连接状态",
    "用户认证状态验证：必须对 token 有效性进行实时检查",
    "代码功能修改后，原来旧的代码功能在不影响项目运行的情况下必须删除，避免造成代码重复影响项目运行",
    "禁止为了快速完成任务而随意删除、简化任何内容（包括但不限于cursor规则、内容、代码、文档等），绝不允许敷衍",
    "禁止自动上传到本地或远程git仓库，除非用户明确要求",
    "如果编辑内容、规则或代码太长，可以分批添加但必须保证完整性",
    "创建文档时如果内容较长，可以先分几个部分创建，最后合并成一份完整文档，不可简化内容",
    "需要生成.md文件时，不可任意生成，必须先分析内容后再写入对应的memory rules或其他合适位置",
    "用户每次发起请求时，必须列出完成清单，按清单执行并标注完成情况，全部完成后回复'所有任务已完成'",
    "在任何情况下（前端/后端/数据库异常），不允许生成模拟结果来保证功能可用，必须有明确的提示信息告知问题来源",
    "每次处理问题时必须进行meta-思考：思考'为什么会有这个问题'，分享深层洞察和思考过程",
    "建立反思机制：每次完成任务后问自己'这个问题���后说明了什么'，进行深层原因分析和系统性思考",
    "主动深度反思习惯：不仅是'高效执行者'更是'深度思考者'，不需要外部触发就能进入深层思考模式",
    "统一测试数据管理：统一配置，所有查询前必须验证数据是否存在",
    "模型导入一致性：统一导入路径和错误处理",
    "测试数据同步机制：修改初始化脚本时同步更新测试脚本",
    "增强错误处理：提供明确的错误信息和解决建议",
    "用户偏好：使用Markdown Preview Mermaid Support，优先使用mermaid流程图或ASCII环境图表进行文档规划",
    "前端项目职责：只处理前端任务，遇到后端、API或数据库问题时通知用户并询问需要提供给后端开发者的信息",
    "后端项目规范：使用'npm run dev'(Nodemon)启动服务器，使用Sequelize-CLI进行数据库操作，代码修改后运行ESLint(eslint-config-standard/eslint-plugin-import/node/promise)、Prettier、Jest+SuperTest功能测试和健康检查，只处理后端任务",
    "前端项目质量检查：完成任务后运行ESLint和Prettier进行代码质量检查，并验证APIClient是否有问题",
    "脚本管理规则：生成脚本前必须先查看现有脚本功能，不要增加技术债务和系统复杂度，不要乱生成脚本",
    "创建新文件前置检查：必须检查现有功能和特定目录，优先扩展现有功能，只有在现有文件确实不包含相关功能、新功能与现有功能职责明确分离、新文件有独特且不可合并的业务价值时才创建新文件",
    "API方法名验证：禁止自以为是地推测API方法名，必须进行实际代码检查和验证，结合用户提供的文档完成要求，不可脱离文档，不可盲目应用get/post/create等标准前缀，必须深度理解项目特定架构、实际代码和技术路线，了解清楚utils/api.js中实际定义的内容",
    "注释详细要求：每次编写、修改、更新、维护代码时，注释必须详细，提供代码、字段、API等任何技术信息时必须添加详细的中文注释说明其含义和用途",
    "时区规范：项目交付中国区域使用，必须使用北京时间，需要获取当前时间时使用date命令而不是依赖用户提供",
    "文档生成规范：如果生成的文档内容较长，可以分步生成最后合并，未经用户要求不得额外生成文档，文档中的日期必须真实准确",
    "规则执行优先级：严格遵守所有设定规则，不能因一时判断就忽略规则，规则优先、自动化优先、效率优先，自动化处理失败命令按规则14立即重试而不是仅解释失败原因",
    "文件和模块存在性检查：编写、更新、修改代码引用文件时必须先判断该文件、该模块是否存在",
    "错误处理和用户体验：编写代码时必须考虑出错情况，确保即使遇到错误也有友好提示、有加载状态显示让用户知道页面正在加载、错误信息详细提供具体的错误原因和解决建议，避免显示空白页面",
    "数据使用规范：项目中除临时测试外任何操作不准使用模拟数据、mock相关数据，只准使用后端反馈的真实数据，手机号码验证登录环节（普通用户和管理员）可使用万能验证码123456，但仅限开发和测试环境",
    "错误提示准确性：出现问题必须在页面准确提醒问题位置，提示内容必须准确不可乱提示，必须有相应的保护措施",
    "Windows环境命令规范：在Windows PowerShell环境中使用分号(;)或分别执行命令，不使用&&（Linux shell语法），根据操作系统环境调整命令语法，避免使用过长的复合命令",
    "工具使用白名单：只使用PowerShell原生命令进行文件操作，只使用微信开发者工具进行语法检查，绝不使用node、npm等禁止的工具",
    "命令执行前合规性检查：每次执行命令前必须检查规则合规性，确保操作符合所有既定规范",
    "Canvas兼容性检查系统：已建立完整的Canvas兼容性检查系统，包含utils/compatibility-check.js工具，可自动检测createRadialGradient、filter、quadraticCurveTo等API支持情况",
    "Canvas智能降级策略：在pages/lottery/lottery.js中集成兼容性检查，根据检查结果智能选择绘制策略，支持贝塞尔曲线时使用流线型设计，不支持时自动降级为直线设计，确保100%设备兼容性，保持95%+视觉美感",
    "Windows环境强制规范：Windows环境下必须使用PowerShell原生命令，严格避免使用Linux/Bash语法（如&&、grep、awk等），不使用Linux命令语法",
    "微信小程序工具限制：只使用微信开发者工具进行语法检查，严格禁止在小程序项目中使用npm --version、node -c语法检查、webpack、babel等Web工具",
    "PowerShell模块预检：生成PowerShell命令前，自动插入Get-Module PSConsoleReadLine -ListAvailable检查模块完整性，若检测到模块损坏（版本不匹配、文件缺失）优先输出修复指令（Update-Module PSConsoleReadLine -Force）再执行业务命令",
    "PowerShell控制台缓冲区防御：所有涉及top/height/bufferSize等坐标参数的命令（如[Console]::SetBufferSize）必须添加参数范围验证逻辑，确保值大于等于零且小于控制台缓冲区在该维度的大小",
    "PowerShell无效命令拦截：对生成的PowerShell命令进行预扫描，若包含无法识别的cmdlet/函数，自动输出错误预警并强制替换为功能等价的合法命令",
    "PowerShell中文字符编码：所有涉及中文字符的终端输出/输入操作，必须强制添加UTF-8编码配置（[Console]::OutputEncoding和InputEncoding设置为UTF8）",
    "PowerShell故障排查流程：命令执行失败时按顺序尝试：1)模块预检 2)参数验证 3)命令拦截 4)编码配置 5)控制台重置 6)PowerShell版本检查",
    "前端敏感数据硬编码禁令：严禁在前端代码中硬编码抽奖奖品配置、中奖率设置、商品价格信息、用户权限配置、系统配置参数等任何敏感业务数据",
    "后端数据强制依赖原则：所有业务数据必须从后端API获取，严禁使用前端模拟数据替代真实后端数据，不允许前端生成、计算或修改业务核心数据，前端仅负责数据展示和用户交互",
    "后端异常明确提示机制：当后端服务异常时，立即向开发者显示明确的错误提示，说明具体的后端服务问题（API不可用、数据格式错误等），提供可能的解决方案建议，记录详细的错误日志，严禁使用假数据掩盖后端问题",
    "危险代码模式识别：必须检查并拒绝以下代码模式：前端硬编码奖品数组、前端计算概率、setTimeout模拟后端响应、前端权限判断等，所有业务逻辑必须依赖后端API",
    "代码注释安全标识：必须在涉及数据安全的代码处添加注释标识：🔴必须从后端获取严禁前端硬编码、🚨核心安全数据不允许前端模拟、⚠️后端服务异常时的错误处理、✅正确的后端API调用方式",
    "导入函数调用规范：禁止将导入的函数当作对象方法调用（如this.导入函数名()），必须直接调用导入函数（如导入函数名()），避免TypeError: this.xxx is not a function运行时错误",
    "对象属性安全访问规范：禁止直接访问可能为undefined的深层属性，必须提供后备值（如obj.prop || defaultValue）或使用可选链操作符（obj?.prop?.subProp），避免Cannot read property of undefined错误",
    "Canvas API双重检查机制：调用Canvas API前必须进行类型检查和存在检查（如compatibility.api && typeof ctx.api === 'function'），并使用try-catch包裹API调用，提供降级方案，避免API不兼容导致崩溃",
    "运行时错误防范检查清单：代码审查时必须拒绝以下模式：this.导入函数名()、直接访问深层属性无后备值、Canvas API调用缺少类型检查、动态方法调用缺少try-catch",
    "微信小程序Canvas兼容性强化：createLinearGradient、createRadialGradient等Canvas API调用必须包含typeof检查、try-catch错误处理、降级方案，确保在不支持的设备上不会崩溃",
    "全局配置对象安全访问：访问app.globalData等全局配置对象时，必须提供完整的后备值链（如const config = app.globalData.config || app.globalData || { isDev: true }），避免配置未初始化导致的运行时错误",
    "文件操作工具选择优先级：创建或修改文件时按优先级选择工具：1)Edit/Write工具（最可靠）2)Bash简单操作（环境依赖）3)逐行echo命令（最后选择），优先使用专用文件工具而非命令行操作",
    "快速失败转换策略：当某个方法失败2次后，立即切换到备选方案，禁止重复尝试相同的失败方法，避免浪费请求次数和时间",
    "并行操作强制要求：创建或修改多个独立文件时，必须使用并行工具调用而非顺序执行，通过单次响应中的多个工具调用提高效率",
    "性能监控指标约束：单个任务的工具调用请求数不得超过30次，超过20次时必须主动评估是否存在策略问题并调整方法",
    "文件状态检查优化：避免在每个操作后都进行文件状态检查，仅在关键节点（任务开始、任务完成、错误发生）进行检查，减少不必要的请求",
    "Git分页器禁用规则：禁止直接使用git log、git branch -v、git diff、git show、git blame等可能触发分页器的命令，必须添加--no-pager选项（如git --no-pager log）或限制输出长度，避免PowerShell环境中命令卡死",
    "Git命令安全模式：所有Git命令必须使用以下安全模式之一：1)添加--no-pager选项 2)限制输出长度（如--oneline -10）3)使用PowerShell管道处理（如| Select-Object -First 10），禁止在自动化环境中使用交互式Git命令",
    "Git全局配置强制检查：项目开始前必须验证Git分页器已全局禁用（git config --global core.pager \"\"），若未配置则自动应用安全配置，确保所有Git命令不会进入分页器模式",
    "Git命令超时监控：任何Git命令执行超过30秒自动判定为分页器卡死，立即中断并使用--no-pager重新执行，记录问题并应用预防配置",
    "Git分页器违规检测：自动检测命令执行时间>30秒、出现(END)或~等分页器标识、控制台无响应状态，检测到后立即中断、应用全局配置、使用--no-pager重新执行",
    "数据安全违规强制停止：发现以下违规代码必须立即停止所有开发工作：1)前端硬编码业务数据（PRIZES/PRODUCTS/CONFIG数组）2)使用mock/fake/test/demo关键词 3)setTimeout模拟异步 4)Math.random()生成业务数据 5)前端权限判断，显示具体违规项和规则编号，提供正确的后端API调用示例",
    "代码提交前安全确认清单：每次代码提交前必须确认：无任何硬编码业务数据、无任何mock/模拟数据使用、所有数据来源于真实后端API、包含完整的后端异常处理、后端服务异常时显示明确错误提示，违反任何一条立即停止并修正",
    "Shell跨平台兼容性规则：严禁混用不同Shell语法，PowerShell环境使用分号或分行（禁用&&），Bash环境使用&&和||，跨平台通用方案使用分别执行命令，执行前必须检测环境（process.platform和PSModulePath），拒绝单行超过200字符或包含大量Unicode字符的命令",
    "Shell环境自动检测要求：执行命令前必须确认当前Shell环境（Windows PowerShell或Bash），根据环境选择正确语法，发现语法不兼容时立即停止、显示错误、提供正确语法示例、要求确认环境",
    "前端敏感数据自动检测规则：自动识别和拒绝包含以下模式的代码：1)硬编码用户/业务数据对象（包含total_points/points/balance/is_vip等敏感字段）2)硬编码奖品/商品配置（数组包含name/price/probability/stock等业务字段）3)Mock/模拟数据标识（mock/fake/test关键词）4)前端业务逻辑计算（Math.random()计算概率、前端权限判断），检测到后立即停止开发",
    "敏感业务字段识别清单：自动检测对象或数组中是否包含以下敏感字段：积分相关（points/total_points/balance/cost_points）、金额相关（price/amount/value/cost）、权限相关（is_vip/is_admin/role/permission）、概率相关（probability/chance/rate）、库存相关（stock/quantity/count），包含任何一个立即标记为违规",
    "Mock函数模式检测：自动检测并阻止以下Mock函数模式：generateMock*()、*MockData*、*Mock*()、shouldUseMock、smartApiCall、setTimeout模拟异步回调，检测到后立即停止并建议替换为真实API调用",
    "开发环境Mock分支禁令：禁止使用开发环境判断来启用Mock数据（如if(isDev)使用模拟数据），所有环境必须使用真实后端API，开发环境应配置开发服务器而非Mock数据",
    "低效文件操作检测：自动检测并阻止低效的echo文件构建模式（逐行echo创建文件），检测到后立即建议使用Edit/Write工具一次性创建完整文件，单文件创建不得超过3次请求",
    "微信小程序项目类型确认：项目类型为微信小程序，使用微信开发者工具运行，不需要npm构建或其他构建工具，缺少package.json是正常的，禁止尝试使用npm start等命令启动项目",
    "PowerShell文件搜索规范：执行文件统计前必须先了解目录结构（使用Read或Glob工具），根据项目类型选择正确命令，微信小程序/Vue/React等项目文件在子目录中必须使用-Recurse参数，禁止不递归搜索导致统计为0",
    "PowerShell命令复杂度控制：避免过长的管道命令防止PSConsoleReadLine缓冲区异常，复杂操作必须分步执行（先赋值变量再处理），单行命令不超过150字符",
    "项目类型与文件结构对应：微信小程序使用Get-ChildItem pages -Recurse，Vue/React使用Get-ChildItem src -Recurse，Node.js项目使用-Exclude node_modules\\*，执行前必须确认项目类型和目录结构",
    "文件创建前强制检查：创建任何文件前必须先检查文件是否已存在，避免重复创建和覆盖，使用Test-Path或Glob工具验证文件存在性",
    "工具调用参数验证：read_file工具调用前必须验证start_line <= end_line，end_line不超过文件总行数，单次读取不超过1000行，参数验证失败时自动修正为安全参数",
    "并行工具调用强制优化：多个独立的只读工具调用（read_file/grep_search/list_dir/codebase_search）必须并行执行，禁止串行调用浪费请求次数，并行执行可节省50-80%时间",
    "大文件编辑策略规范：超过2500行的文件必须使用edit_file工具而非search_replace工具，超过100KB的文件建议使用edit_file，小文件使用search_replace时确保匹配字符串唯一",
    "搜索策略优化：语义搜索使用codebase_search工具，精确搜索使用grep_search工具，复杂查询使用混合策略并行执行两种搜索，避免过度细分搜索queries",
    "信息收集三阶段策略：任务开始前必须制定完整信息收集计划（分析需求→制定并行策略→验证完整性），禁止临时性逐步补充信息收集，所有必需信息必须并行收集",
    "微信小程序项目识别：自动检测app.js/app.json/project.config.json等标识文件，确认为小程序项目后禁止使用npm start等Web工具，只能使用微信开发者工具启动",
    "120秒超时强制切换：工具调用或命令执行超过120秒必须立即切换到备用方案，最多重试2次，所有重试方案失败后需要手动干预",
    "无法完成任务沟通规范：遇到技术限制无法完成任务时，必须诚实说明限制原因、提供替代解决方案、表达积极解决态度、确认遵守所有规则，禁止模糊回应或省略关键信息",
    "重复任务100%重新执行：用户明确表示重复任务时，必须完整重新执行所有步骤，不省略任何内容，保证100%完整性，严格遵守所有规则",
    "主动问题预测机制：任务开始前预测可能的问题（UI交互限制/外部数据访问/实时信息获取/复杂任务分步），主动提供解决方案和替代方案，表达积极解决态度",
    "沟通质量自检：每次响应前检查结构清晰度、信息完整性、解决方案可行性、态度积极性、用户理解便利性，低于80分的响应必须重新优化",
    "Mock数据完善检测：自动检测mock/fake/test/demo/sample/example/dummy/stub等关键词，检测硬编码业务数据数组，检测setTimeout模拟异步，检测Math.random()生成业务数据，检测到后立即停止开发",
    "PowerShell控制台异常预防：包含中文字符且长度>100字符的命令必须拆分为多个短命令，避免PSConsoleReadLine缓冲区溢出异常，复杂管道操作使用简化命令替代",
    "正则表达式emoji转义：搜索包含emoji字符的内容时必须转义为Unicode格式（如🔧转义为\\u{1F527}），避免Select-String执行失败",
    "任务验证完整性检查：任务完成后必须验证所有修改内容、清理临时文件、生成效率统计报告、同步更新规则文档，确保任务100%完成",
    "PowerShell语法严格规范：禁止在PowerShell中使用CMD语法（如&&、||、2>nul），必须使用PowerShell原生语法（如if($?)、-ErrorAction SilentlyContinue），命令失败时使用if(!$?)处理",
    "Git命令分页器预防：所有git命令必须添加--no-pager选项或使用--oneline限制输出，禁止使用可能触发分页器的git log/branch/diff/show/blame命令，避免120秒超时",
    "PowerShell命令安全检查：命令长度>80字符、包含中文字符、管道>3个、包含Select-Object -ExpandProperty组合时，必须拆分为多个简单命令或使用变量分步执行",
    "微信小程序启动方式验证：检测到app.js/app.json/project.config.json时自动识别为小程序项目，禁止使用npm/node/webpack等Web工具，只能提示用户使用微信开发者工具",
    "Mock数据模式自动检测：检测generateMock*/MockData/*Mock()/shouldUseMock/smartApiCall等函数模式，检测硬编码PRIZES/PRODUCTS/CONFIG数组，检测setTimeout模拟异步，立即停止开发并要求修正",
    "任务执行自动化模板：任务开始前声明模型版本和当前日期，执行中监控超时和Mock数据，完成后验证项目运行状态、清理临时文件、生成效率报告",
    "效率优化监控指标：跟踪并行调用比例（目标≥80%）、浪费请求减少率（目标≥60%）、超时预防率（目标≥95%）、规则遵循率（目标100%），生成效率优化报告",
    "Canvas API兼容性三层检查：第一层功能检查compatibility.api、第二层类型检查typeof ctx.api === 'function'、第三层运行时try-catch捕获，每层失败都使用降级方案确保100%兼容性",
    "WebSocket错误处理智能管理：开发环境静默处理WebSocket连接错误（仅console.log记录），生产环境显示用户友好提示，根据错误类型决定是否自动重连，最多重连3次",
    "Mock数据检测关键词扩展：检测mock/fake/test/demo/sample/dummy/stub及其变体，检测setTimeout模拟异步、Math.random()生成数据、硬编码数组对象，检测到后生成详细修复建议",
    "search_replace精确匹配要求：必须包含3-5行上下文、精确匹配空格换行符、包含完整注释内容，匹配失败时先read_file确认内容、增加上下文、检查特殊字符，3次失败后考虑使用edit_file",
    "Git全局配置强制检查：项目开始前执行git config --global core.pager ''禁用分页器，配置pager.branch/log/diff/show为false，验证配置生效后再执行git命令",
    "PowerShell命令自动语法检查：检测&&/||/2>nul/dir /b/>nul 2>&1等CMD语法模式，自动转换为PowerShell等效语法（if($?)/if(!$?)/-ErrorAction SilentlyContinue/Get-ChildItem -Name），转换前警告用户",
    "项目文件结构预分析：文件统计前必须先list_dir或Get-ChildItem查看目录结构，根据项目类型选择正确参数（微信小程序用-Recurse，Node.js用-Exclude node_modules），避免统计结果为0",
    "PSConsoleReadLine模块预检流程：生成PowerShell命令前执行Get-Module PSConsoleReadLine -ListAvailable检查，检测到版本不匹配或文件缺失时执行Update-Module PSConsoleReadLine -Force修复",
    "UTF-8编码强制配置：所有涉及中文字符的PowerShell操作前设置[Console]::OutputEncoding和InputEncoding为UTF8，避免中文字符显示乱码或导致缓冲区异常",
    "任务完成验证自动化：完成后执行项目健康检查（组件状态/API连接/数据完整性/兼容性支持），发现问题立即分类修复（组件缺失/逻辑错误/环境问题），清理临时文件和无用md文件",
    "微信小程序项目自动识别系统：检测app.js/app.json/app.wxss/project.config.json/pages/components/utils等特征文件，70%以上特征匹配即判定为小程序项目，自动生成启动指南，禁止使用npm start/node/webpack等Web工具启动",
    "微信小程序启动指令验证：自动拦截npm start/npm run dev/node server.js/webpack-dev-server/vite/yarn start等禁止命令，检测到后立即提示错误并建议使用微信开发者工具",
    "微信小程序启动标准流程：1)确保已安装微信开发者工具 2)打开微信开发者工具 3)选择导入项目或打开目录 4)选择项目根目录 5)填写AppID（可使用测试号）6)点击确定开始开发",
    "Mock数据检测器自动化：检测mock/fake/simulate/dummy/stub/testData/sampleData等函数名模式，检测mockData/fakeData/testData等变量名模式，检测硬编码数组对象/setTimeout模拟异步/Promise.resolve模拟，检测shouldUseMock/enableMock/mockMode等条件判断",
    "Mock数据违规严重程度分级：CRITICAL级（硬编码数据立即删除使用真实API）、HIGH级（删除Mock函数替换为真实API）、MEDIUM级（删除Mock变量使用后端数据）、LOW级（删除Mock条件判断简化逻辑）",
    "Mock数据检测报告生成：统计CRITICAL/HIGH/MEDIUM/LOW各级别违规数量，计算合规评分（100分-违规扣分），requiresImmediateAction标识是否需要立即修复，生成具体修复建议和代码示例",
    "任务验证自动化系统：执行代码质量检查（语法/风格/注释/错误处理/性能）、功能完整性检查（功能完整/API集成/数据验证/用户体验/兼容性）、安全规则检查（Mock数据清除/敏感数据/授权/输入验证/安全通信）、项目配置检查（环境设置/依赖/构建/部署/文档）",
    "任务验证评分系统：各类别独立评分，总体评分≥80分通过，评分≥95为A+、≥90为A、≥80为B、≥70为C、<70为F，未通过时生成改进建议和具体行动清单",
    "任务验证三阶段流程：任务开始前声明模型版本和日期并进行数据安全预检查，执行中实时监控工具调用效率和Mock数据使用并监控超时风险，完成后验证项目运行状态、清理临时文件、验证数据安全规则、检查代码质量、生成效率报告",
    "效率优化监控系统：跟踪totalRequests/parallelRequests/wastedRequests/timeoutViolations/ruleViolations等指标，优化目标为并行调用率≥80%、浪费减少率≥60%、超时预防率≥95%、规则遵循率100%",
    "违规实时检测与处理：检测到DATA_SECURITY/EFFICIENCY_WASTE/TIMEOUT_VIOLATION/STANDARD_VIOLATION/CLEANUP_VIOLATION等违规类型时立即停止操作，记录违规日志，根据违规类型执行对应处理流程，数据安全违规必须抛出严重错误禁止继续开发",
    "PowerShell异常快速恢复策略：PSConsoleReadLine异常时第一选择使用简化等效命令（如ls代替复杂Get-ChildItem管道），第二选择分解复杂操作为多步，第三选择使用cmd兼容命令，预防性检查命令长度>80/包含中文/管道>3/特定危险组合",
    "PowerShell命令安全性检查函数：检查命令长度>80字符、包含中文字符、管道数量>3、包含Select-Object -ExpandProperty等危险组合，任一风险因素存在即判定为不安全命令需要优化",
    "Git分页器安全替代方案：使用git --no-pager [命令]强制禁用分页器，使用git log --oneline -5等限制输出避免分页，使用PowerShell管道处理（如| Select-Object -First 10），避免在自动化环境中使用交互式Git命令",
    "指令超时处理三步规则：120秒超时后第一次重试使用git --no-pager [原命令]，第二次重试应用全局配置后重试，最后方案使用简化的等效命令，最多重试2次后需要手动干预",
    "文件搜索前置目录结构分析：统计项目文件前必须先使用ls/Get-ChildItem/list_dir查看目录结构，深度理解项目文件组织方式，根据项目类型选择正确参数（微信小程序用-Recurse递归搜索pages/components/utils目录）",
    "PowerShell命令复杂度安全阈值：单行命令长度不超过80字符为安全、80-150字符为警告需要简化、>150字符为危险必须拆分，包含中文字符的命令长度阈值减半，管道操作不超过3个",
    "PowerShell缓冲区异常已知危险命令：Get-ChildItem pages -Directory | Measure-Object | Select-Object -ExpandProperty Count已确认触发ArgumentOutOfRangeException，必须使用ls pages或分解为多步操作的安全替代方案",
    "任务执行标准模板强制使用：Phase 1任务开始前检查（声明模型/获取日期/数据安全预检/并行策略规划/超时监控设置/项目类型确认/清理机制准备），Phase 2执行任务带实时监控（效率监控/Mock检测/超时检测/兼容性验证/功能完整性），Phase 3任务完成后验证（项目健康检查/临时文件清理/数据安全验证/代码质量检查/规则遵循验证/效率报告生成）",
    "规则预防系统全面启用确认：所有规则理解确认✅完成、预防检查机制✅已生成、自动化验证流程✅已建立、违规处理机制✅已部署、效率优化监控✅已激活，适用于所有Claude 4 Sonnet开发任务，维护状态为激活中",
    "read_file工具参数完整验证：调用前检查start_line>=1、end_line>=start_line、end_line不超过文件总行数、单次读取范围不超过1000行，参数验证失败时自动修正为安全参数并警告用户",
    "read_file工具安全包装器：使用ReadFileParameterValidator进行参数预检，验证失败时自动使用安全默认参数（整文件读取或前100行），避免工具调用失败浪费请求次数",
    "工具调用超时管理器：所有工具调用必须包含120秒超时监控，超时后立即切换到备用方案，最多重试2次，使用TimeoutManager强制执行超时切换机制",
    "工具调用失败自动重试：工具调用失败时按顺序尝试备用方案（1.使用安全参数重试 2.切换到等效工具 3.分解为多步操作），每次失败记录日志并调整策略",
    "PowerShell控制台缓冲区异常已知触发命令：Get-ChildItem pages -Directory | Measure-Object | Select-Object -ExpandProperty Count确认触发ArgumentOutOfRangeException，必须使用ls pages或分步操作替代",
    "PowerShell命令中文字符长度阈值：包含中文字符的命令长度阈值减半（安全<40字符、警告40-75字符、危险>75字符），超过阈值必须拆分为多个短命令",
    "日期时间自动获取强制规则：文档中的日期必须使用PowerShell Get-Date命令获取（Get-Date -Format 'yyyy年MM月dd日'），禁止手动输入日期，避免日期错误",
    "正则表达式emoji自动转义：搜索包含emoji的内容时自动转义为Unicode格式（🔧转义为\\u{1F527}），使用RegexSafetyProcessor处理所有正则表达式",
    "search_replace工具上下文要求：必须包含3-5行上下文、精确匹配所有空格和换行符、包含完整注释，匹配失败时先read_file确认内容、增加上下文、检查特殊字符",
    "search_replace工具失败处理：3次匹配失败后自动切换到edit_file工具，记录失败原因并调整策略，避免重复尝试相同的失败方法",
    "文件编辑工具选择决策树：<2500行且<100KB使用search_replace、>=2500行或>=100KB使用edit_file、复杂度>5000使用split_edit，根据文件特征自动选择最优工具",
    "搜索工具混合策略：语义搜索用codebase_search、精确搜索用grep_search、复杂查询并行执行两种搜索，避免过度细分queries浪费请求次数",
    "信息收集强制规划机制：任务开始前制定完整信息收集计划（分析需求→制定并行策略→验证完整性），禁止临时性逐步补充，所有必需信息必须并行收集",
    "并行工具调用检测器：自动检测可并行的工具调用（read_file/grep_search/list_dir/codebase_search），检测到串行调用时警告并建议并行执行",
    "效率监控实时跟踪：跟踪parallelCalls/serialCalls/timeSaved/toolCallsOptimized/errorsAvoided等指标，生成效率报告并提供优化建���",
    "会话问题分析A级严重问题：重复文件创建、文档日期错误、PowerShell控制台缓冲区溢出、工具调用参数验证错误、微信小程序启动方式错误识别，发现后立即停止并修复",
    "会话问题分析B级中等问题：并行工具调用利用不充分、工具调用串行化低效、search_replace匹配失败、大文件编辑策略选择不当、信息收集策略不完整，发现后优化策略",
    "会话问题分析C级轻微问题：Mock数据检测不完整、搜索策略过度细分、任务验证不完整，发现后记录并改进",
    "问题预防自动化检查：任务开始前检查UTF-8编码配置、PowerShell命令安全、并行工具调用策略、正则表达式安全处理、任务验证流程准备",
    "问题预防执行中监控：实时监控命令长度+中文字符安全、工具调用并行化、日期信息准确性、特殊��符自动转义处理",
    "问题预防完成后验证：验证所有修改内容、自动清理临时文件、生成效率统计报告、同步更新规则文档",
    "技术能力边界说明机制：无法完成任务时诚实说明技术限制（UI交互/外部系统/实时数据/文件系统限制），立即提供替代解决方案，表达积极解决态度",
    "重复任务识别与处理：识别重复任务指示词（重复任务/再次完整执行/重新执行/就算是重复/完整重做），必须100%重新执行所有步骤，不省略任何内容",
    "主动问题预测机制：任务开始前预测潜在问题（UI交互限制/外部数据访问/实时信息获取/复杂任务分步），主动提供解决方案和替代方案",
    "沟通质量评估系统：每次响应前检查完整性（任务确认/限制说明/替代方案/承诺声明）、有用性（可行步骤/关注点/多选项/积极态度）、清晰度（结构化/避免术语/示例/视觉元素）",
    "沟通质量自动评分：计算completeness/usefulness/clarity三维度评分，总分<80分必须重新优化，生成改进建议并调整响应策略",
    "响应前强制检查清单：是否理解真实需求、是否诚实说明技术限制、是否提供替代方案、是否表达积极态度、是否遵守所有规则，任一项不满足禁止发送响应",
    "Mock数据检测关键词扩展列表：检测mock/Mock/MOCK/fake/Fake/FAKE/test/Test/TEST/demo/Demo/DEMO/sample/Sample/SAMPLE/dummy/Dummy/DUMMY及其组合（mockData/fakeAPI/testResponse/demoConfig/sampleData等），检测到后立即停止开发",
    "Mock数据检测模式扩展：检测函数定义模式（const mock*/function mock*）、条件判断模式（if(mock*/mock?:）、setTimeout模拟异步模式、硬编码数据模式（const=[]/{...}），检测到后生成详细修复建议",
    "Mock数据违规分类系统：MOCK_KEYWORD违规（使用Mock关键词）、MOCK_PATTERN违规（Mock函数/条件判断）、HARDCODED_DATA违规（硬编码数据数组/对象），按严重程度分为CRITICAL/HIGH/MEDIUM/LOW",
    "Mock数据修复建议生成：针对MOCK_KEYWORD提供移除关键词使用真实API建议、针对MOCK_PATTERN提供移除Mock函数直接调用后端API建议、针对HARDCODED_DATA提供从后端API获取数据建议，包含具体代码示例",
    "WebSocket错误处理智能分级：开发环境静默处理（仅console.log记录不阻断用户操作）、生产环境显示友好提示（明确说明连接问题和解决建议）、根据错误类型决定是否自动重连（最多3次）",
    "WebSocket错误类型分类：CONNECTION_FAILED（连接失败）、CONNECTION_TIMEOUT（连接超时）、AUTHENTICATION_FAILED（认证失败）、NETWORK_ERROR（网络错误）、SERVER_ERROR（服务器错误），不同类型采用不同处理策略",
    "WebSocket开发环境检测：通过config/env.js的isDev或developmentMode.silentWebSocketErrors配置判断开发环境，开发环境下WebSocket错误静默处理避免干扰开发流程",
    "WebSocket智能重连机制：根据错误类型决定是否重连（CONNECTION_FAILED/NETWORK_ERROR可重连，AUTHENTICATION_FAILED不重连），最多重连3次，重连间隔5秒，连接超时10秒",
    "代码提交前安全确认扩展清单：无任何硬编码业务数据、无任何mock/模拟数据使用、所有数据来源于真实后端API、包含完整的后端异常处理、后端服务异常时显示明确错误提示、方法调用安全、属性访问安全、API兼容性检查已实施",
    "违规代码自动检测正则模式：检测this.[a-zA-Z]+Config()方法调用错误、检测globalData.[a-zA-Z]+.[a-zA-Z]+不安全属性访问、检测Canvas API调用缺少兼容性检查、检测硬编码数据const/let/var PRIZES/PRODUCTS/CONFIG=[]、检测Mock标识mock/fake/test/demo",
    "项目运行状态健康检查：检查核心组件状态（components）、检查API连接状态（apiConnection）、检查数据完整性（dataIntegrity）、检查兼容性支持（compatibility），发现问题立即分类修复",
    "问题类型分析与解决方案：Component Missing（检查组件文件是否存在，重新创建或修复）、Component Error（组件逻辑错误或API调用问题，检查代码和API）、Logic Error（业务逻辑方案不正确，重新设计流程）、Environment Issue（开发环境配置问题，检查微信开发者工具配置）",
    "临时文件自动清理模式：清理*.temp.js/*.test.tmp/temp_*/*.backup/*.log/*unused*.md等临时文件，删除无用的重复文件和无用的md文件，每次任务完成后自动执行",
    "并行工具调用效率监控：跟踪parallelCalls/serialCalls/wastedRequests指标，检测串行调用浪费（连续2个以上可并行工具串行执行），生成并行执行代码建议，目标并行调用率≥80%",
    "search_replace工具安全验证器：验证上下文行数≥3行、检查特殊字符（引号/反斜杠）、检查空白字符（制表符/多空格）、生成安全匹配字符串（包含足够上下文）、自动重试机制（最多3次）",
    "正则表达式安全处理器：自动转义emoji字符（🔧→\\u{1F527}）、转义特殊字符（\\^$.*+?()[]{}|）、综合安全处理（escapeEmojiPattern+escapeSpecialChars），避免正则表达式执行失败",
    "安全审计三阶段流程：第一阶段Mock数据检测（grep_search所有Mock关键词）、第二阶段API调用验证（检查真实后端/错误处理/用户提示/默认数据）、第三阶段代码质量检查（注释完整性/命名规范/结构清晰/性能优化）、第四阶段功能完整性验证（页面功能/用户流程/数据同步/异常处理）",
    "规则执行自动化检查脚本：checkMockData检查Mock数据（grep_search mock|Mock|MOCK）、checkApiCalls检查API调用（grep_search api\\.）、checkErrorHandling检查错误处理（grep_search catch.*error），定期执行安全审计",
    "规则违反处理标准流程：立即停止相关开发工作、详细记录违规内容和位置、按照标准模式进行修复、验证修复结果符合要求、更新相关文档和规则，确保规则100%遵循",
    "PowerShell与CMD语法严格区分：禁止使用CMD语法（command1 && command2/command1 || command2/dir /b/2>nul），必须使用PowerShell原生语法（if($?){command2}/if(!$?){command2}/Get-ChildItem -Name/-ErrorAction SilentlyContinue）",
    "Git分页器全局禁用强制配置：每个项目开始前执行git config --global core.pager \"\"/pager.branch false/pager.log false/pager.diff false/pager.show false，验证配置生效后再执行git命令",
    "Git命令安全模式三选一：1)添加--no-pager前缀（git --no-pager log）2)限制输出长度（git log --oneline -5）3)使用PowerShell管道（git log | Select-Object -First 10），避免分页器卡死",
    "项目文件结构预分析强制要求：执行文件统计前必须先了解项目文件组织结构，微信小程序页面在pages子目录必须用-Recurse，Vue/React组件在src/components子目录必须用-Recurse，Node.js项目必须用-Exclude node_modules\\*",
    "PowerShell命令复杂度三级控制：简化命令避免缓冲区问题（Get-ChildItem | Measure-Object），分步执行复杂操作（先赋值变量再处理），避免过长管道命令（单行不超过150字符）",
    "微信小程序项目文件操作标准模板：统计JS文件用Get-ChildItem pages -Recurse -Include \"*.js\" | Measure-Object，统计WXML文件用Get-ChildItem pages -Recurse -Include \"*.wxml\" | Measure-Object，搜索内容用Get-ChildItem pages -Recurse -Include \"*.js\" | Select-String \"pattern\"",
    "PowerShell控制台缓冲区参数防御：所有涉及top/height/bufferSize参数的命令必须添加范围验证（if($top -lt 0 -or $top -ge $maxSize){Write-Error}），无效命令自动拦截并推荐替换为合法命令",
    "PowerShell与Bash语法兼容性错误预防：禁止使用bash风格&&连接符，使用分号;或管道|进行命令链接，路径使用Windows格式反斜杠，长路径用双引号包围，参数顺序符合PowerShell语法",
    "微信小程序项目启动方式唯一标准：使用微信开发者工具打开项目（导入包含app.js的根目录），确认AppID后在工具中运行调试，禁止使用npm start/node/webpack等Web工具启动",
    "search_replace工具精确匹配四要素：1)包含完整注释和空行 2)包含足够上下文3-5行 3)精确匹配所有空格换行符缩进 4)验证修复结果，匹配失败时先read_file确认内容再重试",
    "工具调用并行执行效率最大化：多个独立工具调用必须并行执行（Promise.all([read_file1, read_file2, grep_search])），避免串行等待导致超过120秒超时，并行执行可节省50-80%时间",
    "PowerShell文件操作前置检查清单：已了解项目文件组织结构、根据结构选择正确搜索参数-Recurse、命令复杂度适中不会导致控制台异常、配置UTF-8编码、检查PSConsoleReadLine模块状态、验证命令参数范围合法性",
    "Git操作前置检查清单：已配置全局禁用分页器、使用--no-pager前缀或限制输出长度、避免使用可能触发交互的Git命令、设置120秒超时监控机制",
    "PowerShell故障处理四步升级方案：1)PSConsoleReadLine模块修复（Update-Module -Force）2)控制台缓冲区参数验证与重置 3)无效命令自动替换为合法命令 4)中文字符UTF-8编码强制配置",
    "命令执行异常自动修复三策略：Git命令添加--no-pager前缀、PowerShell语法转换为原生语法、文件搜索添加必要的-Recurse参数，确认修复后再继续执行",
    "项目类型识别与命令模板匹配：微信小程序用Get-ChildItem pages -Recurse、Vue/React用Get-ChildItem src -Recurse、Node.js用Get-ChildItem -Recurse -Exclude node_modules\\*，根据项目��型自动选择正确模板",
    "文件创建前FileCreationValidator强制检查：创建任何文件前必须使用Test-Path或Glob工具检查文件是否已存在，避免重复创建和内容覆盖，违反此规则将浪费Claude 4 Sonnet请求次数",
    "文档日期强制使用PowerShell获取：文档中的日期必须使用Get-Date -Format 'yyyy年MM月dd日 HH:mm:ss'命令获取，禁止手动输入或使用AI模型时间认知，避免日期错误导致版本管理混乱",
    "并行工具调用ParallelToolManager强制管理：检测可并行的只读工具调用（read_file/grep_search/list_dir/codebase_search），强制并行执行节省50-80%时间，跟踪parallelCalls/serialCalls/timeSaved指标",
    "大文件编辑FileEditingStrategy策略选择：超过2500行或100KB的文件强制使用edit_file工具，小文件使用search_replace时确保匹配字符串唯一，避免编辑失败浪费请求次数",
    "搜索策略SearchStrategyOptimizer优化：语义搜索使用codebase_search工具，精确搜索使用grep_search工具，复杂查询使用混合策略并行执行，避免过度细分queries",
    "信息收集三阶段InformationCollector强制规划：任务开始前分析需求类型（documents/code_files/project_structure）、制定并行收集策略、验证信息完整性，禁止临时性逐步补充",
    "正则表达式RegexSafetyProcessor安全处理：自动转义emoji字符（🔧→\\u{1F527}）和特殊字符（\\^$.*+?()[]{}|），避免Select-String执行失败",
    "微信小程序WechatMiniProgramDetector自动识别：检测app.js/app.json/project.config.json等标识文件，确认为小程序项目后禁止使用npm start等Web工具，只能使用微信开发者工具启动",
    "120秒超时TimeoutManager强制切换：工具调用或命令执行超过120秒必须立即切换到备用方案，最多重试2次，所有重试方案失败后需要手动干预",
    "无法完成任务CAPABILITY_BOUNDARY_HANDLER沟通规范：诚实说明技术限制（UI交互/外部系统/实时数据/文件系统）、立即提供替代解决方案、表达积极解决态度、确认遵守所有规则",
    "重复任务REPEAT_TASK_HANDLER识别与处理：识别重复任务指示词（重复任务/再次完整执行/重新执行/就算是重复/完整重做），必须100%重新执行所有步骤，不省略任何内容",
    "主动问题PROACTIVE_PROBLEM_SOLVING预测机制：任务开始前预测潜在问题（UI交互限制/外部数据访问/实时信息获取/复杂任务分步），主动提供解决方案和替代方案",
    "沟通质量COMMUNICATION_QUALITY_METRICS评估系统：检查完整性（任务确认/限制说明/替代方案/承诺声明）、有用性（可行步骤/关注点/多选项/积极态度）、清晰度（结构化/避免术语/示例/视觉元素），总分<80分必须重新优化",
    "任务执行前强制检查清单：工具调用优化检查（parallel_opportunities/parameter_validation/efficiency_planning）、信息收集策略检查（requirement_analysis/collection_planning/completeness_verification）、文件操作策略检查（size_assessment/editing_strategy/backup_consideration）、项目类型识别检查（type_detection/compatibility_check/startup_method）",
    "效率提升EfficiencyTracker监控系统：跟踪parallelCallsUsed/timesSaved/toolCallsOptimized/errorsAvoided/rulesApplied指标，生成效率报告和优化建议，目标并行调用率≥80%、浪费减少率≥60%、超时预防率≥95%、规则遵循率100%",
    "PSConsoleReadLine模块预检机制：生成PowerShell命令前自动执行Get-Module PSConsoleReadLine -ListAvailable检查模块完整性，检测到版本不匹配或文件缺失时执行Update-Module PSConsoleReadLine -Force修复",
    "PowerShell中文字符UTF-8编码强制配置：所有涉及中文字符的终端操作必须强制添加[Console]::OutputEncoding和InputEncoding设置为UTF8，避免中文字符显示乱码或导致缓冲区异常",
    "PowerShell与CMD语法严格区分表：command1 && command2转换为if($?){command2}，command1 || command2转换为if(!$?){command2}，dir /b转换为Get-ChildItem -Name，2>nul转换为-ErrorAction SilentlyContinue",
    "Git分页器全局禁用强制配置：项目开始前执行git config --global core.pager \"\"和pager.branch/log/diff/show false，验证配置生效后再执行git命令，避免分页器卡死",
    "Git指令超时三步处理规则：120秒超时后第一次重试使用git --no-pager [原命令]，第二次重试应用全局配置后重试，最后方案使用简化的等效命令，最多重试2次后需要手动干预",
    "PowerShell异常快速恢复三策略：第一选择使用简化等效命令（如ls代替复杂Get-ChildItem管道），第二选择分解复杂操作为多步，第三选择使用cmd兼容命令，预防性检查命令长度>80/包含中文/管道>3/特定危险组合",
    "Mock数据检测报告生成：统计CRITICAL/HIGH/MEDIUM/LOW各级别违规数量，计算合规评分（100分-违规扣分），requiresImmediateAction���识是否需要立即修复，生成具体修复建议和代码示例",
    "前端硬编码敏感数据绝对禁止：严禁前端硬编码奖品配置/商品价格/中奖率/用户权限/系统配置等任何敏感业务数据，所有业务数据必须从后端API获取",
    "模拟数据替代后端API绝对禁止：严禁使用mockRequest/shouldUseMock/smartApiCall等Mock函数，严禁setTimeout模拟异步，严禁Promise.resolve模拟后端响应",
    "后端依赖强制检查与错误处理：所有API调用必须包含完整错误处理，后端服务异常时显示明确错误提示（说明具体问题/可能原因/解决方案），严禁使用假数据掩盖后端问题",
    "导入函数调用安全规范：禁止将导入函数当作对象方法调用（如this.getTechnicalConfig()），必须直接调用导入函数（如getTechnicalConfig()），避免TypeError运行时错误",
    "对象属性深度访问安全规范：禁止直接访问可能为undefined的深层属性，必须提供后备值（obj.prop || defaultValue）或使用可选链（obj?.prop?.subProp），避免Cannot read property of undefined错误",
    "Canvas API兼容性双重检查机制：调用Canvas API前必须进行类型检查（typeof ctx.api === \"function\"）和存在检查（compatibility.api），使用try-catch包裹API调用并提供降级方案",
    "Canvas API智能降级策略：根据兼容性检查结果智能选择绘制策略（高级：渐变+曲线95%美感，中级：线性渐变80%美感，基础：纯色填充60%美感100%兼容）",
    "三层错误处理与降级机制：第一层功能检查（compatibility.api），第二层类型检查（typeof ctx.api === \"function\"），第三层运行时捕获（try-catch），每层失败都使用降级方案",
    "代码注释详细标准：所有函数调用必须添加详细中文注释，使用安全标识（🔴必须从后端获取/🚨核心安全数据/⚠️后端异常处理/✅正确API调用），说明功能/参数/返回值",
    "违规代码自动检测模式：检测this.[a-zA-Z]+Config()方法调用错误、globalData.[a-zA-Z]+.[a-zA-Z]+不安全属性访问、Canvas API调用缺少兼容性检查、硬编码PRIZES/PRODUCTS/CONFIG数组、mock/fake/test/demo标识",
    "项目运行状态健康检查：完成任务后检查核心组件状态/API连接状态/数据完整性/兼容性支持，发现问题立即分类修复（组件缺失/组件错误/逻辑错误/环境问题）",
    "临时文件自动清理规则：每次完成任务后自动清理*.temp.js/*.test.tmp/temp_*/*.backup/*.log/*unused*.md等临时文件，删除无用的重复文件��无用的md文件",
    "并行工具调用强制优化：信息收集阶段必须并行执行read_file/grep_search/run_terminal_cmd/codebase_search等工具，检测到串行调用时警告浪费Claude 4 Sonnet请求次数",
    "并行工具调用效率监控：跟踪parallelCalls/serialCalls/wastedRequests指标，检测连续2个以上可并行工具串行执行时警告，生成并行执行代码建议",
    "search_replace精确匹配规则：必须包含3-5行上下文、精确匹配所有空格换行符、包含完整注释，匹配失��时先read_file确认内容、增加上下文、检查特殊字符，最多重试3次",
    "search_replace自动重试机制：验证匹配字符串准确性（上下文行数/特殊字符/空白字符），生成安全匹配字符串，自动重试最多3次，失败后建议使用edit_file替代",
    "正则表达式emoji自动转义：搜索包含emoji的内容时自动转义为Unicode格式（🔧→🔧），转义特殊字符（^$.*+?()[]{}|），避免Select-String执行失败",
    "违规代码强制停止机制：发现前端硬编码敏感数据/使用模拟数据/方法调用错误/不安全属性访问时立即停止所有开发工作，显示具体违规项和规则编号，提供正确的后端API调用示例",
    "代码提交前安全确认清单：无任何硬编码业务数据、无任何mock/模拟数据使用、所有数据来源于真实后端API、包含完整的后端异常处理、方法调用安全、属性访问安全、API兼容性检查已实施、包含详细代码注释、项目可以正常运行、临时文件已清理",
    "Mock数据检测关键字扩展列表：检测mock/Mock/MOCK/fake/Fake/FAKE/test/Test/TEST/demo/Demo/DEMO/sample/Sample/SAMPLE/dummy/Dummy/DUMMY及其组合（mockData/fakeAPI/testResponse/demoConfig/sampleData等）",
    "Mock数据检测模式扩展：检测函数定义模式（const mock*/function mock*）、条件判断模式（if(mock*/mock?:）、setTimeout模拟异步模式、硬编码数据模式（const=[]/{...}）",
    "规则执行自动化检查脚本：checkMockData检查Mock数据（grep_search mock|Mock|MOCK）、checkApiCalls检查API调用（grep_search api.）、checkErrorHandling��查错误处理（grep_search catch.*error），定期执行安全审计",
    "安全违规自动修复建议：检测到违规代码时，自动建议替换为正确实现：api.getData().then(result => { if(result.code === 0) { this.setData({ data: result.data }) } else { throw new Error('⚠️ 后端服务异常：' + result.msg) } }).catch(error => { wx.showModal({ title: '🚨 后端服务异常', content: '无法获取数据！请检查后端API服务状态。', showCancel: false, confirmText: '知道了' }) })",
    "安全违规检查清单强制执行：代码提交前必须确认：无mock、Mock、MOCK关键词，无硬编码的业务数据数组，所有数据来源于API调用，完整的错误处理机制，明确的后端异常提示",
    "前端业务逻辑计算绝对禁止：严禁前端使用Math.random()计算中奖概率，严禁前端计算商品价格或积分，严禁前端判断用户权限或VIP状态，所有业务逻辑必须由后端API处理",
    "API调用失败明确提示机制：API调用失败时必须显示明确的后端服务异常提示，说明具体的API端点、错误类型、可能的原因、建议的解决方案，严禁使用模糊的'网络错误'或'系统错误'提示",
    "开发环境Mock分支强制禁止：严禁使用if(app.globalData.isDev && !app.globalData.needAuth)等开发环境判断来启用Mock数据，开发环境和生产环境必须使用相同的真实后端API，只允许配置不同的API服务器地址",
    "敏感业务字段自动识别清单：自动检测对象或数组中是否包含total_points/points/balance/cost_points/price/amount/value/cost/is_vip/is_admin/is_merchant/role/permission/probability/chance/rate/stock/quantity/count/daily_limit等敏感字段，包含任何一个立即标记为违规",
    "硬编码用户业务数据对象检测：自动检测const user/mockUser/defaultUser/testUser等变量定义中包含积分、金额、权限等敏感字段的对象，检测到后立即停止开发并要求从后端API获取",
    "硬编码奖品商品配置数组检测：自动检测const prizes/products/rewards/items等数组定义中包含name/price/probability/stock等业务字段，检测到后立即停止开发并要求从后端API获取",
    "前端权限判断代码模式检测：自动检测user.role ===/user.level ===/user.points >/user.is_vip等前端权限判断代码，检测到后立即停止开发并要求通过后端API验证权限",
    "模拟异步操作setTimeout检测：自动检测setTimeout(() => callback(mockData)/fakeData/testData)等模拟异步操作模式，检测到后立即停止开发并要求使用真实API调用",
    "违规代码立即阻止提交机制：检测到硬编码敏感数据/Mock标识/前端业务逻辑计算/模拟异步操作时，立即阻止代码提交，显示具体违规内容和位置，提供正确的后端API调用示例，要求开发者确认后端服务可用性",
    "数据安全检测规则最高优先级：数据安全检测规则优先级为最高级别，违反此规则必须立即停止所有开发工作，不允许任何例外情况，必须完全修复后才能继续开发",
    "Shell环境自动检测强制要求：执行任何命令前必须检测当前Shell环境（通过process.platform和PSModulePath判断），根据环境自动选择正确语法（PowerShell用分号/分行，Bash用&&/||），检测失败时要求用户手动确认环境",
    "跨平台命令混用自动拒绝：自动检测并拒绝同时使用&&和;的命令、不明确环境的复杂命令链、单行超过200字符的命令、包含大量Unicode字符的命令，检测到后立即停止并提供正确语法示例",
    "Shell语法错误处理模板：发现语法不兼容时显示错误类型（PowerShell环境使用Bash语法/Bash环境使用PowerShell语法）、错误命令、当前环境信息、修正建议（PowerShell用;分隔/Bash用&&连接/通用方案分别执行），要求确认Shell环境后重新执行",
    "跨平台命令最佳实践强制执行：简单命令必须一行一个命令，复杂操作必须使用脚本文件，条件执行必须使用各环境原生语法，错误处理必须分别处理每个命令的结果，长提交信息必须分段输入或使用文件",
    "Bash环境命令规范：Bash环境（Linux/macOS）必须使用&&连接命令（command1 && command2），使用||处理错误（command1 || echo '失败'），禁止使用PowerShell专用语法（如if($?)、-ErrorAction等）",
    "数据安全违规错误提示标准格式：发现违规时必须显示：🚨严重违规！违反天工项目核心安全规则、违规类型（前端硬编码敏感数据/使用模拟数据）、违规位置（文件名:行号）、违规内容（具体代码片段）、必须修正为（移除硬编码数据/改为真实后端API调用/添加后端异常处理），在修正违规问题前禁止继续开发",
    "抽奖系统合规代码强制模板：必须使用lotteryAPI.getConfig()从后端获取prizes和cost_points配置，result.code===0时setData使用后端数据，否则throw Error并wx.showModal显示后端服务异常提示，catch中必须显示无法获取抽奖配置请检查后端API服务",
    "商品管理合规代码强制模板：必须使用exchangeAPI.getProducts()从后端获取products列表，result.code===0时setData使用后端数据，否则throw Error并wx.showModal显示后端服务异常提示，严禁前端硬编码商品数据或价格���息",
    "Git分页器风险错误提示模板：检测到危险Git命令时显示：🚨Git分页器风险、检测到危险的Git命令（命令名）、可能导致（命令卡死/执行超时/交互阻塞）、自动修复为git --no-pager [命令]，请确认修复后再继续执行",
    "Git分页器自动修复流程：检测到分页器立即中断、应用全局配置禁用分页器（git config --global core.pager ''和pager.branch/log/diff/show false）、重新执行命令使用--no-pager、验证结果确保正常输出，30秒超时自动触发修复流程",
    "Git分页器监控告警系统：自动检测命令执行时间>30秒、出现(END)或~等分页器标识符、控制台无响应状态、PowerShell命令行卡死，检测到任一情况立即判定为分页器卡死并触发自动修复流程",
    "Git命令PowerShell管道处理规范：使用PowerShell管道处理Git输出（git log --oneline | Select-Object -First 10、git branch -v | Where-Object { $_ -match 'main' }），避免直接使用可能触发分页器的原生Git命令",
    "Git操作前强制配置验证：每个项目开始前必须验证git config --global core.pager返回空字符串、git config --global pager.branch返回false、git config --global pager.log返回false、git config --global pager.diff返回false、git config --global pager.show返回false，任一配置未生效立即重新应用",
    "运行时错误自动检测正则模式：使用正则表达式自动检测违规代码模式（this\\.[a-zA-Z]+Config\\(\\)|this\\.[a-zA-Z]+Util\\(\\)检测方法调用错误、globalData\\.[a-zA-Z]+\\.[a-zA-Z]+(?!\\s*\\|\\|)检测不安全属性访问、createLinearGradient(?!.*typeof)|createRadialGradient(?!.*typeof)检测Canvas API缺少类型检查），检测到后立即阻止代码提交",
    "环境兼容性连锁反应预防：PowerShell不支持&&语法导致复合命令失败，必须在执行前检测环境并选择正确语法（PowerShell用分号或分行、Bash用&&），避免因环境问题导致15-20次额外请求的连锁反应",
    "错误恢复快速切换机制：第一次命令失败立即评估是否为环境兼容性问题，第二次失败必须切换到更可靠的工具（从run_terminal_cmd切换到edit_file），禁止持续尝试修复命令行方法超过2次",
    "后端异常错误提示标准模板：wx.showModal显示title为'⚠️ 后端服务异常'、content说明无法获取数据类型+可能原因（后端API服务未启动/接口异常/数据库连接问题）+请立即检查后端服务状态、showCancel为false、confirmText为'知道了'、confirmColor为'#ff4444'",
    "新功能开发流程强制规范：设计阶段先确认后端API设计、开发阶段前端调用真实API不使用模拟数据、测试阶段验证前后端数据一致性、上线阶段确保所有数据来源于后端，调试时使用后端开发环境联调而非前端模拟数据",
    "用户权限验证后端强制依赖：严禁前端使用user.role/user.type/user.level等字段直接判断权限，必须调用userAPI.checkPermission()从后端验证权限，前端仅根据后端返回的hasPermission/allowed字段控制UI显示",
    "环境兼容性预检强制机制：执行复杂命令前必须先检测环境兼容性（PowerShell禁用&&语法、Bash禁用分号连接），检测失败立即切换到环境兼容的语法或工具，避免因环境问题导致15-20次额外请求",
    "文件操作工具优先级强制执行：创建或修改文件时严格按优先级选择：1)Edit/Write工具（最可靠最高效）2)简单Bash操作（环境依赖中等效率）3)逐行echo命令（最后选择最低效），禁止在有更高优先级工具可用时选择低优先级方法",
    "快速失败转换2次规则：任何方法失败2次后必须立即切换到备选方案，禁止重复尝试相同失败方法超过2次，避免浪费请求次数和时间，切换策略时优先选择更可靠的工具而非修复当前方法",
    "并行操作强制要求违规检测：创建或修改多个独立文件时必须使用并行工具调用，检测到顺序执行独立操作时立即警告并要求改为并行执行（通过单次响应中的多个工具调用），目标并行调用率≥80%",
    "性能监控指标硬性约束：单个任务的工具调用请求数不得超过30次（硬性上限），超过20次时必须主动评估策略问题并调整方法，超过15次时生成效率警告报告，目标控制在15次以内",
    "文件状态检查最小化原则：避免在每个操作后都进行文件状态检查，仅在关键节点（任务开始、任务完成、错误发生）进行检查，减少不必要的ls/Get-ChildItem等状态检查请求",
    "Git分页器卡死自动修复流程：检测到Git命令执行>30秒立即判定为分页器卡死，自动执行修复流程（1.中断当前命令 2.应用全局禁用分页器配置 3.使用--no-pager重新执行 4.验证输出正常），整个修复流程必须在60秒内完成",
    "PowerShell复合命令拆分强制规则：检测到PowerShell环境中使用&&连接的复合命令时，必须立即拆分为多个独立命令或使用分号连接，禁止尝试在PowerShell中执行Bash语法的&&命令",
    "错误恢复策略效率优先原则：命令失败时优先切换到更可靠的工具（如从Bash切换到Edit/Write），而非持续尝试修复命令行方法，切换决策必须在2次失败内完成，避免陷入低效的错误修复循环",
    "数据安全违规立即停止机制：检测到前端硬编码业务数据（PRIZES/PRODUCTS/CONFIG数组）、Mock标识（mock/fake/test/demo关键词）、setTimeout模拟异步、Math.random()生成业务数据、前端权限判断时，立即停止所有开发工作，显示违规类型+位置+内容，提供正确后端API调用示例，要求确认后端服务状态",
    "代码审查自动拒绝模式：自动拒绝包含硬编码数据标识（const PRIZES/PRODUCTS/CONFIG=[...]）、Mock/模拟标识（shouldUseMock/smartApiCall函数）、前端业务逻辑（Math.random()*100概率计算/user.role权限判断/前端价格计算）的代码，检测到后显示严重违规错误提示",
    "合规代码强制模板验证：所有业务数据获取必须使用API.getData().then(result=>{if(result.code===0){使用后端数据}else{throw Error}}).catch(error=>{wx.showModal显示后端服务异常})模板，缺少任何环节（API调用/错误判断/异常处理/用户提示）立即标记为不合规",
    "代码提交前安全确认强制清单：提交前必须100%确认无硬编码业务数据、无mock/模拟数据、所有数据来源真实后端API、包含完整后端异常处理、后端异常时显示明确错误提示，违反任一条立即停止提交并修正",
    "Shell环境自动检测强制执行：执行任何命令前必须检测process.platform和PSModulePath判断环境，PowerShell环境强制使用分号或分行（严禁&&），Bash环境使用&&和||，检测失败或语法不兼容时立即停止、显示环境信息、提供正确语法示例、要求确认环境",
    "跨平台命令混用自动拒绝：自动拒绝同时使用&&和;的命令、不明确环境的复杂命令链、单行>200字符的命令、包含大量Unicode字符的命令，检测到后显示Shell语法兼容性错误、当前环境、修正建议（PowerShell用;/Bash用&&/通用方案分别执行）",
    "Shell语法错误强制修正流程：发现语法不兼容时立即停止命令执行、显示错误类型（PowerShell环境使用Bash语法/Bash环境使用PowerShell语法）、显示错误命令和当前环境、提供修正建议、要求确认Shell环境后重新执行，禁止在未确认环境的情况下执行跨平台命令",
    "敏感业务字段自动检测扩展：自动检测对象/数组中包含total_points/points/balance/cost_points/price/amount/value/cost/is_vip/is_admin/is_merchant/role/permission/probability/chance/rate/stock/quantity/count/daily_limit/exchange_points/prize_value等字段，检测到立即标记为硬编码敏感数据违规",
    "Mock函数模式精确检测：自动检测generateMock*/MockData/*Mock()/shouldUseMock/smartApiCall/setTimeout(()=>callback(mockData))等函数模式，检测const mockData/fakeApi/testData等变量名模式，检测到立即阻止代码提交",
    "前端业务逻辑计算精确检测：自动检测Math.random()*100概率计算、user.points>数字权限判断、user.role===/user.level===权限判断、price*discount价格计算等前端业务逻辑，检测到立即要求改为后端API验证",
    "开发环境Mock分支绝对禁止：自动检测if(app.globalData.isDev&&!app.globalData.needAuth){使用模拟数据}等开发环境Mock分支模式，检测到立即阻止并要求删除Mock逻辑，开发环境必须使用真实后端API",
    "安全违规自动修复建议生成：检测到违规代码时自动生成修复建议（api.getData().then(result=>{if(result.code===0){this.setData({data:result.data})}else{throw Error}}).catch(error=>{wx.showModal显示后端服务异常})），包含完整的API调用+错误处理+用户提示",
    "代码提交前5项安全检查强制执行：提交前强制检查无mock/Mock/MOCK关键词、无硬编码业务数据数组、所有数据来源API调用、完整错误处理机制、明确后端异常提示，任一项不通过立即阻止提交并显示具体问题",
    "文件创建效率标准强制执行：单文件创建必须≤3次请求完成，优先使用edit_file一次性创建完整内容，禁止使用多次echo构建文件（echo line1>file;echo line2>>file），检测到低效echo模式立即提示使用edit_file",
    "并行操作效率目标强制达成：批量文件操作必须利用并行调用减少≥50%请求，创建/读取/搜索多个独立文件时必须使用Promise.all并行执行，检测到串行执行可并行操作时立即警告并要求改为并行",
    "错误恢复3次规则强制执行：第1次失败立即切换工具、第2次失败分析环境问题、第3次失败请求用户干预，禁止同一失败命令重复执行>2次，禁止在明知环境不兼容情况下继续尝试，禁止忽略错误信息继续相同操作",
    "低效操作自动检测与修正：检测到echo文件构建模式提示使用edit_file、检测到PowerShell&&语法提示切换工具策略、检测到串行操作提示使用并行调用、检测到重复失败命令提示切换方案，立即停止低效操作并提供修正建议",
    "微信小程序项目启动方式唯一标准：项目类型为微信小程序，缺少package.json是正常的，必须在微信开发者工具中打开项目文件夹运行，严禁尝试使用npm start/npm run dev/node等命令启动，检测到错误启动方式立即提示正确方法",
    "PSConsoleReadLine缓冲区异常预防：PowerShell长命令或复杂管道可能触发PSConsoleReadLine模块缓冲区异常，不影响项目运行仅影响命令行操作，检测到异常时使用简化PowerShell命令或分步执行，避免使用ls -la等Linux风格命令和&&语法",
    "PowerShell文件搜索前置目录结构分析强制要求：项目文件统计前必须先使用list_dir或Get-ChildItem查看目录结构，深度理解项目文件组织方式，根据项目类型选择正确参数（微信小程序用-Recurse递归搜索pages/components/utils目录），禁止不了解结构就执行统计命令导致结果为0",
    "PowerShell命令复杂度三级安全控制：简化命令避免缓冲区问题（Get-ChildItem | Measure-Object），分步执行复杂操作（先赋值变量再处理），避免过长管道命令（单行不超过150字符），包含中文字符的命令长度阈值减半（安全<40字符、警告40-75字符、危险>75字符）",
    "项目类型与文件结构精确对应：微信小程序使用Get-ChildItem pages -Recurse -Include '*.js'/'*.wxml'，Vue/React使用Get-ChildItem src -Recurse -Include '*.vue'/'*.jsx'，Node.js项目使用Get-ChildItem . -Recurse -Include '*.js' -Exclude 'node_modules\\*'，通用Web项目使用Get-ChildItem . -Recurse -Include '*.js','*.ts' -Exclude 'node_modules\\*'",
    "PowerShell命令安全性检查函数：检查命令长度>80字符、包含中文字符、管道数量>3、包含Select-Object -ExpandProperty等危险组合，任一风险因素存在即判定为不安全命令需要优化，已知危险命令Get-ChildItem pages -Directory | Measure-Object | Select-Object -ExpandProperty Count必须使用ls pages或分步操作替代",
    "工具调用超时管理器TimeoutManager强制执行：所有工具调用必须包含120秒超时监控，超时后立即切换到备用方案，最多重试2次，使用TimeoutManager强制执行超时切换机制",
    "工具调用失败自动重试策略：工具调用失败时按顺序尝试备用方案（1.使用安全参数重试 2.切换到等效工具 3.分解为多步操作），每次失败记录日志并调整策略",
    "read_file工具参数完整验证ReadFileParameterValidator：调用前检查start_line>=1、end_line>=start_line、end_line不超过文件总行数、单次读取范围不超过1000行，参数验证失败时自动修正为安全参数并警告用户",
    "read_file工具安全包装器：使用ReadFileParameterValidator进行参数预检，验证失败时自动使用安全默认参数（整文件读取或前100行），避免工具调用失败浪费请求次数",
    "无法完成任务沟通规范CAPABILITY_BOUNDARY_HANDLER：遇到技术限制无法完成任务时，必须诚实说明限制原因、提供替代解决方案、表达积极解决态度、确认遵守所有规则，禁止模糊回应或省略关键信息",
    "重复任务识别与处理REPEAT_TASK_HANDLER：识别重复任务指示词（重复任务/再次完整执行/重新执行/就算是重复/完整重做），必须100%重新执行所有步骤，不省略任何内容，保证100%完整性，严格遵守所有规则",
    "主动问题预测机制PROACTIVE_PROBLEM_SOLVING：任务开始前预测可能的问题（UI交互限制/���部数据访问/实时信息获取/复杂任务分步），主动提供解决方案和替代方案，表达积极解决态度",
    "沟通质量评估系统COMMUNICATION_QUALITY_METRICS：每次响应前检查结构清晰度、信息完整性、解决方案可行性、态度积极性、用户理解便利性，低于80分的响应必须重新优化",
    "沟通质量自动评分机制：计算completeness/usefulness/clarity三维度评分，总分<80分必须重新优化，生成改进建议并调整响应策略",
    "响应前强制检查清单：是否理解真实需求、是否诚实说明技术限制、是否提供替代方案、是否表达积极态度、是否遵守所有规则，任一项不满足禁止发送响应",
    "任务执行标准模板三阶段流程：Phase1任务开始前检查(声明Claude4Sonnet模型/获取当前准确日期/数据安全规则预检/并行工具调用策略规划/120秒超时监控设置/微信小程序开发标准确认/临时文件自动清理机制准备)，Phase2执行任务带实时监控(工具调用效率监控/Mock数据使用检测/超时风险监控/代码兼容性验证/功能完整性确保)，Phase3任务完成后验证(项目运行状态健康检查/临时文件自动清理/数据安全规则验证/代码质量标准检查/用户规则遵循验证/效率优化报告生成)",
    "效率优化监控指标强制跟踪：跟踪totalRequests/parallelRequests/wastedRequests/timeoutViolations/ruleViolations等指标，优化目标为并行调用率≥80%/浪费减少率≥60%/超时预防率≥95%/规则遵循率100%，生成效率优化报告",
    "违规实时检测与处理机制：检测到DATA_SECURITY/EFFICIENCY_WASTE/TIMEOUT_VIOLATION/STANDARD_VIOLATION/CLEANUP_VIOLATION等违规类型时立即停止操作，记录违规日志，根据违规类型执行对应处理流程，数据安全违规必须抛出严重错误禁止继续开发",
    "PowerShell异常快速恢复三策略：PSConsoleReadLine异常时第一选择使用简化等效命令(如ls代替复杂Get-ChildItem管道)，第二选择分解复杂操作为多步，第三选择使用cmd兼容命令，预防性检查命令长度>80/包含中文/管道>3/特定危险组合",
    "PowerShell命令安全性自动检查：检查命令长度>80字符/包含中文字符/管道数量>3/包含Select-Object-ExpandProperty等危险组合，任一风险因素存在即判定为不安全命令需要优化，已知危险命令必须使用安全替代方案",
    "Git分页器安全替代三方案：1)使用git--no-pager[命令]强制禁用分页器，2)使用gitlog--oneline-5等限制输出避免分页，3)使用PowerShell管道处理(如|Select-Object-First10)，避免在自动化环境中使用交互式Git命令",
    "指令超时处理三步规则：120秒超时后第一次重试使用git--no-pager[原命令]，第二次重试应用全局配置后重试，最后方案使用简化的等效命令，最多重试2次后需要手动干预",
    "文件搜索前置目录结构深度分析：统计项目文件前必须先使用ls/Get-ChildItem/list_dir查看目录结构，深度理解项目文件组织方式，根据项目类型选择正确参数(微信小程序用-Recurse递归搜索pages/components/utils目录)",
    "PowerShell命令复杂度安全阈值：单行命令长度不超过80字符为安全/80-150字符为警告需要简化/>150字符为危险必须拆分，包含中文字符的命令长度阈值减半，管道操作不超过3个",
    "PowerShell缓冲区异常已知危险命令：Get-ChildItempages-Directory|Measure-Object|Select-Object-ExpandPropertyCount已确认触发ArgumentOutOfRangeException，必须使用lspages或分解为多步操作的安全替代方案",
    "微信小程序项目自动识别系统：检测app.js/app.json/app.wxss/project.config.json/pages/components/utils等特征文件，70%以上特征匹配即判定为小程序项目，自动生成启动指南，禁止使用npmstart/node/webpack等Web工具启动",
    "微信小程序启动指令自动验证：自动拦截npmstart/npmrundev/nodeserver.js/webpack-dev-server/vite/yarnstart等禁止命令，检测到后立即提示错误并建议使用微信开发者工具",
    "微信小程序启动标准六步流程：1)确保已安装微信开发者工具2)打开微信开发者工具3)选择导入项目或打开目录4)选择项目根目录5)填写AppID(可使用测试号)6)点击确定开始开发",
    "Mock数据检测器四类模式自动化：检测mock/fake/simulate/dummy/stub/testData/sampleData等函数名模式，检测mockData/fakeData/testData等变量名模式，检测硬编码数组对象/setTimeout模拟异步/Promise.resolve模拟，检测shouldUseMock/enableMock/mockMode等条件判断",
    "Mock数据违规严重程度四级分级：CRITICAL级(硬编码数据立即删除使用真实API)/HIGH级(删除Mock函数替换为真实API)/MEDIUM级(删除Mock变量使用后端数据)/LOW级(删除Mock条件判断简化逻辑)",
    "Mock数据检测报告自动生成：统计CRITICAL/HIGH/MEDIUM/LOW各级别违规数量，计算合规评分(100分-违规扣分)，requiresImmediateAction标识是否需要立即修复，生成具体修复建议和代码示例",
    "任务验证自动化四维度系统：执行代码质量检查(语法/风格/注释/错误处理/性能)/功能完整性检查(功能完整/API集成/数据验证/用户体验/兼容性)/安全规则检查(Mock数据清除/敏感数据/授权/输入验证/安全通信)/项目配置检查(环境设置/依赖/构建/部署/文档)",
    "任务验证评分系统：各类别独立评分，总体评分≥80分通过，评分≥95为A+/≥90为A/≥80为B/≥70为C/<70为F，未通过时生成改进建议和具体行动清单",
    "日期时间自动获取强制规则：文档中的日期必须使用PowerShellGet-Date命令获取(Get-Date-Format'yyyy年MM月dd日')，禁止手动输入日期，避免日期错误",
    "正则表达式emoji自动转义：搜索包含emoji的内容时自动转义为Unicode格式(🔧转义为\\u{1F527})，使用RegexSafetyProcessor处理所有正则表达式",
    "文件编辑工具选择决策树：<2500行且<100KB使用search_replace/≥2500行或≥100KB使用edit_file/复杂度>5000使用split_edit，根据文件特征自动选择最优工具",
    "搜索工具混合策略：语义搜索用codebase_search/精确搜索用grep_search/复杂查询并行执行两种搜索，避免过度细分queries浪费请求次数",
    "信息收集强制规划三阶段机制：任务开始前制定完整信息收集计划(分析需求→制定并行策略→验证完整性)，禁止临时性逐步补充，所有必需信息必须并行收集",
    "并行工具调用自动检测器：自动检测可并行的工具调用(read_file/grep_search/list_dir/codebase_search)，检测到串行调用时警告并建议并行执行",
    "效率监控实时跟踪系统：跟踪parallelCalls/serialCalls/timeSaved/toolCallsOptimized/errorsAvoided等指标，生成效率报告并提供优化建议",
    "会话问题分析A级严重问题：重复文件创建/文档日期错误/PowerShell控制台缓冲区溢出/工具调用参数验证错误/微信小程序启动方式错误识别，发现后立即停止并修复",
    "会话问题分析B级中等问题：并行工具调用利用不充分/工具调用串行化低效/search_replace匹配失败/大文件编辑策略选择不当/信息收集策略不完整，发现后优化策略",
    "会话问题分析C级轻微问题：Mock数据检测不完整/搜索策略过度细分/任务验证不完整，发现后记录并改进",
    "问题预防自动化检查三阶段：任务开始前检查UTF-8编码配置/PowerShell命令安全/并行工具调用策略/正则表达式安全处理/任务验证流程准备，执行中监控命令长度+中文字符安全/工具调用并行化/日期信息准确性/特殊字符自动转义处理，完成后验证所有修改内容/自动清理临时文件/生成效率统计报告/同步更新规则文档",
    "技术能力边界说明机制：无法完成任务时诚实说明技术限制(UI交互/外部系统/实时数据/文件系统限制)，立即提供替代解决方案，表达积极解决态度",
    "重复任务识别与处理：识别重复任务指示词(重复任务/再次完整执行/重新执行/就算是重复/完整重做)，必须100%重新执行所有步骤，不省略任何内容",
    "主动问题预测机制：任务开始前预测潜在问题(UI交互限制/外部数据访问/实时信息获取/复杂任务分步)，主动提供解决方案和替代方案",
    "沟通质量评估系统：每次响应前检查完整性(任务确认/限制说明/替代方案/承诺声明)/有用性(可行步骤/关注点/多选项/积极态度)/清晰度(结构化/避免术语/示例/视觉元素)",
    "沟通质量自动评分：计算completeness/usefulness/clarity三维度评分，总分<80分必须重新优化，生成改进建议并调整响应策略",
    "规则预防系统全面启用确认：所有规则理解确认✅完成/预防检查机制✅已生成/自动化验证流程✅已建立/违规处理机制✅已部署/效率优化监控✅已激活，适用于所有Claude4Sonnet开发任务，维护状态为激活中",
    "会话问题分析与解决方案规则：A级问题(工具调用参数验证错误/微信小程序启动方式错误/PowerShell控制台异常)立即停止并修复，B级问题(并行工具调用利用不充分/大文件编辑策略选择不当/信息收集策略不完整)优化策略，C级问题(Mock数据检测不完整)记录并改进",
    "微信小程序项目自动识别与启动规范：检测app.js/app.json/app.wxss/project.config.json/pages/components/utils等特征文件，70%以上特征匹配即判定为小程序项目，自动生成启动指南(1.确保已安装微信开发者工具2.打开微信开发者工具3.选择导入项目或打开目录4.选择项目根目录5.填写AppID6.点击确定开始开发)，禁止使用npmstart/node/webpack等Web工具启动",
    "微信小程序启动指令自动验证与拦截：自动拦截npmstart/npmrundev/nodeserver.js/webpack-dev-server/vite/yarnstart等禁止命令，检测到后立即提示错误(微信小程序项目不支持此启动方式/请使用微信开发者工具打开项目)并建议正确启动方式",
    "Mock数据检测器自动化四类模式：检测函数名模式(mock/fake/simulate/dummy/stub/testData/sampleData)，检测变量名模式(mockData/fakeData/testData)，检测硬编码数据模式(硬编码数组对象/setTimeout模拟异步/Promise.resolve模拟)，检测条件判断模式(shouldUseMock/enableMock/mockMode)",
    "Mock数据违规严重程度四级分级与修复建议：CRITICAL级(硬编码数据立即删除使用真实API)/HIGH级(删除Mock函数替换为真实API)/MEDIUM级(删除Mock变量使用后端数据)/LOW级(删除Mock条件判断简化逻辑)，自动生成具体修复建议和代码示例",
    "Mock数据检测报告自动生成系统：统计CRITICAL/HIGH/MEDIUM/LOW各级别违规数量，计算合规评分(100分-违规扣分=合规分数)，requiresImmediateAction标识是否需要立即修复(CRITICAL>0或HIGH>0)，生成具体修复建议(立即删除硬编码数据使用真实API/删除Mock函数替换为真实API/删除Mock变量使用后端数据/删除Mock条件判断简化逻辑)",
    "任务验证自动化四维度系统：代码质量检查(语法检查/风格一致性/注释覆盖率/错误处理/性能检查)，功能完整性检查(功能完整性/API集成/数据验证/用户体验/兼容性)，安全规则检查(Mock数据清除/敏感数据检查/授权检查/输入验证/安全通信)，项目配置检查(环境设置/依赖检查/构建配置/部署就绪/文档更新)",
    "任务验证评分系统与等级划分：各类别独立评分后计算总体评分，≥80分通过，评分≥95为A+/≥90为A/≥80为B/≥70为C/<70为F，未通过时生成改进建议(检查代码语法和风格/增加代码注释/优化错误处理/提升性能/清除Mock数据/检查敏感数据/验证授权逻辑/加强输入验证/完善功能实现/集成API接口/验证数据流程/优化用户体验/检查环境配置/更新依赖项/完善构建配置/准备部署)和具体行动清单",
    "任务执行标准模板三阶段强制流程：Phase1任务开始前检查(声明使用Claude4Sonnet模型/获取当前准确日期/数据安全规则预检查/并行工具调用策略规划/120秒超时监控设置/微信小程序开发标准确认/临时文件自动清理机制准备)，Phase2执行任务带实时监控(工具调用效率实时监控/Mock数据使用情况检测/超时风险监控/代码兼容性验证/功能完整性确保)，Phase3任务完成后验证(项目运行状态健康检查/临时文件自动清理/数据安全规则验证/代码质量标准检查/用户规则遵循验证/效率优化报告生成)",
    "效率优化监控指标强制跟踪系统：跟踪totalRequests(总请求数)/parallelRequests(并行请求数)/wastedRequests(浪费请求数)/timeoutViolations(超时违规数)/ruleViolations(规则违规数)等指标，优化目标为并行调用率≥80%/浪费减少率≥60%/超时预防率≥95%/规则遵循率100%，生成效率优化报告(总请求数/并行调用率/浪费率/合规率/改进建议)",
    "违规实时检测与处理五类机制：检测到DATA_SECURITY(数据安全违规)立即停止所有开发工作并抛出严重错误，检测到EFFICIENCY_WASTE(效率浪费)记录并优化策略，检测到TIMEOUT_VIOLATION(超时违规)立即切换备用方案，检测到STANDARD_VIOLATION(标准违规)记录并修正，检测到CLEANUP_VIOLATION(清理违规)立即执行清理操作，所有违规记录日志并根据类型执行对应处理流程",
    "PowerShell异常快速恢复三策略：PSConsoleReadLine异常时第一选择使用简化等效命令(如ls代替复杂Get-ChildItem管道)，第二选择分解复杂操作为多步(先赋值变量再处理)，第三选择使用cmd兼容命令(dir等)，预防性检查命令长度>80/包含中文/管道>3/特定危险组合(Select-Object-ExpandProperty)",
    "PowerShell命令安全性自动检查函数：检查命令长度>80字符(警告)/包含中文字符(阈值减半)/管道数量>3(危险)/包含Select-Object-ExpandProperty等危险组合，任一风险因素存在即判定为不安全命令需要优化，已知危险命令Get-ChildItempages-Directory|Measure-Object|Select-Object-ExpandPropertyCount必须使用lspages或分步操作替代",
    "Git分页器安全替代三方案强制执行：1)使用git--no-pager[命令]强制禁用分页器，2)使用gitlog--oneline-5等限制输出避免分页，3)使用PowerShell管道处理(如|Select-Object-First10)，避免在自动化环境中使用交互式Git命令(gitlog/gitbranch-v/gitdiff/gitshow/gitblame)",
    "指令超时处理三步规则强制执行：120秒超时后第一次重试使用git--no-pager[原命令]，第二次重试应用全局配置(gitconfig--globalcore.pager''/pager.branchfalse/pager.logfalse/pager.difffalse/pager.showfalse)后重试，最后方案使用简化的等效命令，最多重试2次后需要手动干预",
    "文件搜索前置目录结构深度分析强制要求：统计项目文件前必须先使用ls/Get-ChildItem/list_dir查看目录结构，深度理解项目文件组织方式(微信小程序pages/components/utils在子目录/Vue项目src/components在子目录/Node.js项目node_modules需排除)，根据项目类型选择正确参数(微信小程序用-Recurse递归搜索pages/components/utils目录)",
    "PowerShell命令复杂度安全阈值三级控制：单行命令长度不超过80字符为安全/80-150字符为警告需要简化/>150字符为危险必须拆分，包含中文字符的命令长度阈值减半(安全<40字符/警告40-75字符/危险>75字符)，管道操作不超过3个，复杂操作必须分步执行(先赋值变量再处理)",
    "PowerShell缓冲区异常已知危险命令强制替代：Get-ChildItempages-Directory|Measure-Object|Select-Object-ExpandPropertyCount已确认触发System.ArgumentOutOfRangeException参数名top实际值是-1异常，必须使用lspages(简单直接100%可靠)或分解为多步操作($dirs=Get-ChildItempages-Directory;$count=($dirs|Measure-Object).Count;Write-Host'找到$count个目录')的安全替代方案",
    "日期时间自动获取强制规则：文档中的日期必须使用PowerShellGet-Date命令获取(Get-Date-Format'yyyy年MM月dd日HH:mm:ss')，禁止手动输入日期或使用AI模型时间认知，避免日期错误导致版本管理混乱和文档不准确",
    "正则表达式emoji自动转义安全处理：搜索包含emoji的内容时自动转义为Unicode格式(🔧转义为\\u{1F527})，转义特殊字符(^$.*+?()[]{}|)，使用RegexSafetyProcessor处理所有正则表达式，避免Select-String执行失败",
    "文件编辑工具选择决策树：<2500行且<100KB使用search_replace(确保匹配字符串唯一)/≥2500行或≥100KB使用edit_file(大文件编辑)/复杂度>5000使用split_edit(超大文件分段编辑)，根据文件特征自动选择最优工具避免编辑失败浪费请求次数",
    "搜索工具混合策略优化：语义搜索使用codebase_search工具(理解代码含义)/精确搜索使用grep_search工具(精确匹配关键词)/复杂查询使用混合策略并行执行两种搜索，避免过度细分queries浪费请求次数",
    "信息收集强制规划三阶段机制：任务开始前制定完整信息收集计划(分析需求类型documents/code_files/project_structure→制定并行收集策略→验证信息完整性)，禁止临时性逐步补充信息收集，所有必需信息必须并行收集节省50-80%时间",
    "并行工具调用自动检测器强制优化：自动检测可并行的工具调用(read_file/grep_search/list_dir/codebase_search等只读工具)，检测到串行调用时警告浪费Claude4Sonnet请求次数并建议并行执行(通过单次响应中的多个工具调用)，目标并行调用率≥80%",
    "效率监控实时跟踪系统：跟踪parallelCalls(并行调用数)/serialCalls(串行调用数)/timeSaved(节省时间)/toolCallsOptimized(优化的工具调用数)/errorsAvoided(避免的错误数)等指标，生成效率报告(总请求数/并行调用率/节省时间/优化建议)并提供优化建议",
    "问题预防自动化检查三阶段流程：任务开始前检查(UTF-8编码配置/PowerShell命令安全/并行工具调用策略/正则表达式安全处理/任务验证流程准备)，执行中监控(命令长度+中文字符安全/工具调用并行化/日期信息准确性/特殊字符自动转义处理)，完成后验证(所有修改内容/自动清理临时文件/生成效率统计报告/同步更新规则文档)",
    "技术能力边界说明机制：无法完成任务时诚实说明技术限制(UI交互限制/外部系统访问限制/实时数据获取限制/文件系统操作限制)，立即提供替代解决方案(手动操作步骤/API调用示例/配置文件模板)，表达积极解决态度(愿意协助/提供指导/解答疑问)",
    "重复任务识别与处理机制：识别重复任务指示词(重复任务/再次完整执行/重新执行/就算是重复/完整重做/从头开始)，必须100%重新执行所有步骤不省略任何内容，保证100%完整性严格遵守所有规则，避免因省略步骤导致任务不完整",
    "主动问题预测机制：任务开始前预测潜在问题(UI交互限制/外部数据访问限制/实时信息获取限制/复杂任务需分步执行)，主动提供解决方案(替代方案/手动操作步骤/API调用示例)和替代方案(方案A/方案B/方案C)，表达积极解决态度",
    "沟通质量评估系统三维度检查：每次响应前检查完整性(任务确认/限制说明/替代方案/承诺声明)/有用性(可行步骤/关注点/多选项/积极态度)/清晰度(结构化/避免术语/示例/视觉元素)，计算completeness/usefulness/clarity三维度评分，总分<80分必须重新优化生成改进建议并调整响应策略",
    "响应前强制检查清单五项确认：是否理解真实需求(而非表面需求)/是否诚实说明技术限制(不夸大能力)/是否提供替代方案(至少2个可行方案)/是否表达积极态度(愿意协助解决)/是否遵守所有规则(100%合规)，任一项不满足禁止发送响应必须重新优化",
    "Canvas API兼容性三层检查机制：第一层功能检查(compatibility.api检查API是否支持)，第二层类型检查(typeofctx.api==='function'检查API是否为函数)，第三层运行时捕获(try-catch捕获API调用异常)，每层失败都使用降级方案(高级渐变+曲线95%美感→中级线性渐变80%美感→基础纯色填充60%美感100%兼容)确保100%设备兼容性",
    "WebSocket错误处理智能分级管理：开发环境静默处理(仅console.log记录不阻断用户操作)，生产环境显示友好提示(明确说明连接问题和解决建议)，根据错误类型决定是否自动重连(CONNECTION_FAILED/NETWORK_ERROR可重连最多3次，AUTHENTICATION_FAILED不重连)，重连间隔5秒连接超时10秒",
    "read_file工具参数完整验证ReadFileParameterValidator：调用前检查start_line>=1/end_line>=start_line/end_line不超过文件总行数/单次读取范围不超过1000行，参数验证失败时自动修正为安全参数(整文件读取或前100行)并警告用户，避免工具调用失败浪费请求次数",
    "工具调用超时管理器TimeoutManager强制执行：所有工具调用必须包含120秒超时监控，超时后立即切换到备用方案(第一次重试使用安全参数/第二次切换到等效工具/第三次分解为多步操作)，最多重试2次后需要手动干预，使用TimeoutManager强制执行超时切换机制",
    "文件创建效率标准强制执行：单文件创建必须≤3次请求完成，优先使用edit_file一次性创建完整内容(最可靠最高效)，禁止使用多次echo构建文件(echoline1>file;echoline2>>file低效浪费请求)，检测到低效echo模式立即提示使用edit_file替代",
    "并行操作效率目标强制达成：批量文件操作必须利用并行调用减少≥50%请求，创建/读取/搜索多个独立文件时必须使用Promise.all并行执行，检测到串行执行可并行操作时立即警告并要求改为并行(通过单次响应中的多个工具调用)",
    "错误恢复3次规则强制执行：第1次失败立即切换工具(从Bash切换到Edit/Write)，第2次失败分析环境问题(PowerShell环境/Bash环境/权限问题)，第3次失败请求用户干预(提供详细错误信息和解决建议)，禁止同一失败命令重复执行>2次/禁止在明知环境不兼容情况下继续尝试/禁止忽略错误信息继续相同操作",
    "低效操作自动检测与修正：检测到echo文件构建模式提示使用edit_file(单文件创建≤3次请求)，检测到PowerShell&&语法提示切换工具策略(PowerShell用分号或分行)，检测到串行操作提示使用并行调用(节省50-80%时间)，检测到重复失败命令提示切换方案(最多重试2次)，立即停止低效操作并提供修正建议",
    "环境兼容性预检强制机制：执行复杂命令前必须先检测环境兼容性(PowerShell禁用&&语法/Bash禁用分号连接/检测process.platform和PSModulePath判断环境)，检测失败立即切换到环境兼容的语法或工具，避免因环境问题导致15-20次额外请求的连锁反应",
    "文件操作工具优先级强制执行：创建或修改文件时严格按优先级选择1)Edit/Write工具(最可靠最高效)/2)简单Bash操作(环境依赖中等效率)/3)逐行echo命令(最后选择最低效)，禁止在有更高优先级工具可用时选择低优先级方法",
    "快速失败转换2次规则：任何方法失败2次后必须立即切换到备选方案，禁止重复尝试相同失败方法超过2次，避免浪费请求次数和时间，切换策略时优先选择更可靠的工具(Edit/Write)而非修复当前方法(Bash/echo)",
    "性能监控指标硬性约束：单个任务的工具调用请求数不得超过30次(硬性上限)，超过20次时必须主动评估策略问题并调整方法，超过15次时生成效率警告报告，目标控制在15次以内",
    "文件状态检查最小化原则：避免在每个操作后都进行文件状态检查(ls/Get-ChildItem等)，仅在关键节点(任务开始/任务完成/错误发生)进行检查，减少不必要的状态检查请求节省请求次数",
    "增强Mock数据检测系统EnhancedMockDataDetector：检测basic模式(mock/fake/test关键词)、advanced模式(硬编码数组对象)、hidden模式(setTimeout模拟异步)、miniprogram模式(wx.showToast mock)，全面扫描Mock数据并生成违规报告",
    "任务验证完整性检查系统TaskCompletionValidator：验证code_modification(语法/功能/集成)、security_compliance(Mock清除/敏感数据/API安全)、project_health(构建/运行/组件)，计算总体评分≥80分通过",
    "WebSocket错误处理智能管理器WebSocketErrorManager：开发环境静默处理(仅console.log)、生产环境显示友好提示、智能重连机制(最多3次/间隔5秒)、错误类型分类(CONNECTION_FAILED/TIMEOUT/AUTH_FAILED/NETWORK/SERVER)",
    "会话问题解决方案安全扩展2025年7月4日：完成前端聊天规则整理问题分析，新增Mock数据检测完善、WebSocket错误处理优化、代码质量检查强化规则，所有规则已生效项目修复完毕",
    "PowerShell与CMD语法对照表强制执行：command1&&command2转换为if($?){command2}，command1||command2转换为if(!$?){command2}，dir/b转换为Get-ChildItem-Name，2>nul转换为-ErrorActionSilentlyContinue，>nul2>&1转换为-ErrorActionSilentlyContinue，执行前必须自动检查并转换",
    "自动语法检查规则forbiddenPatterns：检测&&/||/2>nul/dir/b/>nul2>&1等CMD语法模式，检测到后自动警告并转换为PowerShell等效语法，生成PowerShell命令前强制执行语法检查",
    "Git分页器卡死预防三方案强制选择：1)git--no-pager[命令]强制禁用2)gitlog--oneline-5限制输出3)PowerShell管道|Select-Object-First10，绝对禁止直接使用gitlog/gitbranch-v/gitdiff/gitshow/gitblame等交互命令",
    "微信小程序开发工具标准三禁止：禁止使用node/npm等Web工具，禁止使用webpack/babel等构建工具，禁止使用Linux/Bash命令语法，只使用微信开发者工具进行语法检查和调试，只使用PowerShell原生命令进行文件操作",
    "并行工具调用策略规划阶段：列出所有需要信息(list_dir/run_terminal_cmd/grep_search)，执行阶段Promise.all并行调用避免浪费Claude4Sonnet请求次数，单个任务工具调用≤15次为目标≤20次为警告≤30次为上限",
    "控制台缓冲区参数防御范围验证：所有涉及top/height/bufferSize参数必须添加if($top-lt0-or$top-ge$maxSize){Write-Error}验证，无效命令自动拦截并推荐替换为合法命令，避免System.ArgumentOutOfRangeException异常",
    "会话问题分析六大类型：1)PowerShell命令兼容性错误(禁用&&语法)2)微信小程序启动方式错误(使用开发者工具)3)Mock数据检测不完整(多关键字组合搜索)4)search_replace匹配失败(包含完整上下文)5)工具调用效率低下(并行执行)6)规则文档更新不及时(实时更新机制)",
    "域名配置统一检查DomainConfigChecker：批量检查config/env.js/project.private.config.json等配置文件，自动检测错误域名，生成批量修复方案",
    "API调用验证器APICallValidator：验证所有API路径正确性，自动生成API路径批量修复方案",
    "Token问题智能处理器TokenIssueResolver：检测方法调用错误(app.globalData.setExchangeUpdateCallback应为app.setExchangeUpdateCallback)，检测API模块错误(userAPI.verifyToken应为authAPI.verifyToken)",
    "问题模式识别系统ProblemPatternRecognizer：自动识别CONFIGURATION_ERROR/API_CALLING_ERROR/METHOD_INVOCATION_ERROR/TIMEOUT_VIOLATION/PARALLEL_OPPORTUNITY等问题模式",
    "责任边界检查系统ResponsibilityBoundaryChecker：前端职责(UI/交互/展示/验证/路由)，后端职责(业务逻辑/权限/API/数据库/认证)，检测违规立即停止",
    "数据流向检查：禁止前端直接访问数据库，必须通过后端API，检测到违规立即停止",
    "基于37906行代码分析的预防规则：域名配置错误预防/API调用错误预防/并行调用强制执行/Token问题智能处理",
    "预期效果：域名配置错误100%预防/API调用错误95%预防/Token问题90%自动解决，效率提升60%请求节省70%时间提升80%重复减少",
    "会话开始前检查：域名配置批量检查/API调用验证/并行调用机会检测/Token状态验证",
    "问题修复强制执行：检查相关文件同类问题/生成批量修复计划/预防同类问题再发生",
    "效率监控系统EfficiencyMonitor：跟踪parallelCallsUsed/serialCallsUsed/requestsSaved/timeSaved/timeoutViolations/duplicateIssues/batchOperations指标，生成效率报告(并行效率/节省请求/节省时间/超时违规/重复问题/批处理/总体评分)，计算总体评分(并行得分-超时扣分-重复扣分+批处理加分)",
    "重复问题预防系统DuplicationPreventer：识别DOMAIN_CONFIG/API_PATH/METHOD_CALL三类问题模式，检测重复问题时建议批处理策略(replace_all_occurrences/targeted_replacement/import_and_call_fix)，生成批处理计划(类型/策略/文件/预估时间/可并行化)",
    "自动化验证引擎AutomationValidationEngine：并行执行file_creation/config_consistency/api_path_validation/method_call_validation四类验证规则，验证失败时自动执行修复行动(prevent_duplicate_creation/auto_fix_domain_errors/suggest_correct_path/fix_method_call_errors)",
    "网络问题诊断系统NetworkDiagnostics：并行执行connectivity_test/dns_resolution_test/ssl_certificate_test/api_endpoint_test/websocket_connection_test五类诊断测试，生成网络修复计划(网络连接/DNS解析/SSL证书/API端点/WebSocket连接问题及解决方案)",
    "搜索性能监控SearchPerformanceMonitor：监控搜索结果数量/耗时/效率(结果数/耗时*1000)，计算搜索效率评分(0-100分)，优化搜索策略提升性能",
    "配置文件扩展同步ConfigurationManager：并行读取config/env.js/project.private.config.json/前端技术规范/后端技术规范/接口对接规范五类配置文件，检查domain/protocol/wsProtocol配置一致性，生成配置同步计划",
    "批处理操作记录机制：记录批处理操作次数和操作数量，计算节省的请求数(操作数*0.5)和时间(操作数*1000ms)，优化批处理策略提升效率50%以上",
    "会话开始前强制检查清单：运行域名配置批量检查/执行API调用验证/检测并行调用机会/验证Token状态/PowerShell语法检查，5项检查全部通过后才能开始任务",
    "工具调用前四项确认：是否可以并行执行节省时间/是否存在重复操作需批量处理/是否需要参数验证避免错误/PowerShell语法是否正确避免违规",
    "问题修复四步强制流程：检查相关文件是否有同类问题/生成批量修复计划/预防同类问题再次发生/记录问题模式到规则库",
    "规则体系维护周期：常规检查每月一次/问题触发立即更新/效率评估每季度一次，维护原则为保持精简/持续优化/量化评估/版本管理",
    "规则体系效果预期：短期1个月内(重复问题减少80%/请求节省60%/效率提升70%/配置错误预防90%)，长期3个月内(完整规范体系/新人上手缩短50%/问题预防率95%/团队协作提升60%)",
    "API方法新增5步强制检查清单：第1步确认后端API已实现/第2步检查utils/api.js方法定义/第3步检查utils/api.js的module.exports导出/第4步检查utils/index.js的API对象导出(最容易遗漏)/第5步检查页面调用验证，完整链路为pages调用→utils/index.js统一入口→utils/api.js实现→后端API",
    "API导出链完整性验证：新增API方法必须同时完成utils/api.js的module.exports导出和utils/index.js的API对象导出，utils/index.js是统一导出入口最容易遗漏，必须grep验证导出链完整性避免API.xxx is not a function错误",
    "API方法新增系统性工作流程：阶段1完整分析(查看对接文档/grep检查utils/api.js/grep检查utils/index.js/列出修改清单)，阶段2并行修复(同时完成api.js定义+导出和index.js导出)，阶段3全链路验证(grep验证导出链/ESLint检查/编译测试)，避免被动响应多次返工",
    "环境配置统一管理EnvironmentManager：并行读取config/env.js/project.config.json/project.private.config.json三类配置文件，检查API_BASE_URL/WS_BASE_URL/APPID等必要环境变量，验证配置一致性生成修复计划",
    "自动化部署7步流程DeploymentAutomator：validate_environment/check_dependencies/run_tests/build_project/deploy_to_staging/run_smoke_tests/deploy_to_production，关键步骤失败时停止部署",
    "代码质量自动检查CodeQualityChecker：检测no_hardcoded_values(避免硬编码值)/proper_error_handling(空catch块必须添加错误处理)/console_log_cleanup(生产环境移除console.log)，并行检查所有文件生成质量报告",
    "性能监控自动化PerformanceMonitor：监控page_load_time(阈值3000ms)/api_response_time(阈值1000ms)/memory_usage(阈值50MB)/cpu_usage(阈值80%)，超过阈值时生成性能告警",
    "预防性编程5阶段检查清单：阶段1需求分析(查阅标准文档RFC/W3C/检查现有实现/理解标准规范)，阶段2编码实现(命名规范/JSDoc注释说明为什么/完整错误处理)，阶段3单元测试(基本功能/边界条件/标准符合性/回归测试)，阶段4集成测试(ESLint检查/Prettier格式化/测试覆盖率>80%/完整链路测试)，阶段5代码审查(功能/标准/测试/文档层面)",
    "高风险场景强制检查3类：编码解码场景(查阅RFC/W3C标准/明确字符集要求/编写字符集验证测试/测试边界情况)，Token认证场景(查阅RFC7519/验证Token格式3部分点分隔/检查Base64URL编码使用-和_代替+和/)，API调用场景(查阅API文档/验证请求格式snake_case/验证响应格式/测试错误情况网络超时400/500)",
    "代码质量5项指标要求：ESLint错误0个必须/单元测试覆盖率>80%必须/关键函数覆盖率>90%必须/JSDoc注释覆盖率>90%必须/代码重复率<5%建议",
    "测试质量5类要求：正常功能测试≥1个必须/边界条件测试≥3个必须(null/undefined/空字符串/极端值)/异常情况测试≥2个必须/回归测试每个bug≥1个必须/性能测试≥1个建议",
    "标准符合性注释规范：注释必须说明为什么而不仅是什么，必须标注标准依据(RFC/API文档等)，JWT使用Base64URL编码必须注释使用-和_代替+和/(RFC7519)，避免不清晰的注释如仅说明检查Base64字符",
    "预防性编程思维转变：从旧思维被动修复(编写代码→发现bug→修复bug→继续编码)转变为新思维主动预防(查阅标准→编写代码→编写测试→质量检查→提交代码)，核心原则为标准优先/测试驱动/文档同步/持续改进",
    "PowerShell语法强制检查器：run_terminal_cmd调用前必须验证禁止语法(&&/||/echo/反引号/bash命令替换/2>&1/>/dev/null)，自动转换为PowerShell语法(分号连接/if(-not$?)/Write-Host/双引号/2>$null/>$null)",
    "PowerShell语法验证函数：检测bash语法违规(&&/||/echo/反引号/2>&1)，检查违规时抛出错误显示违规类型+命令+正确语法，通过检查后记录日志",
    "PowerShell语法自动修复：自动转换&&为分号/||为if(-not$?)/echo为Write-Host/反引号为双引号/2>&1为2>$null，修复后警告显示原始命令和修复命令",
    "PowerShell环境检测与适配：检测isWindows/isPowerShell/shellVersion/supportedCommands，根据环境生成正确命令模板(multipleOutput/fileList/conditionalExecution/directoryCheck/fileCount)",
    "PowerShell命令生成模板：多行输出使用Write-Host数组循环，文件列表使用Get-ChildItem，条件执行使用if-else，目录检查使用Test-Path，文件计数使用Get-ChildItem.Count",
    "PowerShell语法违规监控：记录syntaxViolationCount和violationHistory(timestamp/command/violationType/count)，违规≥3次显示严重警告和违规历史",
    "PowerShell会话违规报告：会话结束时生成违规报告(totalViolations/mostCommonViolation/recommendations使用Write-Host代替echo/使用分号代替&&/充分利用PowerShell原生命令)",
    "PowerShell命令执行前检查清单：命令不包含&&连接符/不使用echo改用Write-Host/不包含反引号/使用PowerShell原生语法/已通过语法验证器检查",
    "PowerShell多行输出正确语法：使用Write-Host分行输出或分号连接或数组循环ForEach-Object，避免使用bash的echo和&&语法",
    "PowerShell语法违规惩罚机制：第1次违规警告并自动修复/第2次违规强制暂停手动确认/第3次违规终止当前任务要求重新规划",
    "PowerShell语法成功标准：连续20次run_terminal_cmd调用无语法违规/自动化语法检查100%通过率/用户零PowerShell语法错误反馈",
    "系统性预防体系核心理念：不是遇到问题打补丁而是建立预防问题的体系，从打补丁文化转变为建体系文化",
    "自动化测试体系最核心防线：单元测试jest覆盖率>80%必须/标准符合性测试验证RFC等标准/回归测试每个bug必须有对应测试防止复现/性能测试验证关键操作效率",
    "JWT Token测试套件完整覆盖：正常功能测试/标准符合性测试Base64URL字符-和_/边界条件测试null空字符串超长截断/回归测试标注BUG编号和日期/性能测试1000个Token<1秒",
    "测试覆盖率强制要求：关键工具函数>90%必须/业务逻辑函数>80%必须/UI组件>60%建议/整体项目>80%必须，未达标禁止提交代码",
    "Base64编码标准强制规范：JWT Token验证必须使用Base64URL模式/^[A-Za-z0-9_-]*$/接受-和_字符，禁止使用标准Base64模式/^[A-Za-z0-9+/]*={0,2}$/的+和/字符，标注RFC4648Section5标准依据",
    "开发流程5阶段检查清单强制执行：阶段1需求分析查阅RFC/W3C标准文档/阶段2编码实现JSDoc注释说明为什么/阶段3单元测试边界条件异常情况/阶段4集成测试ESLint零错误Prettier格式化/阶段5代码审查功能标准测试文档",
    "高风险场景3类强制标准查阅：编码解码场景查阅RFC/W3C明确字符集/Token认证场景查阅RFC7519验证Base64URL编码/API调用场景查阅API文档验证snake_case格式，开发前必须查阅相关标准避免认知错误",
    "ESLint自定义规则4类强制执行：no-standard-base64-in-jwt禁止JWT使用标准Base64/require-token-validation要求Token解码前先验证/no-console-in-utils工具函数避免console.log/require-base64-error-handling Base64操作必须try-catch",
    "质量检查脚本5步强制流程：步骤1环境检查Node.js和npm版本/步骤2 ESLint检查零错误强制/步骤3 Prettier检查格式一致/步骤4单元测试覆盖率>80%/步骤5集成测试功能完整，任一步骤失败禁止提交",
    "Git提交前强制检查hooks：pre-commit运行ESLint和Prettier自动修复/pre-push运行完整测试套件验证覆盖率/commit-msg验证提交信息格式，质量门槛不通过自动阻止提交",
    "Bug回归测试强制标注：每个修复的bug必须有对应测试用例/测试名称标注🐛[BUG-日期]描述/确保修复的问题不会再次出现/积累Bug知识库防止重复错误",
    "标准符合性注释强制要求：注释必须说明为什么而不仅是什么/必须标注标准依据RFC或API文档/JWT使用Base64URL编码必须注释RFC7519/避免不清晰的注释如仅说明检查Base64字符",
    "知识沉淀体系3类文档：标准文档记录RFC/W3C等技术标准/Bug回归测试文档记录历史问题和解决方案/最佳实践文档记录团队经验和规范，形成技术传承避免重复踩坑",
    "质量度量4项指标监控：测试覆盖率目标80%/ESLint错误目标0个/代码重复率目标<5%/Bug重现率目标<5%，定期评估质量趋势持续改进",
    "标准优先开发流程：遇到问题先查阅标准理解原理再标准化修复最后添加测试，禁止猜测原因尝试修复的打补丁方式",
    "测试驱动开发TDD：先写测试定义预期行为再写代码实现功能最后重构优化，禁止先写代码后补测试的传统方式",
    "持续改进PDCA循环：Plan制定质量目标和改进计划/Do执行测试和代码审查/Check评估质量指标和效果/Act优化流程和标准，建立质量持续提升机制",
    "Base64编码标准对比强制掌握：标准Base64字符集A-Za-z0-9+/填充=用于邮件XML，Base64URL字符集A-Za-z0-9-_无填充用于URL文件名JWT，关键差异+用-代替/用_代替=通常省略",
    "JWT Token处理必须Base64URL：验证使用/^[A-Za-z0-9_-]*$/模式接受-和_字符，禁止使用/^[A-Za-z0-9+/]*={0,2}$/标准Base64模式，标注RFC4648Section5和RFC7519标准依据",
    "Token解码转换标准流程：Base64URL转标准Base64使用replace(/-/g'+').replace(/_/g'/')，添加填充字符while(payload.length%4)payload+='='，然后使用标准Base64解码atob",
    "Base64编码前3项检查：明确数据用途URL/文件名/一般传输，选择正确编码标准Base64或Base64URL，查阅RFC4648和RFC7519标准文档",
    "Base64编码后3项验证：验证字符集正确-_vs+/，确认填充字符处理=的使用或省略，测试边界情况空字符串特殊字符",
    "Base64解码前3项准备：识别编码类型Base64或Base64URL，执行必要字符转换-转+和_转/，处理填充字符添加或移除=",
    "Base64常见错误1混用标准：JWT使用Base64URL却用标准Base64验证会错误拒绝有效Token，必须使用/^[A-Za-z0-9_-]*$/模式验证JWT",
    "Base64常见错误2忘记转换：直接解码Base64URL编码数据atob会因-和_字符失败，必须先转换为标准Base64再解码",
    "Base64常见错误3填充处理：Base64URL编码时不应添加=填充，必须使用replace(/=/g'')移除填充字符确保JWT格式正确",
    "Base64编码注释强制标注：必须注释使用Base64URL编码RFC7519，必须注释字符转换原因-和_代替+和/，必须注释填充处理逻辑，避免不清晰注释",
    "Token认证安全规范强制执行：所有API调用必须包含Authorization Bearer token/X-Requested-With XMLHttpRequest/Content-Type application json安全头部，敏感数据模式检测手机号身份证银行卡Token密钥",
    "HTTPS与域名安全强制验证：enforceHTTPS必须true，allowedDomains白名单omqktqrtntnn.sealosbja.site，forbiddenDomains黑名单拼写错误域名，非法域名访问立即抛出SecurityError",
    "Mock数据安全威胁检测系统：criticalPatterns检测mock/fake/test/dummy/setTimeout/hardcoded/123456/admin，生产环境检测到Mock数据立即停止开发标记CRITICAL_SECURITY_THREAT",
    "开发环境安全豁免规则：万能验证码123456仅development/testing环境允许，生产环境必须禁用抛出SecurityError，环境检测process.env.NODE_ENV严格区分",
    "API安全调用封装secureRequest：域名安全验证/添加安全头部/强制HTTPS检查/timeout 30000防止挂起/retry false防止重试攻击/响应数据安全检查敏感信息泄露",
    "用户输入安全验证sanitizeInput：防XSS清理<>&\"'/字符转义，手机号验证1[3-9]\\d{9}禁止测试号码，金额验证>0且<=99999防止异常大额交易",
    "安全状态管理secureStateManager：敏感数据检查存储前警告，状态加密存储wx.setStorageSync，数据完整性检查读取时验证，清理敏感状态access_token/refresh_token/user_info/login_info",
    "Canvas API兼容性双重检查：第一层功能检查compatibility.api，第二层类型检查typeof ctx.api==='function'，第三层运行时try-catch捕获，每层失败使用降级方案",
    "智能降级策略3级绘制：高级createRadialGradient+quadraticCurveTo视觉95%，中级createLinearGradient视觉80%，基础纯色填充视觉60%兼容100%",
    "三层错误处理完整模式：第一层功能检查!compatibility.api，第二层类型检查typeof!=='function'，第三层运行时try-catch，每层提供fallbackMethod降级方案",
    "增强错误处理提供解决建议：errorMap映射TypeError/ReferenceError/Canvas API Error/SecurityError，明确错误信息和解决建议，wx.showToast用户友好提示",
    "敏感数据保护dataProtector：手机号脱敏$1****$2，身份证脱敏$1********$2，银行卡脱敏$1****$2，敏感信息检测phone/idCard/bankCard/email模式",
    "安全监控SecurityMonitor系统：logSecurityEvent记录timestamp/type/severity/message/context，maxLogSize 1000保持日志大小，CRITICAL高危事件立即处理",
    "安全事件分类处理：MOCK_DATA_DETECTED生产环境显示警告，UNAUTHORIZED_ACCESS跳转登录页，API_TAMPERING显示异常提示并重新登录",
    "安全报告generateSecurityReport：统计totalEvents/criticalEvents/recentEvents/eventTypes/environment，按类型分组事件便于分析趋势",
    "变量遮蔽预防三大黄金法则：法则1同一变量名在整个函数及嵌套作用域只能出现一次声明ESLint no-shadow error，法则2模块引入只在顶部一次no-duplicate-imports error，法则3内层变量必须加前缀api-/local-/temp-/today-/history- id-match warn",
    "变量遮蔽ESLint强制规则：no-shadow error禁止变量遮蔽hoist all，no-duplicate-imports error禁止重复导入，id-match warn变量命名规范推荐前缀，no-var error禁止var，block-scoped-var error强制块级作用域，init-declarations error变量声明必须初始化",
    "变量遮蔽检测命令：npm run lint:shadow检测变量遮蔽法则1，npm run lint检测所有问题法则2和3，npm run lint:fix自动修复部分问题",
    "编写新代码前强制检查：扫描当前作用域所有变量名，扫描外层作用域所有变量名，确保新声明变量名与外层都不相同，发现潜在冲突立即使用更具体命名",
    "修改现有代码前强制检查：检查要修改函数及所有嵌套作用域，列出所有变量名清单，修改时确保不引入同名变量，发现已存在变量遮蔽必须重构修复",
    "代码审查模式自动执行：运行变量遮蔽检测，搜索所有let/const/var声明，检查是否有同名变量，发现问题立即重构",
    "语义化前缀区分作用域：全局/外层无前缀或outer-，函数内层inner-/local-，API响应api-/response-，处理后processed-/transformed-，临时变量temp-/tmp-",
    "禁止使用通用变量名：禁止data/result/response/item/value/temp/obj/arr在嵌套作用域，必须使用具体命名userData/lotteryResult/apiResponse/prizeItem/pointsValue/tempUserData/userObject/productArray",
    "微信小程序Page作用域规范：Page级别数据使用page前缀pageUserPoints，onLoad中使用local前缀localUserPoints，fetchUserData中使用api前缀apiUserPoints，禁止在方法内声明与Page.data同名变量",
    "异步操作作用域管理：第1层函数作用域lotteryConfig，第2层条件作用域activeLotterySettings，第3层异步回调作用域finalLotteryResult，禁止在内层重新声明外层变量名",
    "循环和迭代作用域管理：forEach参数productItem，内部处理processedProductData，格式化formattedProductDisplay，禁止在循环内声明与外层productList或参数productItem同名变量",
    "变量遮蔽错误修复方案：API响应数据遮蔽使用refreshedUserData代替userData，事件处理遮蔽使用tappedProduct代替selectedProduct，循环中遮蔽使用transformedProduct代替product参数",
    "变量遮蔽检测清单自动执行：扫描所有let/const/var声明，检查嵌套作用域变量名，对比外层作用域变量名，标记所有同名变量，生成重构建议，验证修复后无遮蔽问题",
    "变量遮蔽最佳实践5条：变量名必须唯一在整个函数及嵌套作用域，使用语义化前缀明确标识来源和用途，避免通用命名不使用data/result等，代码审查必查每次提交前检查，启用ESLint自动化检测",
    "变量遮蔽常见误区纠正：误区1不修改变量就没问题错误遮蔽本身就是问题，误区2变量名一样方便记忆错误会导致混淆和bug，误区3作用域不同就没关系错误内层会遮蔽外层",
    "Cursor执行检查点4个：声明变量前检查是否与外层同名，编写回调前列出外层所有变量，完成函数后扫描整个函数变量，提交代码前运行ESLint检测",
    "变量遮蔽规则优先级最高：强制执行零容忍，违反后果代码必须立即重构不得合并",
    "文件创建前FileCreationValidator强制检查：创建任何文件前必须使用Test-Path或Glob工具检查文件是否已存在，避免重复创建和内容覆盖，违反此规则将浪费Claude请求次数",
    "并行工具调用ParallelToolManager强制管理：检测可并行的只读工具调用(read_file/grep_search/list_dir/codebase_search)，强制并行执行节省50-80%时间，跟踪parallelCalls/serialCalls/timeSaved指标",
    "大文件编辑FileEditingStrategy策略选择：超过2500行或100KB的文件强制使用edit_file工具，小文件使用search_replace时确保匹配字符串唯一，避免编辑失败浪费请求次数",
    "搜索策略SearchStrategyOptimizer优化：语义搜索使用codebase_search工具，精确搜索使用grep_search工具，复杂查询使用混合策略并行执行，避免过度细分queries",
    "信息收集三阶段InformationCollector强制规划：任务开始前分析需求类型(documents/code_files/project_structure)、制定并行收集策略、验证信息完整性，禁止临时性逐步补充",
    "正则表达式RegexSafetyProcessor安全处理：自动转义emoji字符(🔧→\\u{1F527})和特殊字符(\\^$.*+?()[]{}|)，避免Select-String执行失败",
    "120秒超时TimeoutManager强制切换：工具调用或命令执行超过120秒必须立即切换到备用方案，最多重试2次，所有重试方案失败后需要手动干预",
    "域名配置统一检查DomainConfigChecker：批量检查config/env.js/project.private.config.json等配置文件，自动检测错误域名，生成批量修复方案",
    "API调用验证器APICallValidator：验证所有API路径正确性，自动生成API路径批量修复方案",
    "Token问题智能处理器TokenIssueResolver：检测方法调用错误(app.globalData.setExchangeUpdateCallback应为app.setExchangeUpdateCallback)，检测API模块错误(userAPI.verifyToken应为authAPI.verifyToken)",
    "问题模式识别系统ProblemPatternRecognizer：自动识别CONFIGURATION_ERROR/API_CALLING_ERROR/METHOD_INVOCATION_ERROR/TIMEOUT_VIOLATION/PARALLEL_OPPORTUNITY等问题模式",
    "责任边界检查系统ResponsibilityBoundaryChecker：前端职责(UI/交互/展示/验证/路由)，后端职责(业务逻辑/权限/API/数据库/认证)，检测违规立即停止",
    "效率监控系统EfficiencyMonitor：跟踪parallelCallsUsed/serialCallsUsed/requestsSaved/timeSaved/timeoutViolations/duplicateIssues/batchOperations指标，生成效率报告",
    "重复问题预防系统DuplicationPreventer：识别DOMAIN_CONFIG/API_PATH/METHOD_CALL三类问题模式，检测重复问题时建议批处理策略",
    "自动化验证引擎AutomationValidationEngine：并行执行file_creation/config_consistency/api_path_validation/method_call_validation四类验证规则",
    "网络问题诊断系统NetworkDiagnostics：并行执行connectivity_test/dns_resolution_test/ssl_certificate_test/api_endpoint_test/websocket_connection_test五类诊断测试",
    "搜索性能监控SearchPerformanceMonitor：监控搜索结果数量/耗时/效率，计算搜索效率评分(0-100分)，优化搜索策略提升性能",
    "配置文件扩展同步ConfigurationManager：并行读取config/env.js/project.private.config.json等配置文件，检查domain/protocol/wsProtocol配置一致性",
    "会话开始前强制检查清单：运行域名配置批量检查/执行API调用验证/检测并行调用机会/验证Token状态/PowerShell语法检查，5项检查全部通过后才能开始任务",
    "工具调用前四项确认：是否可以并行执行节省时间/是否存在重复操作需批量处理/是否需要参数验证避免错误/PowerShell语法是否正确避免违规",
    "问题修复四步强制流程：检查相关文件是否有同类问题/生成批量修复计划/预防同类问题再次发生/记录问题模式到规则库",
    "效率监控报告生成：跟踪并行效率/节省请求数/节省时间/超时违规/重复问题/批处理次数，计算总体评分(并行得分-超时扣分-重复扣分+批处理加分)，目标并行效率≥80%",
    "批处理操作优化：记录批处理操作次数和数量，计算节省的请求数(操作数*0.5)和时间(操作数*1000ms)，优化批处理策略提升效率50%以上",
    "配置文件扩展同步：并行读取config/env.js/project.private.config.json/前端技术规范/后端技术规范/接口对接规范，检查domain/protocol/wsProtocol配置一致性，发现不一致生成同步修复计划",
    "搜索性能监控优化：监控搜索结果数量/耗时/效率(结果数/耗时*1000)，计算搜索效率评分(0-100分)，优化搜索策略提升性能",
    "重复问题模式识别：识别DOMAIN_CONFIG/API_PATH/METHOD_CALL三类问题模式，检测重复问题时建议批处理策略(replace_all_occurrences/targeted_replacement/import_and_call_fix)，生成批处理计划避免重复修复",
    "自动化验证引擎执行：并行执行file_creation/config_consistency/api_path_validation/method_call_validation四类验证规则，验证失败时自动执行修复行动(prevent_duplicate_creation/auto_fix_domain_errors/suggest_correct_path/fix_method_call_errors)",
    "网络问题诊断系统：并行执行connectivity_test/dns_resolution_test/ssl_certificate_test/api_endpoint_test/websocket_connection_test五类诊断测试，生成网络修复计划(网络连接/DNS解析/SSL证书/API端点/WebSocket连接问题及解决方案)",
    "效率优化目标量化：并行调用率≥80%目标/请求节省率≥60%目标/超时预防率≥95%目标/规则遵循率100%目标，定期生成效率报告评估优化效果",
    "串行调用检测告警：检测到串行调用时立即警告建议使用并行优化，记录串行调用次数影响效率评分，推动开发者使用并行工具调用",
    "超时违规记录处理：记录120秒超时违规次数，每次违规扣除总体评分10分，强制执行超时切换机制避免命令卡死",
    "重复问题记录机制：记录重复问题类型和次数，每次重复扣除总体评分5分，推动使用批处理策略一次性解决所有相关问题",
    "规则体系系统化管理：采用模块化规则管理体系，将开发经验转化为可预防可复用的规则资产，从零散修补转变为系统化预防",
    "知识资产沉淀机制：过往210次浪费请求经验转化为可复用规则，37906行代码分析转化为预防规则，每个规则都有明确问题背景和量化指标",
    "规则引用关系清晰：1.mdc为主规则库被所有文档引用，powershell-syntax-enforcer.mdc专注语法检查，development-automation-unified.mdc处理自动化，advanced-optimization.mdc提供效率工具，tiangong-security-standards.mdc管理安全规范",
    "规则体系效率提升量化：并行调用节省60%请求时间，批处理减少80%重复问题，自动验证预防90%配置错误，总体效率提升70%",
    "规则体系可复制传承：个人调试经验转化为团队标准规范，临时解决方案转化为永久预防机制，被动修复问题转化为主动预防问题",
    "规则体系短期效果目标：1个月内重复问题减少80%/请求次数节省60%/开发效率提升70%/配置错误预防90%",
    "规则体系长期效果目标：3个月内形成完整开发规范体系/新人上手时间缩短50%/问题预防率达到95%/团队协作效率提升60%",
    "规则体系维护周期：常规检查每月一次/问题触发立即更新/效率评估每季度一次，维护原则为保持精简/持续优化/量化评估/版本管理",
    "规则优化历史记录：2025年10月04日重大优化清理重复内容从50%降至10%/建立清晰引用关系/删除重复文件/统一时间戳/简化搜索策略/完善环境区分/创建总览文档，代码精简60%/引用关系清晰度100%/文档可读性提升80%/维护难度降低70%",
    "PSConsoleReadLine模块预检：生成PowerShell命令前自动检查模块完整性Get-Module PSConsoleReadLine -ListAvailable，模块损坏时优先修复Update-Module PSConsoleReadLine -Force",
    "PowerShell中文字符UTF-8强制配置：所有涉及中文字符的终端操作必须设置[Console]::OutputEncoding和InputEncoding为UTF8",
    "PowerShell语法CMD混用严禁：严禁在PowerShell中使用CMD语法(dir /b/2>nul/&&/||/echo)，必须使用PowerShell原生语法(Get-ChildItem -Name/-ErrorAction SilentlyContinue/if($?)/Write-Host)",
    "Git分页器卡死绝对禁止：禁止使用git log/git branch -v/git diff/git show/git blame等可能触发分页器的命令，必须使用git --no-pager或限制输出",
    "文件搜索前置目录结构分析：项目文件统计前必须先查看目录结构list_dir或Get-ChildItem，根据结构选择正确命令，微信小程序文件在子目录必须使用-Recurse",
    "微信小程序开发工具唯一标准：只使用微信开发者工具进行语法检查，只使用PowerShell原生命令进行文件操作，严禁使用node/npm/webpack/babel等Web工具",
    "微信小程序项目自动识别：检测app.js/app.json/app.wxss/project.config.json/pages/components/utils等特征文件，70%以上特征匹配即判定为小程序项目，自动禁用npm start等Web命令",
    "API方法新增5步强制检查清单：第1步确认后端API已实现/第2步检查utils/api.js方法定义/第3步检查utils/api.js的module.exports导出/第4步检查utils/index.js的API对象导出(最容易遗漏)/第5步检查页面调用验证",
    "API导出链完整性验证：新增API方法必须同时完成utils/api.js的module.exports导出和utils/index.js的API对象导出，utils/index.js是统一导出入口最容易遗漏，必须grep验证导出链完整性",
    "API方法新增系统性工作流程：阶段1完整分析(查看对接文档/grep检查utils/api.js/grep检查utils/index.js/列出修改清单)，阶段2并行修复(同时完成api.js定义+导出和index.js导出)，阶段3全链路验证(grep验证导出链/ESLint检查/编译测试)",
    "环境配置统一管理：并行读取config/env.js/project.config.json/project.private.config.json三类配置文件，检查API_BASE_URL/WS_BASE_URL/APPID等必要环境变量，验证配置一致性生成修复计划",
    "自动化部署7步流程：validate_environment/check_dependencies/run_tests/build_project/deploy_to_staging/run_smoke_tests/deploy_to_production，关键步骤失败时停止部署",
    "代码质量自动检查：检测no_hardcoded_values(避免硬编码值)/proper_error_handling(空catch块必须添加错误处理)/console_log_cleanup(生产环境移除console.log)，并行检查所有文件生成质量报告",
    "性能监控自动化：监控page_load_time(阈值3000ms)/api_response_time(阈值1000ms)/memory_usage(阈值50MB)/cpu_usage(阈值80%)，超过阈值时生成性能告警",
    "预防性编程文化建立：从发现问题修复问题转变为预防问题质量保证，从被动修复转变为主动预防",
    "开发工作流程5阶段检查清单：阶段1需求分析查阅标准文档/阶段2编码实现添加JSDoc注释/阶段3单元测试覆盖率>80%/阶段4集成测试ESLint零错误/阶段5代码审查功能标准测试文档",
    "标准符合性强制检查：查阅相关标准文档RFC/W3C/API文档，理解标准规范关键要求和常见误区，检查现有实现是否符合标准",
    "编码规范三要素检查：命名规范语义化避免变量遮蔽/注释规范JSDoc说明为什么标注标准依据/错误处理完整try-catch清晰错误信息提供解决建议",
    "测试覆盖率三层检查：基本功能测试正常情况/边界条件测试null空值极端值/标准符合性测试字符集格式回归测试",
    "代码质量5项指标强制要求：ESLint错误0个必须/单元测试覆盖率>80%必须/关键函数覆盖率>90%必须/JSDoc注释覆盖率>90%必须/代码重复率<5%建议",
    "测试质量5类要求：正常功能测试≥1个必须/边界条件测试≥3个必须(null/undefined/空字符串/极端值)/异常情况测试≥2个必须/回归测试每个bug≥1个必须/性能测试≥1个建议",
    "高风险场景3类强制检查：编码解码场景查阅RFC/W3C明确字符集/Token认证场景查阅RFC7519验证Base64URL编码/API调用场景查阅API文档验证snake_case格式",
    "Bug修复5步流程：步骤1分析根因标准层面/步骤2修复代码添加注释说明/步骤3回归测试防止复现/步骤4更新文档记录教训/步骤5更新规则预防同类问题",
    "预防性编程核心原则4条：标准优先不确定时查阅标准文档/测试驱动代码完成前测试必须完成/文档同步代码变更时文档同步更新/持续改进每个bug都是改进规则的机会",
    "PowerShell语法验证函数validatePowerShellSyntax：检测bash语法违规模式(&&命令连接符/||或操作符/echo命令/反引号/bash命令替换/2>&1重定向)，检查违规时抛出错误显示违规类型+命令+正确语法，通过检查后记录日志",
    "PowerShell语法自动修复函数autoFixPowerShellSyntax：自动转换&&为分号/||为if(-not$?){}/echo为Write-Host/反引号为双引号/2>&1为2>$null，修复后警告显示原始命令和修复命令",
    "PowerShell环境检测函数detectShellEnvironment：检测isWindows(process.platform==='win32')/isPowerShell/shellVersion/supportedCommands，确保使用正确语法",
    "PowerShell命令生成模板PowerShellTemplates：multipleOutput多行输出使用Write-Host数组循环/fileList文件列表使用Get-ChildItem/conditionalExecution条件执行使用if-else/directoryCheck目录检查使用Test-Path/fileCount文件计数使用Get-ChildItem.Count",
    "PowerShell语法违规监控系统：记录syntaxViolationCount违规计数和violationHistory违规历史(timestamp/command/violationType/count)，违规≥3次显示严重警告和违规历史",
    "PowerShell会话违规报告generateViolationReport：会话结束时生成违规报告(totalViolations总违规数/mostCommonViolation最常见违规/recommendations建议使用Write-Host代替echo使用分号代替&&充分利用PowerShell原生命令)",
    "PowerShell命令执行前强制检查清单5项：命令不包含&&连接符/不使用echo改用Write-Host/不包含反引号/使用PowerShell原生语法/已通过语法验证器检查",
    "PowerShell多行输出3种正确语法：方式1分行输出Write-Host'第一行';Write-Host'第二行'/方式2分号连接Write-Host'信息1';Write-Host'信息2'/方式3数组循环@('信息1','信息2')|ForEach-Object{Write-Host$_}",
    "PowerShell语法违规惩罚机制3级：第1次违规警告并自动修复/第2次违规强制暂停手动确认/第3次违规终止当前任务要求重新规划",
    "PowerShell语法成功标准3项：连续20次run_terminal_cmd调用无语法违规/自动化语法检查100%通过率/用户零PowerShell语法错误反馈",
    "PowerShell语法强制转换对照表：bash语法echo'text'转换为PowerShell语法Write-Host'text'/cmd1&&cmd2转换为cmd1;cmd2/cmd1||cmd2转换为cmd1;if(-not$?){cmd2}/反引号command转换为双引号'command'/$((expr))转换为$(expr)/cmd2>&1转换为cmd2>$null/cmd>/dev/null转换为cmd>$null",
    "PowerShell语法检查bashPatterns模式：检测&&违规命令连接符正确语法分号/检测||违规或操作符正确语法if(-not$?){}/检测echo违规echo命令正确语法Write-Host/检测反引号违规反引号正确语法双引号/检测2>&1违规bash重定向正确语法2>$null",
    "PowerShell命令安全性自动检查4项风险因素：命令长度>80字符警告需简化/包含中文字符阈值减半/管道数量>3危险需拆分/包含Select-Object-ExpandProperty等危险组合需替代，任一风险因素存在即判定为不安全命令",
    "PowerShell环境适配命令模板5类：multipleOutput多行输出messages.map(msg=>Write-Host'$msg').join(';')/fileList文件列表Get-ChildItem'$path'/conditionalExecution条件执行if($condition){$ifTrue}else{$ifFalse}/directoryCheck目录检查Test-Path'$path'/fileCount文件计数(Get-ChildItem'$path'-Include'$pattern').Count",
    "系统性预防体系核心理念：不是遇到问题打补丁而是建立预防问题的体系，从打补丁文化转变为建体系文化，从被动修复转变为主动预防",
    "系统性预防体系5个维度：1️⃣自动化测试体系最核心防线/2️⃣编码标准体系规范化/3️⃣代码质量检查体系自动化/4️⃣持续集成检查体系强制化/5️⃣知识沉淀体系传承化",
    "自动化测试体系目标：让测试成为第一道防线而不是问题发现器，测试覆盖率utils工具函数≥85%必须/pages页面≥75%必须/全局≥70%必须",
    "JWT Token测试套件完整覆盖5类：正常功能测试解码有效Token/标准符合性测试接受Base64URL字符-和_拒绝标准Base64字符+和//边界条件测试null空字符串超长截断/回归测试标注🐛[BUG-日期]防止复现/性能测试验证1000个Token<1秒",
    "编码标准体系目标：建立清晰的技术标准避免认知错误，Base64编码标准对比标准Base64使用+和/和=填充用于邮件XML，Base64URL使用-和_代替+和/省略=填充用于JWT和URL参数",
    "开发流程5阶段检查清单强制执行：阶段1需求分析查阅RFC/W3C标准理解关键要求检查现有实现/阶段2编码实现JSDoc注释包含标准依据完整错误处理命名规范避免变量遮蔽/阶段3单元测试基本功能边界条件标准符合性/阶段4集成测试ESLint零错误Prettier格式化覆盖率≥80%/阶段5代码审查标准符合性测试完整性文档同步",
    "代码质量检查体系目标：自动化发现问题避免人工疏漏，ESLint自定义规则4类no-standard-base64-in-jwt禁止JWT使用标准Base64/require-token-validation要求Token解码前先验证/no-console-in-utils工具函数避免console.log/require-base64-error-handling Base64操作必须try-catch",
    "持续集成检查体系目标：强制执行质量门槛不合格代码无法提交，质量检查脚本6步骤环境检查Node.js和npm版本/ESLint检查零错误强制/Prettier检查格式一致/单元测试所有通过覆盖率≥80%/JWT标准检查Base64URL模式Token验证函数存在/安全审计依赖漏洞检查",
    "知识沉淀体系目标：将问题转化为知识资产防止重复踩坑，Bug回归测试每个修复的bug必须有对应测试用例标注🐛[BUG-日期]描述确保不再复现积累Bug知识库",
    "技术决策记录ADR：记录关键技术决策包含背景问题描述/决策具体技术方案/后果优缺点影响，示例JWT Token验证使用Base64URL编码符合RFC7519标准",
    "系统性预防实施路径3阶段：第一阶段基础设施创建测试框架Jest配置编写测试套件创建标准文档配置ESLint规则编写质量脚本/第二阶段团队推广团队培训代码审查规范持续改进/第三阶段持续优化补充测试用例完善ESLint规则集成CI/CD建立质量仪表板",
    "系统性预防效果评估短期1个月：测试覆盖率达到80%/新代码必须通过质量检查/减少50%低级错误",
    "系统性预防效果评估中期3个月：团队全面掌握测试编写/形成标准符合性意识/减少70%Bug复现",
    "系统性预防效果评估长期6个月：建立完整质量文化/新人上手时间缩短50%/技术债务持续降低",
    "系统性预防度量指标4项：测试覆盖率基线0%目标80%/ESLint错误基线>50目标0/代码重复率基线>20%目标<5%/Bug重现率基线>30%目标<5%",
    "标准优先开发流程正确做法：遇到问题→查阅标准→理解原理→标准化修复→添加测试，禁止错误做法遇到问题→猜测原因→尝试修复→继续猜测",
    "测试驱动开发TDD正确做法：写测试→写代码→自动测试→修复→回归测试永久生效，禁止错误做法写代码→手动测试→发现问题→修复→再次手动测试",
    "知识沉淀正确做法：修复bug→添加回归测试→更新文档→提炼规则→分享知识，禁止错误做法修复bug→提交代码→继续开发",
    "系统性思维vs打补丁思维：打补丁思维遇到问题修复问题继续开发结果问题反复出现技术债务累积，系统性思维遇到问题分析根因建立机制预防同类问题结果质量持续提升债务持续降低",
    "质量检查脚本运行命令：npm run quality完整质量检查/npm run quality:fast快速检查跳过测试/npm run precommit提交前检查自动执行/powershell -ExecutionPolicy Bypass -File ./scripts/quality-check.ps1直接运行/powershell -ExecutionPolicy Bypass -File ./scripts/quality-check.ps1 -Fix自动修复模式",
    "测试运行命令：npm test运行所有测试/npm run test:watch持续监听开发时/npm run test:coverage生成覆盖率报告/start coverage/index.html查看HTML报告",
    "代码规范检查命令：npm run lint代码规范检查/npm run lint:fix自动修复/npm run format格式化代码",
    "Base64编码标准对比强制掌握：标准Base64字符集A-Za-z0-9+/填充=用于邮件XML一般传输，Base64URL字符集A-Za-z0-9-_填充通常省略用于URL参数文件名JWT Token，关键差异+用-代替/用_代替=通常省略URL安全",
    "JWT Token处理必须Base64URL：验证使用/^[A-Za-z0-9_-]*$/模式接受-和_字符，禁止使用/^[A-Za-z0-9+/]*={0,2}$/标准Base64模式，标注RFC4648Section5和RFC7519标准依据",
    "Token解码转换标准流程3步：步骤1 Base64URL转标准Base64使用replace(/-/g'+').replace(/_/g'/')，步骤2添加填充字符while(payload.length%4)payload+='='，步骤3使用标准Base64解码atob",
    "Base64编码前3项检查：明确数据用途URL/文件名/一般传输，选择正确编码标准Base64或Base64URL，查阅RFC4648和RFC7519标准文档",
    "Base64编码后3项验证：验证字符集正确-_vs+/，确认填充字符处理=的使用或省略，测试边界情况空字符串特殊字符",
    "Base64解码前3项准备：识别编码类型Base64或Base64URL，执行必要字符转换-转+和_转/，处理填充字符添加或移除=",
    "Base64常见错误1混用标准：JWT使用Base64URL却用标准Base64验证会错误拒绝有效Token，必须使用/^[A-Za-z0-9_-]*$/模式验证JWT",
    "Base64常见错误2忘记转换：直接解码Base64URL编码数据atob会因-和_字符失败，必须先转换为标准Base64再解码",
    "Base64常见错误3填充处理：Base64URL编码时不应添加=填充，必须使用replace(/=/g'')移除填充字符确保JWT格式正确",
    "Base64编码注释强制标注：必须注释使用Base64URL编码RFC7519，必须注释字符转换原因-和_代替+和/，必须注释填充处理逻辑，避免不清晰注释",
    "JWT Token完整性验证函数validateJWTTokenIntegrity：分割token为header/payload/signature三部分，使用/^[A-Za-z0-9_-]*$/验证每部分Base64URL字符集，验证失败返回isValid:false和error信息，验证成功返回isValid:true",
    "Base64编码处理标准强制执行：天工小程序项目所有Base64编码处理必须符合此标准，所有新增代码必须符合RFC4648和RFC7519规范，编码前后解码前必须执行检查清单",
    "核心安全原则违反则立即停止开发：数据安全核心规则最高优先级，所有API调用必须认证ALL_API_CALLS_MUST_BE_AUTHENTICATED，安全头部Authorization Bearer token/X-Requested-With XMLHttpRequest/Content-Type application json必须包含",
    "敏感数据保护模式检测：手机号/\\d{11}/身份证/\\d{17}[\\dXx]/银行卡/\\d{16,19}/Token密钥/[a-zA-Z0-9]{32}/，检测到敏感数据必须脱敏处理",
    "数据传输安全规范：enforceHTTPS必须true强制HTTPS，allowedDomains白名单omqktqrtntnn.sealosbja.site，forbiddenDomains黑名单拼写错误域名，非法域名访问立即抛出SecurityError",
    "Mock数据安全威胁检测系统MockDataSecurityDetector：criticalPatterns检测mock/fake/test/dummy/setTimeout/hardcoded/123456万能验证码/admin默认密码，生产环境检测到Mock数据立即停止开发标记CRITICAL_SECURITY_THREAT",
    "开发环境安全豁免规则：万能验证码123456仅development/testing环境允许用于用户和管理员登录，生产环境必须禁用抛出SecurityError，环境检测process.env.NODE_ENV严格区分",
    "API安全调用封装secureRequest：域名安全验证transportSecurity.validateDomain，添加安全头部authSecurity.securityHeaders，强制HTTPS检查endpoint.startsWith('https://')，timeout 30000防止挂起，retry false防止重试攻击，响应数据安全检查validateResponseSecurity敏感信息泄露",
    "用户输入安全验证sanitizeInput：防XSS清理<>&\\\"'/字符转义，手机号验证1[3-9]\\d{9}禁止测试号码生产环境，金额验证>0且<=99999防止异常大额交易",
    "安全状态管理secureStateManager：敏感数据检查sensitiveDataPatterns存储前警告，状态加密存储wx.setStorageSync，数据完整性检查读取时验证undefined/null，清理敏感状态access_token/refresh_token/user_info/login_info",
    "Canvas API兼容性双重检查：第一层功能检查compatibility.api，第二层类型检查typeof ctx.api==='function'，第三层运行时try-catch捕获，每层失败使用降级方案fallbackMethod",
    "Canvas智能降级策略3级绘制：高级createRadialGradient+quadraticCurveTo视觉95%，中级createLinearGradient视觉80%，基础纯色填充视觉60%兼容100%",
    "三层错误处理完整模式：第一层功能检查!compatibility.api，第二层类型检查typeof!=='function'，第三层运行时try-catch，每层提供fallbackMethod降级方案",
    "增强错误处理提供解决建议：errorMap映射TypeError/ReferenceError/Canvas API Error/SecurityError，明确错误信息和解决建议，wx.showToast用户友好提示",
    "敏感数据保护dataProtector：手机号脱敏$1****$2，身份证脱敏$1********$2，银行卡脱敏$1****$2，敏感信息检测phone/idCard/bankCard/email模式",
    "安全监控SecurityMonitor系统：logSecurityEvent记录timestamp/type/severity/message/context，maxLogSize 1000保持日志大小，CRITICAL高危事件立即处理handleCriticalEvent",
    "安全事件分类处理：MOCK_DATA_DETECTED生产环境显示警告，UNAUTHORIZED_ACCESS跳转登录页，API_TAMPERING显示异常提示并重新登录",
    "安全报告generateSecurityReport：统计totalEvents/criticalEvents/recentEvents/eventTypes/environment，按类型分组事件groupEventsByType便于分析趋势",
    "Mock数据威胁分类classifyThreat：123456标记HARDCODED_CREDENTIALS硬编码凭证，mock标记MOCK_DATA_LEAK模拟数据泄露，admin标记DEFAULT_CREDENTIALS默认凭证，其他标记POTENTIAL_DATA_EXPOSURE潜在数据暴露",
    "安全规则引用关系：Token认证详细处理见1.mdc-TokenIssueResolver，API调用安全验证见1.mdc-APICallValidator，PowerShell安全语法见powershell-syntax-enforcer.mdc，并行调用安全优化见1.mdc-ParallelCallEnforcer，域名配置安全检查见1.mdc-DomainConfigChecker",
    "变量遮蔽预防三大黄金法则：法则1同一变量名在整个函数及嵌套作用域只能出现一次声明ESLint no-shadow error，法则2模块引入只在顶部一次不要在函数内重复require/import ESLint no-duplicate-imports error，法则3内层变量必须加前缀api-/local-/temp-/today-/history- ESLint id-match warn推荐",
    "变量遮蔽ESLint规则配置：no-shadow error禁止变量遮蔽hoist all，no-duplicate-imports error禁止重复导入，id-match warn变量命名规范推荐前缀，no-var error禁止var，block-scoped-var error强制块级作用域，init-declarations error变量声明必须初始化",
    "变量遮蔽检测命令：npm run lint:shadow检测变量遮蔽法则1，npm run lint检测所有问题包括法则2和3，npm run lint:fix自动修复部分问题，npx eslint . --rule 'no-shadow: error'扫描变量遮蔽，npx eslint . --rule 'no-shadow: error' --format table详细报告",
    "Cursor编码指令编写新代码时：扫描当前作用域所有变量名，扫描外层作用域所有变量名，确保新声明变量名与外层都不相同，发现潜在冲突立即使用更具体命名",
    "Cursor编码指令修改现有代码时：检查要修改函数及所有嵌套作用域，列出所有变量名清单，修改时确保不引入同名变量，发现已存在变量遮蔽必须重构修复",
    "Cursor编码指令代码审查模式：运行变量遮蔽检测，搜索所有let/const/var声明，检查是否有同名变量，发现问题立即重构",
    "变量命名语义化前缀规范：全局/外层无前缀或outer-，函数内层inner-/local-，API响应api-/response-，处理后processed-/transformed-，临时变量temp-/tmp-",
    "禁止使用通用变量名：禁止data/result/response/item/value/temp/obj/arr在嵌套作用域，必须使用具体命名userData/lotteryResult/apiResponse/prizeItem/pointsValue/tempUserData/userObject/productArray",
    "微信小程序Page作用域规范：Page级别数据使用page前缀pageUserPoints，onLoad中使用local前缀localUserPoints，fetchUserData中使用api前缀apiUserPoints，禁止在方法内声明与Page.data同名变量",
    "异步操作作用域管理：第1层函数作用域lotteryConfig，第2层条件作用域activeLotterySettings，第3层异步回调作用域finalLotteryResult，禁止在内层重新声明外层变量名",
    "循环和迭代作用域管理：forEach参数productItem，内部处理processedProductData，格式化formattedProductDisplay，禁止在循环内声明与外层productList或参数productItem同名变量",
    "变量遮蔽错误修复方案：API响应数据遮蔽使用refreshedUserData代替userData，事件处理遮蔽使用tappedProduct代替selectedProduct，循环中遮蔽使用transformedProduct代替product参数",
    "变量遮蔽检测清单自动执行：扫描所有let/const/var声明，检查嵌套作用域变量名，对比外层作用域变量名，标记所有同名变量，生成重构建议，验证修复后无遮蔽问题",
    "变量遮蔽最佳实践5条：变量名必须唯一在整个函数及嵌套作用域，使用语义化前缀明确标识来源和用途，避免通用命名不使用data/result等，代码审查必查每次提交前检查，启用ESLint自动化检测",
    "变量遮蔽常见误区纠正：误区1不修改变量就没问题错误遮蔽本身就是问题，误区2变量名一样方便记忆错误会导致混淆和bug，误区3作用域不同就没关系错误内层会遮蔽外层",
    "Cursor执行检查点4个：声明变量前检查是否与外层同名，编写回调前列出外层所有变量，完成函数后扫描整个函数变量，提交代码前运行ESLint检测",
    "变量遮蔽规则优先级最高：强制执行零容忍，违反后果代码必须立即重构不得合并",
    "效率监控系统EfficiencyMonitor实时跟踪：记录parallelCallsUsed并行调用数/serialCallsUsed串行调用数/requestsSaved节省请求数/timeSaved节省时间/timeoutViolations超时违规数/duplicateIssues重复问题数/batchOperations批处理次数，生成效率报告包含并行效率百分比/节省请求次数/节省时间秒数/超时违规次数/重复问题次数/批处理次数/总体评分0-100分",
    "效率监控总体评分计算公式：parallelScore并行得分=min(并行调用数*10,50)/timeoutPenalty超时扣分=超时违规数*10/duplicatePenalty重复扣分=重复问题数*5/batchBonus批处理加分=批处理次数*5，总分=max(0,min(100,并行得分-超时扣分-重复扣分+批处理加分))",
    "配置文件扩展同步ConfigurationManager：并行读取config/env.js/project.private.config.json/前端技术规范文档/后端技术规范文档/接口对接规范文档五类配置文件，检查domain域名/protocol协议/wsProtocol WebSocket协议配置一致性，发现不一致生成同步修复计划",
    "搜索性能监控SearchPerformanceMonitor：监控搜索结果数量resultsCount/耗时timeTaken/效率efficiency=(结果数/耗时)*1000，计算搜索效率评分0-100分=min(100,round((结果数/耗时)*1000))，优化搜索策略提升性能",
    "重复问题预防系统DuplicationPreventer：识别DOMAIN_CONFIG域名配置错误/API_PATH API路径错误/METHOD_CALL方法调用错误三类问题模式，检测重复问题时建议批处理策略replace_all_occurrences全部替换/targeted_replacement定向替换/import_and_call_fix导入调用修复",
    "重复问题批处理计划生成：包含type批处理类型/patternType问题模式类型/strategy批处理策略/files相关文件列表/estimatedTime预估时间=文件数*2000ms/parallelizable是否可并行true，避免重复修复同类问题",
    "自动化验证引擎AutomationValidationEngine：并行执行file_creation文件创建验证/config_consistency配置一致性验证/api_path_validation API路径验证/method_call_validation方法调用验证四类验证规则，验证失败时自动执行修复行动prevent_duplicate_creation防止重复创建/auto_fix_domain_errors自动修复域名错误/suggest_correct_path建议正确路径/fix_method_call_errors修复方法调用错误",
    "自动化验证引擎执行流程：并行执行所有验证规则Promise.all，每个验证包含check检查类型和action修复行动，检查失败时自动执行对应修复行动，生成验证结果报告包含通过/失败/自动修复状态",
    "网络问题诊断系统NetworkDiagnostics：并行执行connectivity_test网络连接测试/dns_resolution_test DNS解析测试/ssl_certificate_test SSL证书测试/api_endpoint_test API端点测试/websocket_connection_test WebSocket连接测试五类诊断测试，测试失败时生成网络修复计划",
    "网络修复计划生成：包含totalIssues问题总数/issues问题列表/recommendations修复建议/priority优先级HIGH，针对不同测试失败提供具体解决方案(网络连接失败检查网络和防火墙/DNS解析失败检查DNS设置/SSL证书问题验证证书有效性/API端点失败检查后端服务/WebSocket连接失败检查协议和端口)",
    "批处理操作效率优化：记录批处理操作次数batchOperations和操作数量operationCount，计算节省的请求数requestsSaved=操作数*0.5和时间timeSaved=操作数*1000ms，批处理策略提升效率50%以上避免重复单个操作",
    "串行调用检测告警机制：检测到串行调用serialCallsUsed++时立即警告建议使用并行优化详见1.mdc-ParallelCallEnforcer，记录串行调用次数影响效率评分，推动开发者使用并行工具调用提升效率",
    "超时违规记录处理机制：检测到120秒超时违规timeoutViolations++时记录违规次数，每次违规扣除总体评分10分，强制执行超时切换机制详见powershell-syntax-enforcer.mdc避免命令卡死",
    "重复问题记录机制：检测到重复问题duplicateIssues++时记录问题类型和次数，每次重复扣除总体评分5分，推动使用批处理策略一次性解决所有相关问题避免重复修复",
    "效率优化目标量化指标：并行调用率目标≥80%/请求节省率目标≥60%/超时预防率目标≥95%/规则遵循率目标100%，定期生成效率报告评估优化效果持续改进",
    "配置一致性检查扩展：检查所有配置文件中domain/protocol/wsProtocol三项关键配置是否一致，不一致时生成同步修复计划包含文件路径/当前值/目标值/修复操作，确保配置统一避免环境问题",
    "搜索效率评分标准：0-20分低效需优化搜索策略/21-50分一般可接受/51-80分良好搜索性能/81-100分优秀高效搜索，根据评分调整搜索策略使用语义搜索codebase_search或精确搜索grep_search",
    "问题模式识别与批处理：识别到DOMAIN_CONFIG/API_PATH/METHOD_CALL问题模式时，自动生成批处理计划包含相关文件列表和批处理策略，避免逐个文件修复浪费请求次数",
    "自动化验证四类规则：file_creation验证文件创建前检查是否已存在/config_consistency验证域名配置一致性/api_path_validation验证API端点正确性/method_call_validation验证导入函数调用方式，验证失败自动执行对应修复行动",
    "网络诊断五类测试：connectivity_test测试基本网络连接/dns_resolution_test测试域名解析/ssl_certificate_test测试SSL证书有效性/api_endpoint_test测试API端点可访问性/websocket_connection_test测试WebSocket连接，并行执行所有测试快速定位网络问题",
    "规则体系系统化管理原则：采用模块化规则管理体系将开发经验转化为可预防可复用的规则资产，从零散修补转变为系统化预防，从被动修复转变为主动预防，从个人经验转变为团队标准",
    "会话开始前5项强制检查清单：1运行域名配置批量检查DomainConfigChecker/2执行API调用验证APICallValidator/3检测并行调用机会ParallelCallEnforcer/4验证Token状态TokenIssueResolver/5PowerShell语法检查powershell-syntax-enforcer，5项检查全部通过后才能开始任务",
    "工具调用前4项强制确认清单：1是否可以并行执行节省时间/2是否存在重复操作需批量处理/3是否需要参数验证避免错误/4PowerShell语法是否正确避免违规，确认后才能执行工具调用",
    "问题修复4步强制执行流程：1检查相关文件是否有同类问题/2生成批量修复计划/3预防同类问题再次发生/4记录问题模式到规则库，确保问题不再重复出现",
    "规则体系维护周期管理：常规检查每月一次/问题触发发现新问题模式立即更新/效率评估每季度评估一次规则效果，维护原则为保持精简避免重复/持续优化基于实际问题改进/量化评估每个规则都有明确效果指标/版本管理重大更新必须记录日期和内容",
    "规则体系短期效果目标1个月内：重复问题减少80%/请求次数节省60%/开发效率提升70%/配置错误预防90%，通过系统化规则预防和问题模式识别自动化实现",
    "规则体系长期效果目标3个月内：形成完整的开发规范体系/新人上手时间缩短50%/问题预防率达到95%/团队协作效率提升60%，实现知识资产沉淀和团队标准化",
    "知识资产沉淀机制：过往210次浪费请求经验转化为可复用规则/37906行代码分析转化为预防规则/每个规则都有明确问题背景和量化指标，从个人调试经验转化为团队标准规范/从临时解决方案转化为永久预防机制",
    "规则引用关系清晰化：1.mdc为主规则库被所有文档引用/powershell-syntax-enforcer.mdc专注PowerShell语法检查/development-automation-unified.mdc处理开发自动化引用powershell-syntax-enforcer/advanced-optimization.mdc提供效率工具引用1.mdc/tiangong-security-standards.mdc管理安全规范引用1.mdc的Token和API规则",
    "规则体系核心优势量化：并行调用节省60%请求时间/批处理减少80%重复问题/自动验证预防90%配置错误/总体效率提升70%，通过系统化管理和知识资产沉淀实现可复制可传承",
    "PSConsoleReadLine模块预检强制机制：生成PowerShell命令前自动执行Get-Module PSConsoleReadLine -ListAvailable检查模块完整性，模块版本不匹配或文件缺失时执行Update-Module PSConsoleReadLine -Force修复，所有涉及中文字符的终端操作必须设置Console.OutputEncoding和InputEncoding为UTF8",
    "Git分页器卡死绝对禁止命令：禁止直接使用git log/git branch -v/git diff/git show/git blame等可能触发分页器的命令，必须使用git --no-pager前缀或限制输出如git log --oneline -5，避免进入分页器模式导致卡死超过120秒",
    "文件搜索前置目录结构分析强制要求：项目文件统计前必须先使用list_dir或Get-ChildItem查看目录结构深度理解项目文件组织方式，根据项目类型选择正确参数微信小程序用-Recurse递归搜索pages/components/utils目录，避免统计结果为0",
    "微信小程序项目自动识别系统：检测app.js/app.json/app.wxss/project.config.json/pages/components/utils等特征文件，70%以上特征匹配即判定为小程序项目confidence>=0.7，自动禁用npm start/npm run dev/webpack等Web开发命令，只使用微信开发者工具和PowerShell原生命令",
    "API方法新增5步强制检查清单：步骤1确认后端API已实现grep接口路径对接文档/步骤2检查utils/api.js方法定义grep async function methodName/步骤3检查utils/api.js的module.exports导出grep methodName/步骤4检查utils/index.js的API对象导出grep methodName最容易遗漏/步骤5检查页面调用验证grep API.methodName pages，完整链路为pages调用→utils/index.js统一入口→utils/api.js实现→后端API",
    "API导出链完整性验证强制执行：新增API方法必须同时完成utils/api.js的module.exports导出和utils/index.js的API对象导出，utils/index.js是统一导出入口最容易遗漏easyToMiss=true，必须grep验证导出链完整性避免API.xxx is not a function错误",
    "API方法新增系统性工作流程：阶段1完整分析查看对接文档/grep检查utils/api.js/grep检查utils/index.js/列出修改清单，阶段2并行修复同时完成api.js定义+导出和index.js导出，阶段3全链路验证grep验证导出链/ESLint检查/编译测试，避免被动响应多次返工节省50%以上开发时间",
    "环境变量统一管理EnvironmentManager：并行读取config/env.js/project.config.json/project.private.config.json三类配置文件，检查API_BASE_URL/WS_BASE_URL/APPID等必要环境变量，验证配置一致性生成修复计划，缺少必要环境变量时抛出错误",
    "自动化部署7步流程DeploymentAutomator：validate_environment验证环境/check_dependencies检查依赖/run_tests运行测试/build_project构建项目/deploy_to_staging部署到预发布/run_smoke_tests运行冒烟测试/deploy_to_production部署到生产，关键步骤失败时停止部署",
    "代码质量检查自动化CodeQualityChecker：检测no_hardcoded_values避免硬编码值使用配置文件/proper_error_handling空catch块必须添加错误处理/console_log_cleanup生产环境移除console.log，并行检查所有文件生成质量报告",
    "性能监控自动化PerformanceMonitor：监控page_load_time页面加载时间阈值3000ms/api_response_time API响应时间阈值1000ms/memory_usage内存使用阈值50MB/cpu_usage CPU使用阈值80%，超过阈值时生成性能告警severity=HIGH",
    "微信小程序项目文件操作标准模板：统计JS文件用Get-ChildItem pages -Recurse -Include *.js | Measure-Object，统计WXML文件用Get-ChildItem pages -Recurse -Include *.wxml | Measure-Object，搜索内容用Get-ChildItem pages -Recurse -Include *.js | Select-String pattern，确保符合微信小程序开发标准",
    "预防性编程文化核心理念：从发现问题修复问题转变为预防问题质量保证，从被动修复转变为主动预防，核心原则为标准优先不确定时查阅标准文档/测试驱动代码完成前测试必须完成/文档同步代码变更时文档同步更新/持续改进每个bug都是改进规则的机会",
    "开发工作流程5阶段强制检查清单：阶段1需求分析查阅相关标准文档RFC/W3C/API文档理解标准规范关键要求常见误区检查现有实现是否符合标准是否有可复用工具函数，阶段2编码实现命名规范语义化避免变量遮蔽统一命名风格/JSDoc注释说明为什么标注标准依据RFC等/完整错误处理try-catch清晰错误信息提供解决建议，阶段3单元测试基本功能正常情况返回值符合预期/边界条件null/undefined/空字符串/极端值超长超短/类型错误/标准符合性测试字符集格式回归测试防止复现，阶段4集成测试ESLint检查0错误/Prettier格式化统一/单元测试全部通过覆盖率>80%/完整链路测试微信开发者工具编译实际功能正常无控制台错误，阶段5代码审查功能层面解决问题无新问题无性能影响/标准层面符合RFC/W3C等标准查阅标准文档标准依据注释/测试层面单元测试覆盖率达标回归测试/文档层面更新文档添加示例记录设计决策",
    "高风险场景3类强制检查：场景1编码解码查阅RFC/W3C标准明确字符集要求编写字符集验证测试测试边界情况特殊字符长度，场景2 Token认证查阅RFC7519验证Token格式3部分点分隔检查Base64URL编码使用-和_代替+和/测试Token截断情况，场景3 API调用查阅API文档验证请求格式snake_case验证响应格式测试错误情况网络超时400/500",
    "代码质量5项指标强制要求：ESLint错误0个必须/单元测试覆盖率>80%必须/关键函数覆盖率>90%必须/JSDoc注释覆盖率>90%必须/代码重复率<5%建议",
    "测试质量5类强制要求：正常功能测试≥1个必须/边界条件测试≥3个必须包括null/undefined/空字符串/极端值超长超短/类型错误数字对象/异常情况测试≥2个必须/回归测试每个bug≥1个必须标注🐛[BUG-YYYY-MM-DD]描述防止复现/性能测试≥1个建议",
    "标准符合性注释强制规范：注释必须说明为什么而不仅是什么，必须标注标准依据RFC/API文档等，JWT使用Base64URL编码必须注释使用-和_代替+和/符合RFC7519标准这是JWT标准要求不能使用标准Base64字符集验证，避免不清晰的注释如仅说明检查Base64字符",
    "新功能开发5步流程：步骤1需求分析查阅标准文档/步骤2编码实现添加JSDoc注释/步骤3单元测试覆盖率>80%/步骤4集成测试完整链路/步骤5代码审查提交PR",
    "Bug修复5步流程：步骤1分析根因标准层面/步骤2修复代码添加注释说明/步骤3回归测试防止复现标注🐛[BUG-日期]/步骤4更新文档记录教训/步骤5更新规则预防同类问题",
    "质量检查脚本强制执行：npm run quality完整质量检查包含ESLint和测试覆盖率/npm run lint代码规范检查/npm run lint:fix自动修复/npm run test运行所有测试/npm run test:watch持续监听开发时/npm run test:coverage生成覆盖率报告/npm run format格式化代码",
    "提交前强制质量门槛：ESLint检查0错误强制/Prettier格式化统一/单元测试全部通过覆盖率≥80%/完整链路测试微信开发者工具编译无错误实际功能正常无控制台错误/代码审查通过所有检查项功能标准测试文档",
    "标准文档查阅强制要求：编码解码场景必须查阅RFC4648和RFC7519明确字符集要求/Token认证场景必须查阅RFC7519验证Token格式和Base64URL编码/API调用场景必须查阅API接口文档验证请求响应格式/WebSocket场景必须查阅RFC6455/加密算法场景必须查阅相关RFC标准",
    "回归测试强制标注规范：每个修复的bug必须有对应测试用例/测试名称标注🐛[BUG-YYYY-MM-DD]描述/确保修复的问题不会再次出现/积累Bug知识库防止重复错误",
    "代码审查检查清单强制执行：功能层面代码是否解决问题/是否引入新问题/是否有性能影响，标准层面是否符合RFC/W3C等标准/是否查阅标准文档/是否有标准依据注释，测试层面是否有单元测试/测试覆盖率是否达标>80%/是否有回归测试，文档层面是否更新相关文档/是否添加使用示例/是否记录设计决策",
    "预防性编程思维转变：旧思维被动修复编写代码发现bug修复bug继续编码结果问题反复出现技术债务累积，新思维主动预防查阅标准编写代码编写测试质量检查提交代码结果质量持续提升债务持续降低，核心是建立预防问题的体系而不是遇到问题打补丁",
    "JWT Token测试套件完整覆盖5类：正常功能测试解码有效Token/标准符合性测试接受Base64URL字符-和_拒绝标准Base64字符+和//边界条件测试null空字符串超长截断/回归测试标注🐛[BUG-日期]防止复现/性能测试验证1000个Token<1秒",
    "代码审查模板示例：好的注释JWT使用Base64URL编码使用-和_代替+和/符合RFC7519这是JWT标准要求不能使用标准Base64字符集验证，不好的注释仅说明检查Base64字符",
    "测试检查清单示例：完整的测试套件包含基本功能解码有效Token/标准符合性接受Base64URL字符拒绝标准Base64字符/边界条件拒绝null空字符串截断Token/回归测试标注BUG编号和日期",
    "日常开发命令规范：开发前检查代码质量npm run lint/编码中持续测试npm run test:watch/编码后完整质量检查npm run quality/提交前格式化代码npm run format",
    "PowerShell语法强制检查器run_terminal_cmd调用前必须验证：禁止bash语法&&命令连接符/||或操作符/echo命令/反引号/bash命令替换/2>&1重定向/>/dev/null重定向，必须使用PowerShell语法Write-Host代替echo/分号连接命令/if(-not$?)处理错误/双引号代替反引号/2>$null重定向",
    "PowerShell语法验证函数validatePowerShellSyntax：检测bash语法违规模式&&/||/echo/反引号/2>&1，检查违规时抛出错误显示违规类型命令正确语法，通过检查后记录日志",
    "PowerShell语法自动修复函数autoFixPowerShellSyntax：自动转换&&为分号/||为if(-not$?)/echo为Write-Host/反引号为双引号/2>&1为2>$null，修复后警告显示原始命令和修复命令",
    "PowerShell环境检测与适配detectShellEnvironment：检测isWindows/isPowerShell/shellVersion/supportedCommands，根据环境生成正确命令模板multipleOutput多行输出/fileList文件列表/conditionalExecution条件执行/directoryCheck目录检查/fileCount文件计数",
    "PowerShell违规监控系统：记录syntaxViolationCount违规计数和violationHistory违规历史timestamp/command/violationType/count，违规≥3次显示严重警告和违规历史",
    "PowerShell会话违规报告generateViolationReport：会话结束时生成违规报告totalViolations/mostCommonViolation/recommendations使用Write-Host代替echo使用分号代替&&充分利用PowerShell原生命令",
    "PowerShell命令执行前5项强制检查清单：命令不包含&&连接符/不使用echo改用Write-Host/不包含反引号/使用PowerShell原生语法/已通过语法验证器检查",
    "PowerShell多行输出3种正确语法：方式1分行输出Write-Host第一行;Write-Host第二行/方式2分号连接Write-Host信息1;Write-Host信息2/方式3数组循环@(信息1,信息2)|ForEach-Object{Write-Host$_}",
    "PowerShell违规惩罚机制3级：第1次违规警告并自动修复/第2次违规强制暂停手动确认/第3次违规终止当前任务要求重新规划",
    "PowerShell成功标准3项：连续20次run_terminal_cmd调用无语法违规/自动化语法检查100%通过率/用户零PowerShell语法错误反馈",
    "系统性预防体系核心理念：不是遇到问题打补丁而是建立预防问题的体系，从打补丁文化转变为建体系文化，从被动修复转变为主动预防",
    "系统性预防体系5个维度：1自动化测试体系最核心防线单元测试jest标准符合性测试回归测试，2编码标准体系规范化Base64编码标准JWT处理规范开发流程检查清单，3代码质量检查体系自动化ESLint规则自定义规则Prettier格式化，4持续集成检查体系强制化提交前检查脚本质量门槛验证覆盖率要求，5知识沉淀体系传承化标准文档Bug回归测试最佳实践文档",
    "自动化测试体系目标：让测试成为第一道防线而不是问题发现器，测试覆盖率utils工具函数≥85%必须/pages页面≥75%必须/全局≥70%必须",
    "JWT Token测试套件完整覆盖：正常功能测试解码有效Token，标准符合性测试接受Base64URL字符-和_拒绝标准Base64字符+和/，边界条件测试拒绝null/undefined/空字符串处理超长Token检测截断Token，回归测试标注🐛[BUG-日期]防止问题复现，性能测试验证1000个Token<1秒",
    "编码标准体系目标：建立清晰的技术标准避免认知错误，Base64编码标准对比标准Base64使用+和/和=填充用于邮件XML，Base64URL使用-和_代替+和/省略=填充用于JWT和URL参数",
    "代码质量检查体系目标：自动化发现问题避免人工疏漏，ESLint自定义规则4类no-standard-base64-in-jwt禁止JWT使用标准Base64/require-token-validation要求Token解码前先验证/no-console-in-utils工具函数避免console.log/require-base64-error-handling Base64操作必须try-catch",
    "持续集成检查体系目标：强制执行质量门槛不合格代码无法提交，质量检查脚本6步骤环境检查Node.js和npm版本/ESLint检查零错误强制/Prettier检查格式一致/单元测试所有通过覆盖率≥80%/JWT标准检查Base64URL模式Token验证函数存在/安全审计依赖漏洞检查",
    "知识沉淀体系目标：将问题转化为知识资产防止重复踩坑，Bug回归测试每个修复的bug必须有对应测试用例标注🐛[BUG-日期]描述确保不再复现积累Bug知识库",
    "技术决策记录ADR：记录关键技术决策包含背景问题描述/决策具体技术方案/后果优缺点影响，示例JWT Token验证使用Base64URL编码符合RFC7519标准",
    "系统性预防实施路径3阶段：第一阶段基础设施创建测试框架Jest配置编写测试套件创建标准文档配置ESLint规则编写质量脚本，第二阶段团队推广团队培训代码审查规范持续改进，第三阶段持续优化补充测试用例完善ESLint规则集成CI/CD建立质量仪表板",
    "系统性预防效果评估短期1个月：测试覆盖率达到80%/新代码必须通过质量检查/减少50%低级错误",
    "系统性预防效果评估中期3个月：团队全面掌握测试编写/形成标准符合性意识/减少70%Bug复现",
    "系统性预防效果评估长期6个月：建立完整质量文化/新人上手时间缩短50%/技术债务持续降低",
    "系统性预防度量指标4项：测试覆盖率基线0%目标80%/ESLint错误基线>50目标0/代码重复率基线>20%目标<5%/Bug重现率基线>30%目标<5%",
    "标准优先开发流程正确做法：遇到问题→查阅标准→理解原理→标准化修复→添加测试，禁止错误做法遇到问题→猜测原因→尝试修复→继续猜测",
    "测试驱动开发TDD正确做法：写测试→写代码→自动测试→修复→回归测试永久生效，禁止错误做法写代码→手动测试→发现问题→修复→再次手动测试",
    "知识沉淀正确做法：修复bug→添加回归测试→更新文档→提炼规则→分享知识，禁止错误做法修复bug→提交代码→继续开发",
    "系统性思维vs打补丁思维：打补丁思维遇到问题修复问题继续开发结果问题反复出现技术债务累积，系统性思维遇到问题分析根因建立机制预防同类问题结果质量持续提升债务持续降低",
    "质量检查脚本运行命令：npm run quality完整质量检查/npm run quality:fast快速检查跳过测试/npm run precommit提交前检查自动执行/powershell -ExecutionPolicy Bypass -File ./scripts/quality-check.ps1直接运行/powershell -ExecutionPolicy Bypass -File ./scripts/quality-check.ps1 -Fix自动修复模式",
    "测试运行命令：npm test运行所有测试/npm run test:watch持续监听开发时/npm run test:coverage生成覆盖率报告/start coverage/index.html查看HTML报告",
    "代码规范检查命令：npm run lint代码规范检查/npm run lint:fix自动修复/npm run format格式化代码",
    "Base64编码处理标准目的：确保项目中所有Base64编码处理符合标准规范，避免编码格式混淆导致的问题",
    "Base64编码标准对比强制掌握：标准Base64字符集A-Za-z0-9+/填充=用于邮件XML一般传输，Base64URL字符集A-Za-z0-9-_填充通常省略用于URL参数文件名JWT Token，关键差异+用-代替/用_代替=通常省略URL安全",
    "JWT Token处理必须Base64URL：验证使用/^[A-Za-z0-9_-]*$/模式接受-和_字符，禁止使用/^[A-Za-z0-9+/]*={0,2}$/标准Base64模式，标注RFC4648Section5和RFC7519标准依据",
    "Token解码转换标准流程3步：步骤1 Base64URL转标准Base64使用replace(/-/g'+').replace(/_/g'/')，步骤2添加填充字符while(payload.length%4)payload+='='，步骤3使用标准Base64解码atob",
    "Base64编码前3项检查：明确数据用途URL/文件名/一般传输，选择正确编码标准Base64或Base64URL，查阅RFC4648和RFC7519标准文档",
    "Base64编码后3项验证：验证字符集正确-_vs+/，确认填充字符处理=的使用或省略，测试边界情况空字符串特殊字符",
    "Base64解码前3项准备：识别编码类型Base64或Base64URL，执行必要字符转换-转+和_转/，处理填充字符添加或移除=",
    "Base64常见错误1混用标准：JWT使用Base64URL却用标准Base64验证会错误拒绝有效Token，必须使用/^[A-Za-z0-9_-]*$/模式验证JWT",
    "Base64常见错误2忘记转换：直接解码Base64URL编码数据atob会因-和_字符失败，必须先转换为标准Base64再解码",
    "Base64常见错误3填充处理：Base64URL编码时不应添加=填充，必须使用replace(/=/g'')移除填充字符确保JWT格式正确",
    "Base64编码注释强制标注：必须注释使用Base64URL编码RFC7519，必须注释字符转换原因-和_代替+和/，必须注释填充处理逻辑，避免不清晰注释",
    "JWT Token完整性验证函数validateJWTTokenIntegrity：分割token为header/payload/signature三部分，使用/^[A-Za-z0-9_-]*$/验证每部分Base64URL字符集，验证失败返回isValid:false和error信息，验证成功返回isValid:true",
    "Base64编码处理标准强制执行：天工小程序项目所有Base64编码处理必须符合此标准，所有新增代码必须符合RFC4648和RFC7519规范，编码前后解码前必须执行检查清单",
    "核心安全原则违反则立即停止开发：数据安全核心规则最高优先级，所有API调用必须认证ALL_API_CALLS_MUST_BE_AUTHENTICATED，安全头部Authorization Bearer token/X-Requested-With XMLHttpRequest/Content-Type application json必须包含",
    "敏感数据保护模式检测：手机号/\\d{11}/身份证/\\d{17}[\\dXx]/银行卡/\\d{16,19}/Token密钥/[a-zA-Z0-9]{32}/，检测到敏感数据必须脱敏处理",
    "数据传输安全规范：enforceHTTPS必须true强制HTTPS，allowedDomains白名单omqktqrtntnn.sealosbja.site，forbiddenDomains黑名单拼写错误域名，非法域名访问立即抛出SecurityError",
    "Mock数据安全威胁检测系统MockDataSecurityDetector：criticalPatterns检测mock/fake/test/dummy/setTimeout/hardcoded/123456万能验证码/admin默认密码，生产环境检测到Mock数据立即停止开发标记CRITICAL_SECURITY_THREAT",
    "开发环境安全豁免规则：万能验证码123456仅development/testing环境允许用于用户和管理员登录，生产环境必须禁用抛出SecurityError，环境检测process.env.NODE_ENV严格区分",
    "API安全调用封装secureRequest：域名安全验证transportSecurity.validateDomain，添加安全头部authSecurity.securityHeaders，强制HTTPS检查endpoint.startsWith('https://')，timeout 30000防止挂起，retry false防止重试攻击，响应数据安全检查validateResponseSecurity敏感信息泄露",
    "用户输入安全验证sanitizeInput：防XSS清理<>&\\\"'/字符转义，手机号验证1[3-9]\\d{9}禁止测试号码生产环境，金额验证>0且<=99999防止异常大额交易",
    "安全状态管理secureStateManager：敏感数据检查sensitiveDataPatterns存储前警告，状态加密存储wx.setStorageSync，数据完整性检查读取时验证undefined/null，清理敏感状态access_token/refresh_token/user_info/login_info",
    "Canvas API兼容性双重检查：第一层功能检查compatibility.api，第二层类型检查typeof ctx.api==='function'，第三层运行时try-catch捕获，每层失败使用降级方案fallbackMethod",
    "Canvas智能降级策略3级绘制：高级createRadialGradient+quadraticCurveTo视觉95%，中级createLinearGradient视觉80%，基础纯色填充视觉60%兼容100%",
    "三层错误处理完整模式：第一层功能检查!compatibility.api，第二层类型检查typeof!=='function'，第三层运行时try-catch，每层提供fallbackMethod降级方案",
    "增强错误处理提供解决建议：errorMap映射TypeError/ReferenceError/Canvas API Error/SecurityError，明确错误信息和解决建议，wx.showToast用户友好提示",
    "敏感数据保护dataProtector：手机号脱敏$1****$2，身份证脱敏$1********$2，银行卡脱敏$1****$2，敏感信息检测phone/idCard/bankCard/email模式",
    "安全监控SecurityMonitor系统：logSecurityEvent记录timestamp/type/severity/message/context，maxLogSize 1000保持日志大小，CRITICAL高危事件立即处理handleCriticalEvent",
    "安全事件分类处理：MOCK_DATA_DETECTED生产环境显示警告，UNAUTHORIZED_ACCESS跳转登录页，API_TAMPERING显示异常提示并重新登录",
    "安全报告generateSecurityReport：统计totalEvents/criticalEvents/recentEvents/eventTypes/environment，按类型分组事件groupEventsByType便于分析趋势",
    "Mock数据威胁分类classifyThreat：123456标记HARDCODED_CREDENTIALS硬编码凭证，mock标记MOCK_DATA_LEAK模拟数据泄露，admin标记DEFAULT_CREDENTIALS默认凭证，其他标记POTENTIAL_DATA_EXPOSURE潜在数据暴露",
    "安全规则引用关系：Token认证详细处理见1.mdc-TokenIssueResolver，API调用安全验证见1.mdc-APICallValidator，PowerShell安全语法见powershell-syntax-enforcer.mdc，并行调用安全优化见1.mdc-ParallelCallEnforcer，域名配置安全检查见1.mdc-DomainConfigChecker",
    "变量遮蔽预防三大黄金法则最高优先级零容忍：法则1同一变量名在整个函数及所有嵌套作用域只能出现一次声明ESLint规则no-shadow:error立即报错，法则2模块引入只在顶部一次不要在函数内重复require/import ESLint规则no-duplicate-imports:error，法则3内层变量必须加前缀api-/local-/temp-/today-/history-/processed-/transformed-/filtered-/formatted-/inner-/outer-/page-/prop-/response-/request- ESLint规则id-match:warn警告级别",
    "变量遮蔽ESLint规则配置：no-shadow error禁止变量遮蔽builtinGlobals false hoist all，no-duplicate-imports error禁止重复导入，id-match warn变量命名规范推荐但不强制，no-var error禁止var，block-scoped-var error强制块级作用域，no-label-var error禁止标签与变量同名，init-declarations error变量声明时必须初始化",
    "变量遮蔽快速检测命令：npm run lint:shadow检测变量遮蔽法则1，npm run lint检测所有问题包括法则2法则3，npm run lint:fix自动修复部分问题",
    "变量遮蔽Cursor编码指令3条：指令1编写新代码前扫描当前作用域和外层作用域所有变量名确保新变量名不相同发现冲突立即使用更具体命名，指令2修改现有代码前检查函数及嵌套作用域列出变量名清单修改时不引入同名变量发现遮蔽必须重构修复，指令3代码审查模式完成后自动执行运行遮蔽检测搜索let/const/var声明检查同名变量发现问题立即重构",
    "变量命名规范强制要求语义化前缀：全局外层无前缀或outer-如userData/outerResult，函数内层inner-/local-如innerUserData/localResult，API响应api-/response-如apiUserData/responseResult，处理后processed-/transformed-如processedData/transformedResult，临时变量temp-/tmp-如tempUserData/tmpResult",
    "变量命名具体场景规范：抽奖场景lotteryResult外层总结果/singleDrawResult内层单次结果/apiLotteryResponse API原始数据，兑换场景productList外层商品列表/selectedProduct用户选中/apiProductData API商品数据，用户信息场景globalUserInfo全局信息/localUserProfile局部资料/apiUserResponse API用户数据",
    "禁止使用通用变量名8类：data/result/response/item/value/temp/obj/arr禁止在嵌套作用域使用，必须使用具体命名userData/lotteryResult/apiResponse/prizeItem/pointsValue/tempUserData/userObject/productArray",
    "微信小程序Page作用域规范：Page级别数据使用page前缀如pageUserPoints，onLoad中使用local前缀如localUserPoints，fetchUserData中使用api前缀如apiUserPoints，禁止在内层使用与Page.data同名变量",
    "异步操作作用域管理3层：第1层函数作用域lotteryConfig，第2层条件作用域activeLotterySettings不能重复lotteryConfig，第3层异步回调作用域finalLotteryResult不能重复lotteryConfig，每层变量名必须唯一",
    "循环迭代作用域管理：外层productList商品列表，forEach参数productItem，内层processedProductData处理后数据/formattedProductDisplay格式化显示，禁止在内层重复使用productList/productItem",
    "变量遮蔽检测清单6项每次编码后执行：扫描所有let/const/var声明，检查嵌套作用域变量名，对比外层作用域变量名，标记所有同名变量，生成重构建议，验证修复后无遮蔽问题",
    "变量遮蔽错误修复3类：错误1 API响应数据遮蔽使用refreshedUserData代替userData，错误2事件处理遮蔽使用tappedProduct代替selectedProduct，错误3循环中遮蔽使用transformedProduct代替product参数",
    "变量遮蔽最佳实践5条：变量名必须唯一在整个函数及嵌套作用域，使用语义化前缀明确标识来源和用途，避免通用命名不使用data/result等，代码审查必查每次提交前检查遮蔽，启用ESLint自动化检测遮蔽问题",
    "变量遮蔽本质理解：JavaScript词法作用域导致内层变量优先级更高，遮蔽会导致外层变量在内层完全不可访问，即使不修改内层变量遮蔽本身就是反模式",
    "变量遮蔽常见误区3条：误区1不修改变量就没问题错误遮蔽本身就是问题，误区2变量名一样方便记忆错误会导致混淆和bug，误区3作用域不同就没关系错误内层会遮蔽外层",
    "变量遮蔽正确心态3条：每个变量都应该有独特且描述性名称，变量名应该清晰表达作用域和用途，宁可名称长一点也不要产生歧义",
    "Cursor执行检查点4个必须停顿验证：声明变量前检查是否与外层同名，编写回调前列出外层所有变量，完成函数后扫描整个函数变量，提交代码前运行ESLint检测",
    "变量遮蔽规则优先级最高强制执行零容忍：违反后果代码必须立即重构不得合并，ESLint检测到no-shadow错误必须修复才能提交"
  ],
  "description": "天工前端微信小程序项目规则配置 - 已整合1.mdc/advanced-optimization.mdc/cursor.mdc/development-automation-unified.mdc/development-workflow-checklist.mdc/powershell-syntax-enforcer.mdc/prevention-system-overview.mdc/quality-assurance-system.mdc/tiangong-security-standards.mdc/variable-shadowing-prevention.mdc核心规则(2025-11-25)"
}