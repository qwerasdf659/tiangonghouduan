# Base64ç¼–ç å¤„ç†æ ‡å‡† - å¤©å·¥å°ç¨‹åºé¡¹ç›®

## ğŸ¯ ç›®çš„

ç¡®ä¿é¡¹ç›®ä¸­æ‰€æœ‰Base64ç¼–ç å¤„ç†ç¬¦åˆæ ‡å‡†è§„èŒƒï¼Œé¿å…ç¼–ç æ ¼å¼æ··æ·†å¯¼è‡´çš„é—®é¢˜ã€‚

---

## ğŸ“Š Base64ç¼–ç æ ‡å‡†å¯¹æ¯”

### æ ‡å‡†Base64ï¼ˆRFC 4648ï¼‰

**å­—ç¬¦é›†**ï¼š`A-Z`, `a-z`, `0-9`, `+`, `/`  
**å¡«å……å­—ç¬¦**ï¼š`=`  
**é€‚ç”¨åœºæ™¯**ï¼šé‚®ä»¶é™„ä»¶ã€XMLã€ä¸€èˆ¬æ•°æ®ä¼ è¾“

**ç¤ºä¾‹**ï¼š
```
åŸæ–‡ï¼šHello, World!
ç¼–ç ï¼šSGVsbG8sIFdvcmxkIQ==
```

### Base64 URLç¼–ç ï¼ˆRFC 4648 Section 5ï¼‰

**å­—ç¬¦é›†**ï¼š`A-Z`, `a-z`, `0-9`, `-`, `_`  
**å¡«å……å­—ç¬¦**ï¼šé€šå¸¸çœç•¥  
**é€‚ç”¨åœºæ™¯**ï¼šURLå‚æ•°ã€æ–‡ä»¶åã€JWT Token

**ç¤ºä¾‹**ï¼š
```
åŸæ–‡ï¼šHello, World!
ç¼–ç ï¼šSGVsbG8sIFdvcmxkIQï¼ˆæ— å¡«å……ï¼‰
```

### å…³é”®å·®å¼‚

| ç‰¹æ€§ | æ ‡å‡†Base64 | Base64 URL |
|-----|-----------|-----------|
| + å­—ç¬¦ | âœ… ä½¿ç”¨ | âŒ ç”¨ - ä»£æ›¿ |
| / å­—ç¬¦ | âœ… ä½¿ç”¨ | âŒ ç”¨ _ ä»£æ›¿ |
| = å¡«å…… | âœ… å¿…é¡» | âŒ é€šå¸¸çœç•¥ |
| URLå®‰å…¨ | âŒ éœ€è¦è½¬ä¹‰ | âœ… ç›´æ¥ä½¿ç”¨ |

---

## ğŸ”´ å¼ºåˆ¶è§„èŒƒ

### 1. JWT Tokenå¤„ç†

**å¿…é¡»ä½¿ç”¨Base64 URLç¼–ç æ ‡å‡†**

```javascript
// âœ… æ­£ç¡®ï¼šBase64 URLå­—ç¬¦é›†
const base64UrlPattern = /^[A-Za-z0-9_-]*$/

// âŒ é”™è¯¯ï¼šæ ‡å‡†Base64å­—ç¬¦é›†
const base64Pattern = /^[A-Za-z0-9+/]*={0,2}$/
```

### 2. Tokenè§£ç è½¬æ¢

```javascript
// âœ… æ­£ç¡®ï¼šBase64 URL â†’ æ ‡å‡†Base64
let payload = tokenParts[1]
payload = payload.replace(/-/g, '+').replace(/_/g, '/')

// æ·»åŠ å¡«å……å­—ç¬¦
while (payload.length % 4) {
  payload += '='
}

// ç„¶åä½¿ç”¨æ ‡å‡†Base64è§£ç 
const decoded = base64Decode(payload)
```

### 3. éªŒè¯è§„åˆ™

```javascript
/**
 * JWT Tokenå®Œæ•´æ€§éªŒè¯
 * å¿…é¡»ä½¿ç”¨Base64 URLå­—ç¬¦é›†éªŒè¯
 */
function validateJWTTokenIntegrity(token) {
  const [header, payload, signature] = token.split('.')
  
  // ğŸ”´ å…³é”®ï¼šä½¿ç”¨Base64 URLæ¨¡å¼
  const base64UrlPattern = /^[A-Za-z0-9_-]*$/
  
  if (!base64UrlPattern.test(header) ||
      !base64UrlPattern.test(payload) ||
      !base64UrlPattern.test(signature)) {
    return {
      isValid: false,
      error: 'JWT TokenåŒ…å«æ— æ•ˆçš„Base64 URLå­—ç¬¦'
    }
  }
  
  return { isValid: true }
}
```

---

## âœ… æ£€æŸ¥æ¸…å•

### ç¼–ç å‰æ£€æŸ¥

- [ ] æ˜ç¡®æ•°æ®ç”¨é€”ï¼ˆURL/æ–‡ä»¶å/ä¸€èˆ¬ä¼ è¾“ï¼‰
- [ ] é€‰æ‹©æ­£ç¡®çš„ç¼–ç æ ‡å‡†ï¼ˆBase64 or Base64 URLï¼‰
- [ ] æŸ¥é˜…ç›¸å…³RFCæ ‡å‡†æ–‡æ¡£

### ç¼–ç åæ£€æŸ¥

- [ ] éªŒè¯å­—ç¬¦é›†æ˜¯å¦æ­£ç¡®ï¼ˆ- _ vs + /ï¼‰
- [ ] ç¡®è®¤å¡«å……å­—ç¬¦å¤„ç†ï¼ˆ= çš„ä½¿ç”¨ï¼‰
- [ ] æµ‹è¯•è¾¹ç•Œæƒ…å†µï¼ˆç©ºå­—ç¬¦ä¸²ã€ç‰¹æ®Šå­—ç¬¦ï¼‰

### è§£ç å‰æ£€æŸ¥

- [ ] è¯†åˆ«ç¼–ç ç±»å‹ï¼ˆBase64 or Base64 URLï¼‰
- [ ] æ‰§è¡Œå¿…è¦çš„å­—ç¬¦è½¬æ¢
- [ ] å¤„ç†å¡«å……å­—ç¬¦

---

## ğŸ› å¸¸è§é”™è¯¯æ¨¡å¼

### é”™è¯¯1ï¼šæ··ç”¨ç¼–ç æ ‡å‡†

```javascript
// âŒ é”™è¯¯ï¼šJWTä½¿ç”¨Base64 URLï¼Œå´ç”¨æ ‡å‡†Base64éªŒè¯
const base64Pattern = /^[A-Za-z0-9+/]*={0,2}$/
if (!base64Pattern.test(jwtPayload)) {
  // ä¼šé”™è¯¯æ‹’ç»æœ‰æ•ˆçš„JWT Token
}
```

**ä¿®å¤**ï¼š
```javascript
// âœ… æ­£ç¡®ï¼šä½¿ç”¨Base64 URLæ¨¡å¼
const base64UrlPattern = /^[A-Za-z0-9_-]*$/
if (!base64UrlPattern.test(jwtPayload)) {
  // æ­£ç¡®éªŒè¯
}
```

### é”™è¯¯2ï¼šå¿˜è®°å­—ç¬¦è½¬æ¢

```javascript
// âŒ é”™è¯¯ï¼šç›´æ¥è§£ç Base64 URLç¼–ç çš„æ•°æ®
const decoded = atob(base64UrlString)
// ä¼šå› ä¸º - å’Œ _ å­—ç¬¦è€Œå¤±è´¥
```

**ä¿®å¤**ï¼š
```javascript
// âœ… æ­£ç¡®ï¼šå…ˆè½¬æ¢ä¸ºæ ‡å‡†Base64
let base64String = base64UrlString
  .replace(/-/g, '+')
  .replace(/_/g, '/')

// æ·»åŠ å¡«å……
while (base64String.length % 4) {
  base64String += '='
}

const decoded = atob(base64String)
```

### é”™è¯¯3ï¼šå¡«å……å­—ç¬¦å¤„ç†ä¸å½“

```javascript
// âŒ é”™è¯¯ï¼šBase64 URLç¼–ç æ—¶æ·»åŠ äº†å¡«å……
const base64UrlEncoded = btoa(data) // åŒ…å« = å¡«å……
// JWTä¸åº”è¯¥æœ‰ = å­—ç¬¦
```

**ä¿®å¤**ï¼š
```javascript
// âœ… æ­£ç¡®ï¼šç§»é™¤å¡«å……å­—ç¬¦
const base64UrlEncoded = btoa(data)
  .replace(/\+/g, '-')
  .replace(/\//g, '_')
  .replace(/=/g, '') // ç§»é™¤å¡«å……
```

---

## ğŸ“š å‚è€ƒèµ„æ–™

- RFC 4648: The Base16, Base32, and Base64 Data Encodings
- RFC 7519: JSON Web Token (JWT)
- MDN: WindowOrWorkerGlobalScope.atob()
- MDN: WindowOrWorkerGlobalScope.btoa()

---

**åˆ›å»ºæ—¶é—´**ï¼š2025-11-08  
**é€‚ç”¨èŒƒå›´**ï¼šå¤©å·¥å°ç¨‹åºé¡¹ç›®æ‰€æœ‰Base64ç¼–ç å¤„ç†  
**å¼ºåˆ¶æ‰§è¡Œ**ï¼šæ‰€æœ‰æ–°å¢ä»£ç å¿…é¡»ç¬¦åˆæ­¤æ ‡å‡†
