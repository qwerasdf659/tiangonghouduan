# Webç®¡ç†å¹³å°å‰ç«¯åŠŸèƒ½å®Œå–„æ–¹æ¡ˆ

**ç‰ˆæœ¬**: v1.7ï¼ˆä»¥å½“å‰ä»£ç +çœŸå®DBä¸ºå‡†å®ŒæˆäºŒæ¬¡æ ¡éªŒï¼šè‡ªåŠ¨æå–é¡µé¢APIæ¸…å• + ä¿®æ­£consoleæ¨¡å—/ç»Ÿè®¡/å…‘æ¢/ææ–™ç­‰å·®å¼‚ï¼‰  
**ç”Ÿæˆæ—¶é—´**: 2026å¹´01æœˆ08æ—¥  
**é¡¹ç›®**: é¤é¥®ç§¯åˆ†æŠ½å¥–ç³»ç»Ÿ  
**ç›®æ ‡**: å®Œå–„Webç®¡ç†åå°ï¼ˆ`public/admin/`ï¼‰ï¼Œä½¿å…¶è¦†ç›–å¹¶è”åŠ¨**å½“å‰åç«¯ï¼ˆå«`/api/v4/console`ï¼‰**å¯æä¾›çš„ç®¡ç†èƒ½åŠ›ï¼Œå¹¶åŸºäº**çœŸå®æ•°æ®åº“**æ•°æ®åšåˆ°å¯æŸ¥å¯ç®¡

**æ•°æ®å¯¹é½åŸºå‡†ï¼ˆä»¥å½“å‰ä»£ç /çœŸå®DBä¸ºå‡†ï¼‰**ï¼š

- **åç«¯è·¯ç”±æŒ‚è½½**ï¼šä»¥ `app.js` çš„ `app.use('/api/v4/...')` ä¸ºå‡†ï¼ˆå½“å‰é¡¹ç›®é‡‡ç”¨æ ‡å‡†åŒ–åŸŸç»“æ„ï¼‰
- **Consoleæ¨¡å—æ¸…å•**ï¼šä»¥ `routes/v4/console/index.js` çš„ `router.use(...)` **å®é™…æŒ‚è½½**ä¸ºå‡†ï¼ˆ`modules`å¯¹è±¡ä»…ä½œè‡ªæè¿°ï¼Œå­˜åœ¨æ»å/ä¸ä¸€è‡´é£é™©ï¼‰
- **çœŸå®æ•°æ®åº“**ï¼šé€šè¿‡ Node.js + Sequelizeï¼ˆè¯»å–`.env`ï¼‰è¿æ¥åˆ° `restaurant_points_dev` å¹¶åšåªè¯»ç»Ÿè®¡ï¼ˆè§ç¬¬4ç« ï¼‰

---

## 0. å…ˆå›ç­”ï¼šæŒ‰æœ¬æ–‡æ¡£æ‰§è¡Œèƒ½å¦ä¿è¯â€œè¦†ç›–åç«¯æ•°æ®åº“èƒ½åŠ›â€ï¼Ÿ

**ç»“è®ºï¼šv1.0ç‰ˆæœ¬ä¸èƒ½ç›´æ¥ä¿è¯ï¼›v1.7éœ€è¦ä½ æŒ‰â€œæ ¡éªŒåçš„ç¼ºå£æ¸…å•â€æ‰§è¡Œï¼Œæ‰èƒ½é€æ­¥è¾¾åˆ°ç›®æ ‡ã€‚**  
åŸå› ï¼ˆå‡æ¥è‡ªå½“å‰ä»£ç çŠ¶æ€ï¼‰ï¼š

- **Consoleæ¨¡å—æ¯”v1.0å†™çš„æ›´å¤š**ï¼ˆå½“å‰`/api/v4/console`å®é™…æŒ‚è½½**19**ä¸ªå­æ¨¡å—ï¼›åŒæ—¶åœ¨consoleè‡ªæè¿°ä¸­è¿˜å£°æ˜äº†diamondæ¨¡å—ä½†æœªæŒ‚è½½ï¼‰ï¼Œv1.0åªåˆ—äº†å°‘é‡æ¨¡å—ï¼Œå¯¼è‡´â€œè¦†ç›–çŸ©é˜µ/ç¼ºå£â€ä¸å‡†ç¡®
- **ç®¡ç†åå°å·²å­˜åœ¨æ›´å¤šé¡µé¢**ï¼ˆä¾‹å¦‚ææ–™ç³»ç»Ÿ4é¡µã€å¥–å“æ± ã€ç³»ç»Ÿè®¾ç½®ã€å®¢æœå·¥ä½œå°ã€Bannerç®¡ç†ç­‰ï¼‰ï¼Œv1.0è¯¯åˆ¤ä¸ºâ€œç¼ºå¤±â€
- **éƒ¨åˆ†å·²å­˜åœ¨é¡µé¢çš„APIè·¯å¾„ä»æ˜¯æ—§è·¯å¾„/æˆ–è°ƒç”¨äº†ä¸å­˜åœ¨çš„æ¥å£**ï¼ˆä¾‹å¦‚`/api/v4/statistics/*`ã€`/api/v4/consumption/*`ã€`/api/v4/exchange_market/*`ã€`/api/v4/console/users/search`ï¼‰ï¼Œä¸ `app.js` å½“å‰è·¯ç”±æŒ‚è½½ä¸ä¸€è‡´ï¼Œç›´æ¥æ‰§è¡Œä¼šå‡ºç°â€œé¡µé¢æœ‰ä½†æ— æ³•è”åŠ¨æ•°æ®â€
- **å¦ä¸€ä¸ªå…³é”®å·®å¼‚**ï¼šç®¡ç†åå°ä¸­ `material-balances.html` / `material-transactions.html` å½“å‰è°ƒç”¨çš„ `/api/v4/console/material/users/*` ä¸ `/api/v4/console/material/transactions` **åœ¨ç°æœ‰åç«¯å¹¶æœªå®ç°**ï¼ˆ`routes/v4/console/material.js`ä»…æä¾›`asset-types`ä¸`conversion-rules`ï¼‰ï¼Œéœ€è¦åœ¨æ–¹æ¡ˆä¸­æ˜ç¡®â€œæ”¹å‰ç«¯èµ°æ—¢æœ‰é€šç”¨èµ„äº§ä¸­å¿ƒï¼ˆasset-adjustmentï¼‰â€æˆ–â€œè¡¥é½åç«¯materialç”¨æˆ·ä½™é¢/æµæ°´ç«¯ç‚¹â€äºŒé€‰ä¸€

### 0.1 æƒå¨åŸåˆ™ï¼ˆä½ å¼ºè°ƒçš„æ ¸å¿ƒè¦æ±‚ï¼šä»¥åç«¯æ•°æ®åº“/åç«¯å®ç°ä¸ºå‡†ï¼‰

- **æƒå¨æ¥æºï¼ˆä»é«˜åˆ°ä½ï¼‰**
  - **çœŸå®æ•°æ®åº“ç»“æ„ä¸æ•°æ®**ï¼ˆSequelizeæ¨¡å‹ + `information_schema`ï¼Œæœ¬æ¬¡ä»¥`restaurant_points_dev`ä¸ºå‡†ï¼‰
  - **åç«¯ç°æœ‰ä¸šåŠ¡å®ç°**ï¼ˆ`routes/` + `services/` + `TransactionManager/Idempotency`ç­‰çº¦æŸï¼‰
  - **Webç®¡ç†åå°é¡µé¢**ï¼ˆ`public/admin/`ï¼‰ï¼šåªèƒ½ä½œä¸º"å±•ç¤ºä¸æ“ä½œå…¥å£"ï¼Œä¸å¾—åå‘å®šä¹‰ä¸šåŠ¡èƒ½åŠ›
- **è½åœ°è§„åˆ™**
  - **å‰ç«¯é¡µé¢å¿…é¡»èƒ½æ˜ å°„åˆ°åç«¯/DBçš„çœŸå®å­—æ®µä¸ä¸šåŠ¡è¯­ä¹‰**ï¼›å¦‚æœé¡µé¢å­˜åœ¨ä½†è¯­ä¹‰ä¸ä¸€è‡´ï¼ˆä¾‹å¦‚æ—§å…‘æ¢å¸‚åœºå­—æ®µã€æ—§ç»Ÿè®¡è·¯å¾„ï¼‰ï¼Œä»¥**åç«¯/DBä¸ºå‡†**æ”¹é€ é¡µé¢
  - **ä¸å…¼å®¹æ—§webç«¯ç®¡ç†å¹³å°å‰ç«¯çš„å†…å®¹**ï¼šè·¯å¾„ä»¥`app.js`æŒ‚è½½ä¸ºæƒå¨ï¼Œ**ä¸ä¸º"è¿å°±å‰ç«¯æ—§è·¯å¾„"å»å‘æ˜æ–°æ¥å£**ï¼ˆ**å·²å†³ç­–ï¼šåªæ”¹å‰ç«¯ï¼Œä¸åŠ åç«¯å…¼å®¹è·¯ç”±**ï¼‰
  - **éœ€è¦æ–°å¢åç«¯æ¥å£æ—¶**ï¼šå¿…é¡»æ˜¯"æŠŠæ•°æ®åº“å·²å­˜åœ¨å­—æ®µ/å·²å­˜åœ¨ä¸šåŠ¡èƒ½åŠ›"ä»¥æ›´è§„èŒƒçš„æ–¹å¼å¯¹å¤–æä¾›ï¼Œè€Œä¸æ˜¯ä¸ºå‰ç«¯"æƒ³è¦"è€Œå‡­ç©ºé€ ä¸šåŠ¡ï¼ˆè§0.3æ•°æ®åº“éªŒè¯ï¼‰

### 0.2 å·²æ‹æ¿å†³ç­–ï¼ˆ2026-01-08ï¼‰

> ä»¥ä¸‹ä¸ºä½ æ˜ç¡®åšå‡ºçš„å†³ç­–ï¼Œåç»­å®æ–½å¿…é¡»ä¸¥æ ¼éµå®ˆï¼Œä¸å†é¢å¤–è¯¢é—®ã€‚

| å†³ç­–é¡¹                   | ä½ çš„é€‰æ‹©                         | å½±å“èŒƒå›´                                                                                                                                                                                                                             |
| ------------------------ | -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **æ—§APIè·¯å¾„å…¼å®¹**        | **A - ä¸å…¼å®¹ï¼Œåªæ”¹ç®¡ç†åå°å‰ç«¯** | æ‰€æœ‰æ—§è·¯å¾„é¡µé¢ï¼ˆ`/api/v4/statistics/*`ã€`/api/v4/notifications/*`ã€`/api/v4/consumption/*`ç­‰ï¼‰åªæ”¹å‰ç«¯å¯¹é½`app.js`å½“å‰æŒ‚è½½ï¼Œåç«¯ä¸å¢åŠ å…¼å®¹è·¯ç”±                                                                                       |
| **diamondæ¨¡å—å¤„ç†**      | **B - ç»Ÿä¸€å½’å…¥é€šç”¨èµ„äº§ä¸­å¿ƒ**     | `diamond-accounts.html`å°†æ”¹é€ ä¸ºä½¿ç”¨`/api/v4/console/asset-adjustment`ä¸èµ„äº§æµæ°´èƒ½åŠ›ï¼›é’»çŸ³ä½œä¸º`DIAMOND`èµ„äº§ç±»å‹ç»Ÿä¸€ç®¡ç†ï¼Œä¸å†å•ç‹¬åšdiamondæ¨¡å—                                                                                        |
| **ç®¡ç†åå°è®¤è¯**         | **B - ç»Ÿä¸€åˆ°console auth**       | `login.html`æ”¹ä¸ºè°ƒç”¨`/api/v4/console/auth/login`ï¼›ç®¡ç†å‘˜profileæ”¹ä¸º`/api/v4/console/auth/profile`                                                                                                                                    |
| **ç»Ÿè®¡/å›¾è¡¨å£å¾„**        | **ä»¥åç«¯ä¸ºå‡†ï¼ˆä¸¤å¥—éƒ½ä¿ç•™ï¼‰**     | åç«¯å®é™…æœ‰ï¼š(1)`/api/v4/system/statistics/*`ï¼ˆå›¾è¡¨/æŠ¥è¡¨/å¯¼å‡ºï¼‰ï¼Œ(2)`/api/v4/console/analytics/*`ï¼ˆå†³ç­–åˆ†æ/è¶‹åŠ¿/æ€§èƒ½/ä»Šæ—¥ç»Ÿè®¡ï¼‰ï¼›å‰ç«¯`charts.html`/`statistics.html`å¯¹é½system/statisticsï¼Œæ–°å¢`analytics.html`å¯¹é½console/analytics |
| **activitiesä¸Šçº¿èŒƒå›´**   | **B - å®Œæ•´é—­ç¯ï¼Œä»…ç®¡ç†å‘˜**       | âœ… å½“å‰ä»£ç å·²å…·å¤‡`/api/v4/activities`åŸŸï¼ˆavailable/check-eligibility/participate/conditions/configure-conditionsï¼‰ï¼›æŒ‰ä½ çš„å†³ç­–éœ€å°†**å…¨éƒ¨ç«¯ç‚¹æ”¶ç´§ä¸ºä»…ç®¡ç†å‘˜å¯è°ƒç”¨**ï¼ˆä¸å¯¹å¤–æ™®é€šç”¨æˆ·å¼€æ”¾ï¼‰                                             |
| **é«˜é£é™©æ“ä½œæƒé™**       | **ä»¥åç«¯ä¸ºå‡†**                   | èµ„äº§è°ƒæ•´/å¼ºåˆ¶ä¸­å¥–/å­¤å„¿å†»ç»“æ¸…ç†ç­‰é«˜é£é™©æ“ä½œï¼š**ä»…ç®¡ç†å‘˜è§’è‰²** + **å¼ºåˆ¶äºŒæ¬¡ç¡®è®¤** + **å…¨é‡å®¡è®¡æ—¥å¿—**ï¼ˆåç«¯å·²å®ç°`requireAdmin` + `IdempotencyService` + å®¡è®¡è®°å½•ï¼‰                                                                     |
| **`products`è¡¨å¤„ç†**     | **A - é—ç•™/åºŸå¼ƒï¼Œä¸åšç®¡ç†å…¥å£**  | åç«¯ä»£ç å®Œå…¨æœªä½¿ç”¨è¯¥è¡¨ï¼Œæ•°æ®åœç•™åœ¨åˆå§‹åŒ–çŠ¶æ€ï¼›å¦‚éœ€"ç§¯åˆ†ç©ºé—´å•†å“"ä¸šåŠ¡ï¼Œæ ¹æ®å®é™…éœ€æ±‚é‡æ–°è®¾è®¡ï¼ˆè§6.3.1ï¼‰                                                                                                                                |
| **å…¶ä»–æ•°æ®åº“è¡¨ç®¡ç†å…¥å£** | **å…¨éƒ¨è¦åš**                     | `trade_orders`/`system_announcements`/`feedbacks`/`stores`/`user_premium_status`/`user_hierarchy`/`admin_operation_logs`/`lottery_draws`/`exchange_records` å…¨éƒ¨è¡¥é½ç®¡ç†å…¥å£ï¼ˆè§5.1.1/6.5ï¼‰                                          |

### 0.3 æ•°æ®åº“éªŒè¯ï¼ˆç¡®è®¤"ä»¥åç«¯æ•°æ®åº“ä¸ºæƒå¨"ï¼‰

> ä»¥ä¸‹ä¸ºé€šè¿‡ Node.js + Sequelize è¿æ¥çœŸå®æ•°æ®åº“ï¼ˆ`restaurant_points_dev`ï¼‰çš„åªè¯»éªŒè¯ç»“æœï¼Œç”¨äºç¡®è®¤æœ¬æ–‡æ¡£çš„æ‰€æœ‰"æ–°å¢åç«¯æ¥å£"å»ºè®®éƒ½æ˜¯**ä¸ºæ•°æ®åº“å·²å­˜åœ¨å­—æ®µ/å·²å­˜åœ¨ä¸šåŠ¡èƒ½åŠ›æä¾›è§„èŒƒAPI**ï¼Œè€Œéä¸ºå‰ç«¯å‡­ç©ºé€ ä¸šåŠ¡ã€‚

| æ–‡æ¡£å»ºè®®                  | æ•°æ®åº“è¡¨/å­—æ®µ                                                                           | éªŒè¯ç»“æœ                                                                                                                                                                                     | ç¬¦åˆ"æ•°æ®åº“å·²å­˜åœ¨"åŸåˆ™                               |
| ------------------------- | --------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------- |
| **activitiesåŸŸè¡¥é½**      | `lottery_campaigns.participation_conditions` (JSON) + `condition_error_messages` (JSON) | âœ… å­—æ®µå·²å­˜åœ¨ï¼Œä¸”æœ‰çœŸå®æ•°æ®ï¼š`{"user_points":{"value":100,"operator":">="}}`ç­‰                                                                                                               | âœ… æ˜¯                                                |
| **æŠ½å¥–å¹²é¢„/é¢„è®¾é˜Ÿåˆ—**     | `lottery_management_settings`è¡¨                                                         | âœ… è¡¨å·²å­˜åœ¨ï¼›çœŸå®æ•°æ®ä¸­å·²å‡ºç°`setting_type=probability_adjust(667)`ã€`force_win(202)`ï¼›ä»£ç ä¾§å·²å®ç°`force_lose`ä¸`user-specific-queue`ç­‰èƒ½åŠ›ï¼ˆä»¥`/api/v4/console/lottery-management/*`ä¸ºå‡†ï¼‰ | âœ… æ˜¯                                                |
| **DIAMONDç»Ÿä¸€åˆ°èµ„äº§ä¸­å¿ƒ** | `account_asset_balances.asset_code`                                                     | âœ… `DIAMOND`ä½œä¸ºasset_codeå€¼**å·²å­˜åœ¨**ï¼ˆä¸POINTS/red_shard/MATERIAL_001å¹¶åˆ—ï¼‰                                                                                                                | âœ… æ˜¯                                                |
| **activitiesç‹¬ç«‹è¡¨**      | â€”                                                                                       | âŒ æ•°æ®åº“ä¸­**æ— **activitiesç›¸å…³è¡¨                                                                                                                                                            | âœ… ä¸éœ€è¦æ–°å»ºè¡¨ï¼ˆæ¡ä»¶å­˜å‚¨åœ¨lottery_campaignså­—æ®µä¸­ï¼‰ |

### 0.4 `products` ä¸ `exchange_items` å…³ç³»æ¾„æ¸…ï¼ˆä»¥DB/åç«¯ä¸ºæƒå¨ï¼‰

> ä½ é—®"productsï¼ˆå•†å“è¡¨ï¼‰ä¸exchange_itemsæ˜¯ä»€ä¹ˆå…³ç³»"ï¼Œä»¥ä¸‹ä¸ºçœŸå®æ•°æ®åº“éªŒè¯ç»“è®ºã€‚

| ç»´åº¦         | `products` è¡¨                                                        | `exchange_items` è¡¨                                                                               |
| ------------ | -------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------- |
| **æ•°æ®é‡**   | 52è¡Œ                                                                 | 24è¡Œ                                                                                              |
| **ä¸šåŠ¡è¯­ä¹‰** | ç§¯åˆ†/ç©ºé—´å•†å“ï¼ˆå¹¸è¿ç©ºé—´/è‡»é€‰ç©ºé—´ï¼‰                                   | B2Cææ–™èµ„äº§æ”¯ä»˜å…‘æ¢å•†å“                                                                           |
| **ä»·æ ¼å­—æ®µ** | `exchange_points`ï¼ˆç§¯åˆ†ï¼‰+ `premium_exchange_points`ï¼ˆè‡»é€‰ä¸“å±ç§¯åˆ†ï¼‰ | `cost_asset_code` + `cost_amount`ï¼ˆææ–™èµ„äº§æ”¯ä»˜ï¼‰                                                 |
| **ç©ºé—´å­—æ®µ** | `space`ï¼ˆlucky/premium/bothï¼‰                                        | æ—                                                                                                 |
| **å¤–é”®å…³è”** | æ— ï¼ˆæœªè¢«å…¶ä»–è¡¨å¼•ç”¨ï¼‰                                                 | âœ… `exchange_records.item_id â†’ exchange_items.item_id`                                            |
| **åç«¯è·¯ç”±** | âŒ **å½“å‰æ— ç®¡ç†è·¯ç”±æŒ‚è½½**                                            | âœ… `/api/v4/shop/exchange/*`ï¼ˆç”¨æˆ·ç«¯ï¼‰+ `/api/v4/console/marketplace/exchange_market/*`ï¼ˆç®¡ç†ç«¯ï¼‰ |
| **åç«¯æœåŠ¡** | æ¨¡å‹å­˜åœ¨ï¼ˆ`models/Product.js`ï¼‰ï¼Œä½†æ— ProductService                  | âœ… `ExchangeService`ï¼ˆå®Œæ•´CRUDï¼‰                                                                  |

**ç»“è®ºï¼ˆä»¥DB/åç«¯ä¸ºæƒå¨ï¼‰**ï¼š

- **`products` å’Œ `exchange_items` æ˜¯ä¸¤å¥—ç‹¬ç«‹çš„"å•†å“"ä½“ç³»**ï¼Œæ•°æ®åº“å±‚é¢æ²¡æœ‰å¤–é”®å…³è”ã€å­—æ®µè¯­ä¹‰å®Œå…¨ä¸åŒã€‚
- å½“å‰åç«¯ä¸šåŠ¡ä»£ç **åªå›´ç»• `exchange_items` æ„å»ºäº†å®Œæ•´çš„B2Cå…‘æ¢æµç¨‹**ï¼ˆExchangeService + è·¯ç”±ï¼‰ã€‚
- **`products` è¡¨æœ‰æ•°æ®ï¼ˆ52è¡Œï¼‰ï¼Œä½†å½“å‰åç«¯æœªæŒ‚è½½ç®¡ç†è·¯ç”±**â€”â€”å¦‚æœä½ éœ€è¦ç®¡ç†å®ƒï¼Œå±äº"ä¸ºæ•°æ®åº“å·²å­˜åœ¨è¡¨æä¾›è§„èŒƒAPI"ï¼ˆç¬¦åˆæƒå¨åŸåˆ™ï¼‰ï¼Œéœ€æ–°å¢åç«¯æ¥å£ã€‚

**å·²æ‹æ¿å†³ç­–ï¼ˆ2026-01-08ï¼‰**ï¼š

- âœ… **é€‰æ–¹æ¡ˆA**ï¼š`products` æ˜¯é—ç•™/åºŸå¼ƒä½“ç³»ï¼Œ**ä¸åšç®¡ç†å…¥å£**ï¼ˆç»´æŒç°çŠ¶ï¼‰
- **ç†ç”±**ï¼šåç«¯ä»£ç å®Œå…¨æœªä½¿ç”¨è¯¥è¡¨ï¼ˆæ— è·¯ç”±/æœåŠ¡è°ƒç”¨ï¼‰ï¼Œæ•°æ®åœç•™åœ¨åˆå§‹åŒ–çŠ¶æ€ï¼ˆ2025-12-12ï¼‰ï¼Œå½“å‰ä¸šåŠ¡å·²è¿ç§»åˆ°`exchange_items`ï¼ˆææ–™èµ„äº§æ”¯ä»˜ä½“ç³»ï¼‰
- **åç»­è§„åˆ’**ï¼šå¦‚éœ€"ç§¯åˆ†ç©ºé—´å•†å“"ä¸šåŠ¡ï¼Œæ ¹æ®å®é™…éœ€æ±‚é‡æ–°è®¾è®¡å¹¶è¡¥é½åç«¯+å‰ç«¯ï¼ˆå±Šæ—¶æŒ‰"ä¸ºDBå·²å­˜åœ¨èƒ½åŠ›æä¾›æ¥å£"åŸåˆ™æ‰§è¡Œï¼‰

---

**ç»“è®º**ï¼šæœ¬æ–‡æ¡£æ‰€æœ‰"è¡¥é½åç«¯èƒ½åŠ›"çš„å»ºè®®éƒ½æ˜¯ä¸º**æ•°æ®åº“å·²å­˜åœ¨çš„å­—æ®µ/è¡¨**æä¾›è§„èŒƒçš„è¯»å†™APIï¼Œæœªå‡­ç©ºå‘æ˜ä¸šåŠ¡ã€‚

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [åç«¯èƒ½åŠ›æ¸…å•](#åç«¯èƒ½åŠ›æ¸…å•)
3. [ç°æœ‰å‰ç«¯é¡µé¢æ¸…å•](#ç°æœ‰å‰ç«¯é¡µé¢æ¸…å•)
4. [æ•°æ®åº“å®é™…æ•°æ®åˆ†å¸ƒ](#æ•°æ®åº“å®é™…æ•°æ®åˆ†å¸ƒ)
5. [åŠŸèƒ½è¦†ç›–çŸ©é˜µ](#åŠŸèƒ½è¦†ç›–çŸ©é˜µ)
6. [åŠŸèƒ½ç¼ºå£åˆ†æ](#åŠŸèƒ½ç¼ºå£åˆ†æ)
7. [å®æ–½æ–¹æ¡ˆ](#å®æ–½æ–¹æ¡ˆ)
8. [é¡µé¢å¯¼èˆªæ¶æ„](#é¡µé¢å¯¼èˆªæ¶æ„)
9. [éªŒè¯æ£€æŸ¥æ¸…å•](#éªŒè¯æ£€æŸ¥æ¸…å•)

---

## 1. é¡¹ç›®æ¦‚è¿°

### 1.1 éœ€æ±‚èƒŒæ™¯

- **æ ¸å¿ƒéœ€æ±‚**: Webç®¡ç†å¹³å°å‰ç«¯åŠŸèƒ½éœ€è¦å®Œå…¨å¯¹é½**åç«¯æ•°æ®åº“+åç«¯ç°æœ‰ä¸šåŠ¡å®ç°**æä¾›çš„èƒ½åŠ›ï¼ˆåç«¯/DBæ˜¯æƒå¨ï¼‰
- **æŠ€æœ¯çº¦æŸ**:
  - é¡¹ç›®æœªå®‰è£…MySQLå®¢æˆ·ç«¯ï¼Œä½¿ç”¨Node.js + Sequelizeè¿æ¥æ•°æ®åº“
  - é…ç½®ä¿¡æ¯å­˜å‚¨åœ¨`.env`æ–‡ä»¶ä¸­
  - éœ€è¦åŸºäºçœŸå®æ•°æ®åº“æ•°æ®è€Œéå¤‡ä»½æ–‡ä»¶
- **å®æ–½åŸåˆ™**:
  - ä¸ç”Ÿæˆä»£ç ï¼Œä»…æä¾›æ–¹æ¡ˆ
  - æ‰€æœ‰æ•°æ®å’ŒåŠŸèƒ½å¿…é¡»ä¸å®é™…ä¸šåŠ¡é€»è¾‘å’Œå•†ä¸šæ¨¡å¼å¯¹é½

### 1.2 å•†ä¸šæ¨¡å¼ç†è§£

åŸºäºä»£ç å’Œæ•°æ®åº“åˆ†æï¼Œé¡¹ç›®çš„æ ¸å¿ƒå•†ä¸šæ¨¡å¼åŒ…æ‹¬ï¼š

1. **ç§¯åˆ†ç³»ç»Ÿ**: POINTSï¼ˆæ™®é€šç§¯åˆ†ï¼‰ã€BUDGET_POINTSï¼ˆé¢„ç®—ç§¯åˆ†ï¼‰ã€DIAMONDï¼ˆé’»çŸ³ï¼‰
2. **ææ–™èµ„äº§ç³»ç»Ÿ**: å¯è½¬æ¢ã€å¯å…‘æ¢çš„è™šæ‹Ÿææ–™èµ„äº§
3. **æŠ½å¥–ç³»ç»Ÿ**: åŸºäºé¢„ç®—æ± çš„æŠ½å¥–æ´»åŠ¨ï¼Œæ”¯æŒå¤šç§å¥–å“ç±»å‹
4. **B2Cå…‘æ¢å¸‚åœº**: ç”¨æˆ·ä½¿ç”¨ææ–™èµ„äº§å…‘æ¢å®ç‰©/è™šæ‹Ÿå•†å“
5. **C2Cäº¤æ˜“å¸‚åœº**: ç”¨æˆ·ä¹‹é—´äº¤æ˜“ç‰©å“å®ä¾‹
6. **æ¶ˆè´¹è®°å½•å®¡æ ¸**: ç”¨æˆ·æäº¤æ¶ˆè´¹è®°å½•ï¼Œç®¡ç†å‘˜å®¡æ ¸åå‘æ”¾å¥–åŠ±
7. **ä¼šå‘˜ç³»ç»Ÿ**: é«˜çº§ä¼šå‘˜åŠŸèƒ½å’Œæƒé™ç®¡ç†

---

## 2. åç«¯èƒ½åŠ›æ¸…å•

### 2.1 Console APIæ¨¡å—æ¦‚è§ˆ

åç«¯æä¾›äº†`/api/v4/console`æ§åˆ¶å°åŸŸï¼ˆè§`app.js`æŒ‚è½½ï¼‰ï¼Œå…¶å­æ¨¡å—**ä»¥`routes/v4/console/index.js`ä¸­`router.use(...)`å®é™…æŒ‚è½½ä¸ºå‡†**ã€‚

| Consoleæ¨¡å—        | è·¯ç”±å‰ç¼€ï¼ˆç›¸å¯¹`/api/v4/console`ï¼‰ | ä¸»è¦ç”¨é€”                                                                        | ç°æœ‰ç®¡ç†åå°é¡µé¢ï¼ˆ`public/admin/*.html`ï¼‰                                                                             | è¦†ç›–çŠ¶æ€                                                                                                                                 |
| ------------------ | --------------------------------- | ------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| system             | `/system/*`                       | ç›‘æ§/ä»ªè¡¨ç›˜                                                                     | `dashboard.html`                                                                                                      | âœ…                                                                                                                                       |
| settings           | `/settings/*` + `/cache/clear`    | è¿è¥é…ç½®/ç¼“å­˜æ¸…ç†                                                               | `settings.html`                                                                                                       | âœ…                                                                                                                                       |
| prize-pool         | `/prize-pool/*`                   | å¥–å“æ± ç®¡ç†                                                                      | `prizes.html`ï¼ˆ`users.html`ä¹Ÿä¼šè¯»å–é»˜è®¤æ´»åŠ¨å¥–å“ï¼‰                                                                     | âœ…                                                                                                                                       |
| user-management    | `/user-management/*`              | ç”¨æˆ·/è§’è‰²/çŠ¶æ€ç®¡ç†                                                              | `users.html`ã€`customer-service.html`                                                                                 | âœ…                                                                                                                                       |
| lottery-management | `/lottery-management/*`           | æŠ½å¥–å¼ºæ§/ä¸ªæ€§åŒ–é…ç½®                                                             | `users.html`ä»…è¦†ç›–`probability-adjust`                                                                                | ğŸŸ¡ï¼ˆç¼ºforce-win/force-loseç­‰ï¼‰                                                                                                           |
| customer-service   | `/customer-service/*`             | å®¢æœä¼šè¯/æ¶ˆæ¯/è½¬æ¥                                                              | `customer-service.html`                                                                                               | âœ…                                                                                                                                       |
| marketplace        | `/marketplace/*`                  | C2Cä¸Šæ¶ç»Ÿè®¡ï¼›ä»¥åŠå…‘æ¢å•†å“çš„åå°CRUDå…¥å£                                         | `marketplace-stats.html`ï¼ˆå…‘æ¢å•†å“CRUDå‰ç«¯æœªå¯¹é½ï¼Œè§ç¬¬6ç« ï¼‰                                                           | ğŸŸ¡                                                                                                                                       |
| material           | `/material/*`                     | ææ–™èµ„äº§ç±»å‹/è§„åˆ™ï¼ˆâœ…å·²å®ç°ï¼‰ï¼›ä½™é¢/æµæ°´ï¼ˆâš ï¸ materialç”¨æˆ·ç«¯ç‚¹ç°çŠ¶éœ€äºŒé€‰ä¸€å¤„ç†ï¼‰ | `material-asset-types.html`ã€`material-conversion-rules.html`ã€`material-balances.html`ã€`material-transactions.html` | ğŸŸ¡ï¼ˆ`material.js`å½“å‰ä»…å®ç°`asset-types`ä¸`conversion-rules`ï¼›ä½™é¢/æµæ°´é¡µéœ€æ”¹èµ°`asset-adjustment`æˆ–è¡¥é½åç«¯materialç”¨æˆ·ç«¯ç‚¹ï¼Œè§5.2/6.1ï¼‰ |
| popup-banners      | `/popup-banners/*`                | å¼¹çª—Banner                                                                      | `popup-banners.html`                                                                                                  | âœ…                                                                                                                                       |
| lottery-quota      | `/lottery-quota/*`                | æŠ½å¥–é…é¢è§„åˆ™/ç”¨æˆ·é…é¢                                                           | æ—                                                                                                                     | âŒ                                                                                                                                       |
| asset-adjustment   | `/asset-adjustment/*`             | é€šç”¨èµ„äº§è°ƒæ•´ï¼ˆå«æ‰¹é‡/å¹‚ç­‰ï¼‰                                                     | æ—                                                                                                                     | âŒ                                                                                                                                       |
| campaign-budget    | `/campaign-budget/*`              | æ´»åŠ¨é¢„ç®—(BUDGET_POINTS)/é¢„ç®—æ±                                                   | æ—                                                                                                                     | âŒ                                                                                                                                       |
| assets             | `/assets/*`                       | è¿è¥èµ„äº§ä¸­å¿ƒï¼ˆç‰©å“/äº‹ä»¶/ç»„åˆï¼‰                                                  | æ—                                                                                                                     | âŒ                                                                                                                                       |
| images             | `/images/*`                       | é€šç”¨å›¾ç‰‡ä¸Šä¼ /ç»‘å®š/åˆ é™¤                                                          | æ—                                                                                                                     | âŒ                                                                                                                                       |
| orphan-frozen      | `/orphan-frozen/*`                | å­¤å„¿å†»ç»“æ£€æµ‹/ç»Ÿè®¡/æ¸…ç†                                                          | æ—                                                                                                                     | âŒ                                                                                                                                       |
| merchant-points    | `/merchant-points/*`              | å•†å®¶ç§¯åˆ†å®¡æ ¸/è®°å½•                                                               | æ—                                                                                                                     | âŒ                                                                                                                                       |
| analytics          | `/analytics/*`                    | å†³ç­–/è¶‹åŠ¿/æ€§èƒ½åˆ†æ                                                              | æ—                                                                                                                     | âŒ                                                                                                                                       |
| config             | `/config/*`                       | é…ç½®/æ¨¡æ‹Ÿæµ‹è¯•                                                                   | æ—                                                                                                                     | âŒ                                                                                                                                       |
| auth               | `/auth/*`                         | æ§åˆ¶å°è®¤è¯ï¼ˆ`POST /login` + `GET /profile`ï¼‰                                    | `login.html`                                                                                                          | âœ…ï¼ˆ**å·²å†³ç­–**ï¼šç»Ÿä¸€åˆ°`/api/v4/console/auth/*`ï¼‰                                                                                         |

> âš ï¸ é‡è¦ï¼š`routes/v4/console/index.js`çš„`modules`å¯¹è±¡**å¯¹å¤–å£°æ˜äº†diamondæ¨¡å—**ï¼Œä½†å½“å‰ä»“åº“ä¸­æ²¡æœ‰å¯¹åº”è·¯ç”±æ–‡ä»¶ä¸”æœªæŒ‚è½½`/diamond`ã€‚**å·²å†³ç­–**ï¼šä¸å•ç‹¬åšdiamondæ¨¡å—ï¼Œç»Ÿä¸€å½’å…¥"é€šç”¨èµ„äº§ä¸­å¿ƒ"ï¼ˆæŠŠé’»çŸ³ä½œä¸º`DIAMOND`èµ„äº§ç±»å‹ç®¡ç†ï¼‰ï¼Œ`diamond-accounts.html`å°†æ”¹é€ ä¸ºä½¿ç”¨`asset-adjustment`/èµ„äº§æµæ°´èƒ½åŠ›ã€‚

### 2.2 è¯¦ç»†åŠŸèƒ½æ¸…å•

#### 2.2.1 èµ„äº§ç®¡ç† (`/console/assets`)

**èµ„äº§è°ƒæ•´åŠŸèƒ½** (`/console/asset-adjustment.js`):

- `POST /adjust` - å•ç”¨æˆ·èµ„äº§è°ƒæ•´ï¼ˆPOINTS/BUDGET_POINTS/DIAMOND/ææ–™ï¼‰
- `POST /batch-adjust` - æ‰¹é‡ç”¨æˆ·èµ„äº§è°ƒæ•´
- `GET /user/:user_id/balances` - æŸ¥è¯¢ç”¨æˆ·æ‰€æœ‰èµ„äº§ä½™é¢
- **ç‰¹æ€§**:
  - å¼ºåˆ¶è¦æ±‚`idempotency_key`é˜²æ­¢é‡å¤æäº¤
  - å®Œæ•´çš„å®¡è®¡æ—¥å¿—è®°å½•
  - äº‹åŠ¡ç®¡ç†ç¡®ä¿åŸå­æ€§

**èµ„äº§ç»„åˆæŸ¥è¯¢** (`/console/assets/portfolio.js`):

- `GET /portfolio` - è¿è¥èµ„äº§ä¸­å¿ƒæ€»è§ˆï¼ˆç»„åˆè§†è§’ï¼‰
- `GET /portfolio/items` - ç‰©å“å®ä¾‹åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µ/ç­›é€‰ï¼‰
- `GET /portfolio/items/:item_instance_id` - ç‰©å“å®ä¾‹è¯¦æƒ…
- `GET /item-events` - ç‰©å“äº‹ä»¶å†å²ï¼ˆæŒ‰æ¡ä»¶æŸ¥è¯¢ï¼‰

**å­¤ç«‹å†»ç»“èµ„äº§ç®¡ç†** (`/console/orphan-frozen.js`):

- `GET /detect` - æ£€æµ‹å­¤å„¿å†»ç»“ï¼ˆä»…æ£€æµ‹ï¼Œä¸æ¸…ç†ï¼‰
- `GET /stats` - è·å–å­¤å„¿å†»ç»“ç»Ÿè®¡æŠ¥å‘Š
- `POST /cleanup` - æ¸…ç†å­¤å„¿å†»ç»“ï¼ˆé»˜è®¤dry-runï¼›`dry_run=false`éœ€è¦è¶…çº§ç®¡ç†å‘˜role_level>=100ä¸”å¿…å¡«reason/operator_nameï¼‰
- **ä¸šåŠ¡åœºæ™¯**: å¤„ç†å› äº¤æ˜“å¤±è´¥ã€è®¢å•å–æ¶ˆç­‰å¯¼è‡´çš„å†»ç»“èµ„äº§æœªæ­£ç¡®é‡Šæ”¾é—®é¢˜

#### 2.2.2 ææ–™ç³»ç»Ÿç®¡ç† (`/console/material.js`)

**è½¬æ¢è§„åˆ™ç®¡ç†**:

- `GET /conversion-rules` - æŸ¥è¯¢è½¬æ¢è§„åˆ™åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€ç­›é€‰ï¼‰
- `POST /conversion-rules` - åˆ›å»ºæ–°è½¬æ¢è§„åˆ™
- `PUT /conversion-rules/:rule_id/disable` - ç¦ç”¨è½¬æ¢è§„åˆ™
- **ç‰¹æ€§**:
  - ç‰ˆæœ¬æ§åˆ¶ï¼ˆæ¯æ¬¡ä¿®æ”¹åˆ›å»ºæ–°ç‰ˆæœ¬ï¼‰
  - å¾ªç¯æ£€æµ‹ï¼ˆé˜²æ­¢Aâ†’Bâ†’Açš„è½¬æ¢é“¾ï¼‰
  - é£é™©æ§åˆ¶æ£€æŸ¥

**èµ„äº§ç±»å‹ç®¡ç†**:

- `GET /asset-types` - æŸ¥è¯¢ææ–™èµ„äº§ç±»å‹åˆ—è¡¨
- `POST /asset-types` - åˆ›å»ºæ–°ææ–™èµ„äº§ç±»å‹
- `PUT /asset-types/:asset_code/disable` - ç¦ç”¨èµ„äº§ç±»å‹

> âš ï¸ æ ¡éªŒç»“è®ºï¼ˆä»¥å½“å‰ä»£ç ä¸ºå‡†ï¼‰ï¼š`routes/v4/console/material.js` **ç›®å‰æœªå®ç°** `GET /users/:user_id/balance`ã€`POST /users/:user_id/adjust`ã€`GET /transactions` ç­‰â€œmaterialç”¨æˆ·ä½™é¢/æµæ°´â€ç«¯ç‚¹ã€‚  
> å› æ­¤ç®¡ç†åå°ä¸­ `material-balances.html` / `material-transactions.html` éœ€è¦åœ¨æ–¹æ¡ˆä¸­æ˜ç¡®äºŒé€‰ä¸€ï¼š
>
> - **æ–¹æ¡ˆAï¼ˆæ¨èï¼Œå°‘é€ è½®å­ï¼‰**ï¼šæ”¹å‰ç«¯èµ° `console/asset-adjustment`ï¼ˆä½™é¢ç”¨`GET /asset-adjustment/user/:user_id/balances`ï¼›è°ƒæ•´ç”¨`POST /asset-adjustment/adjust`ï¼›æµæ°´å¦è¡¥ä¸€ä¸ªâ€œç®¡ç†å‘˜æŒ‰ç”¨æˆ·æŸ¥è¯¢èµ„äº§æµæ°´â€ç«¯ç‚¹ï¼‰
> - **æ–¹æ¡ˆBï¼ˆè¡¥é½materialæ¨¡å—ç«¯ç‚¹ï¼‰**ï¼šåœ¨åç«¯`console/material`è¡¥é½ä½™é¢/è°ƒæ•´/æµæ°´ç«¯ç‚¹ï¼ˆæœ¬è´¨ä¸Šä»æ˜¯å¯¹`account_asset_balances`/`asset_transactions`çš„è§„èŒƒæš´éœ²ï¼‰

#### 2.2.3 æŠ½å¥–æ´»åŠ¨ç®¡ç† (`/console/campaign-budget.js`)

**é¢„ç®—é…ç½®**:

- `GET /campaigns/:campaign_id` - æŸ¥è¯¢æ´»åŠ¨é¢„ç®—é…ç½®
- `PUT /campaigns/:campaign_id` - æ›´æ–°æ´»åŠ¨é¢„ç®—é…ç½®
- `POST /campaigns/:campaign_id/validate` - éªŒè¯å¥–å“é…ç½®åˆç†æ€§
- `POST /campaigns/:campaign_id/pool/add` - è¡¥å……é¢„ç®—æ± 
- `GET /campaigns/:campaign_id/budget-status` - æŸ¥è¯¢é¢„ç®—æ± çŠ¶æ€

**ç”¨æˆ·é¢„ç®—æŸ¥è¯¢**:

- `GET /users/:user_id` - æŸ¥è¯¢ç”¨æˆ·é¢„ç®—ç§¯åˆ†ä½™é¢

#### 2.2.4 å›¾ç‰‡èµ„æºç®¡ç† (`/console/images.js`)

**ç»Ÿä¸€å›¾ç‰‡ç®¡ç†**:

- `POST /upload` - ä¸Šä¼ å›¾ç‰‡ï¼ˆæ”¯æŒå¤šä¸šåŠ¡ç±»å‹ï¼‰
- `GET /:image_id` - è·å–å›¾ç‰‡è¯¦æƒ…
- `GET /` - æŸ¥è¯¢å›¾ç‰‡åˆ—è¡¨ï¼ˆæ”¯æŒæŒ‰ä¸šåŠ¡ç±»å‹ç­›é€‰ï¼‰
- `PATCH /:image_id/bind` - ç»‘å®šå›¾ç‰‡åˆ°ä¸šåŠ¡è®°å½•
- `DELETE /:image_id` - ç‰©ç†åˆ é™¤å›¾ç‰‡
- **æ”¯æŒä¸šåŠ¡ç±»å‹**: lotteryï¼ˆæŠ½å¥–ï¼‰ã€exchangeï¼ˆå…‘æ¢ï¼‰ã€tradeï¼ˆäº¤æ˜“ï¼‰ã€uploadsï¼ˆé€šç”¨ï¼‰

#### 2.2.5 å¸‚åœºç®¡ç†

**C2Cäº¤æ˜“å¸‚åœº** (`/console/marketplace`):

- `GET /listing-stats` - ç”¨æˆ·æŒ‚å•ç»Ÿè®¡ï¼ˆæ¥è¿‘/è¾¾åˆ°ä¸Šé™çš„ç”¨æˆ·ï¼‰
- **æ•°æ®ç»´åº¦**: æ€»æŒ‚å•ç”¨æˆ·æ•°ã€æŒ‚å•æ•°é‡åˆ†å¸ƒã€ç”¨æˆ·è¯¦ç»†åˆ—è¡¨

**B2Cå…‘æ¢å¸‚åœºï¼ˆä»¥å½“å‰è·¯ç”±æŒ‚è½½ä¸ºå‡†ï¼‰**ï¼š

- **å•†å“åˆ—è¡¨/è¯¦æƒ…ï¼ˆå…¼å®¹ç®¡ç†å‘˜fullæ•°æ®ï¼‰**ï¼š`/api/v4/shop/exchange/items`ã€`/api/v4/shop/exchange/items/:item_id`
  - è¯´æ˜ï¼šè¯¥ç«¯ç‚¹ä¼šæ ¹æ®ç™»å½•ç”¨æˆ·è§’è‰²å†³å®šæ•°æ®è„±æ•ç­‰çº§ï¼ˆadminè¿”å›fullï¼‰ï¼Œå› æ­¤ç®¡ç†åå°å¯ç›´æ¥å¤ç”¨â€œshopåŸŸGETâ€ä½œä¸ºåˆ—è¡¨ä¸è¯¦æƒ…çš„æ•°æ®æº
- **åå°å•†å“å¢åˆ æ”¹ï¼ˆä»…ç®¡ç†å‘˜ï¼‰**ï¼š`/api/v4/console/marketplace/exchange_market/items`
  - `POST /items` åˆ›å»º
  - `PUT /items/:item_id` æ›´æ–°
  - `DELETE /items/:item_id` åˆ é™¤
- **è®¢å•ï¼ˆç°çŠ¶ï¼šç®¡ç†èƒ½åŠ›ä¸å®Œæ•´ï¼‰**ï¼š`/api/v4/shop/exchange/orders*`
  - `GET /orders`ã€`GET /orders/:order_no`ï¼šå½“å‰å®ç°ä¸ºâ€œåªèƒ½æŸ¥çœ‹è‡ªå·±çš„è®¢å•â€
  - `POST /orders/:order_no/status`ï¼šç®¡ç†å‘˜å¯æ›´æ–°è®¢å•çŠ¶æ€
  - âš ï¸ ç¼ºå£ï¼šç®¡ç†åå°éœ€è¦â€œç®¡ç†å‘˜æŸ¥çœ‹å…¨é‡è®¢å•åˆ—è¡¨/è¯¦æƒ…/ç­›é€‰â€ï¼Œç°æœ‰åç«¯æœªæä¾›ï¼Œéœ€è¦æ–°å¢ admin-only æŸ¥è¯¢ç«¯ç‚¹ï¼ˆå±äºå¯¹`exchange_records`æ—¢æœ‰è¡¨èƒ½åŠ›çš„è§„èŒƒæš´éœ²ï¼Œè§6.5/5.1.1ï¼‰

#### 2.2.6 ç³»ç»ŸåŠŸèƒ½

**é€šçŸ¥ç®¡ç†** (`/system/notifications.js`):

- `GET /` - é€šçŸ¥åˆ—è¡¨ï¼ˆæ”¯æŒç±»å‹ã€çŠ¶æ€ç­›é€‰ï¼‰
- `GET /:notification_id` - é€šçŸ¥è¯¦æƒ…
- `POST /:notification_id/read` - æ ‡è®°å•æ¡å·²è¯»
- `POST /read-all` - æ ‡è®°å…¨éƒ¨å·²è¯»
- `POST /clear` - æ¸…ç©ºå·²è¯»é€šçŸ¥
- `POST /send` - å‘é€æ–°é€šçŸ¥

**ç»Ÿè®¡æŠ¥è¡¨** (`/system/statistics.js`):

- `GET /charts` - å›¾è¡¨ç»Ÿè®¡æ•°æ®
- `GET /report` - ç»¼åˆæŠ¥è¡¨æ•°æ®
- `GET /export` - å¯¼å‡ºExcelæŠ¥è¡¨
- **å½“å‰å·²å®ç°çš„å‚æ•°å£å¾„ï¼ˆä»¥ä»£ç ä¸ºå‡†ï¼‰**:
  - `GET /charts?days=7|30|90`ï¼ˆé»˜è®¤30ï¼‰
  - `GET /report?period=week|month|year`ï¼ˆå½“å‰å®ç°ä¸ºfallbackï¼šç”¨`getChartsData(7/30/365)`æ›¿ä»£ï¼Œä»£ç æ³¨é‡Šå·²æ˜ç¡®â€œç¼ºå°‘getStatisticsReportæ–¹æ³•â€ï¼‰
  - `GET /export?days=7|30|90`ï¼ˆäºŒè¿›åˆ¶Excelæµä¸‹è½½ï¼Œå±è§„èŒƒå…è®¸çš„ç‰¹ä¾‹ï¼‰
- âš ï¸ ç°çŠ¶å·®å¼‚ï¼šå½“å‰æœªå®ç° today/yesterday/custom(start_date/end_date) å£å¾„ï¼›å¦‚ç®¡ç†åå°éœ€è¦è¿™äº›ç»´åº¦ï¼Œå¿…é¡»è¡¥é½ ReportingService/Statistics çš„çœŸå®æŠ¥è¡¨æ–¹æ³•ï¼ˆå±äºâ€œå¯¹æ—¢æœ‰ç»Ÿè®¡èƒ½åŠ›çš„å®Œå–„â€ï¼Œä¸æ˜¯ä¸ºè¿å°±æ—§å‰ç«¯è·¯å¾„é€ ä¸šåŠ¡ï¼‰

**æŠ½å¥–é¢„è®¾** (`/lottery/lottery-preset.js`):

- `POST /create` - ä¸ºæŒ‡å®šç”¨æˆ·åˆ›å»ºæŠ½å¥–é¢„è®¾
- `GET /list` - æŸ¥è¯¢é¢„è®¾åˆ—è¡¨ï¼ˆæ”¯æŒåˆ†é¡µã€ç­›é€‰ï¼‰
- `GET /stats` - é¢„è®¾ç»Ÿè®¡æ•°æ®

**æ¶ˆè´¹è®°å½•å®¡æ ¸** (`/shop/consumption/review.js`):

- `GET /admin/records` - æŸ¥è¯¢æ‰€æœ‰æ¶ˆè´¹è®°å½•ï¼ˆæ”¯æŒç­›é€‰ã€æœç´¢ï¼‰
- `POST /approve/:record_id` - æ‰¹å‡†æ¶ˆè´¹è®°å½•
- `POST /reject/:record_id` - æ‹’ç»æ¶ˆè´¹è®°å½•

---

## 3. ç°æœ‰å‰ç«¯é¡µé¢æ¸…å•

### 3.1 å·²å®ç°é¡µé¢

| é¡µé¢æ–‡ä»¶                         | é¡µé¢æ ‡é¢˜         | ä¸»è¦åŠŸèƒ½                       | å½“å‰è°ƒç”¨çš„APIå‰ç¼€ï¼ˆä»é¡µé¢æºç æå–ï¼‰                                                                         | ä¸å½“å‰åç«¯æŒ‚è½½æ˜¯å¦ä¸€è‡´ï¼ˆä»¥`app.js`ä¸ºå‡†ï¼‰                                                                                                                                   |
| -------------------------------- | ---------------- | ------------------------------ | ----------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `login.html`                     | ç™»å½•             | ç®¡ç†å‘˜ç™»å½•                     | `/api/v4/auth/login`                                                                                        | ğŸŸ¡ï¼ˆåç«¯æŒ‚è½½âœ…å¯ç”¨ï¼Œä½†**å·²å†³ç­–**ç»Ÿä¸€åˆ°`/api/v4/console/auth/login`ï¼‰                                                                                                       |
| `dashboard.html`                 | æ•°æ®ä»ªè¡¨ç›˜       | ç®¡ç†åå°æ¦‚è§ˆã€å¿«æ·å…¥å£         | `/api/v4/console/system/dashboard`                                                                          | âœ…                                                                                                                                                                         |
| `users.html`                     | ç”¨æˆ·ç®¡ç†         | ç”¨æˆ·/è§’è‰²/çŠ¶æ€ï¼›ä¸ªæ€§åŒ–æ¦‚ç‡è°ƒæ•´ | `/api/v4/console/user-management/*`ã€`/api/v4/console/lottery-management/*`ã€`/api/v4/console/prize-pool/*` | âœ…ï¼ˆä½†`lottery-management`ä»…è¦†ç›–éƒ¨åˆ†ç«¯ç‚¹ï¼‰                                                                                                                                 |
| `prizes.html`                    | å¥–å“æ± é…ç½®       | å¥–å“å¢åˆ æ”¹/åº“å­˜                | `/api/v4/console/prize-pool/*`                                                                              | âœ…                                                                                                                                                                         |
| `settings.html`                  | ç³»ç»Ÿè®¾ç½®         | è¿è¥é…ç½®ã€ç¼“å­˜æ¸…ç†             | `/api/v4/console/settings/*`ã€`/api/v4/console/cache/clear`                                                 | âœ…                                                                                                                                                                         |
| `popup-banners.html`             | å¼¹çª—Bannerç®¡ç†   | Banner CRUD/ç»Ÿè®¡               | `/api/v4/console/popup-banners/*`                                                                           | âœ…                                                                                                                                                                         |
| `customer-service.html`          | å®¢æœå·¥ä½œå°       | ä¼šè¯åˆ—è¡¨/æ¶ˆæ¯/è½¬æ¥/å…³é—­        | `/api/v4/console/customer-service/*`ã€`/api/v4/console/user-management/*`                                   | âœ…                                                                                                                                                                         |
| `marketplace-stats.html`         | å¸‚åœºç»Ÿè®¡         | C2Cä¸Šæ¶ç»Ÿè®¡                    | `/api/v4/console/marketplace/listing-stats`                                                                 | âœ…                                                                                                                                                                         |
| `material-asset-types.html`      | ææ–™èµ„äº§ç±»å‹ç®¡ç† | ç±»å‹CRUD                       | `/api/v4/console/material/asset-types`                                                                      | âœ…                                                                                                                                                                         |
| `material-conversion-rules.html` | ææ–™è½¬æ¢è§„åˆ™ç®¡ç† | è§„åˆ™CRUD                       | `/api/v4/console/material/conversion-rules`                                                                 | âœ…                                                                                                                                                                         |
| `material-transactions.html`     | ææ–™æµæ°´         | ææ–™æµæ°´æŸ¥è¯¢                   | `/api/v4/console/material/transactions`                                                                     | ğŸ”´ï¼ˆåç«¯`console/material`å½“å‰æœªå®ç°`/transactions`ï¼›éœ€æ”¹èµ°`asset-adjustment`/æ–°å¢ç®¡ç†å‘˜æŒ‰ç”¨æˆ·æŸ¥è¯¢èµ„äº§æµæ°´ç«¯ç‚¹ï¼Œè§2.2.2/5.2ï¼‰                                              |
| `material-balances.html`         | ææ–™ä½™é¢         | ç”¨æˆ·ææ–™ä½™é¢æŸ¥è¯¢/è°ƒæ•´          | `/api/v4/console/material/users/*` + `/api/v4/console/users/search`                                         | ğŸ”´ï¼ˆåç«¯åŒæ—¶ç¼º`/console/material/users/*`ä¸`/console/users/search`ï¼›å»ºè®®ä½™é¢/è°ƒæ•´æ”¹èµ°`/console/asset-adjustment/*`ï¼Œç”¨æˆ·æœç´¢æ”¹èµ°`/console/user-management/users?search=`ï¼‰ |
| `diamond-accounts.html`          | é’»çŸ³è´¦æˆ·         | é’»çŸ³ä½™é¢/è°ƒæ•´/æµæ°´             | `/api/v4/console/diamond/*` + `/api/v4/console/users/search`                                                | ğŸ”´ï¼ˆconsoleæœªæŒ‚è½½diamondæ¨¡å—ï¼Œä¸”`/console/users/search`ä¸å­˜åœ¨ï¼‰                                                                                                            |
| `exchange-market-items.html`     | å…‘æ¢å•†å“ç®¡ç†     | å•†å“åˆ—è¡¨/ç¼–è¾‘/åˆ é™¤             | `/api/v4/exchange_market/*` + `/api/v4/console/exchange_market/*`                                           | ğŸ”´ï¼ˆç°æœ‰åç«¯ï¼šåˆ—è¡¨/è¯¦æƒ…åº”æ”¹ä¸º`/api/v4/shop/exchange/items*`ï¼›å¢åˆ æ”¹åº”æ”¹ä¸º`/api/v4/console/marketplace/exchange_market/items*`ï¼›å½“å‰æ—§è·¯å¾„å‡æœªæŒ‚è½½ï¼‰                        |
| `exchange-market-orders.html`    | å…‘æ¢è®¢å•ç®¡ç†     | è®¢å•åˆ—è¡¨/è¯¦æƒ…/çŠ¶æ€æ›´æ–°         | `/api/v4/exchange_market/orders*`                                                                           | ğŸ”´ï¼ˆåº”æ”¹ä¸º`/api/v4/shop/exchange/orders*`ï¼›ä½†ç°çŠ¶ä»…èƒ½æŸ¥çœ‹â€œè‡ªå·±çš„è®¢å•â€ï¼Œç®¡ç†åå°è¦çœ‹å…¨é‡è®¢å•éœ€è¡¥åç«¯admin-onlyæŸ¥è¯¢ç«¯ç‚¹ï¼Œè§2.2.5/6.5ï¼‰                                       |
| `exchange-market-stats.html`     | å…‘æ¢ç»Ÿè®¡         | å…‘æ¢ç»Ÿè®¡å›¾è¡¨                   | `/api/v4/exchange_market/statistics`                                                                        | ğŸ”´ï¼ˆåŒä¸Šï¼Œåº”å¯¹é½åˆ°`/api/v4/shop/exchange/statistics`ï¼‰                                                                                                                     |
| `consumption.html`               | æ¶ˆè´¹è®°å½•å®¡æ ¸     | å®¡æ ¸/æ‹’ç»/åˆ—è¡¨                 | `/api/v4/consumption/*`                                                                                     | ğŸ”´ï¼ˆåº”å¯¹é½åˆ°`/api/v4/shop/consumption/*`ï¼‰                                                                                                                                 |
| `notifications.html`             | é€šçŸ¥ä¸­å¿ƒ         | é€šçŸ¥åˆ—è¡¨/å‘é€/å·²è¯»/æ¸…ç©º        | `/api/v4/notifications/*`                                                                                   | ğŸ”´ï¼ˆåº”æ”¹å‰ç«¯åˆ°`/api/v4/system/notifications/*`ï¼›ä¸”`clear`å½“å‰å‰ç«¯ç”¨DELETEï¼Œä½†åç«¯ä¸ºPOSTï¼‰                                                                                  |
| `charts.html`                    | å›¾è¡¨å¯è§†åŒ–       | ç»Ÿè®¡å›¾è¡¨                       | `/api/v4/statistics/charts`                                                                                 | ğŸ”´ï¼ˆåº”æ”¹å‰ç«¯åˆ°`/api/v4/system/statistics/charts?days=...`ï¼‰                                                                                                                |
| `statistics.html`                | æ•°æ®ç»Ÿè®¡æŠ¥è¡¨     | æŠ¥è¡¨/å¯¼å‡º                      | `/api/v4/statistics/report`ã€`/api/v4/statistics/export`                                                    | ğŸ”´ï¼ˆåº”æ”¹å‰ç«¯åˆ°`/api/v4/system/statistics/report?period=...` ä¸ `/api/v4/system/statistics/export?days=...`ï¼›ä¸”å½“å‰åç«¯æœªå®ç°today/yesterday/customå£å¾„ï¼Œè§2.2.6ï¼‰          |
| `presets.html`                   | æŠ½å¥–é¢„è®¾ç®¡ç†     | é¢„è®¾åˆ›å»º/åˆ—è¡¨ï¼ˆå«æ¿€æ´»æŒ‰é’®ï¼‰    | `/api/v4/lottery-preset/*`                                                                                  | ğŸ”´ï¼ˆåç«¯å®é™…ä¸º`/api/v4/lottery/preset/*`ï¼Œä¸”å½“å‰æ— `activate`ç«¯ç‚¹ï¼‰                                                                                                         |
| `activity-conditions.html`       | æ´»åŠ¨æ¡ä»¶é…ç½®     | æ´»åŠ¨æ¡ä»¶é…ç½®                   | `/api/v4/lottery/campaigns*`ã€`/api/v4/activities/*`                                                        | ğŸŸ¡ï¼ˆåç«¯ç°å·²æŒ‚è½½`/api/v4/activities`ä¸`/api/v4/lottery/campaigns`ï¼›ä¸‹ä¸€æ­¥æ˜¯æŒ‰â€œä»…ç®¡ç†å‘˜å¯è°ƒç”¨â€æ”¶ç´§activitiesæƒé™ï¼Œå¹¶å¯¹é½é¡µé¢è¯»å†™æ¡ä»¶å­—æ®µä¸é”™è¯¯æç¤ºå­—æ®µï¼‰                    |

### 3.2 é¡µé¢åŠŸèƒ½ç‰¹æ€§åˆ†æ

#### é€šç”¨ç‰¹æ€§

- âœ… ç»Ÿä¸€çš„APIè¯·æ±‚å°è£…ï¼ˆ`admin-common.js`ï¼‰
- âœ… JWT Tokenè®¤è¯æœºåˆ¶
- âœ… é”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
- âœ… åˆ†é¡µå’Œç­›é€‰åŠŸèƒ½
- âœ… å“åº”å¼å¸ƒå±€ï¼ˆBootstrap 5ï¼‰

#### é«˜çº§ç‰¹æ€§

- âœ… WebSocketå®æ—¶é€šçŸ¥ï¼ˆ`notifications.html`ï¼‰
- âœ… å›¾è¡¨å¯è§†åŒ–ï¼ˆChart.jsï¼‰
- âœ… Excel/PDFå¯¼å‡ºï¼ˆ`statistics.html`ï¼‰
- âœ… æ‰¹é‡æ“ä½œæ”¯æŒ
- âœ… æœç´¢å’Œè¿‡æ»¤åŠŸèƒ½

---

## 4. æ•°æ®åº“å®é™…æ•°æ®åˆ†å¸ƒ

### 4.1 æ•°æ®åº“è¿æ¥ä¿¡æ¯

- **æ•°æ®åº“**: `restaurant_points_dev`ï¼ˆæ¥è‡ª `SELECT DATABASE()` çš„çœŸå®ç»“æœï¼‰
- **è¿æ¥æ–¹å¼**: Node.js + Sequelize ORM
- **é…ç½®æ¥æº**: `.env`æ–‡ä»¶
- **è¿æ¥çŠ¶æ€**: âœ… å·²éªŒè¯è¿æ¥æˆåŠŸ

### 4.2 æ ¸å¿ƒæ•°æ®è¡¨ç»Ÿè®¡

> è¯´æ˜ï¼šä»¥ä¸‹ä¸º**çœŸå®æ•°æ®åº“åªè¯»å¿«ç…§ï¼ˆ2026-01-08ï¼‰**ï¼Œç”¨äºæ ¡éªŒâ€œç®¡ç†åå°åº”è¦†ç›–çš„æ•°æ®è§„æ¨¡/çŠ¶æ€æšä¸¾â€ã€‚  
> è¡Œæ•°æ¥è‡ª`COUNT(*)`ï¼ˆéä¼°ç®—å€¼ï¼‰ã€‚

| è¡¨                            | è¡Œæ•°ï¼ˆCOUNT(\*)ï¼‰ | è¯´æ˜                                                                |
| ----------------------------- | ----------------: | ------------------------------------------------------------------- |
| `users`                       |                23 | ç”¨æˆ·è¡¨ï¼ˆå½“å‰`status`å…¨éƒ¨ä¸º`active`ï¼‰                                |
| `account_asset_balances`      |                11 | è´¦æˆ·èµ„äº§ä½™é¢ï¼ˆå«POINTS/DIAMOND/ææ–™èµ„äº§ï¼‰                           |
| `asset_transactions`          |              1373 | èµ„äº§æµæ°´ï¼ˆå¤šèµ„äº§ç±»å‹ï¼‰                                              |
| `item_instances`              |               606 | ç‰©å“å®ä¾‹ï¼ˆå¯ç”¨/é”å®š/å·²ä½¿ç”¨ï¼‰                                        |
| `item_instance_events`        |               331 | ç‰©å“äº‹ä»¶ï¼ˆç”¨äºè¿è¥èµ„äº§ä¸­å¿ƒè¿½æº¯ï¼‰                                    |
| `market_listings`             |                24 | C2CæŒ‚å•ï¼ˆå½“å‰çŠ¶æ€å…¨éƒ¨ä¸º`withdrawn`ï¼‰                                |
| `trade_orders`                |                 0 | C2Cäº¤æ˜“è®¢å•ï¼ˆå½“å‰ä¸ºç©ºï¼‰                                             |
| `exchange_items`              |                24 | B2Cå…‘æ¢å•†å“ï¼ˆææ–™èµ„äº§æ”¯ä»˜ä½“ç³»ï¼Œæœ‰å®Œæ•´åç«¯è·¯ç”±ï¼‰                     |
| `exchange_records`            |                 0 | B2Cå…‘æ¢è®¢å•è®°å½•ï¼ˆå½“å‰ä¸ºç©ºï¼›ä½†åç«¯å·²æœ‰è®¢å•åŸŸèƒ½åŠ›ï¼‰                   |
| `products`                    |                52 | ç§¯åˆ†/ç©ºé—´å•†å“ï¼ˆé—ç•™/åºŸå¼ƒä½“ç³»ï¼Œ**å·²å†³ç­–ä¸åšç®¡ç†å…¥å£**ï¼Œè§0.4/6.3.1ï¼‰ |
| `redemption_orders`           |               268 | å…‘æ¢è®¢å•ï¼ˆå½“å‰ä¸º`pending`ä¸`expired`å„134ï¼‰                         |
| `system_announcements`        |                 5 | ç³»ç»Ÿå…¬å‘Š/é€šçŸ¥åŸºç¡€è¡¨                                                 |
| `feedbacks`                   |                26 | ç”¨æˆ·åé¦ˆï¼ˆå¾…å›å¤/å¤„ç†ä¸­/å·²å›å¤/å…³é—­ï¼‰                               |
| `material_asset_types`        |                 3 | ææ–™èµ„äº§ç±»å‹                                                        |
| `material_conversion_rules`   |                 1 | ææ–™è½¬æ¢è§„åˆ™                                                        |
| `image_resources`             |                 2 | å›¾ç‰‡èµ„æºï¼ˆSealoså¯¹è±¡å­˜å‚¨ç»‘å®šï¼‰                                      |
| `api_idempotency_requests`    |               438 | å¹‚ç­‰è¯·æ±‚è®°å½•ï¼ˆé«˜é£é™©æ“ä½œå¿…å¤‡ï¼‰                                      |
| `admin_operation_logs`        |              1192 | ç®¡ç†å‘˜å®¡è®¡æ—¥å¿—ï¼ˆå…³é”®æ“ä½œè¿½æº¯ï¼‰                                      |
| `popup_banners`               |                 0 | å¼¹çª—Bannerï¼ˆå½“å‰ä¸ºç©ºï¼‰                                              |
| `lottery_campaigns`           |                 1 | æŠ½å¥–æ´»åŠ¨                                                            |
| `lottery_prizes`              |                 9 | æŠ½å¥–å¥–å“                                                            |
| `lottery_presets`             |                 2 | æŠ½å¥–é¢„è®¾                                                            |
| `lottery_management_settings` |               869 | æŠ½å¥–å¹²é¢„è®¾ç½®ï¼ˆæ¦‚ç‡è°ƒæ•´/å¼ºæ§ç­‰ï¼‰                                     |
| `lottery_draws`               |                 1 | æŠ½å¥–è®°å½•ï¼ˆå¯åœ¨åˆ†æé¡µå±•ç¤ºï¼‰                                          |
| `lottery_draw_quota_rules`    |                 1 | æŠ½å¥–é…é¢è§„åˆ™                                                        |
| `customer_service_sessions`   |                 3 | å®¢æœä¼šè¯                                                            |
| `websocket_startup_logs`      |               808 | WebSocketå¯åŠ¨/è¿è¡Œæ—¥å¿—ï¼ˆè§‚æµ‹/æ’éšœï¼‰                                 |

#### å…³é”®åˆ†å¸ƒï¼ˆçœŸå®æ•°æ®ï¼‰

- **users.status**ï¼š`active=23`
- **item_instances.status**ï¼š`used=304`ï¼Œ`locked=162`ï¼Œ`available=140`ï¼ˆåˆè®¡606ï¼‰
- **market_listings.status**ï¼š`withdrawn=24`
- **exchange_items.status**ï¼š`active=24`
- **redemption_orders.status**ï¼š`pending=134`ï¼Œ`expired=134`ï¼ˆåˆè®¡268ï¼‰
- **account_asset_balancesï¼ˆæŒ‰asset_codeæ±‡æ€»ï¼‰**ï¼š
  - `POINTS`: 7ä¸ªè´¦æˆ·ï¼Œavailableåˆè®¡ 48352ï¼Œfrozenåˆè®¡ 0
  - `red_shard`: 2ä¸ªè´¦æˆ·ï¼Œavailableåˆè®¡ 44070ï¼Œfrozenåˆè®¡ 0
  - `DIAMOND`: 1ä¸ªè´¦æˆ·ï¼Œavailableåˆè®¡ 125700ï¼Œfrozenåˆè®¡ 0
  - `MATERIAL_001`: 1ä¸ªè´¦æˆ·ï¼Œavailableåˆè®¡ 100ï¼Œfrozenåˆè®¡ 0
- **asset_transactionsï¼ˆæŒ‰asset_codeåˆ†å¸ƒï¼‰**ï¼š`red_shard=1363`ï¼Œ`POINTS=8`ï¼Œ`DIAMOND=1`ï¼Œ`MATERIAL_001=1`

### 4.3 æ•°æ®å®Œæ•´æ€§éªŒè¯

âœ… **æ‰€æœ‰æ ¸å¿ƒä¸šåŠ¡è¡¨å‡æœ‰å®é™…æ•°æ®**
âœ… **çŠ¶æ€å­—æ®µåˆ†å¸ƒåˆç†ï¼Œç¬¦åˆä¸šåŠ¡æµç¨‹**
âœ… **èµ„äº§ç±»å‹å¤šæ ·ï¼Œæ”¯æŒå¤æ‚çš„èµ„äº§ç®¡ç†éœ€æ±‚**
âœ… **äº¤æ˜“å’Œè®¢å•æ•°æ®å®Œæ•´ï¼Œå¯è¿½æº¯**

---

## 5. åŠŸèƒ½è¦†ç›–çŸ©é˜µ

### 5.1 Consoleæ¨¡å—è¦†ç›–ï¼ˆä»¥`routes/v4/console/index.js`å®é™…æŒ‚è½½ä¸ºå‡†ï¼‰

> ç›®æ ‡ï¼šè®©æ¯ä¸ªConsoleæ¨¡å—éƒ½èƒ½åœ¨ç®¡ç†åå°æœ‰â€œå¯æŸ¥çœ‹/å¯æ“ä½œâ€çš„é¡µé¢å…¥å£ï¼Œå¹¶ä¸”æ¥å£è·¯å¾„ä¸`app.js`æŒ‚è½½ä¸€è‡´ã€‚

| æ¨¡å—                    | åç«¯æ˜¯å¦å·²æŒ‚è½½ | ç°æœ‰é¡µé¢                   | çŠ¶æ€  | ä¸‹ä¸€æ­¥ï¼ˆæ»¡è¶³â€œå¯è”åŠ¨æŸ¥çœ‹æ•°æ®/å¯æ“ä½œâ€ï¼‰                                                                                                                                             |
| ----------------------- | -------------- | -------------------------- | ----- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| system                  | âœ…             | `dashboard.html`           | âœ…    | ä¿æŒ                                                                                                                                                                              |
| settings                | âœ…             | `settings.html`            | âœ…    | ä¿æŒ                                                                                                                                                                              |
| prize-pool              | âœ…             | `prizes.html`              | âœ…    | ä¿æŒ                                                                                                                                                                              |
| user-management         | âœ…             | `users.html`               | âœ…    | ä¿æŒ                                                                                                                                                                              |
| lottery-management      | âœ…             | `users.html`ï¼ˆä»…æ¦‚ç‡è°ƒæ•´ï¼‰ | ğŸŸ¡    | è¡¥é½force-win/force-lose/é˜Ÿåˆ—/æ¸…ç†ç­‰å…¥å£ï¼ˆå»ºè®®æ–°é¡µæˆ–åœ¨ç”¨æˆ·è¯¦æƒ…æ‰©å±•ï¼‰                                                                                                              |
| customer-service        | âœ…             | `customer-service.html`    | âœ…    | ä¿æŒ                                                                                                                                                                              |
| marketplace             | âœ…             | `marketplace-stats.html`   | ğŸŸ¡    | å…‘æ¢å•†å“CRUDç«¯ç‚¹åœ¨è¯¥æ¨¡å—ä¸‹ï¼Œä½†å‰ç«¯é¡µæœªå¯¹é½ï¼ˆè§5.2ï¼‰                                                                                                                               |
| material                | âœ…             | `material-*` 4é¡µ           | ğŸŸ¡    | `asset-types`/`conversion-rules`é¡µé¢å¯ç”¨ï¼›`material-balances.html`/`material-transactions.html`éœ€äºŒé€‰ä¸€ï¼šæ”¹èµ°`asset-adjustment`æˆ–è¡¥é½åç«¯materialç”¨æˆ·ä½™é¢/æµæ°´ç«¯ç‚¹ï¼ˆè§2.2.2/5.2ï¼‰ |
| popup-banners           | âœ…             | `popup-banners.html`       | âœ…    | ä¿æŒ                                                                                                                                                                              |
| lottery-quota           | âœ…             | æ—                          | âŒ    | æ–°å¢`lottery-quota.html`ï¼ˆè§„åˆ™CRUDã€ç”¨æˆ·é…é¢æŸ¥è¯¢/åŠ æ¬¡æ•°/æ ¡éªŒï¼‰                                                                                                                    |
| asset-adjustment        | âœ…             | æ—                          | âŒ    | æ–°å¢`asset-adjustment.html`ï¼ˆPOINTS/BUDGET_POINTS/DIAMOND/ææ–™ç»Ÿä¸€è°ƒæ•´ + æ‰¹é‡ + å¹‚ç­‰æç¤ºï¼‰                                                                                        |
| campaign-budget         | âœ…             | æ—                          | âŒ    | æ–°å¢`campaign-budget.html`ï¼ˆæ´»åŠ¨é¢„ç®—é…ç½®ã€validateã€æ± è¡¥å……ã€é¢„ç®—çŠ¶æ€ã€ç”¨æˆ·BUDGET_POINTSæŸ¥è¯¢ï¼‰                                                                                     |
| assets                  | âœ…             | æ—                          | âŒ    | æ–°å¢`assets-portfolio.html`ï¼ˆèµ„äº§æ€»è§ˆã€ç‰©å“åˆ—è¡¨/è¯¦æƒ…ã€äº‹ä»¶å†å²ï¼‰                                                                                                                  |
| images                  | âœ…             | æ—                          | âŒ    | æ–°å¢`image-resources.html`ï¼ˆä¸Šä¼ ã€åˆ—è¡¨ã€ç»‘å®šã€åˆ é™¤/æ¸…ç†ï¼‰                                                                                                                         |
| orphan-frozen           | âœ…             | æ—                          | âŒ    | æ–°å¢`orphan-frozen.html`ï¼ˆdetect/stats/cleanup + dry-runï¼‰                                                                                                                        |
| merchant-points         | âœ…             | æ—                          | âŒ    | æ–°å¢`merchant-points.html`ï¼ˆå•†å®¶ç§¯åˆ†å®¡æ ¸/è®°å½•æŸ¥è¯¢/ç­›é€‰ï¼›é«˜é£é™©å†™æ“ä½œéœ€äºŒæ¬¡ç¡®è®¤+å®¡è®¡ï¼‰                                                                                             |
| analytics               | âœ…             | æ—                          | âŒ    | **å·²å†³ç­–**ï¼šæ–°å¢`analytics.html`å¯¹é½`/api/v4/console/analytics/*`ï¼ˆå†³ç­–åˆ†æ/è¶‹åŠ¿/æ€§èƒ½/ä»Šæ—¥ç»Ÿè®¡ï¼‰ï¼›`charts.html`/`statistics.html`ä¿ç•™ä½†å¯¹é½`/api/v4/system/statistics/*`          |
| config                  | âœ…             | æ—                          | âŒ    | æ–°å¢`config-tools.html`ï¼ˆé…ç½®æŸ¥çœ‹/æ¨¡æ‹Ÿæµ‹è¯•ï¼›åªè¯»ä¸ºä¸»ï¼‰                                                                                                                            |
| auth                    | âœ…             | `login.html`               | ğŸŸ¡    | **å·²å†³ç­–**ï¼šç»Ÿä¸€åˆ°`/api/v4/console/auth/*`ï¼Œæ”¹é€ `login.html`è°ƒç”¨è·¯å¾„                                                                                                              |
| diamondï¼ˆå£°æ˜ä½†æœªæŒ‚è½½ï¼‰ | âŒ             | `diamond-accounts.html`    | ğŸ”´â†’âœ… | **å·²å†³ç­–**ï¼šä¸è¡¥diamondæ¨¡å—ï¼Œæ”¹é€ `diamond-accounts.html`ç»Ÿä¸€èµ°`asset-adjustment`/èµ„äº§æµæ°´èƒ½åŠ›ï¼ˆé’»çŸ³=`DIAMOND`èµ„äº§ç±»å‹ï¼‰                                                           |

### 5.1.1 æ•°æ®åº“è¡¨è¦†ç›–è¡¥å……è¯´æ˜

> é™¤Consoleæ¨¡å—å¤–ï¼Œä»¥ä¸‹æ•°æ®åº“è¡¨éœ€æ˜ç¡®ç®¡ç†å…¥å£å½’å±ï¼š

| è¡¨                     | æ•°æ®é‡ | å½“å‰åç«¯è·¯ç”±                                                               | ç®¡ç†å…¥å£çŠ¶æ€                 | è¯´æ˜                                                                                |
| ---------------------- | -----: | -------------------------------------------------------------------------- | ---------------------------- | ----------------------------------------------------------------------------------- |
| `exchange_items`       |     24 | âœ… `/api/v4/shop/exchange/*` + `/console/marketplace/*`                    | ğŸ”´â†’âœ… éœ€å¯¹é½è·¯å¾„             | B2Cææ–™å…‘æ¢å•†å“ï¼Œè§5.2                                                              |
| `exchange_records`     |      0 | ğŸŸ¡ `/api/v4/shop/exchange/orders*`ï¼ˆä»…æœ¬äººè®¢å•ï¼›ç®¡ç†å‘˜ä»…æœ‰çŠ¶æ€æ›´æ–°ä¸ç»Ÿè®¡ï¼‰ | ğŸ”´â†’âœ… éœ€è¡¥é½èƒ½åŠ›             | B2Cå…‘æ¢è®¢å•ï¼šç®¡ç†åå°éœ€è¦â€œå…¨é‡è®¢å•åˆ—è¡¨/è¯¦æƒ…/ç­›é€‰â€ï¼Œç°æœ‰åç«¯æœªæä¾›admin-onlyæŸ¥è¯¢ç«¯ç‚¹ |
| `products`             |     52 | âŒ æ— ç®¡ç†è·¯ç”±                                                              | âœ… **å·²å†³ç­–ä¸åš**ï¼ˆè§6.3.1ï¼‰ | é—ç•™/åºŸå¼ƒä½“ç³»ï¼Œåç«¯æœªä½¿ç”¨                                                           |
| `trade_orders`         |      0 | âœ… TradeOrderServiceï¼ŒâŒ æ— consoleè·¯ç”±                                     | âœ… **å·²å†³ç­–è¦åš**            | C2Cäº¤æ˜“è®¢å•ï¼Œéœ€è¡¥é½consoleè·¯ç”±+å‰ç«¯                                                 |
| `system_announcements` |      5 | âœ… `/console/system/announcements/*`                                       | âœ… **å·²å†³ç­–è¦åš**            | ç³»ç»Ÿå…¬å‘Šï¼Œåç«¯å·²æœ‰ï¼Œéœ€è¡¥å‰ç«¯é¡µé¢                                                    |
| `feedbacks`            |     26 | âœ… `/console/system/feedbacks/*`                                           | âœ… **å·²å†³ç­–è¦åš**            | ç”¨æˆ·åé¦ˆï¼Œåç«¯å·²æœ‰ï¼Œéœ€è¡¥å‰ç«¯é¡µé¢                                                    |
| `stores`               |      0 | âŒ æ— åç«¯è·¯ç”±/æœåŠ¡                                                         | âœ… **å·²å†³ç­–è¦åš**            | é—¨åº—ä¿¡æ¯ï¼Œéœ€è¡¥é½åç«¯+å‰ç«¯                                                           |
| `user_premium_status`  |      1 | âœ… PremiumService                                                          | âœ… **å·²å†³ç­–è¦åš**            | é«˜çº§ä¼šå‘˜ï¼Œå¯åœ¨users.htmlæ‰©å±•                                                        |
| `user_hierarchy`       |      0 | âœ… HierarchyManagementServiceï¼ŒâŒ æ— è·¯ç”±                                   | âœ… **å·²å†³ç­–è¦åš**            | ç”¨æˆ·å±‚çº§ï¼Œéœ€è¡¥é½consoleè·¯ç”±+å‰ç«¯                                                    |
| `admin_operation_logs` |   1192 | âœ… AuditLogServiceï¼ŒâŒ æ— ç‹¬ç«‹æŸ¥è¯¢è·¯ç”±                                      | âœ… **å·²å†³ç­–è¦åš**            | å®¡è®¡æ—¥å¿—ï¼Œéœ€è¡¥é½consoleè·¯ç”±+å‰ç«¯é¡µé¢                                                |
| `lottery_draws`        |      1 | âœ… åœ¨analyticsä¸­æœ‰ç»Ÿè®¡                                                     | âœ… **å·²å†³ç­–è¦åš**            | æŠ½å¥–è®°å½•ï¼Œå¯åœ¨analytics.htmlå±•ç¤º                                                    |
| `redemption_orders`    |    256 | âœ… `/api/v4/shop/redemption/*`                                             | âœ… å·²æœ‰æ ¸é”€æµç¨‹              | æ ¸é”€è®¢å•                                                                            |

### 5.2 ç°æœ‰é¡µé¢çš„APIè·¯å¾„å¯¹é½æ¸…å•ï¼ˆP0ï¼‰

> ç›®æ ‡ï¼šå…ˆæŠŠ"é¡µé¢å­˜åœ¨ä½†æ— æ³•è”åŠ¨"çš„é—®é¢˜æ¸…æ‰ï¼š**è·¯å¾„å¯¹é½ + èƒ½åŠ›å¯¹é½ï¼ˆå­—æ®µ/ä¸šåŠ¡è§„åˆ™å¯¹é½ï¼‰**ã€‚

| é¡µé¢                          | å½“å‰è°ƒç”¨                                                                       | å½“å‰åç«¯å®é™…å¯ç”¨/å»ºè®®æ”¹ä¸º                                                                                                                                                                                       | å¤‡æ³¨                                                                                                                                |
| ----------------------------- | ------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------- | ----- | ----------------------------------------------- | --- | --- | ---------------------------------------------------------------------------------------------- |
| `login.html`                  | `POST /api/v4/auth/login`                                                      | **å·²å†³ç­–**ï¼š`POST /api/v4/console/auth/login` + `GET /api/v4/console/auth/profile`                                                                                                                              | ç»Ÿä¸€â€œç®¡ç†åå°è®¤è¯å£å¾„â€ä¸ºconsole auth                                                                                                |
| `material-balances.html`      | `/api/v4/console/material/users/*` + `/api/v4/console/users/search?mobile=...` | **æ¨è**ï¼šä½™é¢æŸ¥è¯¢æ”¹ä¸º`GET /api/v4/console/asset-adjustment/user/:user_id/balances`ï¼›è°ƒæ•´æ”¹ä¸º`POST /api/v4/console/asset-adjustment/adjust`ï¼›ç”¨æˆ·æœç´¢æ”¹ä¸º`GET /api/v4/console/user-management/users?search=...` | ç°æœ‰åç«¯æœªå®ç°`console/material/users/*`ä¸`console/users/search`                                                                    |
| `material-transactions.html`  | `/api/v4/console/material/transactions`                                        | å¢åŠ â€œç®¡ç†å‘˜æŒ‰ç”¨æˆ·æŸ¥è¯¢èµ„äº§æµæ°´â€ç«¯ç‚¹ï¼ˆå»ºè®®å½’å±`console/assets`æˆ–`console/asset-adjustment`ï¼‰ï¼Œå‰ç«¯ä»¥`asset_code`ç­›é€‰ææ–™ç±»æµæ°´                                                                                    | ç°æœ‰åç«¯æœªå®ç°`console/material/transactions`                                                                                       |
| `diamond-accounts.html`       | `/api/v4/console/diamond/*` + `/console/users/search`                          | **å·²å†³ç­–B**ï¼šæ”¹ä¸º`/api/v4/console/asset-adjustment/*`+èµ„äº§æµæ°´æŸ¥è¯¢ï¼Œé’»çŸ³ä½œä¸º`DIAMOND`èµ„äº§ç±»å‹ç»Ÿä¸€ç®¡ç†                                                                                                           | ä¸å†å•ç‹¬åšdiamondæ¨¡å—                                                                                                               |
| `exchange-market-*.html`      | `/api/v4/exchange_market/*` + `/api/v4/console/exchange_market/*`              | å•†å“åˆ—è¡¨/è¯¦æƒ…ï¼š`/api/v4/shop/exchange/items*`ï¼ˆç®¡ç†å‘˜ç™»å½•è¿”å›fullæ•°æ®ï¼‰ï¼›å•†å“å¢åˆ æ”¹ï¼š`/api/v4/console/marketplace/exchange_market/items*`ï¼›ç»Ÿè®¡ï¼š`/api/v4/shop/exchange/statistics`                             | æ—§è·¯å¾„å‡æœªæŒ‚è½½ï¼›å­—æ®µéœ€ä»æ—§`virtual_value_price/price_type`å¯¹é½åˆ°`cost_asset_code/cost_amount`ç­‰ææ–™æ”¯ä»˜å­—æ®µ                         |
| `consumption.html`            | `/api/v4/consumption/*`                                                        | `/api/v4/shop/consumption/*`                                                                                                                                                                                    | å½“å‰åç«¯æŒ‚è½½åœ¨shopåŸŸ                                                                                                                |
| `exchange-market-orders.html` | `/api/v4/exchange_market/orders*`                                              | çŠ¶æ€æ›´æ–°ï¼š`POST /api/v4/shop/exchange/orders/:order_no/status`ï¼ˆå·²å­˜åœ¨ï¼‰ï¼›**åˆ—è¡¨/è¯¦æƒ…**ï¼šéœ€æ–°å¢`admin-only`æŸ¥è¯¢ç«¯ç‚¹ï¼ˆå»ºè®®ï¼š`GET /api/v4/shop/exchange/admin/orders*`ï¼‰                                          | ç°æœ‰`GET /shop/exchange/orders*`ä»…æœ¬äººè®¢å•ï¼Œæ— æ³•æ»¡è¶³ç®¡ç†åå°â€œå…¨é‡è®¢å•ç®¡ç†â€                                                          |
| `notifications.html`          | `/api/v4/notifications/*`                                                      | **å·²å†³ç­–A**ï¼šæ”¹å‰ç«¯åˆ°`/api/v4/system/notifications/*`                                                                                                                                                           | æ³¨æ„ï¼š`clear`åç«¯ä¸º`POST /clear`ï¼Œå‰ç«¯å½“å‰ç”¨DELETEéœ€è¦ä¿®æ­£                                                                          |
| `charts.html`                 | `/api/v4/statistics/charts`                                                    | æ”¹ä¸º`/api/v4/system/statistics/charts?days=7                                                                                                                                                                    | 30                                                                                                                                  | 90`   | system/statisticså½“å‰ä»¥`days`ä¸ºå£å¾„             |
| `statistics.html`             | `/api/v4/statistics/report                                                     | export`                                                                                                                                                                                                         | æ”¹ä¸º`/api/v4/system/statistics/report?period=week                                                                                   | month | year`ä¸`/api/v4/system/statistics/export?days=7 | 30  | 90` | âš ï¸ å½“å‰åç«¯æœªå®ç°today/yesterday/customå£å¾„ï¼›å¦‚éœ€è¦ï¼Œéœ€è¡¥é½ReportingServiceæŠ¥è¡¨èƒ½åŠ›ï¼ˆè§2.2.6ï¼‰ |
| `presets.html`                | `/api/v4/lottery-preset/*`ï¼ˆå«activateï¼‰                                       | **å·²å†³ç­–**ï¼šé‡æ„ä¸º"æŠ½å¥–å¹²é¢„/é¢„è®¾é˜Ÿåˆ—ç®¡ç†"ï¼Œå¯¹é½`/api/v4/console/lottery-management/*`                                                                                                                           | æ¿€æ´»=`user-specific-queue`ï¼›æŸ¥çœ‹=`user-status/:user_id`ï¼›æ’¤é”€=`clear-user-settings/:user_id`ï¼›å¼ºæ§=`force-win/force-lose`           |
| `activity-conditions.html`    | `/api/v4/lottery/campaigns*`ã€`/api/v4/activities/*`                           | **å·²å†³ç­–B**ï¼šactivitiesåŸŸå½“å‰å·²å…·å¤‡ï¼›æŒ‰å†³ç­–å°†**å…¨éƒ¨ç«¯ç‚¹æ”¶ç´§ä¸ºä»…ç®¡ç†å‘˜å¯è°ƒç”¨**ï¼Œå¹¶å°†é¡µé¢è¯»å†™ç»Ÿä¸€åˆ°`/api/v4/activities/*`                                                                                         | ç«¯ç‚¹ï¼šavailable/check-eligibility/participate/conditions/configure-conditionsï¼ˆç°çŠ¶éƒ¨åˆ†ä¸ºç™»å½•ç”¨æˆ·å¯ç”¨ï¼Œéœ€åç«¯æ”¶ç´§ä¸º`requireAdmin`ï¼‰ |

---

## 6. åŠŸèƒ½ç¼ºå£åˆ†æ

### 6.1 P0ï¼šå…ˆè®©"å·²æœ‰é¡µé¢"çœŸæ­£èƒ½è”åŠ¨æ•°æ®

- **APIè·¯å¾„ç»Ÿä¸€**ï¼šæŒ‰ç¬¬5.2è¡¨é€é¡µä¿®æ­£ï¼ˆ**å·²å†³ç­–ï¼šåªæ”¹å‰ç«¯ï¼Œä¸åŠ åç«¯å…¼å®¹è·¯ç”±**ï¼‰ï¼Œç›®æ ‡æ˜¯"é¡µé¢æ‰€æœ‰è¯·æ±‚éƒ½èƒ½å‘½ä¸­å½“å‰åç«¯æŒ‚è½½è·¯å¾„"
- **è®¤è¯å£å¾„ç»Ÿä¸€**ï¼š`login.html`æ”¹ä¸ºè°ƒç”¨`/api/v4/console/auth/login`ï¼ˆ**å·²å†³ç­–**ï¼‰
- **ä¸šåŠ¡å­—æ®µå¯¹é½**ï¼šé‡ç‚¹æ˜¯å…‘æ¢å¸‚åœºï¼ˆæ—§virtual_value â†’ ç°ææ–™èµ„äº§æ”¯ä»˜ï¼‰ä¸æŠ½å¥–é¢„è®¾ï¼ˆé‡æ„ä¸ºå¹²é¢„ç®¡ç†é¡µï¼‰
- **diamondæ¨¡å—å¤„ç†**ï¼š**å·²å†³ç­–**ä¸å•ç‹¬åšdiamondæ¨¡å—ï¼Œ`diamond-accounts.html`æ”¹é€ ä¸ºèµ°é€šç”¨èµ„äº§ä¸­å¿ƒèƒ½åŠ›

### 6.2 P0ï¼šè¡¥é½Consoleç¼ºå¤±æ¨¡å—é¡µé¢ï¼ˆè®©19/19æ¨¡å—å¯ç”¨ï¼‰

- **lottery-quota**ï¼šæ–°å¢ç®¡ç†é¡µé¢ï¼ˆè§„åˆ™ç®¡ç† + ç”¨æˆ·é…é¢æŸ¥è¯¢/ä¸´æ—¶åŠ æ¬¡æ•°/æ ¡éªŒï¼‰
- **asset-adjustment**ï¼šæ–°å¢ç»Ÿä¸€èµ„äº§è°ƒæ•´é¡µé¢ï¼ˆå«æ‰¹é‡ã€å¹‚ç­‰æç¤ºã€æŸ¥è¯¢ç”¨æˆ·balancesï¼‰
- **campaign-budget**ï¼šæ–°å¢é¢„ç®—é…ç½®é¡µé¢ï¼ˆbudget_modeã€validateã€poolè¡¥å……ã€budget-statusã€ç”¨æˆ·BUDGET_POINTSæŸ¥è¯¢ï¼‰
- **assetsï¼ˆè¿è¥èµ„äº§ä¸­å¿ƒï¼‰**ï¼šæ–°å¢èµ„äº§ä¸­å¿ƒé¡µé¢ï¼ˆoverview/items/item-eventsï¼‰
- **images**ï¼šæ–°å¢å›¾ç‰‡èµ„æºç®¡ç†é¡µé¢ï¼ˆupload/list/bind/deleteï¼‰
- **orphan-frozen**ï¼šæ–°å¢æ¸…ç†å·¥å…·é¡µï¼ˆdetect/stats/cleanup + dry-runï¼‰
- **analytics/config**ï¼šæ–°å¢åˆ†æ/å·¥å…·é¡µï¼ˆæˆ–ä¸ç°æœ‰charts/statisticsåˆå¹¶ï¼Œä½†å¿…é¡»å…ˆå®Œæˆè·¯å¾„å¯¹é½ï¼‰

### 6.3 P1ï¼šè¡¥é½"éƒ¨åˆ†è¦†ç›–"çš„æ¨¡å—èƒ½åŠ›

- **lottery-management**ï¼šè¡¥é½force-win/force-lose/é˜Ÿåˆ—/æ¸…ç†ç­‰å…¥å£ï¼ˆå¯åœ¨ç”¨æˆ·è¯¦æƒ…é¡µæ‰©å±•ï¼‰
- **material**ï¼šè¡¥é½ç”¨æˆ·æœç´¢ä¸æ‰¹é‡è°ƒæ•´ï¼ˆå¯é€‰ï¼‰

### 6.3.1 å·²å†³ç­–ï¼š`products` è¡¨ï¼ˆç§¯åˆ†/ç©ºé—´å•†å“ä½“ç³»ï¼‰ä¸åšç®¡ç†å…¥å£

> è§0.4çš„æ•°æ®åº“éªŒè¯ç»“è®ºï¼š`products`ï¼ˆ52è¡Œï¼‰ä¸`exchange_items`ï¼ˆ24è¡Œï¼‰æ˜¯ä¸¤å¥—ç‹¬ç«‹å•†å“ä½“ç³»ï¼Œå‰è€…å½“å‰åç«¯æ— ç®¡ç†è·¯ç”±ã€‚

**å·²æ‹æ¿å†³ç­–ï¼ˆ2026-01-08ï¼‰**ï¼š

- âœ… **é€‰æ–¹æ¡ˆA**ï¼š`products` æ˜¯é—ç•™/åºŸå¼ƒä½“ç³»ï¼Œ**ä¸åšç®¡ç†å…¥å£**
- **éªŒè¯ä¾æ®**ï¼ˆä»¥åç«¯/DBä¸ºæƒå¨ï¼‰ï¼š
  - åç«¯è·¯ç”±/æœåŠ¡**å®Œå…¨æœªè°ƒç”¨**`Product`æ¨¡å‹ï¼ˆä»…æœ‰æ¨¡å‹å®šä¹‰ï¼Œæ— ä¸šåŠ¡ä½¿ç”¨ï¼‰
  - æ•°æ®åº“æ— å…¶ä»–è¡¨å¤–é”®å¼•ç”¨`products`
  - æ•°æ®åœç•™åœ¨åˆå§‹åŒ–çŠ¶æ€ï¼ˆæœ€åæ›´æ–°ï¼š2025-12-12ï¼‰
  - å½“å‰ä¸šåŠ¡å·²è¿ç§»åˆ°`exchange_items`ï¼ˆææ–™èµ„äº§æ”¯ä»˜ä½“ç³»ï¼‰
- **åç»­è§„åˆ’**ï¼šå¦‚éœ€"ç§¯åˆ†ç©ºé—´å•†å“"ä¸šåŠ¡ï¼Œæ ¹æ®å®é™…éœ€æ±‚é‡æ–°è®¾è®¡å¹¶è¡¥é½åç«¯+å‰ç«¯ï¼ˆå±Šæ—¶æŒ‰"ä¸ºDBå·²å­˜åœ¨èƒ½åŠ›æä¾›æ¥å£"åŸåˆ™æ‰§è¡Œï¼‰

**æœ¬æ–‡æ¡£ä¸å†æ¶‰åŠ`products`è¡¨çš„ç®¡ç†å…¥å£å»ºè®¾ã€‚**

### 6.5 å·²å†³ç­–ï¼šè¡¥é½å…¶ä»–æ•°æ®åº“è¡¨çš„ç®¡ç†å…¥å£ï¼ˆå…¨éƒ¨è¦åšï¼‰

> ä½ æ˜ç¡®è¦æ±‚"è¿™äº›åŠŸèƒ½éƒ½è¦åšï¼Œwebç«¯ç®¡ç†å¹³å°å‰ç«¯é¡µé¢éƒ½è¦åš"ï¼Œä»¥ä¸‹ä¸ºæ‰§è¡Œæ–¹æ¡ˆï¼ˆä»¥åç«¯/DBä¸ºæƒå¨ï¼‰ã€‚

| è¡¨                       | æ•°æ®é‡ | åç«¯ç°çŠ¶                                                                               | æ‰§è¡Œæ–¹æ¡ˆ                                                                                                                                                                                                                                                 | ä¼˜å…ˆçº§ |
| ------------------------ | -----: | -------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| **trade_orders**         |      0 | âœ… æœ‰TradeOrderServiceï¼ŒâŒ æ— consoleè·¯ç”±                                               | è¡¥é½`/api/v4/console/marketplace/trade-orders/*`ï¼ˆåˆ—è¡¨/è¯¦æƒ…/çŠ¶æ€ç®¡ç†ï¼‰+ `trade-orders.html`                                                                                                                                                              | P1     |
| **system_announcements** |      5 | âœ… å·²æœ‰`/api/v4/console/system/announcements/*`ï¼ˆCRUDï¼‰                                | åªéœ€æ–°å¢`announcements.html`å¯¹é½ç°æœ‰åç«¯                                                                                                                                                                                                                 | P0     |
| **feedbacks**            |     26 | âœ… å·²æœ‰`/api/v4/console/system/feedbacks/*`ï¼ˆåˆ—è¡¨/å›å¤/çŠ¶æ€ï¼‰                          | åªéœ€æ–°å¢`feedbacks.html`å¯¹é½ç°æœ‰åç«¯                                                                                                                                                                                                                     | P0     |
| **stores**               |      0 | âŒ æ— åç«¯è·¯ç”±/æœåŠ¡                                                                     | è¡¥é½`/api/v4/console/stores/*`ï¼ˆCRUDï¼‰+ `stores.html`ï¼ˆéœ€å…ˆç¡®è®¤è¡¨ç»“æ„/ä¸šåŠ¡éœ€æ±‚ï¼‰                                                                                                                                                                         | P2     |
| **user_premium_status**  |      1 | âœ… æœ‰PremiumServiceï¼ŒâŒ æ— consoleç®¡ç†å…¥å£                                              | åœ¨`users.html`ç”¨æˆ·è¯¦æƒ…ä¸­æ‰©å±•"é«˜çº§ä¼šå‘˜çŠ¶æ€"å±•ç¤º/ç®¡ç†                                                                                                                                                                                                      | P1     |
| **user_hierarchy**       |      0 | âœ… æœ‰HierarchyManagementServiceï¼ŒâŒ æ— è·¯ç”±                                             | è¡¥é½`/api/v4/console/user-management/hierarchy/*`+ åœ¨`users.html`æ‰©å±•æˆ–æ–°å¢`user-hierarchy.html`                                                                                                                                                         | P2     |
| **admin_operation_logs** |   1192 | âœ… æœ‰AuditLogServiceï¼ˆå«getOperatorLogs/getLogDetailï¼‰ï¼ŒâŒ æ— ç‹¬ç«‹è·¯ç”±                  | è¡¥é½`/api/v4/console/system/audit-logs/*`ï¼ˆåˆ—è¡¨/è¯¦æƒ…/ç»Ÿè®¡ï¼‰+ `audit-logs.html`                                                                                                                                                                           | P1     |
| **lottery_draws**        |      1 | âœ… åœ¨analyticsä¸­æœ‰ç»Ÿè®¡                                                                 | åœ¨`analytics.html`ä¸­å¢åŠ "æŠ½å¥–è®°å½•"æ¨¡å—ï¼ˆåˆ—è¡¨/ç­›é€‰/è¯¦æƒ…ï¼‰                                                                                                                                                                                                 | P1     |
| **exchange_records**     |      0 | ğŸŸ¡ å·²æœ‰ExchangeServiceï¼ˆç»Ÿè®¡/çŠ¶æ€æ›´æ–°/æœ¬äººè®¢å•æŸ¥è¯¢ï¼‰ï¼›âŒ ç¼ºå°‘â€œç®¡ç†å‘˜å…¨é‡è®¢å•åˆ—è¡¨/è¯¦æƒ…â€ | æ–°å¢ admin-only æŸ¥è¯¢ç«¯ç‚¹ï¼ˆå»ºè®®ï¼š`GET /api/v4/shop/exchange/admin/orders`ã€`GET /api/v4/shop/exchange/admin/orders/:order_no`ï¼‰ï¼Œå¹¶å°†`exchange-market-orders.html`å¯¹é½åˆ°è¯¥adminç«¯ç‚¹ï¼›çŠ¶æ€æ›´æ–°ç»§ç»­å¤ç”¨`POST /api/v4/shop/exchange/orders/:order_no/status` | P0     |

**æ‰§è¡ŒåŸåˆ™**ï¼ˆä»¥åç«¯/DBä¸ºæƒå¨ï¼‰ï¼š

- **åç«¯å·²æœ‰è·¯ç”±/æœåŠ¡çš„è¡¨**ï¼ˆannouncements/feedbacks/exchange_recordsï¼‰ï¼šåªéœ€è¡¥å‰ç«¯é¡µé¢å¯¹é½
- **åç«¯æœ‰æœåŠ¡ä½†æ— consoleè·¯ç”±çš„è¡¨**ï¼ˆtrade_orders/user_premium_status/user_hierarchy/admin_operation_logsï¼‰ï¼šè¡¥é½consoleè·¯ç”± + å‰ç«¯é¡µé¢
- **åç«¯æ— æœåŠ¡çš„è¡¨**ï¼ˆstoresï¼‰ï¼šéœ€å…ˆè¡¥åç«¯æœåŠ¡/è·¯ç”±ï¼Œå†åšå‰ç«¯ï¼ˆæŒ‰"åªä¸ºDBå·²å­˜åœ¨èƒ½åŠ›æä¾›æ¥å£"åŸåˆ™ï¼‰

### 6.4 P0ï¼šä¸€æ¬¡æ€§è¡¥é½â€œåç«¯èƒ½åŠ›ç¼ºå£/æƒé™ä¸ä¸€è‡´/å‰ç«¯æ— æ³•è”åŠ¨â€çš„èƒ½åŠ›ï¼ˆå·²å†³ç­–ï¼šå…¨éƒ¨è¡¥é½ï¼‰

ä½ è¦æ±‚"ä¸€æ¬¡æ€§è¡¥é½ç®¡ç†åå°æ‰€æœ‰é¡µé¢å†…å®¹"ï¼Œä»¥ä¸‹ä¸º**å·²æ‹æ¿å†³ç­–**çš„æ‰§è¡Œæ–¹æ¡ˆã€‚

#### 6.4.1 æ´»åŠ¨æ¡ä»¶é…ç½®ï¼ˆ`activity-conditions.html`ï¼‰â€”â€”activities åŸŸæƒé™æ”¶ç´§ + å‰ç«¯å¯¹é½ï¼ˆä»…ç®¡ç†å‘˜ï¼‰

**ç°çŠ¶ï¼ˆå·²ä¸å½“å‰ä»£ç /DBå¯¹é½ï¼‰**ï¼š

- `LotteryCampaign`æ¨¡å‹å·²åŒ…å« `participation_conditions` / `condition_error_messages`ï¼ˆå­˜å‚¨åœ¨`lottery_campaigns`è¡¨ï¼ŒJSONå­—æ®µï¼‰
- âœ… å½“å‰åç«¯**å·²æŒ‚è½½**`/api/v4/activities`åŸŸï¼ˆè§`app.js`ï¼š`app.use('/api/v4/activities', require('./routes/v4/activities'))`ï¼‰ï¼Œæ´»åŠ¨æ¡ä»¶ç›¸å…³ç«¯ç‚¹å·²å¯è°ƒç”¨
- âš ï¸ å·®å¼‚ç‚¹ï¼šå½“å‰`/api/v4/activities/available|check-eligibility|participate`ä¸ºâ€œç™»å½•ç”¨æˆ·å¯ç”¨â€ç«¯ç‚¹ï¼›ä½†ä½ å·²æ‹æ¿â€œactivitiesåŸŸä»…ç®¡ç†å‘˜å¯ç”¨â€ï¼Œå› æ­¤éœ€è¦åœ¨åç«¯å°†è¿™äº›ç«¯ç‚¹æƒé™æ”¶ç´§ä¸º`requireAdmin`ï¼ˆä¸æ”¹å˜ä¸šåŠ¡å­—æ®µï¼Œåªæ”¹å˜è®¿é—®ç­–ç•¥ï¼‰

**å·²å†³ç­–æ–¹æ¡ˆï¼ˆä»…ç®¡ç†å‘˜ï¼‰**ï¼š

- âœ… ç°çŠ¶å·²å…·å¤‡ `/api/v4/activities` è·¯ç”±ä¸å®ç°ï¼›ä¸‹ä¸€æ­¥ä¸å†æ˜¯â€œæ–°å¢æŒ‚è½½â€ï¼Œè€Œæ˜¯ï¼š
  - **æƒé™æ”¶ç´§**ï¼šå°† activities åŸŸæ‰€æœ‰ç«¯ç‚¹ç»Ÿä¸€åŠ  `requireAdmin`ï¼ˆç¬¦åˆä½ â€œä»…ç®¡ç†å‘˜â€å†³ç­–ï¼‰
  - **å‰ç«¯å¯¹é½**ï¼š`activity-conditions.html` æ˜ç¡®ä½¿ç”¨ `POST /api/v4/activities/:code/configure-conditions` å†™å…¥æ¡ä»¶ï¼ˆè½åˆ°`lottery_campaigns.participation_conditions`ï¼‰ï¼Œè¯»å–æ—¶ä½¿ç”¨`GET /api/v4/activities/:idOrCode/conditions`ï¼ˆæˆ–ç­‰ä»·è¯»æ¥å£ï¼‰
- **å…¨éƒ¨ç«¯ç‚¹åŠ `requireAdmin`**ï¼ˆ**å·²å†³ç­–ï¼šä¸å¯¹æ™®é€šç”¨æˆ·å¼€æ”¾**ï¼‰ï¼š
  - `GET /api/v4/activities/available`ï¼šè¿”å›æ´»åŠ¨åˆ—è¡¨ï¼ˆç®¡ç†å‘˜æŸ¥çœ‹ï¼‰
  - `GET /api/v4/activities/:idOrCode/check-eligibility`ï¼šè¿”å›`eligible`+ä¸æ»¡è¶³åŸå› ï¼ˆç®¡ç†å‘˜æµ‹è¯•æ ¡éªŒç”¨ï¼‰
  - `POST /api/v4/activities/:idOrCode/participate`ï¼šè¿”å›`can_participate`ï¼ˆç®¡ç†å‘˜æ¨¡æ‹Ÿæµ‹è¯•ç”¨ï¼‰
  - `GET /api/v4/activities/:idOrCode/conditions`ï¼šè¿”å›å½“å‰`participation_conditions`ä¸`condition_error_messages`ï¼ˆä¾›åå°ç¼–è¾‘å™¨å›æ˜¾ï¼‰
  - `POST /api/v4/activities/:code/configure-conditions`ï¼šå†™å…¥`lottery_campaigns.participation_conditions/condition_error_messages`

**å‰ç«¯å¯¹é½**ï¼š

- `activity-conditions.html`ä¿ç•™ï¼Œå°†å…¶è¯»å†™è·¯å¾„ç»Ÿä¸€åˆ°ä¸Šè¿°`/api/v4/activities/*`

**éªŒæ”¶**ï¼š

- é¡µé¢å¯å¯¹ä»»ä¸€æ´»åŠ¨ï¼šåŠ è½½æ¡ä»¶ â†’ ä¿®æ”¹ â†’ ä¿å­˜ â†’ å†æ¬¡åŠ è½½ä¸€è‡´
- çœŸå®DBï¼š`lottery_campaigns.participation_conditions`å­—æ®µè¢«æ­£ç¡®æ›´æ–°ï¼ˆæŠ½æ ·æ ¸å¯¹ï¼‰
- éç®¡ç†å‘˜è°ƒç”¨è¿”å›403

#### 6.4.2 é¢„è®¾æ¿€æ´»ï¼ˆ`presets.html`ï¼‰â€”â€”ä¸é€ â€œå‡activateâ€ï¼Œæ”¹æˆå¯¹é½ç°æœ‰æŠ½å¥–å¹²é¢„èƒ½åŠ›

**ç°çŠ¶é—®é¢˜ï¼ˆå·²å¯¹é½å½“å‰ä»£ç ï¼‰**ï¼š

- `presets.html`å½“å‰UIæ˜¯â€œé¢„è®¾åç§°/ç±»å‹/å¥–å“æ¦‚ç‡100%â€çš„**æ–¹æ¡ˆå‹é¢„è®¾**ï¼Œä½†å½“å‰åç«¯ä¸DBå¹¶ä¸å­˜åœ¨å¯¹åº”çš„â€œé¢„è®¾æ–¹æ¡ˆâ€è¡¨/æ¥å£
- åç«¯ç°æœ‰å¯ç”¨çš„â€œæŠ½å¥–å¹²é¢„/é¢„è®¾â€èƒ½åŠ›åœ¨`/api/v4/console/lottery-management/*`ï¼š
  - `POST /probability-adjust`ï¼ˆå·²åœ¨`users.html`é‡Œä½¿ç”¨ï¼‰
  - `POST /user-specific-queue`ï¼ˆç”¨æˆ·ä¸“å±é˜Ÿåˆ—ï¼Œå¯è§†ä¸ºâ€œæ¿€æ´»é¢„è®¾é˜Ÿåˆ—â€ï¼‰
  - `POST /force-win` / `POST /force-lose` / `GET /user-status/:user_id` / `POST /clear-user-settings/:user_id`

**ä¸€æ¬¡æ€§è¡¥é½å†³ç­–**ï¼š

- **ä¸æ–°å¢ä¸€ä¸ªè¯­ä¹‰ä¸æ¸…/ä¸ç°æœ‰æ¶æ„å†²çªçš„`activate`ç«¯ç‚¹**
- ç›´æ¥æŠŠ`presets.html`é‡æ„ä¸º**â€œæŠ½å¥–å¹²é¢„ä¸é¢„è®¾é˜Ÿåˆ—ç®¡ç†ï¼ˆè¿è¥å·¥å…·é¡µï¼‰â€**ï¼Œå¯¹é½ç°æœ‰consoleèƒ½åŠ›ï¼š
  - â€œæ¿€æ´»é¢„è®¾â€= è°ƒç”¨`/api/v4/console/lottery-management/user-specific-queue`å†™å…¥ç”¨æˆ·é˜Ÿåˆ—å¹¶è®¾ç½®æŒç»­æ—¶é—´ï¼ˆ`duration_minutes`ï¼‰
  - â€œæŸ¥çœ‹ç”Ÿæ•ˆçŠ¶æ€â€= è°ƒç”¨`/api/v4/console/lottery-management/user-status/:user_id`
  - â€œæ’¤é”€/æ¸…ç©ºâ€= è°ƒç”¨`/api/v4/console/lottery-management/clear-user-settings/:user_id`
  - â€œå¼ºåˆ¶ä¸­å¥–/ä¸ä¸­å¥–â€= å¯¹é½åˆ°`/force-win`ã€`/force-lose`

**å‰ç«¯é‡æ„è¦ç‚¹ï¼ˆä¸å†™ä»£ç ï¼Œä»…å®šä¹‰é¡µé¢å†…å®¹ï¼‰**ï¼š

- å¢åŠ â€œé€‰æ‹©ç›®æ ‡ç”¨æˆ·â€ï¼ˆå¤ç”¨`users.html`çš„æœç´¢/ç­›é€‰é€»è¾‘ï¼Œç»Ÿä¸€èµ°`/api/v4/console/user-management/users?search=`ï¼‰
- å¢åŠ â€œé˜Ÿåˆ—ç¼–è¾‘å™¨â€ï¼ˆè¾“å…¥`prize_id`åºåˆ—æˆ–ä»å¥–å“æ± é€‰æ‹©ï¼›é˜Ÿåˆ—ä¿å­˜å³ä¸ºæ¿€æ´»ï¼‰
- ç§»é™¤â€œæ¦‚ç‡æ€»å’Œ=100%â€è¿™ç±»ä¸ç°æœ‰åç«¯ä¸ä¸€è‡´çš„æ ¡éªŒä¸å­—æ®µ

**éªŒæ”¶**ï¼š

- åœ¨`lottery_management_settings`è¡¨èƒ½çœ‹åˆ°å¯¹åº”è®¾ç½®å†™å…¥ï¼ˆæŠ½æ ·æ ¸å¯¹ï¼‰
- ç”¨æˆ·çŠ¶æ€é¡µèƒ½æ˜¾ç¤ºé˜Ÿåˆ—/æ¦‚ç‡å¹²é¢„å·²ç”Ÿæ•ˆï¼›æ¸…ç†åçŠ¶æ€æ¶ˆå¤±

---

## 7. å®æ–½æ–¹æ¡ˆï¼ˆæŒ‰å½“å‰ä»£ç å¯¹é½è½åœ°ï¼‰

### 7.1 æ€»ä½“ç­–ç•¥

- **å…ˆä¿®å¤â€œé¡µé¢å­˜åœ¨ä½†æ— æ³•è”åŠ¨â€çš„é—®é¢˜ï¼ˆP0ï¼‰**ï¼šAPIè·¯å¾„ç»Ÿä¸€ + å…³é”®ä¸šåŠ¡å­—æ®µå¯¹é½ï¼ˆè§ç¬¬5.2/ç¬¬6.1ï¼‰
- **å†è¡¥é½Consoleç¼ºå¤±æ¨¡å—é¡µé¢ï¼ˆP0ï¼‰**ï¼šè®©`/api/v4/console`æ¯ä¸ªæ¨¡å—éƒ½æœ‰å¯¹åº”é¡µé¢å…¥å£ï¼ˆè§ç¬¬5.1/ç¬¬6.2ï¼‰
- **æœ€åè¡¥é½â€œåç«¯èƒ½åŠ›ç¼ºå£/æƒé™ä¸ä¸€è‡´/éœ€è¦æ–°å¢è§„èŒƒæš´éœ²â€çš„èƒ½åŠ›ï¼ˆP1/P2ï¼‰**ï¼šä¾‹å¦‚å…‘æ¢è®¢å•å…¨é‡ç®¡ç†ï¼ˆadmin-onlyæŸ¥è¯¢ç«¯ç‚¹ï¼‰ã€activitiesæƒé™æ”¶ç´§ï¼ˆä»…ç®¡ç†å‘˜ï¼‰ã€trade_orders/admin_operation_logs ç­‰ç¼ºå°‘consoleæŸ¥è¯¢è·¯ç”±ï¼ˆè§ç¬¬6.4/ç¬¬6.5ï¼‰

### 7.2 é˜¶æ®µ0ï¼ˆP0ï¼‰ï¼šAPIè·¯å¾„ä¸èƒ½åŠ›å¯¹é½ï¼ˆè®©ç°æœ‰é¡µé¢çœŸæ­£å¯ç”¨ï¼‰

æ‰§è¡Œæ–¹å¼ï¼ˆä¸æ¶‰åŠMySQLå®¢æˆ·ç«¯ï¼Œä»…åŸºäºå½“å‰åç«¯æŒ‚è½½è·¯å¾„ï¼‰ï¼š

- é€é¡µæŒ‰ç¬¬5.2è¡¨åš"è·¯å¾„å¯¹é½"ï¼Œç¡®ä¿é¡µé¢è¯·æ±‚ä¸å†å‡ºç°404ï¼ˆ**å·²å†³ç­–ï¼šåªæ”¹å‰ç«¯ï¼Œä¸åŠ åç«¯å…¼å®¹è·¯ç”±**ï¼‰
- `login.html`æ”¹ä¸º`/api/v4/console/auth/login`ï¼ˆ**å·²å†³ç­–**ï¼‰
- `diamond-accounts.html`æ”¹ä¸ºä½¿ç”¨`asset-adjustment`/èµ„äº§æµæ°´èƒ½åŠ›ï¼ˆ**å·²å†³ç­–ï¼šä¸åšdiamondæ¨¡å—**ï¼‰
- å¯¹äºâ€œåç«¯å­˜åœ¨ç¼ºå£/æƒé™ä¸ä¸€è‡´/å‰ç«¯æ— æ³•è”åŠ¨â€çš„èƒ½åŠ›ï¼ˆactivitiesæƒé™æ”¶ç´§ã€é¢„è®¾æ¿€æ´»/å¹²é¢„èƒ½åŠ›å¯¹é½ã€å…‘æ¢è®¢å•å…¨é‡ç®¡ç†ç­‰ï¼‰ï¼Œ**å·²å†³ç­–ä¸€æ¬¡æ€§è¡¥é½**ï¼ˆè§ç¬¬6.4/6.5ï¼‰
- å¯¹äº"ä¸šåŠ¡è§„åˆ™å·²è¿ç§»"çš„æ¨¡å—ï¼ˆå…‘æ¢å¸‚åœºï¼šæ—§virtual_value â†’ ç°ææ–™èµ„äº§æ”¯ä»˜ï¼‰ï¼Œå‰ç«¯å­—æ®µä¸äº¤äº’å¿…é¡»å¯¹é½åç«¯ç°è¡Œè§„åˆ™

### 7.3 é˜¶æ®µ1ï¼ˆP0ï¼‰ï¼šè¡¥é½Consoleç¼ºå¤±æ¨¡å—é¡µé¢ + æ•°æ®åº“è¡¨ç®¡ç†å…¥å£

å»ºè®®æ–°å¢é¡µé¢ï¼ˆæ–‡ä»¶åå¯æŒ‰ä½ å›¢é˜Ÿå‘½åä¹ æƒ¯è°ƒæ•´ï¼‰ï¼š

**Consoleæ¨¡å—è¦†ç›–**ï¼š

- `lottery-quota.html`ï¼šé…é¢è§„åˆ™CRUD + ç”¨æˆ·é…é¢çŠ¶æ€/åŠ æ¬¡æ•°/æ ¡éªŒ
- `asset-adjustment.html`ï¼šé€šç”¨èµ„äº§è°ƒæ•´ï¼ˆå«æ‰¹é‡ã€å¹‚ç­‰æç¤ºã€æŸ¥è¯¢ç”¨æˆ·balancesï¼‰
- `campaign-budget.html`ï¼šæ´»åŠ¨é¢„ç®—é…ç½®/validate/é¢„ç®—æ± è¡¥å……/é¢„ç®—çŠ¶æ€/ç”¨æˆ·BUDGET_POINTS
- `assets-portfolio.html`ï¼šè¿è¥èµ„äº§ä¸­å¿ƒï¼ˆoverview/items/detail/eventsï¼‰
- `image-resources.html`ï¼šå›¾ç‰‡ä¸Šä¼ /åˆ—è¡¨/ç»‘å®š/åˆ é™¤/æ¸…ç†
- `orphan-frozen.html`ï¼šå­¤å„¿å†»ç»“ detect/stats/cleanupï¼ˆå«dry-runï¼‰
- `merchant-points.html`ï¼šå•†å®¶ç§¯åˆ†å®¡æ ¸ç®¡ç†ï¼ˆå¯¹é½`/api/v4/console/merchant-points/*`ï¼‰
- `analytics.html` + `config-tools.html`ï¼šæ–°å¢å†³ç­–åˆ†æ/é…ç½®å·¥å…·é¡µï¼›`charts.html`/`statistics.html`ä¿ç•™å¹¶å®Œæˆè·¯å¾„/å‚æ•°å¯¹é½ï¼ˆè§0.2å†³ç­–ï¼‰

**æ•°æ®åº“è¡¨ç®¡ç†å…¥å£ï¼ˆP0ï¼‰**ï¼š

- `announcements.html`ï¼šç³»ç»Ÿå…¬å‘Šç®¡ç†ï¼ˆåç«¯å·²æœ‰`/console/system/announcements/*`ï¼Œåªéœ€è¡¥å‰ç«¯ï¼‰
- `feedbacks.html`ï¼šç”¨æˆ·åé¦ˆç®¡ç†ï¼ˆåç«¯å·²æœ‰`/console/system/feedbacks/*`ï¼Œåªéœ€è¡¥å‰ç«¯ï¼‰

**æ•°æ®åº“è¡¨ç®¡ç†å…¥å£ï¼ˆP1ï¼‰**ï¼š

- `trade-orders.html`ï¼šC2Cäº¤æ˜“è®¢å•ç®¡ç†ï¼ˆéœ€å…ˆè¡¥`/console/marketplace/trade-orders/*`è·¯ç”±ï¼‰
- `audit-logs.html`ï¼šæ“ä½œå®¡è®¡æ—¥å¿—æŸ¥çœ‹ï¼ˆéœ€å…ˆè¡¥`/console/system/audit-logs/*`è·¯ç”±ï¼‰
- `users.html`æ‰©å±•ï¼šé«˜çº§ä¼šå‘˜çŠ¶æ€ï¼ˆuser_premium_statusï¼‰ã€ç”¨æˆ·å±‚çº§ï¼ˆuser_hierarchyï¼‰å±•ç¤º
- `analytics.html`æ‰©å±•ï¼šæŠ½å¥–è®°å½•ï¼ˆlottery_drawsï¼‰æ¨¡å—

**æ•°æ®åº“è¡¨ç®¡ç†å…¥å£ï¼ˆP2ï¼‰**ï¼š

- `stores.html`ï¼šé—¨åº—ä¿¡æ¯ç®¡ç†ï¼ˆéœ€å…ˆè¡¥åç«¯æœåŠ¡/è·¯ç”±ï¼‰
- `user-hierarchy.html`ï¼šç”¨æˆ·å±‚çº§ç®¡ç†ï¼ˆå¦‚éœ€ç‹¬ç«‹é¡µé¢ï¼›æˆ–åœ¨users.htmlä¸­æ‰©å±•ï¼‰

### 7.4 é˜¶æ®µ2ï¼ˆP1/P2ï¼‰ï¼šè¡¥é½éƒ¨åˆ†è¦†ç›–ä¸å¯é€‰å¢å¼º

- **lottery-management**ï¼šè¡¥é½force-win/force-lose/é˜Ÿåˆ—/æ¸…ç†ç­‰å…¥å£ï¼ˆå¯åœ¨`users.html`ç”¨æˆ·è¯¦æƒ…æ‰©å±•æˆ–å•ç‹¬é¡µé¢ï¼‰
- **material**ï¼šä½™é¢/æµæ°´é¡µå¿…é¡»å¯¹é½ï¼ˆP0ï¼šæ”¹èµ°`asset-adjustment`æˆ–è¡¥é½materialç”¨æˆ·ç«¯ç‚¹ï¼‰ï¼›æ‰¹é‡è°ƒæ•´/å¯¼å‡ºä¸ºå¯é€‰å¢å¼º
- **diamond**ï¼š**å·²å†³ç­–ä¸å•ç‹¬åš**ï¼Œç»Ÿä¸€åœ¨"é€šç”¨èµ„äº§ä¸­å¿ƒ/èµ„äº§è°ƒæ•´"å¤„ç†
- **activity-conditions / presets**ï¼šactivitiesåŸŸå·²å…·å¤‡ä½†éœ€â€œä»…ç®¡ç†å‘˜â€æƒé™æ”¶ç´§ï¼›`presets.html`æŒ‰å†³ç­–é‡æ„ä¸ºæŠ½å¥–å¹²é¢„å·¥å…·é¡µï¼ˆP0æ‰§è¡Œï¼Œè§6.4ï¼‰

### 7.5 å®Œæˆåˆ¤å®šï¼ˆæ»¡è¶³ä½ â€œå…¨éƒ¨èƒ½åŠ›éƒ½è¦æœ‰é¡µé¢è”åŠ¨æŸ¥çœ‹æ•°æ®â€çš„æ ‡å‡†ï¼‰

- **Consoleè¦†ç›–**ï¼šç¬¬5.1ä¸­æ‰€æœ‰æ¨¡å—éƒ½ä¸ºâœ…ï¼ˆæˆ–æ˜ç¡®æ ‡æ³¨â€œä¸éœ€è¦é¡µé¢è¦†ç›–â€çš„å†…éƒ¨æ¨¡å—ï¼Œå¹¶ç»ä½ ç¡®è®¤ï¼‰
- **é¡µé¢å¯ç”¨æ€§**ï¼šç®¡ç†åå°æ‰€æœ‰é¡µé¢è¯·æ±‚å‡å‘½ä¸­æœ‰æ•ˆè·¯ç”±ï¼ˆæ— 404ï¼‰ï¼Œä¸”èƒ½å±•ç¤ºçœŸå®DBæ•°æ®
- **æ•°æ®å¯¹é½**ï¼šå…³é”®è¡¨ï¼ˆç¬¬4ç« ï¼‰æŠ½æ ·æ ¸å¯¹ï¼šé¡µé¢å±•ç¤ºçš„ç»Ÿè®¡/åˆ—è¡¨ä¸DBä¸€è‡´ï¼ˆè‡³å°‘æŒ‰çŠ¶æ€æšä¸¾ã€æ€»æ•°ã€åˆ†é¡µä¸€è‡´ï¼‰

### 7.6 åŠ¨æ€è”åŠ¨è¦æ±‚ï¼ˆä»¥æ•°æ®åº“/åç«¯ä¸ºæƒå¨ï¼‰

> ä½ æå‡ºâ€œåŠ¨æ€è”åŠ¨ç®¡ç†å‘˜ä¿®æ”¹å¥–å“é…ç½®ã€æ•°æ®å±•æ¿ç­‰â€ï¼Œè¿™é‡Œå°†å…¶å˜æˆ**å¼ºåˆ¶éªŒæ”¶æ¡æ¬¾**ï¼Œå¹¶æ˜ç¡®â€œä»¥DB/åç«¯ä¸ºå‡†â€ã€‚

#### 7.6.1 å¥–å“é…ç½®åŠ¨æ€è”åŠ¨ï¼ˆprize-poolï¼‰

- **æƒå¨æ•°æ®æº**ï¼š`lottery_prizes`ï¼ˆä»¥åŠå¥–å“æ± /åº“å­˜ç›¸å…³è¡¨ï¼‰ï¼Œä»¥`/api/v4/console/prize-pool/*`å†™å…¥åçš„ç»“æœä¸ºå‡†
- **åå°è¡Œä¸ºè¦æ±‚**ï¼š
  - ç®¡ç†å‘˜åœ¨`prizes.html`ä¿®æ”¹å¥–å“/åº“å­˜åï¼Œé¡µé¢å¿…é¡»ç«‹å³é‡æ–°æ‹‰å–å¹¶æ˜¾ç¤ºæœ€æ–°æ•°æ®ï¼ˆä¸å¾—ä»…åœ¨å‰ç«¯æœ¬åœ°â€œå‡æ›´æ–°â€ï¼‰
  - å¦‚æœåç«¯å­˜åœ¨ç¼“å­˜ï¼ˆä¾‹å¦‚PrizePoolService/Reportingç¼“å­˜ç­‰ï¼‰ï¼Œå¿…é¡»åœ¨åç«¯å†™æ“ä½œä¸­å®Œæˆå¤±æ•ˆæˆ–åˆ·æ–°ï¼Œä¿è¯åç»­è¯»è¯·æ±‚è¿”å›æœ€æ–°æ•°æ®
- **è”åŠ¨éªŒæ”¶**ï¼š
  - ä¿®æ”¹åç«‹å³åˆ·æ–°åˆ—è¡¨ä»ä¸€è‡´
  - ç›¸å…³ç»Ÿè®¡/å±•æ¿åœ¨ä¸‹ä¸€æ¬¡åˆ·æ–°å‘¨æœŸå†…åæ˜ å˜æ›´ï¼ˆè§7.6.2ï¼‰

#### 7.6.2 æ•°æ®å±•æ¿/æŠ¥è¡¨åŠ¨æ€è”åŠ¨ï¼ˆdashboard / charts / statisticsï¼‰

- **æƒå¨æ•°æ®æº**ï¼šçœŸå®DBèšåˆç»Ÿè®¡ï¼ˆåç«¯æŠ¥è¡¨æœåŠ¡çš„èšåˆç»“æœå¿…é¡»å¯è¿½æº¯åˆ°DBï¼‰
- **åå°è¡Œä¸ºè¦æ±‚**ï¼š
  - `dashboard.html`å¿…é¡»å±•ç¤º`/api/v4/console/system/dashboard`æœ€æ–°æ•°æ®ï¼ˆå…è®¸è½®è¯¢åˆ·æ–°ï¼›æœ¬é¡¹ç›®å·²ä½¿ç”¨å®šæ—¶åˆ·æ–°æ¨¡å¼ï¼‰
  - `charts.html`ä¸`statistics.html`éœ€å…ˆå®Œæˆè·¯å¾„å¯¹é½åˆ°`/api/v4/system/statistics/*`ï¼Œå¹¶ç¡®ä¿å±•ç¤ºçš„æ˜¯åç«¯å®æ—¶/å‡†å®æ—¶èšåˆç»“æœ
- **è”åŠ¨éªŒæ”¶**ï¼š
  - ç®¡ç†å‘˜ä¿®æ”¹å¥–å“é…ç½®/é¢„ç®—é…ç½®/ææ–™è§„åˆ™åï¼Œç›¸å…³ç»Ÿè®¡æŒ‡æ ‡åœ¨åˆç†å»¶è¿Ÿå†…å˜åŒ–ï¼ˆå»¶è¿Ÿç­–ç•¥éœ€æ˜ç¡®ï¼šå®æ—¶/1åˆ†é’Ÿ/5åˆ†é’Ÿï¼‰

#### 7.6.3 è¿è¥ç±»é…ç½®åŠ¨æ€è”åŠ¨ï¼ˆsettings / campaign-budget / lottery-quota / materialï¼‰

- **æƒå¨æ•°æ®æº**ï¼šæ•°æ®åº“é…ç½®è¡¨ï¼ˆä¾‹å¦‚`system_settings`ã€`lottery_campaigns`ã€`lottery_draw_quota_rules`ã€`material_*`ç­‰ï¼‰
- **åå°è¡Œä¸ºè¦æ±‚**ï¼š
  - ç®¡ç†åå°æ‰€æœ‰â€œä¿å­˜/æ›´æ–°â€æ“ä½œå¿…é¡»ä»¥æˆåŠŸå“åº”ä¸ºå‡†ï¼Œå¹¶åœ¨æˆåŠŸåç«‹å³å›è¯»ç¡®è®¤ï¼ˆé¡µé¢å›æ˜¾å¿…é¡»æ¥è‡ªåç«¯ï¼‰
  - æ¶‰åŠæ ¸å¿ƒä¸šåŠ¡è·¯å¾„çš„é…ç½®ï¼ˆé¢„ç®—ã€é…é¢ã€è½¬æ¢è§„åˆ™ï¼‰å¿…é¡»åšåˆ°â€œå†™åè¯»ä¸€è‡´â€ï¼Œå¹¶å¯¹ç”¨æˆ·ç«¯ç”Ÿæ•ˆ

---

## 8. é¡µé¢å¯¼èˆªæ¶æ„

### 8.1 å»ºè®®çš„èœå•ç»“æ„

```
ç®¡ç†åå°
â”œâ”€â”€ ğŸ“Š æ•°æ®æ¦‚è§ˆ
â”‚   â””â”€â”€ dashboard.htmlï¼ˆâœ… å·²å¯¹é½ï¼‰
â”‚
â”œâ”€â”€ ğŸ‘¥ ç”¨æˆ·ç®¡ç†
â”‚   â”œâ”€â”€ users.htmlï¼ˆâœ… å·²å¯¹é½ï¼Œå¾…æ‰©å±•ï¼šé«˜çº§ä¼šå‘˜çŠ¶æ€ã€ç”¨æˆ·å±‚çº§å±•ç¤ºï¼‰
â”‚   â””â”€â”€ ç”¨æˆ·å±‚çº§ç®¡ç†ï¼ˆuser-hierarchy.html âŒ å¾…æ–°å¢ï¼šå¯¹é½user_hierarchyè¡¨ï¼‰
â”‚
â”œâ”€â”€ ğŸ’ èµ„äº§ä¸ææ–™
â”‚   â”œâ”€â”€ ğŸ§© ææ–™èµ„äº§ç±»å‹ï¼ˆmaterial-asset-types.html âœ…ï¼‰
â”‚   â”œâ”€â”€ ğŸ”„ ææ–™è½¬æ¢è§„åˆ™ï¼ˆmaterial-conversion-rules.html âœ…ï¼‰
â”‚   â”œâ”€â”€ ğŸ§¾ ææ–™æµæ°´ï¼ˆmaterial-transactions.html ğŸ”´ï¼šå½“å‰åç«¯æœªå®ç°`/api/v4/console/material/transactions`ï¼›éœ€æ”¹é€ èµ°èµ„äº§æµæ°´/æ–°å¢ç®¡ç†å‘˜æµæ°´æŸ¥è¯¢ç«¯ç‚¹ï¼‰
â”‚   â”œâ”€â”€ ğŸ’° ææ–™ä½™é¢ï¼ˆmaterial-balances.html ğŸ”´ï¼šå½“å‰åç«¯æœªå®ç°`/api/v4/console/material/users/*`ä¸”`/api/v4/console/users/search`ä¸å­˜åœ¨ï¼›å»ºè®®èµ°`asset-adjustment` + `user-management`æœç´¢ï¼‰
â”‚   â”œâ”€â”€ ğŸ’ é’»çŸ³è´¦æˆ·ï¼ˆdiamond-accounts.html ğŸ”´ï¼šconsoleæœªæŒ‚è½½diamondæ¨¡å—ï¼›**å·²å†³ç­–**æ”¹é€ ä¸ºèµ°asset-adjustment/èµ„äº§æµæ°´ï¼Œé’»çŸ³=DIAMONDèµ„äº§ç±»å‹ï¼‰
â”‚   â”œâ”€â”€ ğŸ’° é€šç”¨èµ„äº§è°ƒæ•´ï¼ˆasset-adjustment.html âŒ å¾…æ–°å¢ï¼šå¯¹é½console asset-adjustmentï¼‰
â”‚   â””â”€â”€ ğŸ”§ å­¤å„¿å†»ç»“æ¸…ç†ï¼ˆorphan-frozen.html âŒ å¾…æ–°å¢ï¼šå¯¹é½console orphan-frozenï¼‰
â”‚
â”œâ”€â”€ ğŸ“¦ è¿è¥èµ„äº§ä¸­å¿ƒ
â”‚   â””â”€â”€ assets-portfolio.html âŒ å¾…æ–°å¢ï¼ˆå¯¹é½console assetsï¼šoverview/items/eventsï¼‰
â”‚
â”œâ”€â”€ ğŸª å¸‚åœºç®¡ç†
â”‚   â”œâ”€â”€ ğŸ“Š C2Cä¸Šæ¶ç»Ÿè®¡ï¼ˆmarketplace-stats.html âœ…ï¼‰
â”‚   â”œâ”€â”€ ğŸ“¦ C2Cäº¤æ˜“è®¢å•ï¼ˆtrade-orders.html âŒ å¾…æ–°å¢ï¼šéœ€å…ˆè¡¥`/console/marketplace/trade-orders/*`è·¯ç”±ï¼‰
â”‚   â”œâ”€â”€ ğŸ›’ B2Cå…‘æ¢å•†å“ï¼ˆexchange-market-items.html ğŸ”´ éœ€å¯¹é½è·¯å¾„/å­—æ®µåˆ°shop+console marketplaceï¼‰
â”‚   â”œâ”€â”€ ğŸ“¦ B2Cå…‘æ¢è®¢å•ï¼ˆexchange-market-orders.html ğŸ”´ éœ€å¯¹é½åˆ°shopï¼Œå«exchange_recordsï¼‰
â”‚   â””â”€â”€ ğŸ“Š B2Cå…‘æ¢ç»Ÿè®¡ï¼ˆexchange-market-stats.html ğŸ”´ éœ€å¯¹é½åˆ°shopï¼‰
â”‚
â”œâ”€â”€ ğŸ² æŠ½å¥–ç®¡ç†
â”‚   â”œâ”€â”€ ğŸ å¥–å“æ± é…ç½®ï¼ˆprizes.html âœ…ï¼‰
â”‚   â”œâ”€â”€ ğŸ¯ æŠ½å¥–é…é¢ç®¡ç†ï¼ˆlottery-quota.html âŒ å¾…æ–°å¢ï¼šå¯¹é½console lottery-quotaï¼‰
â”‚   â”œâ”€â”€ ğŸ’° æ´»åŠ¨é¢„ç®—é…ç½®ï¼ˆcampaign-budget.html âŒ å¾…æ–°å¢ï¼šå¯¹é½console campaign-budgetï¼‰
â”‚   â”œâ”€â”€ ğŸ æŠ½å¥–å¹²é¢„ä¸é¢„è®¾é˜Ÿåˆ—ï¼ˆpresets.html ğŸ”´ éœ€é‡æ„ï¼šå¯¹é½console lottery-managementï¼‰
â”‚   â””â”€â”€ âš™ï¸ æ´»åŠ¨æ¡ä»¶ï¼ˆactivity-conditions.html ğŸŸ¡ï¼šåç«¯å·²å…·å¤‡activitiesåŸŸï¼›éœ€â€œä»…ç®¡ç†å‘˜â€æƒé™æ”¶ç´§ + é¡µé¢è¯»å†™å¯¹é½ï¼‰
â”‚
â”œâ”€â”€ ğŸ›ï¸ å®¡æ ¸ä¸­å¿ƒ
â”‚   â”œâ”€â”€ ğŸ“ æ¶ˆè´¹è®°å½•å®¡æ ¸ï¼ˆconsumption.html ğŸ”´ï¼šéœ€å¯¹é½åˆ°`/api/v4/shop/consumption/*`ï¼‰
â”‚   â””â”€â”€ ğŸª å•†å®¶ç§¯åˆ†å®¡æ ¸ï¼ˆmerchant-points.html âŒ å¾…æ–°å¢ï¼šå¯¹é½`/api/v4/console/merchant-points/*`ï¼‰
â”‚
â”œâ”€â”€ ğŸ”” ç³»ç»Ÿç®¡ç†
â”‚   â”œâ”€â”€ ğŸ“¢ é€šçŸ¥ä¸­å¿ƒï¼ˆnotifications.html ğŸ”´ï¼šéœ€å¯¹é½åˆ°`/api/v4/system/notifications/*`ï¼Œå¹¶ä¿®æ­£clear/read-allç­‰HTTPæ–¹æ³•/è·¯å¾„ï¼‰
â”‚   â”œâ”€â”€ ğŸ“¢ ç³»ç»Ÿå…¬å‘Šï¼ˆannouncements.html âŒ å¾…æ–°å¢ï¼šå¯¹é½`/api/v4/console/system/announcements/*`ï¼‰
â”‚   â”œâ”€â”€ ğŸ“Š å›¾è¡¨å¯è§†åŒ–ï¼ˆcharts.html ğŸ”´ï¼šéœ€å¯¹é½åˆ°`/api/v4/system/statistics/charts`ï¼‰
â”‚   â”œâ”€â”€ ğŸ“Š æ•°æ®ç»Ÿè®¡æŠ¥è¡¨ï¼ˆstatistics.html ğŸ”´ï¼šéœ€å¯¹é½åˆ°`/api/v4/system/statistics/report|export`ï¼‰
â”‚   â”œâ”€â”€ ğŸ“Š è¿è¥åˆ†æï¼ˆanalytics.html âŒ å¾…æ–°å¢ï¼šå¯¹é½`/api/v4/console/analytics/*`ï¼Œå«æŠ½å¥–è®°å½•lottery_drawsï¼‰
â”‚   â”œâ”€â”€ ğŸ–¼ï¸ å¼¹çª—Bannerï¼ˆpopup-banners.html âœ…ï¼‰
â”‚   â”œâ”€â”€ ğŸ–¼ï¸ å›¾ç‰‡èµ„æºç®¡ç†ï¼ˆimage-resources.html âŒ å¾…æ–°å¢ï¼šå¯¹é½console imagesï¼‰
â”‚   â”œâ”€â”€ âš™ï¸ ç³»ç»Ÿè®¾ç½®ï¼ˆsettings.html âœ…ï¼‰
â”‚   â”œâ”€â”€ ğŸ§ª é…ç½®/æ¨¡æ‹Ÿå·¥å…·ï¼ˆconfig-tools.html âŒ å¾…æ–°å¢ï¼šå¯¹é½console configï¼‰
â”‚   â””â”€â”€ ğŸ“‹ å®¡è®¡æ—¥å¿—ï¼ˆaudit-logs.html âŒ å¾…æ–°å¢ï¼šå¯¹é½admin_operation_logsæŸ¥è¯¢ï¼‰
â”‚
â”œâ”€â”€ ğŸ’¬ ç”¨æˆ·åé¦ˆ
â”‚   â””â”€â”€ ğŸ“ åé¦ˆç®¡ç†ï¼ˆfeedbacks.html âŒ å¾…æ–°å¢ï¼šå¯¹é½`/api/v4/console/system/feedbacks/*`ï¼‰
â”‚
â”œâ”€â”€ ğŸª é—¨åº—ç®¡ç†
â”‚   â””â”€â”€ ğŸ“ é—¨åº—ä¿¡æ¯ï¼ˆstores.html âŒ å¾…æ–°å¢ï¼šéœ€å…ˆè¡¥åç«¯æœåŠ¡/è·¯ç”±ï¼‰
â”‚
â””â”€â”€ âš™ï¸ ç³»ç»Ÿè®¾ç½®
    â””â”€â”€ è®¤è¯/æƒé™ï¼ˆé€šè¿‡users.htmlä¸login.htmlè¦†ç›–ï¼›å¦‚éœ€ç‹¬ç«‹â€œæƒé™ç¼“å­˜å¤±æ•ˆâ€é¡µå¯å•ç‹¬è§„åˆ’ï¼‰
```

### 8.2 å¯¼èˆªå®æ–½å»ºè®®

**ä¸€çº§å¯¼èˆª**:

- æ•°æ®æ¦‚è§ˆ
- ç”¨æˆ·ç®¡ç†
- èµ„äº§ç®¡ç† â­ï¼ˆæ–°å¢ï¼Œæ ¸å¿ƒåŠŸèƒ½ï¼‰
- ææ–™ç³»ç»Ÿ â­ï¼ˆæ–°å¢ï¼Œæ ¸å¿ƒåŠŸèƒ½ï¼‰
- ç‰©å“ç®¡ç† â­ï¼ˆæ–°å¢ï¼‰
- å¸‚åœºç®¡ç†
- æŠ½å¥–ç®¡ç†
- æ¶ˆè´¹ç®¡ç†
- ç³»ç»Ÿç®¡ç†

**å¿«æ·å…¥å£**ï¼ˆDashboardï¼‰:

- å¾…å®¡æ ¸æ¶ˆè´¹è®°å½•
- å¾…å¤„ç†è®¢å•
- èµ„äº§å¼‚å¸¸å‘Šè­¦
- ç³»ç»Ÿé€šçŸ¥

---

## 9. éªŒè¯æ£€æŸ¥æ¸…å•

### 9.1 åŠŸèƒ½å®Œæ•´æ€§éªŒè¯

#### èµ„äº§ç®¡ç†æ¨¡å—

- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹æ‰€æœ‰èµ„äº§ç±»å‹ï¼ˆç§¯åˆ†/é’»çŸ³/ææ–™ï¼‰
- [ ] ç®¡ç†å‘˜å¯åˆ›å»ºå’Œç®¡ç†ææ–™èµ„äº§ç±»å‹
- [ ] ç®¡ç†å‘˜å¯é…ç½®ææ–™è½¬æ¢è§„åˆ™
- [ ] ç®¡ç†å‘˜å¯ç»Ÿä¸€è°ƒæ•´ç”¨æˆ·èµ„äº§ï¼ˆå•ä¸ª/æ‰¹é‡ï¼‰
- [ ] ç®¡ç†å‘˜å¯æŸ¥è¯¢ä»»æ„ç”¨æˆ·çš„èµ„äº§äº¤æ˜“è®°å½•
- [ ] ç®¡ç†å‘˜å¯æŸ¥è¯¢ææ–™èµ„äº§ä½™é¢åˆ†å¸ƒ
- [ ] ç®¡ç†å‘˜å¯æ£€æµ‹å’Œæ¸…ç†å­¤ç«‹å†»ç»“èµ„äº§
- [ ] æ‰€æœ‰èµ„äº§è°ƒæ•´æ“ä½œæœ‰å¹‚ç­‰æ€§ä¿è¯
- [ ] æ‰€æœ‰èµ„äº§è°ƒæ•´æ“ä½œæœ‰å®¡è®¡æ—¥å¿—

#### ç‰©å“å’Œå¸‚åœºç®¡ç†æ¨¡å—

- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹æ‰€æœ‰ç‰©å“å®ä¾‹
- [ ] ç®¡ç†å‘˜å¯æŒ‰çŠ¶æ€ç­›é€‰ç‰©å“å®ä¾‹
- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹ç‰©å“äº‹ä»¶å†å²
- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹C2Cå¸‚åœºæ‰€æœ‰æŒ‚å•
- [ ] ç®¡ç†å‘˜å¯å¼ºåˆ¶ä¸‹æ¶è¿è§„æŒ‚å•
- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹C2Cäº¤æ˜“è®¢å•
- [ ] ç®¡ç†å‘˜å¯å¤„ç†äº¤æ˜“çº çº·
- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹B2Cå•†å“ï¼ˆå¯å¤ç”¨`/api/v4/shop/exchange/items*`åœ¨adminç™»å½•ä¸‹è¿”å›fullæ•°æ®ï¼‰
- [ ] ç®¡ç†å‘˜å¯å…¨é‡æŸ¥çœ‹B2Cè®¢å•åˆ—è¡¨/è¯¦æƒ…ï¼ˆéœ€æ–°å¢admin-onlyæŸ¥è¯¢ç«¯ç‚¹ï¼›ç°çŠ¶ä»…æ”¯æŒæœ¬äººè®¢å•æŸ¥è¯¢+ç®¡ç†å‘˜çŠ¶æ€æ›´æ–°ï¼‰

#### æŠ½å¥–ç®¡ç†æ¨¡å—

- [ ] ç®¡ç†å‘˜å¯é…ç½®æŠ½å¥–æ´»åŠ¨é¢„ç®—æ± 
- [ ] ç®¡ç†å‘˜å¯éªŒè¯å¥–å“é…ç½®åˆç†æ€§
- [ ] ç®¡ç†å‘˜å¯æ‰‹åŠ¨è¡¥å……é¢„ç®—æ± 
- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹é¢„ç®—æ± å®æ—¶çŠ¶æ€
- [ ] ç®¡ç†å‘˜å¯åˆ›å»ºæŠ½å¥–é¢„è®¾ï¼ˆå·²æœ‰ï¼‰
- [ ] ç®¡ç†å‘˜å¯é…ç½®æ´»åŠ¨å‚ä¸æ¡ä»¶ï¼ˆå·²æœ‰ï¼‰

#### ç³»ç»Ÿç®¡ç†æ¨¡å—

- [ ] ç®¡ç†å‘˜å¯ç»Ÿä¸€ç®¡ç†å›¾ç‰‡èµ„æº
- [ ] ç®¡ç†å‘˜å¯åˆ é™¤æœªä½¿ç”¨çš„å›¾ç‰‡
- [ ] ç®¡ç†å‘˜å¯å‘é€å’Œç®¡ç†ç³»ç»Ÿé€šçŸ¥ï¼ˆå·²æœ‰ï¼‰
- [ ] ç®¡ç†å‘˜å¯æŸ¥çœ‹ç»¼åˆç»Ÿè®¡æŠ¥è¡¨ï¼ˆå·²æœ‰ï¼‰
- [ ] ç®¡ç†å‘˜å¯å¯¼å‡ºæ•°æ®æŠ¥è¡¨ï¼ˆå·²æœ‰ï¼‰

### 9.2 æ•°æ®ä¸€è‡´æ€§éªŒè¯

#### æ•°æ®åº“å¯¹é½æ£€æŸ¥

- [ ] æ‰€æœ‰æ•°æ®åº“è¡¨éƒ½æœ‰å¯¹åº”çš„æŸ¥è¯¢å…¥å£
- [ ] æ‰€æœ‰å…³é”®ä¸šåŠ¡æ•°æ®éƒ½å¯åœ¨å‰ç«¯æŸ¥çœ‹
- [ ] å‰ç«¯æ˜¾ç¤ºçš„æ•°æ®ä¸æ•°æ®åº“å®é™…æ•°æ®ä¸€è‡´
- [ ] æ•°æ®ç­›é€‰å’Œæœç´¢åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- [ ] åˆ†é¡µåŠŸèƒ½æ­£å¸¸å·¥ä½œ

#### APIå¯¹é½æ£€æŸ¥

- [ ] æ‰€æœ‰åç«¯Console APIéƒ½æœ‰å‰ç«¯è°ƒç”¨
- [ ] å‰ç«¯APIè°ƒç”¨å‚æ•°ç¬¦åˆåç«¯è¦æ±‚
- [ ] å‰ç«¯æ­£ç¡®å¤„ç†APIå“åº”ï¼ˆæˆåŠŸ/å¤±è´¥ï¼‰
- [ ] å‰ç«¯æ­£ç¡®å¤„ç†åˆ†é¡µå’Œç­›é€‰å‚æ•°
- [ ] å‰ç«¯æ­£ç¡®æºå¸¦è®¤è¯Token

### 9.3 ç”¨æˆ·ä½“éªŒéªŒè¯

#### ç•Œé¢ä¸€è‡´æ€§

- [ ] æ–°é¡µé¢ä¸ç°æœ‰é¡µé¢é£æ ¼ä¸€è‡´
- [ ] ä½¿ç”¨ç»Ÿä¸€çš„Bootstrap 5ç»„ä»¶
- [ ] ä½¿ç”¨ç»Ÿä¸€çš„é¢œè‰²å’Œå­—ä½“
- [ ] ä½¿ç”¨ç»Ÿä¸€çš„å›¾æ ‡åº“
- [ ] å“åº”å¼å¸ƒå±€åœ¨å„è®¾å¤‡æ­£å¸¸æ˜¾ç¤º

#### æ“ä½œä¾¿æ·æ€§

- [ ] å…³é”®æ“ä½œæœ‰å¿«æ·å…¥å£
- [ ] æœç´¢å’Œç­›é€‰åŠŸèƒ½æ˜“ç”¨
- [ ] æ‰¹é‡æ“ä½œåŠŸèƒ½å®Œå–„
- [ ] è¡¨å•éªŒè¯å‹å¥½
- [ ] é”™è¯¯æç¤ºæ¸…æ™°

#### æ€§èƒ½ä½“éªŒ

- [ ] åˆ—è¡¨é¡µåŠ è½½é€Ÿåº¦<2ç§’
- [ ] æœç´¢å“åº”é€Ÿåº¦<1ç§’
- [ ] å¤§æ•°æ®é‡åˆ—è¡¨æ”¯æŒåˆ†é¡µ
- [ ] å›¾ç‰‡åŠ è½½ä¼˜åŒ–ï¼ˆæ‡’åŠ è½½ï¼‰
- [ ] æ— æ˜æ˜¾å¡é¡¿ç°è±¡

### 9.4 å®‰å…¨æ€§éªŒè¯

#### æƒé™æ§åˆ¶

- [ ] æ‰€æœ‰ç®¡ç†é¡µé¢éœ€è¦ç®¡ç†å‘˜æƒé™
- [ ] Tokenè¿‡æœŸè‡ªåŠ¨è·³è½¬ç™»å½•
- [ ] æ•æ„Ÿæ“ä½œéœ€äºŒæ¬¡ç¡®è®¤
- [ ] å…³é”®æ“ä½œæœ‰æ“ä½œæ—¥å¿—
- [ ] æ•°æ®è„±æ•æ­£ç¡®å®æ–½

#### æ•°æ®å®‰å…¨

- [ ] å¹‚ç­‰æ€§æ§åˆ¶æ­£ç¡®å®æ–½
- [ ] å¹¶å‘æ“ä½œä¸ä¼šå¯¼è‡´æ•°æ®é”™è¯¯
- [ ] äº‹åŠ¡å›æ»šæœºåˆ¶æ­£å¸¸å·¥ä½œ
- [ ] æ•æ„Ÿæ•°æ®ä¸åœ¨å‰ç«¯æš´éœ²
- [ ] APIé”™è¯¯ä¿¡æ¯ä¸æ³„éœ²æ•æ„Ÿä¿¡æ¯

### 9.5 ä¸šåŠ¡é€»è¾‘éªŒè¯

#### èµ„äº§ç®¡ç†ä¸šåŠ¡

- [ ] èµ„äº§è°ƒæ•´åä½™é¢æ­£ç¡®æ›´æ–°
- [ ] æ‰¹é‡è°ƒæ•´æ”¯æŒäº‹åŠ¡å›æ»š
- [ ] ææ–™è½¬æ¢è§„åˆ™æ­£ç¡®æ‰§è¡Œ
- [ ] å†»ç»“èµ„äº§æ¸…ç†ä¸å½±å“æ­£å¸¸ä¸šåŠ¡
- [ ] èµ„äº§äº¤æ˜“è®°å½•å®Œæ•´å¯è¿½æº¯

#### å¸‚åœºç®¡ç†ä¸šåŠ¡

- [ ] æŒ‚å•ä¸‹æ¶åç‰©å“çŠ¶æ€æ­£ç¡®
- [ ] äº¤æ˜“è®¢å•å–æ¶ˆåèµ„äº§æ­£ç¡®é€€å›
- [ ] B2Cè®¢å•çŠ¶æ€æµè½¬æ­£ç¡®
- [ ] åº“å­˜æ‰£å‡å’Œæ¢å¤æ­£ç¡®
- [ ] è®¢å•å®Œæˆåèµ„äº§æ­£ç¡®è½¬ç§»

#### æŠ½å¥–ç®¡ç†ä¸šåŠ¡

- [ ] é¢„ç®—æ± é…ç½®åæŠ½å¥–æ­£å¸¸è¿›è¡Œ
- [ ] é¢„ç®—ä¸è¶³æ—¶æ­£ç¡®æç¤º
- [ ] å¥–å“é…ç½®éªŒè¯æ­£ç¡®
- [ ] æŠ½å¥–å¹²é¢„/é¢„è®¾é˜Ÿåˆ—â€œæ¿€æ´»â€åç”¨æˆ·ä¾§ç”Ÿæ•ˆï¼ˆå¯é€šè¿‡ç”¨æˆ·çŠ¶æ€æ¥å£ä¸æŠ½æ ·æŠ½å¥–éªŒè¯ï¼‰
- [ ] æ´»åŠ¨æ¡ä»¶é…ç½®æ­£ç¡®ç”Ÿæ•ˆï¼ˆæ¡ä»¶å†™å…¥DBå¹¶å¯¹ç”¨æˆ·ä¾§eligibilityç”Ÿæ•ˆï¼‰

---

## 10. é™„å½•

### 10.1 å…³é”®æŠ€æœ¯æ–‡æ¡£

- **Sequelize ORM**: https://sequelize.org/
- **Bootstrap 5**: https://getbootstrap.com/
- **Chart.js**: https://www.chartjs.org/
- **JWTè®¤è¯**: https://jwt.io/

### 10.2 é¡¹ç›®å…³é”®æ–‡ä»¶

- **æ•°æ®åº“é…ç½®**: `/home/devbox/project/config/database.js`
- **æ¨¡å‹å®šä¹‰**: `/home/devbox/project/models/`
- **Consoleè·¯ç”±**: `/home/devbox/project/routes/v4/console/`
- **å‰ç«¯é¡µé¢**: `/home/devbox/project/public/admin/`
- **å‰ç«¯å…¬å…±JS**: `/home/devbox/project/public/admin/js/admin-common.js`

### 10.3 æ•°æ®åº“è¿æ¥ä¸æ•°æ®æ ¡éªŒæ–¹å¼ï¼ˆåªè¯»ï¼‰

- ä½¿ç”¨ Node.js + Sequelizeï¼ˆè¯»å–`.env`ï¼‰è¿æ¥çœŸå®æ•°æ®åº“ï¼ˆæœ¬æ¬¡æ ¡éªŒåº“åä¸º`restaurant_points_dev`ï¼‰
- æœ€å°éªŒè¯ï¼šç¡®è®¤`SELECT DATABASE()`ç»“æœæ­£ç¡®ï¼›å¯¹å…³é”®è¡¨åš`COUNT(*)`ä¸çŠ¶æ€åˆ†å¸ƒç»Ÿè®¡ï¼ˆç¬¬4ç« å·²ç»™å‡ºå¿«ç…§ï¼‰
- åŸåˆ™ï¼š**åªè¯»ã€å¯å¤ç°ã€ä¸ä¾èµ–mysqlå®¢æˆ·ç«¯**

### 10.4 å‰ç«¯/æ¥å£å¯¹é½éªŒè¯æ–¹å¼ï¼ˆä¸å†™ä»£ç ï¼‰

- æ‰“å¼€ç®¡ç†åå°é¡µé¢ â†’ æµè§ˆå™¨å¼€å‘è€…å·¥å…· Network
- æ ¸æŸ¥æ¯ä¸ªé¡µé¢çš„è¯·æ±‚æ˜¯å¦å‘½ä¸­å½“å‰æŒ‚è½½åŸŸï¼ˆ`/api/v4/console`ã€`/api/v4/shop`ã€`/api/v4/system`ã€`/api/v4/lottery`ï¼‰
- éªŒæ”¶è¦æ±‚ï¼šæ— 404ï¼›åˆ†é¡µ/ç­›é€‰å‚æ•°ç”Ÿæ•ˆï¼›é¡µé¢ç»Ÿè®¡/åˆ—è¡¨ä¸ç¬¬4ç« å…³é”®è¡¨æŠ½æ ·ä¸€è‡´

---

## 11. æ€»ç»“

### 11.1 æ ¸å¿ƒå‘ç°

1. **Consoleæ¨¡å—å·²æ‰©å±•**ï¼šå½“å‰`/api/v4/console`å·²æŒ‚è½½19ä¸ªå­æ¨¡å—ï¼›ä½†`diamond`æ¨¡å—åœ¨consoleä¿¡æ¯ä¸­â€œå£°æ˜å­˜åœ¨â€å´æœªæŒ‚è½½ä¸”æ— è·¯ç”±æ–‡ä»¶ï¼ˆå±äºçœŸå®ç¼ºå£ï¼‰
2. **ç®¡ç†åå°é¡µé¢æ•°é‡æ›´å¤šä½†â€œå¯è”åŠ¨æ€§ä¸ä¸€è‡´â€**ï¼šå½“å‰`public/admin/`æœ‰22ä¸ªé¡µé¢ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†ä»åœ¨è°ƒç”¨æ—§è·¯å¾„/ä¸å­˜åœ¨çš„æ¥å£ï¼Œå¯¼è‡´â€œé¡µé¢æœ‰ä½†æ•°æ®è”åŠ¨å¤±è´¥â€
3. **çœŸå®æ•°æ®åº“æ•°æ®è§„æ¨¡æ˜ç¡®**ï¼šå·²é€šè¿‡ Node.js + Sequelize å¯¹`restaurant_points_dev`åšåªè¯»ç»Ÿè®¡ï¼ˆç¬¬4ç« ï¼‰ï¼Œå¯ç”¨äºéªŒæ”¶å¯¹é½æ•ˆæœ
4. **å®ç°è·¯å¾„æ˜ç¡®**ï¼šP0å…ˆåšâ€œè·¯å¾„/å­—æ®µå¯¹é½è®©é¡µé¢å¯ç”¨â€ï¼Œå†åšâ€œè¡¥é½consoleç¼ºå¤±æ¨¡å—é¡µé¢â€ï¼Œå¹¶åŒæ­¥è¡¥é½â€œåç«¯ç¼ºå£/æƒé™ä¸ä¸€è‡´â€ï¼ˆä¾‹å¦‚ï¼šå…‘æ¢è®¢å•å…¨é‡ç®¡ç†ã€activitiesä»…ç®¡ç†å‘˜æƒé™æ”¶ç´§ã€å®¡è®¡æ—¥å¿—/äº¤æ˜“è®¢å•ç­‰ç¼ºå°‘consoleæŸ¥è¯¢è·¯ç”±ï¼‰

### 11.2 å…³é”®ä¼˜å…ˆçº§ï¼ˆå·²æ‹æ¿ï¼‰

**ç«‹å³å®æ–½** (P0):

- æŒ‰ç¬¬5.2è¡¨ä¿®å¤ç°æœ‰é¡µé¢çš„APIè·¯å¾„/å­—æ®µå¯¹é½ï¼ˆ**å·²å†³ç­–ï¼šåªæ”¹å‰ç«¯ï¼Œä¸åŠ åç«¯å…¼å®¹è·¯ç”±**ï¼‰
- `login.html`ç»Ÿä¸€åˆ°`/api/v4/console/auth/*`ï¼ˆ**å·²å†³ç­–**ï¼‰
- `diamond-accounts.html`æ”¹é€ ä¸ºèµ°`asset-adjustment`/èµ„äº§æµæ°´ï¼ˆ**å·²å†³ç­–ï¼šä¸åšdiamondæ¨¡å—**ï¼‰
- è¡¥é½consoleç¼ºå¤±æ¨¡å—é¡µé¢ï¼š`lottery-quota` / `asset-adjustment` / `campaign-budget` / `assets` / `images` / `orphan-frozen` / `merchant-points` / `analytics` / `config`
- activities åŸŸï¼šå½“å‰å·²å…·å¤‡è·¯ç”±ä¸å®ç°ï¼ŒæŒ‰å†³ç­–éœ€è¦â€œä»…ç®¡ç†å‘˜â€æƒé™æ”¶ç´§å¹¶å®Œæˆç®¡ç†åå°é¡µé¢å¯¹é½
- é‡æ„`presets.html`ä¸ºæŠ½å¥–å¹²é¢„ç®¡ç†é¡µï¼Œå¯¹é½`console/lottery-management`
- **æ–°å¢**ï¼š`announcements.html`ï¼ˆç³»ç»Ÿå…¬å‘Šï¼Œåç«¯å·²æœ‰ï¼‰
- **æ–°å¢**ï¼š`feedbacks.html`ï¼ˆç”¨æˆ·åé¦ˆï¼Œåç«¯å·²æœ‰ï¼‰

**è¿‘æœŸå®æ–½** (P1):

- lottery-management å¼ºæ§èƒ½åŠ›å…¥å£è¡¥é½ï¼ˆforce-win/force-lose/é˜Ÿåˆ—/æ¸…ç†ç­‰ï¼‰
- material ä¾§è¡¥é½ç”¨æˆ·æœç´¢/æ‰¹é‡è°ƒæ•´ï¼ˆå¯é€‰ï¼‰
- **æ–°å¢**ï¼š`trade-orders.html`ï¼ˆC2Cäº¤æ˜“è®¢å•ï¼Œéœ€è¡¥consoleè·¯ç”±ï¼‰
- **æ–°å¢**ï¼š`audit-logs.html`ï¼ˆå®¡è®¡æ—¥å¿—ï¼Œéœ€è¡¥consoleè·¯ç”±ï¼‰
- **æ–°å¢**ï¼š`users.html`æ‰©å±•é«˜çº§ä¼šå‘˜çŠ¶æ€ï¼ˆuser_premium_statusï¼‰ã€ç”¨æˆ·å±‚çº§ï¼ˆuser_hierarchyï¼‰å±•ç¤º
- **æ–°å¢**ï¼š`analytics.html`æ‰©å±•æŠ½å¥–è®°å½•ï¼ˆlottery_drawsï¼‰æ¨¡å—

**åç»­ä¼˜åŒ–** (P2):

- ç»Ÿè®¡/å›¾è¡¨ä½“ç³»ä¸¤å¥—éƒ½ä¿ç•™ï¼ˆ`system/statistics` + `console/analytics`ï¼‰ï¼Œæ–°å¢`analytics.html`å¯¹é½console analytics
- **æ–°å¢**ï¼š`stores.html`ï¼ˆé—¨åº—ä¿¡æ¯ï¼Œéœ€è¡¥åç«¯æœåŠ¡/è·¯ç”±ï¼‰
- **æ–°å¢**ï¼š`user-hierarchy.html`ï¼ˆç”¨æˆ·å±‚çº§ç‹¬ç«‹é¡µé¢ï¼Œå¦‚éœ€ï¼‰

### 11.3 é¢„æœŸæˆæœ

å®Œæˆæœ¬æ–¹æ¡ˆåï¼ŒWebç®¡ç†å¹³å°å°†å®ç°:

- âœ… é¡µé¢ä¸åç«¯æŒ‚è½½è·¯å¾„å®Œå…¨ä¸€è‡´ï¼ˆä¸å†å‡ºç°â€œé¡µé¢æœ‰ä½†æ¥å£404â€ï¼‰
- âœ… `/api/v4/console`æ¯ä¸ªæ¨¡å—éƒ½æœ‰å¯¹åº”çš„ç®¡ç†åå°é¡µé¢å…¥å£ï¼ˆæˆ–ç»ä½ ç¡®è®¤å¯ä¸åšé¡µé¢çš„å†…éƒ¨æ¨¡å—ï¼‰
- âœ… å…³é”®ä¸šåŠ¡æ•°æ®ï¼ˆç¬¬4ç« ï¼‰åœ¨ç®¡ç†ç«¯å¯æŸ¥å¯ç®¡ï¼Œå¹¶å¯ç”¨æŠ½æ ·æ–¹å¼ä¸çœŸå®DBå¯¹é½éªŒæ”¶
- âœ… å®Œæ•´çš„èµ„äº§ç®¡ç†ä½“ç³»
- âœ… å®Œæ•´çš„å¸‚åœºç®¡ç†ä½“ç³»
- âœ… å®Œæ•´çš„æŠ½å¥–ç®¡ç†ä½“ç³»
- âœ… ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒ
- âœ… å®Œå–„çš„æ•°æ®å®‰å…¨ä¿éšœ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.7ï¼ˆä»¥å½“å‰ä»£ç +çœŸå®DBä¸ºå‡†å®ŒæˆäºŒæ¬¡æ ¡éªŒï¼šè‡ªåŠ¨æå–é¡µé¢APIæ¸…å• + ä¿®æ­£consoleæ¨¡å—/ç»Ÿè®¡/å…‘æ¢/ææ–™ç­‰å·®å¼‚ï¼‰  
**æœ€åæ›´æ–°**: 2026å¹´01æœˆ09æ—¥  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ  
**çŠ¶æ€**: âœ… æ‰€æœ‰å†³ç­–å·²å®Œæˆï¼ˆè§0.2ï¼‰+ æ•°æ®åº“éªŒè¯é€šè¿‡ï¼ˆè§0.3/0.4/5.1.1ï¼‰+ å…¶ä»–æ•°æ®åº“è¡¨ç®¡ç†å…¥å£å·²å†³ç­–å…¨éƒ¨åšï¼ˆè§6.5ï¼‰ï¼Œå¯æŒ‰å®æ–½æ–¹æ¡ˆæ‰§è¡Œ
