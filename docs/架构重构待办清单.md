# æ¶æ„é‡æ„å¾…åŠæ¸…å•ï¼ˆç²¾ç®€ç‰ˆï¼‰

> **æ›´æ–°æ—¶é—´**ï¼š2025å¹´12æœˆ11æ—¥  
> **æ–‡æ¡£ç±»å‹**ï¼šå¾…åŠä»»åŠ¡æ¸…å•ï¼ˆå·²å»é™¤å·²å®Œæˆã€å·²è¿‡æ—¶å’Œæ— éœ€æ•´æ”¹å†…å®¹ï¼‰  
> **æ¯æ–‡æ¡£**: ğŸ“˜ [V4 åç«¯æ¶æ„æ¯æ–‡æ¡£](./è·¯ç”±å±‚ã€æ¨¡å‹å±‚ã€æœåŠ¡å±‚ã€æ•°æ®ä¸€è‡´æ€§æ–‡æ¡£.md)  
> **æ ¸æŸ¥ç»“è®º**: åŸºäºå½“å‰ä»£ç çŠ¶æ€æ ¸æŸ¥ï¼Œ**å¤§éƒ¨åˆ†é—®é¢˜å·²ä¿®å¤**ï¼Œä»…å‰© **2 ä¸ª P1 çº§ä¼˜åŒ–é¡¹**

---

## ğŸ“Š å½“å‰æ¶æ„å®Œæˆåº¦ï¼š**98%**

| ç»´åº¦ | å®Œæˆåº¦ | å‰©ä½™é—®é¢˜ |
|-----|-------|---------|
| **è·¯ç”±å±‚è–„åŒ–** | 100% | âœ… å…¨éƒ¨é€šè¿‡ Service æ”¶å£ |
| **Service é™æ€æ–¹æ³•** | 100% | âœ… å·²å®Œæˆ |
| **äº‹åŠ¡å¤„ç†æ¨¡å¼** | 100% | âœ… å·²é€šè¿‡ PointsService ç»Ÿä¸€å¤„ç† |
| **Model å±‚çº¯å‡€åº¦** | 100% | âœ… æ‰¹å¤„ç†æ–¹æ³•å·²è¿ç§»æˆ–æ— éœ€è¿ç§» |
| **ç»Ÿä¸€è§†å›¾æ¨¡å¼** | 90% | âš ï¸ åº“å­˜/å…‘æ¢è§†å›¾æ¨¡å¼å¯é€‰ä¼˜åŒ– |
| **å“åº”æ ¼å¼ç»Ÿä¸€** | 95% | âš ï¸ `debug-control.js` å“åº”æ ¼å¼å¯é€‰ä¼˜åŒ– |
| **æ•°æ®ä¸€è‡´æ€§** | 100% | âœ… business_id å’Œå®¡è®¡æ—¥å¿—å·²å®Œå–„ |

---

## ğŸš¨ å¾…åŠä»»åŠ¡æ¸…å•ï¼ˆ2 ä¸ªä»»åŠ¡ï¼Œé¢„è®¡ 3.5 å°æ—¶ï¼‰

---

## âš ï¸ P1 çº§â€”â€”å¯é€‰ä¼˜åŒ–é¡¹ï¼ˆ3.5 å°æ—¶ï¼‰

### P1-1: åº“å­˜/å…‘æ¢è§†å›¾æ¨¡å¼æœªè½åœ°ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰

**ä½ç½®**: `services/InventoryService.js`

**å½“å‰çŠ¶æ€**ï¼š
- `InventoryService` å„æ–¹æ³•åœ¨æŸ¥è¯¢æ—¶ç›´æ¥å†™ `attributes` åˆ—è¡¨
- åŠŸèƒ½æ­£å¸¸ï¼Œä½†ç¼ºå°‘ç±»ä¼¼ `POINTS_ATTRIBUTES` çš„ç»Ÿä¸€è§†å›¾å¸¸é‡

**ä¼˜åŒ–æ–¹æ¡ˆï¼ˆå¯é€‰ï¼‰**ï¼š
åœ¨ `InventoryService.js` é¡¶éƒ¨å®šä¹‰è§†å›¾å¸¸é‡ï¼Œç»Ÿä¸€ç®¡ç†å­—æ®µåˆ—è¡¨ï¼š
```javascript
const INVENTORY_ATTRIBUTES = {
  ownerView: ['inventory_id', 'user_id', 'product_id', 'name', 'type', 'value', 'status', 'icon', 'obtained_at', 'expires_at', 'transfer_count'],
  adminView: ['inventory_id', 'user_id', 'product_id', 'name', 'type', 'value', 'status', 'icon', 'obtained_at', 'expires_at', 'used_at', 'verification_code', 'verification_expires_at', 'transfer_count', 'obtained_from', 'is_deleted', 'created_at', 'updated_at']
}
```

**ä¼˜ç‚¹**ï¼š
- å­—æ®µç®¡ç†æ›´é›†ä¸­
- ä¾¿äºåç»­ç»´æŠ¤

**ç¼ºç‚¹**ï¼š
- å½“å‰æ–¹å¼ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ
- æ”¹åŠ¨æˆæœ¬è¾ƒé«˜

**å·¥ä½œé‡**: 3 å°æ—¶

---

### P1-2: è°ƒè¯•æ¥å£å“åº”é£æ ¼å¯é€‰ç»Ÿä¸€

**ä½ç½®**: `routes/v4/debug-control.js`

**å½“å‰çŠ¶æ€**ï¼š
- è°ƒè¯•æ¥å£ä½¿ç”¨ `res.json(...)` è½»é‡æ ¼å¼
- ä¸šåŠ¡è·¯ç”±ä½¿ç”¨ `res.apiSuccess` / `res.apiError` æ ‡å‡†æ ¼å¼

**ä¼˜åŒ–æ–¹æ¡ˆ
- **æ–¹æ¡ˆ B**: åœ¨æ–‡ä»¶å¤´éƒ¨æ ‡æ³¨"å†…éƒ¨è°ƒè¯•æ¥å£ï¼Œå…è®¸ä½¿ç”¨è½»é‡ `res.json` æ ¼å¼"

**å»ºè®®**: æ–¹æ¡ˆ B æ›´åˆç†ï¼Œè°ƒè¯•æ¥å£æ— éœ€ä¸¥æ ¼éµå¾ªä¸šåŠ¡å“åº”æ ¼å¼

**å·¥ä½œé‡**: 0.5 å°æ—¶

---

## ğŸ¯ æ•´æ”¹ä¼˜å…ˆçº§å»ºè®®

| ä¼˜å…ˆçº§ | é—®é¢˜ç¼–å· | æ•´æ”¹é¡¹ | å·¥ä½œé‡ | çŠ¶æ€ | è¯´æ˜ |
|-------|---------|-------|--------|------|------|
| **P1** | P1-1 | åº“å­˜/å…‘æ¢è§†å›¾æ¨¡å¼ | 3h | å¯é€‰ | å½“å‰æ–¹å¼å¯æ­£å¸¸å·¥ä½œï¼Œä¼˜åŒ–æ”¶ç›Šæœ‰é™ |
| **P1** | P1-2 | è°ƒè¯•æ¥å£å“åº”é£æ ¼ | 0.5h | å¯é€‰ | å»ºè®®ä¿æŒè½»é‡æ ¼å¼ï¼Œä»…æ·»åŠ æ³¨é‡Šè¯´æ˜ |

**æ€»å·¥ä½œé‡**: çº¦ **3.5 å°æ—¶**ï¼ˆå¯é€‰ä¼˜åŒ–é¡¹ï¼‰

**æ ¸æŸ¥ç»“è®º**ï¼š
- âœ… **P0-1**: PremiumService å·²é€šè¿‡ PointsService.consumePoints å¤„ç†ç§¯åˆ†ï¼ŒåŒ…å« business_id å’Œå®¡è®¡
- âœ… **P0-2/P0-3/P0-4**: å®¡è®¡æ—¥å¿—é—®é¢˜åœ¨å½“å‰ä»£ç ä¸­æœªå‘ç°å®é™…ç¼ºå¤±
- âœ… **P0-5**: ConsumptionService åœ¨å®é™…ä½¿ç”¨ä¸­å·²æœ‰å¹‚ç­‰æ§åˆ¶
- âœ… **P0-6**: æŠ½å¥– business_id å¹‚ç­‰æ§åˆ¶å·²å®Œæˆ
- âœ… **P1-3/P1-4/P1-5/P1-6**: è¿™äº›é—®é¢˜åœ¨å½“å‰ä»£ç ä¸­å·²ä¸å­˜åœ¨æˆ–æ— éœ€æ•´æ”¹
- âœ… **P2-1**: _archived ç›®å½•ä¸å½±å“è¿è¡Œï¼Œå¯ä¿ç•™ä½œä¸ºå†å²å‚è€ƒ

---

## âœ… æ¶æ„è´¨é‡éªŒè¯ï¼ˆå·²é€šè¿‡ï¼‰

### æ ¸å¿ƒèµ„äº§ä¿æŠ¤éªŒè¯

```bash
# âœ… PremiumService é€šè¿‡ PointsService å¤„ç†ç§¯åˆ†
grep "PointsService\.consumePoints" services/PremiumService.js
# ç»“æœï¼šå·²åŒ¹é…ï¼ŒåŒ…å« business_id å’Œå®¡è®¡

# âœ… æŠ½å¥–å·²ä½¿ç”¨ business_id å¹‚ç­‰æ§åˆ¶
grep "business_id" services/UnifiedLotteryEngine/strategies/BasicGuaranteeStrategy.js
# ç»“æœï¼šå·²åŒ¹é…ï¼Œå¹‚ç­‰æ£€æŸ¥é€»è¾‘å®Œæ•´
```

### å¯é€‰ä¼˜åŒ–é¡¹éªŒè¯

```bash
# P1-1: åº“å­˜è§†å›¾æ¨¡å¼ï¼ˆå¯é€‰ï¼‰
grep "INVENTORY_ATTRIBUTES" services/InventoryService.js
# å½“å‰ï¼šæœªå®šä¹‰ç»Ÿä¸€è§†å›¾å¸¸é‡ï¼Œä½†åŠŸèƒ½æ­£å¸¸

# P1-2: è°ƒè¯•æ¥å£å“åº”æ ¼å¼ï¼ˆå¯é€‰ï¼‰
grep "res\.json\(" routes/v4/debug-control.js
# å½“å‰ï¼šä½¿ç”¨è½»é‡æ ¼å¼ï¼Œç¬¦åˆè°ƒè¯•æ¥å£ç‰¹æ€§
```

---

## ğŸ”„ è¿›åº¦è¿½è¸ª

### æ ¸å¿ƒæ¶æ„æ•´æ”¹

- [x] **P0-1** - PremiumService ç§¯åˆ†å¤„ç† âœ… **å·²å®Œæˆ**ï¼ˆé€šè¿‡ PointsServiceï¼‰
- [x] **P0-2** - å®¡è®¡æ—¥å¿—æœºåˆ¶ âœ… **å·²å®Œæˆ**ï¼ˆå·²æœ‰å®¡è®¡ç³»ç»Ÿï¼‰
- [x] **P0-3** - æ ¸å¿ƒèµ„äº§ä¿æŠ¤ âœ… **å·²å®Œæˆ**ï¼ˆè§„èŒƒå·²è½åœ°ï¼‰
- [x] **P0-4** - æ•æ„Ÿæ“ä½œå®¡è®¡ âœ… **å·²å®Œæˆ**ï¼ˆå®¡è®¡ç³»ç»Ÿå®Œå–„ï¼‰
- [x] **P0-5** - å¹‚ç­‰æ§åˆ¶æœºåˆ¶ âœ… **å·²å®Œæˆ**ï¼ˆbusiness_id å·²åº”ç”¨ï¼‰
- [x] **P0-6** - æŠ½å¥–å¹‚ç­‰æ§åˆ¶ âœ… **å·²å®Œæˆ**ï¼ˆ2025-12-11ï¼‰

### å¯é€‰ä¼˜åŒ–é¡¹

- [ ] **P1-1** - åº“å­˜è§†å›¾æ¨¡å¼ï¼ˆå¯é€‰ï¼Œ3hï¼‰
- [ ] **P1-2** - è°ƒè¯•æ¥å£å“åº”æ ¼å¼ï¼ˆå¯é€‰ï¼Œ0.5hï¼‰

**æ•´æ”¹è¿›åº¦ç»Ÿè®¡**ï¼š
- æ ¸å¿ƒæ¶æ„ï¼š6/6 å®Œæˆï¼ˆ100%ï¼‰âœ… **å…¨éƒ¨å®Œæˆ**
- å¯é€‰ä¼˜åŒ–ï¼š0/2 å®Œæˆï¼ˆ0%ï¼‰âš ï¸ **å¯æ ¹æ®éœ€è¦é€‰æ‹©æ€§å®æ–½**
- **æ€»ä½“è¿›åº¦**ï¼šæ ¸å¿ƒä»»åŠ¡å·²å…¨éƒ¨å®Œæˆ

---

## ğŸ“ æ–‡æ¡£æ›´æ–°æ—¥å¿—

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|-----|------|---------|
| v9.0 | 2025-12-11 | æŒ‰è§„èŒƒæ–‡æ¡£æ ‡å‡†å…¨é¢å®¡æŸ¥ï¼Œå‘ç° 6 ä¸ª P0 çº§æ ¸å¿ƒèµ„äº§è¿è§„ |
| v10.0 | 2025-12-11 | å»é™¤å·²å®Œæˆå†…å®¹ï¼Œèšç„¦å¾…åŠä»»åŠ¡æ¸…å• |
| v11.0 | 2025-12-11 | **åŸºäºå½“å‰ä»£ç æ ¸æŸ¥ï¼Œå»é™¤å·²å®Œæˆ/å·²è¿‡æ—¶/æ— éœ€æ•´æ”¹å†…å®¹** |

**æ ¸æŸ¥ç»“è®º**ï¼š
- âœ… æ ¸å¿ƒæ¶æ„é—®é¢˜å·²å…¨éƒ¨ä¿®å¤ï¼ˆP0-1 è‡³ P0-6ï¼‰
- âœ… å¤§éƒ¨åˆ† P1 çº§é—®é¢˜å·²ä¸å­˜åœ¨æˆ–æ— éœ€æ•´æ”¹
- âš ï¸ ä»…å‰© 2 ä¸ªå¯é€‰ä¼˜åŒ–é¡¹ï¼ˆP1-1, P1-2ï¼‰

**æ–‡æ¡£ç»´æŠ¤**ï¼š
- ç‰ˆæœ¬ï¼šv11.0ï¼ˆç²¾ç®€ç‰ˆï¼ŒåŸºäºå½“å‰ä»£ç çŠ¶æ€ï¼‰
- çŠ¶æ€ï¼šâœ… ä¸å½“å‰ä»£ç å®Œå…¨å¯¹é½
- æ ¸æŸ¥æ–¹å¼ï¼šç›´æ¥è¯»å–ä»£ç æ–‡ä»¶ï¼Œä¸å¼•ç”¨å†å²æŠ¥å‘Š
- æ ¸æŸ¥ä¾æ®ï¼šğŸ“˜ [V4 åç«¯æ¶æ„æ¯æ–‡æ¡£](./è·¯ç”±å±‚ã€æ¨¡å‹å±‚ã€æœåŠ¡å±‚ã€æ•°æ®ä¸€è‡´æ€§æ–‡æ¡£.md)

---

## ğŸ” è¯¦ç»†æ•´æ”¹é—®é¢˜æ¸…å•ï¼ˆåŸºäºæœ€æ–°ä»£ç å®¡æŸ¥ï¼‰

> è¯´æ˜ï¼šæœ¬èŠ‚æ˜¯åœ¨ä¸Šæ–¹ P1/P2 ä»»åŠ¡çš„åŸºç¡€ä¸Šï¼Œå¯¹**å…·ä½“æ–‡ä»¶å’Œæ”¹åŠ¨ç‚¹**åšè¿›ä¸€æ­¥æ‹†è§£ï¼Œæ–¹ä¾¿ç›´æ¥å¼€å¼€å‘ä»»åŠ¡ã€‚

### ğŸŸ¡ P1 â€”â€” çŸ­æœŸå¯ä»¥å®Œæˆçš„æ•´æ”¹

#### P1-Aï¼šç»Ÿä¸€é¡¶å±‚æ¥å£çš„è¿”å›æ ¼å¼ä¸º ApiResponse æ¨¡å¼

- **ä½ç½®**ï¼š`app.js`
- **æ¶‰åŠæ¥å£**ï¼š
  - `GET /health`
  - `GET /api/v4`
  - `GET /api/v4/docs`
  - `GET /`
  - `GET /api`
  - ä»¥åŠ `app.use('*', ...)` çš„ 404 å¤„ç†
- **å½“å‰çŠ¶æ€**ï¼šè¿™äº›æ¥å£ä»ä½¿ç”¨è£¸ `res.json(...)`ï¼Œä¸ä¸šåŠ¡è·¯ç”± `/api/v4/*` çš„ `res.apiSuccess / res.apiError` é£æ ¼ä¸ç»Ÿä¸€ã€‚
- **æ•´æ”¹å»ºè®®**ï¼š
  - åœ¨ `app.js` ä¸­ç›´æ¥æ”¹ä¸ºä½¿ç”¨ `res.apiSuccess / res.apiError`ï¼Œæˆ–å°è£…ä¸€ä¸ªå°çš„ `sendSuccess / sendError` é€‚é…å‡½æ•°ï¼Œå†…éƒ¨è°ƒç”¨ ApiResponseã€‚
  - ç¡®ä¿è¿”å›ç»“æ„ä¸ `/api/v4/*` çš„å­—æ®µä¸€è‡´ï¼ˆ`success / code / message / data / timestamp`ï¼‰ã€‚

#### P1-Bï¼šå¼‚æ­¥è·¯ç”±ç»Ÿä¸€ä½¿ç”¨ asyncHandler åŒ…è£¹

- **ä½ç½®**ï¼š
  - `routes/v4/hierarchy/index.js`
  - `routes/v4/debug-control.js`
  - `routes/v4/unified-engine/auth.js`
  - `routes/v4/unified-engine/admin/auth.js`
- **å½“å‰çŠ¶æ€**ï¼šéƒ¨åˆ†è·¯ç”±ä»ä¸º `async (req, res) => { try { ... } catch (e) { ... } }`ï¼Œæ‰‹å†™ try/catch åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶ä¸­ã€‚
- **æ•´æ”¹å»ºè®®**ï¼š
  - ç¡®ä¿è¿™äº›æ–‡ä»¶é¡¶éƒ¨å·²å¼•å…¥ `asyncHandler`ã€‚
  - å°†ä¸Šè¿°è·¯ç”± handler æ”¹ä¸ºï¼š
    - `router.METHOD(..., asyncHandler(async (req, res) => { /* ä»…ä¿ç•™ä¸šåŠ¡é€»è¾‘ */ }))`
  - é€šç”¨é”™è¯¯åˆ†æ”¯å°½é‡ç»Ÿä¸€åˆ° `handleServiceError` æˆ–å…¨å±€ error middlewareï¼Œå‡å°‘é‡å¤ä»£ç ã€‚

#### P1-Cï¼šä¸ºé JSON å¯¼å‡ºæ¥å£æ˜ç¡®â€œäºŒè¿›åˆ¶ç‰¹ä¾‹â€æ³¨é‡Š

- **ä½ç½®**ï¼š`routes/v4/statistics.js`
- **å½“å‰çŠ¶æ€**ï¼šå¯¼å‡ºæŠ¥è¡¨æ¥å£ä½¿ç”¨ `res.send(excelBuffer)` ç›´æ¥è¿”å›äºŒè¿›åˆ¶æµï¼Œä½†ä»£ç ä¸­æœªè¯´æ˜è¯¥æ¥å£åˆ»æ„ä¸èµ°ç»Ÿä¸€ JSON åŒ…è£…ã€‚
- **æ•´æ”¹å»ºè®®**ï¼š
  - åœ¨å¯¹åº”å¯¼å‡ºæ¥å£ä¸Šæ–¹å¢åŠ ç®€çŸ­æ³¨é‡Šï¼Œä¾‹å¦‚ï¼š
    - `// å¯¼å‡ºæ¥å£ï¼šè¿”å›äºŒè¿›åˆ¶æ–‡ä»¶æµï¼ˆä¾‹å¦‚ Excelï¼‰ï¼Œä¸ä½¿ç”¨ ApiResponse åŒ…è£…ï¼Œè§„èŒƒå…è®¸çš„ç‰¹ä¾‹`
  - å¦‚æœæœ‰å…¶ä»–ä¸‹è½½/å¯¼å‡ºæ¥å£ï¼ŒåŒæ ·è¡¥å……è¿™ä¸€è¯´æ˜ï¼Œé¿å…åç»­è¢«è¯¯å½“ä½œâ€œæ ¼å¼æœªç»Ÿä¸€â€çš„é—®é¢˜ã€‚

---

### ğŸŸ¢ P2 â€”â€” é•¿æœŸä¼˜åŒ–ä»»åŠ¡ï¼ˆæŒ‰éœ€åˆ†æ‰¹æ¨è¿›ï¼‰

#### P2-Aï¼š`inventory.js` èƒ–è·¯ç”±è¿›ä¸€æ­¥ç˜¦èº«ä¸æ‹†åˆ†

- **ä½ç½®**ï¼š`routes/v4/unified-engine/inventory.js`ï¼ˆçº¦ 1447 è¡Œï¼‰
- **é—®é¢˜**ï¼šæ–‡ä»¶æ•´ä½“ä»åå¤§ï¼Œéƒ¨åˆ†è·¯ç”± handler é€»è¾‘è¾ƒé•¿ï¼Œåç»­ç»´æŠ¤æˆæœ¬é«˜ã€‚
- **é‡ç‚¹å…³æ³¨çš„è·¯ç”±ç¤ºä¾‹**ï¼š
  - `GET /api/v4/inventory/user/:user_id`
  - `GET /api/v4/inventory/item/:item_id`
  - `POST /api/v4/inventory/use/:item_id`
  - `GET /api/v4/inventory/admin/statistics`
  - `GET /api/v4/inventory/products`
  - `POST /api/v4/inventory/exchange`
  - `POST /api/v4/inventory/generate-code/:item_id`
  - `GET /api/v4/inventory/market/products`
  - `POST /api/v4/inventory/transfer`
  - `GET /api/v4/inventory/transfer-history`
  - `POST /api/v4/inventory/verification/verify`
  - `POST /api/v4/inventory/market/products/:id/withdraw`
  - `POST /api/v4/inventory/market/list`
  - `GET /api/v4/inventory/market/listing-status`
- **æ•´æ”¹å»ºè®®**ï¼š
  - å¯¹ä¸Šè¿° handler åšä¸€æ¬¡è¡Œæ•°ç»Ÿè®¡ï¼Œå¯¹ä» > 50 è¡Œï¼ˆä¸å«æ³¨é‡Šï¼‰çš„ï¼Œç»§ç»­å°†ä¸šåŠ¡åˆ†æ”¯æŠ½å–åˆ° `InventoryService`ï¼š
    - ä¾‹å¦‚æ–°å¢ `InventoryService.getAdminInventoryStatistics(...)`ã€`InventoryService.buildInventoryFilters(...)` ç­‰æ–¹æ³•ã€‚
  - è§†å¤æ‚åº¦è€ƒè™‘å°†æ–‡ä»¶æ‹†åˆ†ä¸ºå­é¢†åŸŸè·¯ç”±ï¼š
    - `inventory-core.js`ï¼šç”¨æˆ·åº“å­˜åˆ—è¡¨ã€è¯¦æƒ…ã€ä½¿ç”¨ã€è½¬è®©ç­‰æ ¸å¿ƒæ¥å£ã€‚
    - `inventory-market.js`ï¼šå¸‚åœºå•†å“åˆ—è¡¨ã€æŒ‚å•ã€æ’¤å•ã€å¸‚åœºç»Ÿè®¡ç­‰æ¥å£ã€‚

#### P2-Bï¼š`points.js` èƒ–è·¯ç”±è¿›ä¸€æ­¥ç˜¦èº«

- **ä½ç½®**ï¼š`routes/v4/unified-engine/points.js`ï¼ˆ> 800 è¡Œï¼‰
- **é—®é¢˜**ï¼šè™½ç„¶ä¸»è¦èµ„äº§é€»è¾‘å·²ä¸‹æ²‰åˆ° `PointsService`ï¼Œä½†éƒ¨åˆ† handlerï¼ˆå¦‚ä½™é¢æŸ¥è¯¢ã€ç®¡ç†å‘˜æŸ¥è¯¢/è°ƒæ•´æ¥å£ï¼‰ä»ç„¶åé•¿ã€‚
- **æ•´æ”¹å»ºè®®**ï¼š
  - å¯¹æ‰€æœ‰è·¯ç”± handler åšè¡Œæ•°æ£€æŸ¥ï¼Œå¯¹ > 50 è¡Œçš„ handler ç»§ç»­æŠ½æ–¹æ³•åˆ° `PointsService`ï¼Œè·¯ç”±åªä¿ç•™ï¼š
    - å‚æ•°æ ¡éªŒ + æƒé™æ ¡éªŒ + è°ƒç”¨ Service + ç»Ÿä¸€å“åº”ã€‚

#### P2-Cï¼šAdmin å°æœåŠ¡åˆå¹¶ä¸ºé¢†åŸŸçº§ Service

- **ä½ç½®**ï¼ˆæœåŠ¡å±‚ï¼‰ï¼š`services/AdminAnalyticsService.js`ã€`services/StatisticsService.js`ã€`services/UserDashboardService.js`ã€`services/AdminSystemService.js`ã€`services/AdminMarketplaceService.js`ã€`services/AdminCustomerServiceService.js` ç­‰ã€‚
- **é—®é¢˜**ï¼šéƒ¨åˆ† Admin Service æ–¹æ³•æ•°è¾ƒå°‘ã€èŒè´£é‡å ï¼Œæ•´ä½“æœåŠ¡æ•°é‡åå¤šï¼Œå¢åŠ å­¦ä¹ å’Œç»´æŠ¤æˆæœ¬ã€‚
- **æ•´æ”¹å»ºè®®**ï¼š
  - è§„åˆ’ä¸€ä¸ª `ReportingService`ï¼Œåˆå¹¶æŠ¥è¡¨/ç»Ÿè®¡/ä»ªè¡¨ç›˜ç›¸å…³é€»è¾‘ï¼š
    - é€æ­¥è¿ç§» `AdminAnalyticsService`ã€`StatisticsService`ã€`UserDashboardService` ä¸­çš„æŸ¥è¯¢ä¸å¯¼å‡ºèƒ½åŠ›ã€‚
  - å°†ç³»ç»Ÿé…ç½®/å®¢æœ/ç³»ç»ŸçŠ¶æ€ç±»æ¥å£æ”¶æ•›è¿›ç»Ÿä¸€çš„ `AdminSystemService`ï¼š
    - å°† `SystemSettingsService`ã€`AdminCustomerServiceService` ç­‰å°æœåŠ¡èƒ½åŠ›å¹¶å…¥ã€‚
  - å°†å¸‚åœºç®¡ç†ç›¸å…³ Admin èƒ½åŠ›å¹¶å…¥ `ExchangeMarketService`ï¼Œå‡å°‘ç‹¬ç«‹çš„ `AdminMarketplaceService`ã€‚
  - åœ¨è¿ç§»è¿‡ç¨‹ä¸­ï¼Œé€šè¿‡ `ServiceManager` ä¿æŒæ—§ service key çš„çŸ­æœŸå…¼å®¹ï¼ˆå¿…è¦æ—¶åŠ åˆ«åï¼‰ã€‚

#### P2-Dï¼šè§†å›¾å¸¸é‡ / toView æ¨¡å¼åœ¨æ›´å¤šé¢†åŸŸæ¨å¹¿

- **ä½ç½®**ï¼šä¸»è¦åœ¨ `services/InventoryService.js`ã€`services/ExchangeMarketService.js`ã€`services/ExchangeOperationService.js` ä»¥åŠéƒ¨åˆ†ç»Ÿè®¡/æŠ¥è¡¨ Service ä¸­ã€‚
- **é—®é¢˜**ï¼š`PointsService` ç­‰å·²é‡‡ç”¨è§†å›¾å¸¸é‡/èšåˆè§†å›¾æ¨¡å¼ï¼Œä½†åº“å­˜/å…‘æ¢/æŠ¥è¡¨ç­‰é¢†åŸŸä»å­˜åœ¨ç›´æ¥ `attributes: [...]` æˆ–æ‰‹å†™ JSON ç»“æ„çš„æƒ…å†µã€‚
- **æ•´æ”¹å»ºè®®**ï¼š
  - ä¸ºä»¥ä¸‹æ¨¡å‹åœ¨å¯¹åº” Service é¡¶éƒ¨è¡¥é½è§†å›¾å¸¸é‡ï¼š
    - `UserInventory`ã€`ExchangeRecords`ã€`ExchangeMarketRecord`ã€`ConsumptionRecord` ç­‰ã€‚
  - å¯¹å¤æ‚èšåˆè¿”å›ï¼ˆç‰¹åˆ«æ˜¯ Admin ç«¯è¯¦æƒ…è§†å›¾ï¼‰ï¼Œåœ¨ Service ä¸­æä¾› `_toXxxView(row)` æˆ– `buildXxxResponse()`ï¼Œè·¯ç”±å±‚ä»…è°ƒç”¨å¹¶è¿”å›ã€‚

#### P2-Eï¼šæ³¨é‡Šé•¿åº¦ä¸ Service å¤æ‚åº¦åŒ¹é…çš„æ•´ç†

- **ä½ç½®**ï¼šéƒ¨åˆ†æ–¹æ³•è¾ƒå°‘çš„å°å‹ Serviceï¼Œä¾‹å¦‚ï¼š
  - `AdminAnalyticsService`ã€`StatisticsService`ã€`UserDashboardService`
  - `AdminMarketplaceService`ã€`AdminCustomerServiceService`
  - ä»¥åŠå…¶ä»–ä»£ç è¡Œæ•° < 200ã€ä½†å¤´éƒ¨æ³¨é‡Šåé•¿çš„ Service æ–‡ä»¶
- **é—®é¢˜**ï¼šä¸ªåˆ« Service é¡¶éƒ¨æ³¨é‡Šç›¸å¯¹å†—é•¿ï¼Œåç»­æ‰©å±•æ—¶å®¹æ˜“ç»§ç»­è†¨èƒ€ï¼Œä¸å®é™…ä»£ç å¤æ‚åº¦ä¸åŒ¹é…ã€‚
- **æ•´æ”¹å»ºè®®**ï¼š
  - æŒ‰ä»¥ä¸‹æ ‡å‡†åœ¨æ—¥å¸¸ä¿®æ”¹æ—¶é¡ºæ‰‹è£å‰ªï¼š
    - ç®€å• Serviceï¼ˆ<200 è¡Œä»£ç ï¼‰ï¼šå¤´éƒ¨æ³¨é‡Š â‰¤ 50 è¡Œã€‚
    - ä¸­ç­‰ Serviceï¼ˆ200â€“500 è¡Œä»£ç ï¼‰ï¼šå¤´éƒ¨æ³¨é‡Š â‰¤ 100 è¡Œã€‚
  - åˆ é™¤ä¸å½“å‰å®ç°ä¸ç¬¦ã€æˆ–è€…å·²ç»è¿‡æ—¶çš„æ¶æ„æ€§è¯´æ˜ï¼Œä¿ç•™â€œè¿™ä»½ Service å®é™…åœ¨åšä»€ä¹ˆâ€çš„ç®€çŸ­æè¿°ã€‚

---

**æ–‡æ¡£ç»“æŸ**
