# ç®¡ç†åå°ã€Œæ‰‹æœºå·ä¸»å¯¼æœç´¢ã€æ”¹é€ æ–¹æ¡ˆ

## 1. èƒŒæ™¯ä¸å†³ç­–

### 1.1 ç°çŠ¶é—®é¢˜

ç®¡ç†åå° **15+ ä¸ªé¡µé¢ã€30+ ä¸ªæœç´¢/è¾“å…¥æ¡†**è¦æ±‚è¿è¥äººå‘˜è¾“å…¥"ç”¨æˆ·ID"ï¼ˆæ•°æ®åº“è‡ªå¢ä¸»é”®ï¼‰ã€‚

è¿è¥äººå‘˜ä¸å¯èƒ½çŸ¥é“ç”¨æˆ·çš„å†…éƒ¨ IDã€‚å®é™…åœºæ™¯ä¸­ï¼Œé¤å…åº—å‘˜å’Œé¡¾å®¢çš„äº¤äº’çº½å¸¦æ˜¯**æ‰‹æœºå·**â€”â€”ç•™æ‰‹æœºå·åŠä¼šå‘˜ã€å¾®ä¿¡æˆæƒæ‰‹æœºå·ç™»å½•ã€æ¥å®¢è¯‰ç”µè¯ã€‚

### 1.2 è¡Œä¸šå¯¹æ ‡

æœ¬é¡¹ç›®å±äºã€Œå¾®ä¿¡å°ç¨‹åº + é¤é¥®æœ¬åœ°ç”Ÿæ´»ã€ç±»å‹ï¼Œä¸ä»¥ä¸‹äº§å“åŒç±»ï¼š

| äº§å“ | ç®¡ç†ç«¯æœç´¢æ–¹å¼ |
|---|---|
| ç¾å›¢å•†å®¶ç‰ˆ | æ‰‹æœºå· |
| å®¢å¦‚äº‘ / äºŒç»´ç« | æ‰‹æœºå· |
| å°ç¨‹åºæ´»åŠ¨å¹³å° | æ‰‹æœºå· |
| å¤§ä¼—ç‚¹è¯„å•†å®¶ä¸­å¿ƒ | æ‰‹æœºå· |

**ç»“è®º**ï¼šæ‰‹æœºå·ä¸»å¯¼æ˜¯æœ¬ç±»å‹é¡¹ç›®çš„è¡Œä¸šæ ‡å‡†åšæ³•ã€‚

### 1.3 å†³ç­–

- **ä¸»æœç´¢æ ‡è¯†**ï¼šæ‰‹æœºå·ï¼ˆç²¾ç¡®åŒ¹é…ï¼‰
- **è¾…åŠ©æœç´¢æ ‡è¯†**ï¼šæ˜µç§°ï¼ˆæ¨¡ç³ŠåŒ¹é…ï¼Œæ¬¡è¦åœºæ™¯ï¼‰
- **å½»åº•ç§»é™¤**ï¼šæ‰€æœ‰"ç”¨æˆ·ID"æœç´¢è¾“å…¥æ¡†
- **user_id å®šä½**ï¼šä»…åœ¨è¡¨æ ¼ä¸­ä½œä¸ºåªè¯»å‚è€ƒåˆ—æ˜¾ç¤ºï¼Œä¸ä½œä¸ºæœç´¢å…¥å£

---

## 2. æŠ€æœ¯æ–¹æ¡ˆ

### 2.1 åç«¯ï¼šæ–°å¢ resolve ç«¯ç‚¹

**æ–‡ä»¶**ï¼š`routes/v4/console/user_management.js`

```
GET /api/v4/console/user_management/users/resolve?mobile=13800138000
GET /api/v4/console/user_management/users/resolve?nickname=å¼ ä¸‰
```

**èŒè´£**ï¼š
- `mobile` å‚æ•°ï¼šç²¾ç¡®åŒ¹é… `users.mobile`ï¼Œè¿”å›å•ä¸ªç”¨æˆ·
- `nickname` å‚æ•°ï¼šæ¨¡ç³ŠåŒ¹é… `users.nickname`ï¼Œè¿”å›åˆ—è¡¨ï¼ˆæœ€å¤š 10 æ¡ï¼‰
- ä¸¤ä¸ªå‚æ•°äº’æ–¥ï¼Œä¸åš"è‡ªåŠ¨çŒœæµ‹è¾“å…¥ç±»å‹"

**è¿”å›ç»“æ„**ï¼š
```json
{
  "success": true,
  "data": {
    "user_id": 42,
    "mobile": "138****8000",
    "nickname": "å¼ ä¸‰",
    "status": "active",
    "avatar_url": null
  }
}
```

**è¦ç‚¹**ï¼š
- åœ¨ `authenticateToken` + `requireRoleLevel(100)` ä¿æŠ¤ä¸‹ï¼Œä»…ç®¡ç†å‘˜å¯ç”¨
- æ‰‹æœºå·æŸ¥è¯¢å¯ç›´æ¥å‘½ä¸­å·²æœ‰çš„ `BusinessCacheHelper.getUserByMobile` Redis ç¼“å­˜
- ä¸éœ€è¦æ–°å¢ Serviceï¼Œç›´æ¥è°ƒç”¨ `UserService.findByMobile()` + `User.findAll({ nickname LIKE })`

### 2.2 åç«¯ï¼šæ–°å¢ resolveUserParam ä¸­é—´ä»¶ï¼ˆå¯é€‰ï¼‰

**æ–‡ä»¶**ï¼š`middleware/resolveUserParam.js`

å¯¹äºè·¯å¾„å‚æ•°ä¸º `:user_id` çš„ç°æœ‰è·¯ç”±ï¼Œæ·»åŠ å¯é€‰ä¸­é—´ä»¶ï¼š
- æ£€æµ‹ `req.params.user_id` æ˜¯å¦ä¸º 11 ä½æ‰‹æœºå·æ ¼å¼
- å¦‚æœæ˜¯ â†’ `UserService.findByMobile()` è§£æä¸ºçœŸå® user_idï¼Œæ›¿æ¢ `req.params.user_id`
- å¦‚æœä¸æ˜¯ â†’ åŸæ ·é€ä¼ 

**å¥½å¤„**ï¼šç°æœ‰æ‰€æœ‰ `:user_id` è·¯ç”±é›¶æ”¹åŠ¨å³å¯åŒæ—¶æ¥å—æ‰‹æœºå·ã€‚

### 2.3 å‰ç«¯ï¼šæ–°å¢ userResolverMixin

**æ–‡ä»¶**ï¼š`admin/src/alpine/mixins/user-resolver.js`

**æä¾›çš„çŠ¶æ€**ï¼š
```
resolvedUser: null          // { user_id, mobile, nickname, status }
resolving: false            // æ­£åœ¨è§£æä¸­
resolveError: ''            // è§£æå¤±è´¥çš„é”™è¯¯ä¿¡æ¯
resolveMode: 'mobile'       // 'mobile' | 'nickname'
```

**æä¾›çš„æ–¹æ³•**ï¼š
```
resolveUserByMobile(mobile)    // æ‰‹æœºå·ç²¾ç¡®æŸ¥è¯¢
resolveUserByNickname(keyword) // æ˜µç§°æ¨¡ç³ŠæŸ¥è¯¢
clearResolvedUser()            // æ¸…ç©ºå·²è§£æç”¨æˆ·
```

**å†…ç½®ç¼“å­˜**ï¼šåŒä¸€æ‰‹æœºå·åœ¨é¡µé¢ä¼šè¯å†…ä¸é‡å¤è¯·æ±‚ï¼ˆMap å­˜å‚¨ï¼Œé¡µé¢åˆ·æ–°å³å¤±æ•ˆï¼‰ã€‚

**é›†æˆåˆ° createPageMixin**ï¼š
```js
createPageMixin({
  userResolver: true,  // æ–°å¢é…ç½®é¡¹
  pagination: true,
  // ...
})
```

### 2.4 å‰ç«¯ï¼šæ–°å¢ resolve API æ–¹æ³•

**æ–‡ä»¶**ï¼š`admin/src/api/user.js`

```js
// æ–°å¢
async resolveUser(params) {
  // params: { mobile } æˆ– { nickname }
  return await request({
    url: `${API_PREFIX}/console/user_management/users/resolve`,
    method: 'GET',
    params
  })
}
```

### 2.5 å‰ç«¯ï¼šæœç´¢è¾“å…¥æ¡†ç»Ÿä¸€æ”¹é€ 

#### æ”¹é€ æ¨¡å¼ A â€” ç­›é€‰å‹ï¼ˆç”¨äºåˆ—è¡¨é¡µçš„ç­›é€‰åŒºåŸŸï¼‰

**æ”¹é€ å‰**ï¼š
```html
<input type="text" x-model="filters.user_id" placeholder="ç”¨æˆ·ID">
```

**æ”¹é€ å**ï¼š
```html
<input type="text" x-model="filters.mobile" placeholder="è¯·è¾“å…¥æ‰‹æœºå·"
       maxlength="11" @keyup.enter="resolveAndSearch()">
```

- `x-model` ä» `filters.user_id` æ”¹ä¸º `filters.mobile`
- æäº¤æ—¶å…ˆè°ƒ `resolveUserByMobile()`ï¼Œè§£ææˆåŠŸåç”¨ `resolvedUser.user_id` è°ƒä¸šåŠ¡ API

#### æ”¹é€ æ¨¡å¼ B â€” å®šå‘æ“ä½œå‹ï¼ˆç”¨äº"ç»™æŸç”¨æˆ·åšæŸæ“ä½œ"çš„è¡¨å•ï¼‰

**æ”¹é€ å‰**ï¼š
```html
<label>ç”¨æˆ·ID *</label>
<input type="number" x-model="form.user_id" placeholder="è¯·è¾“å…¥ç”¨æˆ·ID">
```

**æ”¹é€ å**ï¼š
```html
<label>ç›®æ ‡ç”¨æˆ· *</label>
<div class="flex gap-2">
  <input type="text" x-model="form.mobile" placeholder="è¯·è¾“å…¥æ‰‹æœºå·"
         maxlength="11" @keyup.enter="resolveUser()">
  <button @click="resolveUser()">æŸ¥æ‰¾</button>
</div>
<!-- è§£ææˆåŠŸåæ˜¾ç¤ºç”¨æˆ·å¡ç‰‡ -->
<div x-show="resolvedUser" class="mt-2 p-2 bg-blue-50 rounded text-sm">
  âœ… <span x-text="resolvedUser?.nickname"></span>
  (<span x-text="resolvedUser?.mobile"></span>)
</div>
```

- è¿è¥è¾“å…¥æ‰‹æœºå· â†’ ç‚¹æŸ¥æ‰¾ â†’ æ˜¾ç¤ºç”¨æˆ·å¡ç‰‡ç¡®è®¤èº«ä»½ â†’ æäº¤æ“ä½œæ—¶ç”¨ `resolvedUser.user_id`

#### æ”¹é€ æ¨¡å¼ C â€” æ‰¹é‡å‹ï¼ˆç”¨äºæ‰¹é‡æ“ä½œï¼Œå¦‚æ‰¹é‡å‘é…é¢ï¼‰

**æ”¹é€ å‰**ï¼š
```html
<label>ç”¨æˆ·IDåˆ—è¡¨ *</label>
<textarea placeholder="è¾“å…¥ç”¨æˆ·IDï¼Œæ”¯æŒé€—å·åˆ†éš”"></textarea>
```

**æ”¹é€ å**ï¼š
```html
<label>æ‰‹æœºå·åˆ—è¡¨ *</label>
<textarea placeholder="è¾“å…¥æ‰‹æœºå·ï¼Œæ”¯æŒé€—å·ã€æ¢è¡Œåˆ†éš”&#10;ä¾‹å¦‚ï¼š13800001111, 13800002222"></textarea>
```

- æäº¤æ—¶æ‰¹é‡è°ƒ resolveï¼Œå…¨éƒ¨è§£ææˆåŠŸåå†æäº¤ä¸šåŠ¡æ“ä½œ
- è§£æå¤±è´¥çš„æ‰‹æœºå·é«˜äº®æç¤º"æœªæ‰¾åˆ°å¯¹åº”ç”¨æˆ·"

---

## 3. å—å½±å“æ–‡ä»¶æ¸…å•

### 3.1 åç«¯æ–°å¢ï¼ˆ2 ä¸ªæ–‡ä»¶ï¼‰

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|---|---|---|
| `routes/v4/console/user_management.js` | **ä¿®æ”¹** | æ–°å¢ `GET /users/resolve` è·¯ç”± |
| `middleware/resolveUserParam.js` | **æ–°å»º** | æ‰‹æœºå·è‡ªåŠ¨è§£æä¸­é—´ä»¶ï¼ˆå¯é€‰ï¼‰ |

### 3.2 å‰ç«¯æ–°å¢ï¼ˆ3 ä¸ªæ–‡ä»¶ï¼‰

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|---|---|---|
| `admin/src/alpine/mixins/user-resolver.js` | **æ–°å»º** | ç”¨æˆ·è§£æ mixin |
| `admin/src/alpine/mixins/index.js` | **ä¿®æ”¹** | æ³¨å†Œå¹¶å¯¼å‡ºæ–° mixin |
| `admin/src/api/user.js` | **ä¿®æ”¹** | æ–°å¢ `resolveUser()` API æ–¹æ³• |

### 3.3 å‰ç«¯é¡µé¢æ”¹é€ ï¼ˆ12 ä¸ª HTML + å¯¹åº” JSï¼‰

| é¡µé¢æ–‡ä»¶ | æ”¹é€ ç‚¹æ•° | æ”¹é€ æ¨¡å¼ | å…·ä½“å­—æ®µ |
|---|---|---|---|
| `finance-management.html` | 4 | AÃ—2 + BÃ—2 | consumptionFilters.user_id, diamondFilters.user_id, merchantFilters.user_id, diamondAdjustForm.user_id |
| `asset-management.html` | 4 | AÃ—4 | materialAccountFilters.user_id, logFilters.user_id, virtualAccountFilters.user_id, virtualTxFilters.user_id |
| `lottery-management.html` | 6 | AÃ—2 + BÃ—2 + CÃ—1 + AÃ—1 | searchUserId, presetFilters.user_id, createPresetForm.user_id, quotaForm.target_user_id, æ‰¹é‡é…é¢user_ids, redemptionFilters.user_id |
| `asset-adjustment.html` | 1 | B | form.user_id |
| `assets-portfolio.html` | 1 | A | searchForm.user_id |
| `user-management.html` | 5 | AÃ—3 + BÃ—2 | premiumFilters.user_id, roleHistoryFilters.user_id, statusHistoryFilters.user_id, å±‚çº§åˆ†é…form, é£æ§é…ç½®form |
| `trade-management.html` | 2 | AÃ—2 | tradeFilters.buyer_user_id, tradeFilters.seller_user_id |
| `sessions.html` | 1 | A | filters.user_id |
| `user-hierarchy.html` | 2 | A + B | filters.superior_user_id, form.user_id |
| `presets.html` | 2 | A + B | filters.user_search, userSearchKeyword |
| `customer-service.html` | 1 | A | ä¼šè¯ç­›é€‰ |
| `orphan-frozen.html` | 1 | A | ç­›é€‰æ¡ä»¶ |

**åˆè®¡**ï¼šçº¦ 30 ä¸ªè¾“å…¥æ¡†æ”¹é€ ç‚¹ã€‚

---

## 4. äº¤äº’è§„èŒƒ

### 4.1 æœç´¢æ¡†æ ‡å‡†äº¤äº’

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“± è¯·è¾“å…¥æ‰‹æœºå·               [ğŸ” æŸ¥è¯¢]     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ 13800138000             â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚  ğŸ’¡ ä¹Ÿå¯æŒ‰æ˜µç§°æœç´¢                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è§£ææˆåŠŸåï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… å¼ ä¸‰ (138****8000) Â· æ´»è·ƒ                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 äº¤äº’çŠ¶æ€

| çŠ¶æ€ | è¡¨ç° |
|---|---|
| ç©ºè¾“å…¥ | æ˜¾ç¤º placeholder "è¯·è¾“å…¥æ‰‹æœºå·" |
| è§£æä¸­ | æŒ‰é’®å˜ä¸º loading çŠ¶æ€ï¼Œè¾“å…¥æ¡†ç¦ç”¨ |
| è§£ææˆåŠŸ | è¾“å…¥æ¡†ä¸‹æ–¹æ˜¾ç¤ºç”¨æˆ·å¡ç‰‡ï¼ˆæ˜µç§° + è„±æ•æ‰‹æœºå· + çŠ¶æ€ï¼‰ |
| è§£æå¤±è´¥ | çº¢è‰²æç¤º"æœªæ‰¾åˆ°è¯¥æ‰‹æœºå·å¯¹åº”çš„ç”¨æˆ·" |
| æ ¼å¼é”™è¯¯ | çº¢è‰²æç¤º"è¯·è¾“å…¥ 11 ä½æ‰‹æœºå·" |

### 4.3 æ‰‹æœºå·æ ¼å¼æ ¡éªŒ

å‰ç«¯åœ¨è°ƒ API å‰åšåŸºç¡€æ ¡éªŒï¼š
- é•¿åº¦ 11 ä½
- ä»¥ 1 å¼€å¤´
- å…¨éƒ¨ä¸ºæ•°å­—

ä¸é€šè¿‡åˆ™ä¸å‘è¯·æ±‚ï¼Œç›´æ¥æç¤ºæ ¼å¼é”™è¯¯ã€‚

### 4.4 æ˜µç§°æœç´¢ï¼ˆæ¬¡è¦æ¨¡å¼ï¼‰

ç‚¹å‡»"ä¹Ÿå¯æŒ‰æ˜µç§°æœç´¢"åï¼š
- è¾“å…¥æ¡† placeholder åˆ‡æ¢ä¸º"è¯·è¾“å…¥æ˜µç§°å…³é”®è¯"
- è°ƒ `resolveUserByNickname()`ï¼Œè¿”å›åŒ¹é…åˆ—è¡¨ï¼ˆæœ€å¤š 10 æ¡ï¼‰
- è¿è¥ä»åˆ—è¡¨ä¸­ç‚¹é€‰ç›®æ ‡ç”¨æˆ·

---

## 5. ä¸æ”¹åŠ¨çš„éƒ¨åˆ†

| é¡¹ç›® | è¯´æ˜ |
|---|---|
| åç«¯ç°æœ‰ console è·¯ç”± | æ‰€æœ‰ `/users/:user_id/xxx` è·¯ç”±é›¶æ”¹åŠ¨ï¼Œç»§ç»­ç”¨ user_id |
| åç«¯ Service å±‚ | UserService / UserRoleService é›¶æ”¹åŠ¨ |
| åç«¯æ•°æ®åº“ | users è¡¨ç»“æ„é›¶æ”¹åŠ¨ï¼Œuser_id ä»ä¸ºä¸»é”® |
| å‰ç«¯è¡¨æ ¼ä¸­çš„ user_id åˆ— | ä¿ç•™ä¸ºåªè¯»å±•ç¤ºåˆ—ï¼Œæ–¹ä¾¿æŠ€æœ¯æ’æŸ¥ |
| ç”¨æˆ·ç®¡ç†ä¸»åˆ—è¡¨ | å·²æœ‰æ‰‹æœºå·æœç´¢ï¼ˆ`userFilters.phone`ï¼‰ï¼Œä¸éœ€è¦æ”¹ |

---

## 6. å®æ–½æ­¥éª¤

### Phase 1ï¼šåŸºç¡€è®¾æ–½ï¼ˆ0.5 å¤©ï¼‰

1. åç«¯ï¼šåœ¨ `user_management.js` æ–°å¢ `GET /users/resolve` è·¯ç”±
2. åç«¯ï¼šæ–°å»º `middleware/resolveUserParam.js`ï¼ˆå¯é€‰ï¼‰
3. å‰ç«¯ï¼šæ–°å»º `admin/src/alpine/mixins/user-resolver.js`
4. å‰ç«¯ï¼šåœ¨ `admin/src/alpine/mixins/index.js` æ³¨å†Œ
5. å‰ç«¯ï¼šåœ¨ `admin/src/api/user.js` æ–°å¢ `resolveUser()` æ–¹æ³•

### Phase 2ï¼šé«˜é¢‘é¡µé¢æ”¹é€ ï¼ˆ1 å¤©ï¼‰

ä¼˜å…ˆæ”¹é€ è¿è¥æ—¥å¸¸ä½¿ç”¨æœ€å¤šçš„é¡µé¢ï¼š
1. `finance-management.html` â€” 4 å¤„
2. `asset-management.html` â€” 4 å¤„
3. `asset-adjustment.html` â€” 1 å¤„
4. `lottery-management.html` â€” 6 å¤„

### Phase 3ï¼šå…¶ä½™é¡µé¢æ”¹é€ ï¼ˆ0.5 å¤©ï¼‰

1. `assets-portfolio.html` â€” 1 å¤„
2. `user-management.html` â€” 5 å¤„
3. `trade-management.html` â€” 2 å¤„
4. `sessions.html` â€” 1 å¤„
5. `user-hierarchy.html` â€” 2 å¤„
6. `presets.html` â€” 2 å¤„
7. `customer-service.html` â€” 1 å¤„
8. `orphan-frozen.html` â€” 1 å¤„

### Phase 4ï¼šæµ‹è¯•éªŒè¯ï¼ˆ0.5 å¤©ï¼‰

- æ¯ä¸ªæ”¹é€ é¡µé¢æ‰‹åŠ¨éªŒè¯ï¼šæ‰‹æœºå·æœç´¢ â†’ æ˜¾ç¤ºç”¨æˆ·å¡ç‰‡ â†’ ä¸šåŠ¡æ“ä½œæ­£å¸¸
- éªŒè¯æ˜µç§°æœç´¢æ¨¡å¼
- éªŒè¯ä¸å­˜åœ¨çš„æ‰‹æœºå·é”™è¯¯æç¤º
- éªŒè¯æ ¼å¼é”™è¯¯æç¤º

**æ€»è®¡ï¼šçº¦ 2.5 å¤©**

---

## 7. æŠ€æœ¯è¦ç‚¹å¤‡å¿˜

### 7.1 ç¼“å­˜ç­–ç•¥

resolve ç«¯ç‚¹çš„ç¼“å­˜è·¯å¾„ï¼š
```
å‰ç«¯ mixin Map ç¼“å­˜ï¼ˆé¡µé¢ä¼šè¯çº§ï¼‰
  â†“ miss
åç«¯ Redis ç¼“å­˜ï¼ˆBusinessCacheHelper.getUserByMobileï¼Œ120s TTLï¼‰
  â†“ miss
MySQL æŸ¥è¯¢ï¼ˆusers è¡¨ï¼Œmobile å­—æ®µæœ‰ unique ç´¢å¼•ï¼‰
```

ä¸‰çº§ç¼“å­˜ä¿è¯æ€§èƒ½ï¼ŒåŒä¸€æ‰‹æœºå·åœ¨çŸ­æ—¶é—´å†…ä¸ä¼šé‡å¤æŸ¥åº“ã€‚

### 7.2 å®‰å…¨è€ƒè™‘

- resolve ç«¯ç‚¹åœ¨ `authenticateToken` + `requireRoleLevel(100)` ä¿æŠ¤ä¸‹
- è¿”å›çš„æ‰‹æœºå·åšè„±æ•å¤„ç†ï¼ˆ`138****8000`ï¼‰
- æ˜µç§°æ¨¡ç³Šæœç´¢é™åˆ¶è¿”å›æ¡æ•°ï¼ˆæœ€å¤š 10 æ¡ï¼‰ï¼Œé˜²æ­¢æ•°æ®æ³„éœ²

### 7.3 å‰ç«¯ x-model å˜é‡å‘½åå˜æ›´

æ‰€æœ‰ `filters.user_id` / `form.user_id` ç­‰å˜é‡ï¼Œæ”¹ä¸º `filters.mobile` / `form.mobile`ã€‚

å¯¹åº”çš„ JS æ¨¡å—ä¸­çš„ API è°ƒç”¨å‚æ•°ä¹Ÿéœ€è¦åŒæ­¥ä¿®æ”¹ï¼šå…ˆè°ƒ resolve æ‹¿åˆ° user_idï¼Œå†ä¼ ç»™ä¸šåŠ¡ APIã€‚

### 7.4 trade-management ç‰¹æ®Šå¤„ç†

äº¤æ˜“ç®¡ç†çš„"ä¹°å®¶"å’Œ"å–å®¶"æ˜¯ä¸¤ä¸ªç‹¬ç«‹ç”¨æˆ·è¾“å…¥ï¼š
- `buyer_user_id` â†’ `buyer_mobile`ï¼ˆä¹°å®¶æ‰‹æœºå·ï¼‰
- `seller_user_id` â†’ `seller_mobile`ï¼ˆå–å®¶æ‰‹æœºå·ï¼‰
- å„è‡ªç‹¬ç«‹ resolveï¼Œäº’ä¸å½±å“

### 7.5 æ‰¹é‡æ“ä½œç‰¹æ®Šå¤„ç†

`lottery-management.html` çš„"æ‰¹é‡å‘é…é¢"åŠŸèƒ½ï¼š
- åŸæ¥è¾“å…¥å¤šä¸ª user_id
- æ”¹ä¸ºè¾“å…¥å¤šä¸ªæ‰‹æœºå·
- æäº¤å‰æ‰¹é‡ resolveï¼Œé€ä¸ªæ ¡éªŒ
- ä»»ä½•ä¸€ä¸ªæ‰‹æœºå·è§£æå¤±è´¥ï¼Œé«˜äº®æ ‡è®°å¹¶é˜»æ­¢æäº¤


