# å¾®ä¿¡å°ç¨‹åºå‰ç«¯é€‚é…åç«¯ - å¯¹é½åˆ†ææ–¹æ¡ˆ

> ç”Ÿæˆæ—¶é—´ï¼š2026-02-06  
> æ•°æ®æ¥æºï¼šåç«¯çœŸå®ä»£ç  + çœŸå®æ•°æ®åº“è¿æ¥æŸ¥è¯¢  
> å‰ç«¯ç›®å½•ï¼š`tgwc/tiangongqianduan`  
> åç«¯ç›®å½•ï¼š`/home/devbox/project`  

---

## ä¸€ã€æ ¸å¿ƒåŸåˆ™

1. **åç«¯æ•°æ®åº“æ˜¯æƒå¨æº**ï¼šä¸€åˆ‡ä»¥åç«¯çœŸå®æ•°æ®åº“è¡¨ç»“æ„ã€çœŸå® API è·¯ç”±ä¸ºå‡†
2. **å‰ç«¯é€‚é…åç«¯**ï¼šä¸æ”¹é¡µé¢ç»“æ„/æ ·å¼/äº¤äº’ï¼Œåªæ”¹ API è°ƒç”¨è·¯å¾„ã€æ•°æ®æ ¼å¼è½¬æ¢ã€é”™è¯¯å¤„ç†
3. **ä¸å…¼å®¹æ—§é€»è¾‘**ï¼šå‰ç«¯ä»£ç ä¸­å·²æœ‰çš„æ—§æ¥å£è°ƒç”¨å¦‚æœè·Ÿåç«¯å¯¹ä¸ä¸Šï¼Œç›´æ¥æ”¹æ‰
4. **ä¸ç”¨æ¨¡æ‹Ÿæ•°æ®**ï¼šè°ƒä¸é€šå°±æ˜¾ç¤ºé”™è¯¯æç¤º
5. **å‰ç«¯ = æ•°æ®å±•ç¤ºå±‚ï¼Œåç«¯ = ä¸šåŠ¡é€»è¾‘ + æ•°æ®å¤„ç†**

---

## äºŒã€é¡¹ç›®å…¨è²Œï¼ˆåŸºäºçœŸå®ä»£ç å’Œæ•°æ®åº“ï¼‰

### ä¸šåŠ¡æ¨¡å¼

**é¤å…ç§¯åˆ†æŠ½å¥–ç³»ç»Ÿ** â†’ ç”¨æˆ·åœ¨é¤å…æ¶ˆè´¹ â†’ è·å¾—ç§¯åˆ† â†’ ç§¯åˆ†å¯ä»¥ç”¨æ¥ï¼šæŠ½å¥–ã€å…‘æ¢å•†å“ã€åœ¨å¸‚åœºäº¤æ˜“

### æŠ€æœ¯æ¶æ„

| å±‚çº§ | æŠ€æœ¯ |
|---|---|
| åç«¯ | Node.js + Express + Sequelize + MySQL + Redis |
| å‰ç«¯ | å¾®ä¿¡å°ç¨‹åºï¼ˆåŸç”Ÿå¼€å‘ï¼‰ |
| APIç‰ˆæœ¬ | V4.0 ç»Ÿä¸€å¼•æ“æ¶æ„ |
| è®¤è¯ | JWTï¼ˆaccess_token + refresh_tokenï¼‰ |
| éƒ¨ç½² | Sealos DevBox |

### æ•°æ®åº“çœŸå®çŠ¶æ€ï¼ˆå…³é”®ä¸šåŠ¡è¡¨ï¼‰

| è¡¨å | è®°å½•æ•° | è¯´æ˜ |
|---|---|---|
| users | 59 | ç”¨æˆ· |
| lottery_campaigns | 4 | æŠ½å¥–æ´»åŠ¨ï¼ˆ1ä¸ªactiveï¼šBASIC_LOTTERYï¼‰ |
| lottery_prizes | 30 | å¥–å“ |
| lottery_draws | 1642 | æŠ½å¥–è®°å½• |
| products | 52 | å…‘æ¢å•†å“ |
| item_instances | 5913 | ç”¨æˆ·åº“å­˜ç‰©å“ |
| item_templates | 16 | ç‰©å“æ¨¡æ¿ |
| market_listings | 272 | äº¤æ˜“å¸‚åœºæŒ‚å• |
| consumption_records | 48 | æ¶ˆè´¹å½•å…¥è®°å½• |
| accounts | 55 | èµ„äº§è´¦æˆ· |
| account_asset_balances | 42 | èµ„äº§ä½™é¢ |
| material_asset_types | 4 | èµ„äº§ç±»å‹ï¼šPOINTSã€DIAMONDã€red_shardã€BUDGET_POINTS |
| stores | 5 | é¤å…é—¨åº— |
| store_staff | 3 | é—¨åº—å‘˜å·¥ |
| customer_service_sessions | 13 | å®¢æœä¼šè¯ |
| chat_messages | 432 | èŠå¤©æ¶ˆæ¯ |
| feedbacks | 147 | ç”¨æˆ·åé¦ˆ |
| system_announcements | 73 | ç³»ç»Ÿå…¬å‘Š |
| popup_banners | 4 | å¼¹çª—æ¨ªå¹… |
| image_resources | 0 | å›¾ç‰‡èµ„æºï¼ˆç©ºï¼‰ |
| exchange_records | 0 | å…‘æ¢è®°å½•ï¼ˆç©ºï¼‰ |

### èµ„äº§ç±»å‹ï¼ˆmaterial_asset_types çœŸå®æ•°æ®ï¼‰

| asset_code | display_name | group_code | form | tier |
|---|---|---|---|---|
| red_shard | çº¢è‰²ç¢ç‰‡ | red | shard | 1 |
| POINTS | æ™®é€šç§¯åˆ† | points | crystal | 0 |
| BUDGET_POINTS | é¢„ç®—ç§¯åˆ† | points | crystal | 0 |
| DIAMOND | é’»çŸ³ | currency | currency | 10 |

### è§’è‰²ä½“ç³»ï¼ˆroles çœŸå®æ•°æ®ï¼‰

| role_name | role_level | description |
|---|---|---|
| user | 0 | æ™®é€šç”¨æˆ· |
| merchant_staff | 20 | å•†å®¶å‘˜å·¥ï¼ˆå¯æ‰§è¡Œæ¶ˆè´¹å½•å…¥ï¼‰ |
| ops | 30 | è¿è¥åªè¯»è§’è‰² |
| sales_staff | 40 | ä¸šåŠ¡å‘˜ |
| merchant_manager | 40 | å•†å®¶åº—é•¿ |
| business_manager | 60 | ä¸šåŠ¡ç»ç† |
| regional_manager | 80 | åŒºåŸŸè´Ÿè´£äºº |
| admin | 100 | ç®¡ç†å‘˜ï¼ˆå…¨éƒ¨æƒé™ï¼‰ |

---

## ä¸‰ã€åç«¯çœŸå®è·¯ç”±æŒ‚è½½ï¼ˆä» app.js ç¡®è®¤ï¼‰

```
/api/v4/auth              â†’ è®¤è¯ï¼ˆlogin, verify, profile, refresh, quick-login, logoutï¼‰
/api/v4/permissions       â†’ æƒé™æ£€æŸ¥
/api/v4/lottery           â†’ æŠ½å¥–ï¼ˆdraw, campaigns, prizes, history, configï¼‰
/api/v4/market            â†’ äº¤æ˜“å¸‚åœºï¼ˆlistings, buy, sell, manageï¼‰
/api/v4/shop              â†’ å•†åŸï¼ˆexchange, consumption/qrcode, premium, staff, audit, redemption, assetsï¼‰
/api/v4/system            â†’ ç³»ç»Ÿï¼ˆannouncements, chat, feedback, status, popup-banners, notifications, dictionaries, statisticsï¼‰
/api/v4/user              â†’ ç”¨æˆ·ï¼ˆ/meï¼‰
/api/v4/assets            â†’ èµ„äº§ï¼ˆbalance, transactions, conversion-rulesï¼‰
/api/v4/backpack          â†’ èƒŒåŒ…/åº“å­˜
/api/v4/merchant-points   â†’ å•†æˆ·ç§¯åˆ†
/api/v4/activities        â†’ æ´»åŠ¨
/api/v4/console           â†’ ç®¡ç†åå°ï¼ˆéå°ç¨‹åºç”¨æˆ·ä½¿ç”¨ï¼‰
/api/v4/debug-control     â†’ è°ƒè¯•æ§åˆ¶
```

### åç«¯è·¯ç”±æ–‡ä»¶ç»“æ„

```
routes/v4/
â”œâ”€â”€ auth/           â†’ login.js, profile.js, token.js, permissions.js, index.js
â”œâ”€â”€ lottery/        â†’ draw.js, campaigns.js, history.js, user-points.js, middleware.js, lottery-preset.js, index.js
â”œâ”€â”€ market/         â†’ listings.js, buy.js, sell.js, manage.js, index.js
â”œâ”€â”€ shop/
â”‚   â”œâ”€â”€ exchange/   â†’ exchange.js, orders.js, items.js, statistics.js, index.js
â”‚   â”œâ”€â”€ consumption/â†’ qrcode.js
â”‚   â”œâ”€â”€ audit/      â†’ index.js
â”‚   â”œâ”€â”€ redemption/ â†’ orders.js, fulfill.js, query.js, index.js
â”‚   â”œâ”€â”€ assets/     â†’ rules.js, convert.js, index.js
â”‚   â”œâ”€â”€ risk/       â†’ index.js
â”‚   â”œâ”€â”€ staff/      â†’ index.js
â”‚   â””â”€â”€ premium.js
â”œâ”€â”€ system/         â†’ announcements.js, chat.js, feedback.js, status.js, popup-banners.js, notifications.js, dictionaries.js, statistics.js, user-stats.js, index.js
â”œâ”€â”€ user/           â†’ index.js
â”œâ”€â”€ assets/         â†’ balance.js, transactions.js, conversion-rules.js, index.js
â”œâ”€â”€ backpack/       â†’ index.js
â”œâ”€â”€ console/        â†’ (å¤§é‡ç®¡ç†åå°è·¯ç”±ï¼Œéå°ç¨‹åºå‰ç«¯ä½¿ç”¨)
â”œâ”€â”€ activities.js
â”œâ”€â”€ merchant-points.js
â””â”€â”€ debug-control.js
```

---

## å››ã€å‰ç«¯é¡µé¢ç»“æ„

### TabBar é¡µé¢ï¼ˆ4ä¸ªä¸»æ ‡ç­¾ï¼‰

| æ ‡ç­¾ | é¡µé¢è·¯å¾„ | åŠŸèƒ½ |
|---|---|---|
| ğŸ° æŠ½å¥– | pages/lottery/lottery | æŠ½å¥–è½¬ç›˜ |
| ğŸ” å‘ç° | pages/camera/camera | æ´»åŠ¨èšåˆå…¥å£ |
| ğŸ å…‘æ¢ | pages/exchange/exchange | ç§¯åˆ†å…‘æ¢å•†å“ |
| ğŸ‘¤ æˆ‘çš„ | pages/user/user | ç”¨æˆ·ä¸­å¿ƒ |

### å­é¡µé¢

| é¡µé¢è·¯å¾„ | åŠŸèƒ½ |
|---|---|
| pages/auth/auth | ç™»å½•/è®¤è¯ |
| pages/points-detail/points-detail | ç§¯åˆ†è¯¦æƒ…/å†å² |
| pages/trade/market/market | äº¤æ˜“å¸‚åœº |
| pages/trade/inventory/inventory | ç”¨æˆ·åº“å­˜ |
| pages/records/trade-upload-records/trade-upload-records | ç§¯åˆ†æ´»åŠ¨è®°å½• |
| pages/chat/chat | å®¢æœèŠå¤© |
| pages/feedback/feedback | åé¦ˆæäº¤ |
| pages/admin/admin-dashboard/admin-dashboard | ç®¡ç†å‘˜ä»ªè¡¨æ¿ |
| pages/admin/consume-submit/consume-submit | æ¶ˆè´¹å½•å…¥ï¼ˆå•†å®¶æ‰«ç ï¼‰ |
| pages/admin/audit-list/audit-list | å®¡æ ¸åˆ—è¡¨ |
| pages/admin/customer-service/customer-service | ç®¡ç†å‘˜å®¢æœ |
| pages/admin/chat-management/chat-management | èŠå¤©å·¥ä½œå° |

---

## äº”ã€ğŸ”´ æ ¸å¿ƒå‘ç°ï¼šå‰ç«¯ API è·¯å¾„ä¸åç«¯çœŸå®è·¯ç”±ä¸¥é‡ä¸åŒ¹é…

### å¯¹ç…§è¡¨

| åŠŸèƒ½æ¨¡å— | å‰ç«¯å½“å‰è·¯å¾„ï¼ˆapi.jsï¼‰ | åç«¯çœŸå®è·¯å¾„ | çŠ¶æ€ |
|---|---|---|---|
| **ç™»å½•** | `/auth/login` | `/api/v4/auth/login` | âœ… åŒ¹é… |
| **å¿«é€Ÿç™»å½•** | `/auth/quick-login` | `/api/v4/auth/quick-login` | âœ… åŒ¹é… |
| **ç”¨æˆ·ä¿¡æ¯** | `/auth/profile` | `/api/v4/auth/profile` | âœ… åŒ¹é… |
| **TokenéªŒè¯** | `/auth/verify` (POST) | `/api/v4/auth/verify` (GET) | âš ï¸ HTTPæ–¹æ³•å¯èƒ½ä¸åŒ¹é… |
| **Tokenåˆ·æ–°** | `/auth/refresh` | `/api/v4/auth/refresh` | âœ… åŒ¹é… |
| **ç§¯åˆ†ä½™é¢** | `/points/balance/:user_id` | `/api/v4/assets/balance/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **å½“å‰ç”¨æˆ·ä½™é¢** | `/points/balance` | `/api/v4/assets/balance/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **ç§¯åˆ†äº¤æ˜“å†å²** | `/points/transactions/:user_id` | `/api/v4/assets/transactions/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **ç”¨æˆ·ç»Ÿè®¡** | `/points/user/statistics/:user_id` | å¾…ç¡®è®¤ | âŒ å¾…ç¡®è®¤ |
| **ç®¡ç†å‘˜ç§¯åˆ†è°ƒæ•´** | `/points/admin/adjust` | å¯èƒ½åœ¨ `/api/v4/console/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **ç®¡ç†å‘˜ç§¯åˆ†ç»Ÿè®¡** | `/points/admin/statistics` | å¯èƒ½åœ¨ `/api/v4/console/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **æŠ½å¥–-æ´»åŠ¨åˆ—è¡¨** | `/lottery/campaigns` | `/api/v4/lottery/campaigns` | âœ… åŒ¹é… |
| **æŠ½å¥–-å¥–å“åˆ—è¡¨** | `/lottery/prizes/:code` | `/api/v4/lottery/:code/prizes` | âš ï¸ è·¯å¾„å‚æ•°ä½ç½®ä¸åŒ |
| **æŠ½å¥–-é…ç½®** | `/lottery/config/:code` | `/api/v4/lottery/:code/config` | âš ï¸ è·¯å¾„å‚æ•°ä½ç½®ä¸åŒ |
| **æŠ½å¥–-æ‰§è¡Œ** | `/lottery/draw` | `/api/v4/lottery/draw` | âœ… åŒ¹é…ï¼ˆéœ€ç¡®è®¤POST bodyï¼‰ |
| **æŠ½å¥–-å†å²** | `/lottery/history/:user_id` | `/api/v4/lottery/history/:user_id` | âœ… åŒ¹é… |
| **ç”¨æˆ·åº“å­˜** | `/inventory/user/:user_id` | `/api/v4/backpack/*` | âŒ æ¨¡å—å®Œå…¨ä¸åŒ |
| **ç‰©å“è¯¦æƒ…** | `/inventory/item/:item_id` | `/api/v4/backpack/*` | âŒ æ¨¡å—å®Œå…¨ä¸åŒ |
| **ä½¿ç”¨ç‰©å“** | `/inventory/use/:item_id` | `/api/v4/backpack/*` | âŒ æ¨¡å—å®Œå…¨ä¸åŒ |
| **å…‘æ¢å•†å“åˆ—è¡¨** | `/inventory/products` | `/api/v4/shop/exchange/items` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **æ‰§è¡Œå…‘æ¢** | `/inventory/exchange` | `/api/v4/shop/exchange/` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **å…‘æ¢è®°å½•** | `/inventory/exchange-records` | `/api/v4/shop/exchange/orders` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **å–æ¶ˆå…‘æ¢** | `/inventory/exchange-records/:id/cancel` | `/api/v4/shop/exchange/orders/:id/cancel` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **ç”Ÿæˆæ ¸é”€ç ** | `/inventory/generate-code/:item_id` | å¾…ç¡®è®¤ | âŒ å¾…ç¡®è®¤ |
| **è½¬ç§»ç‰©å“** | `/inventory/transfer` | å¾…ç¡®è®¤ | âŒ å¾…ç¡®è®¤ |
| **è½¬ç§»å†å²** | `/inventory/transfer-history` | å¾…ç¡®è®¤ | âŒ å¾…ç¡®è®¤ |
| **ç®¡ç†å‘˜åº“å­˜ç»Ÿè®¡** | `/inventory/admin/statistics` | å¯èƒ½åœ¨ `/api/v4/console/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **å¸‚åœºå•†å“åˆ—è¡¨** | `/inventory/market/products` | `/api/v4/market/listings` | âŒ æ¨¡å—å®Œå…¨ä¸åŒ |
| **å¸‚åœºå•†å“è¯¦æƒ…** | `/inventory/market/products/:id` | `/api/v4/market/listings/:id` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **è´­ä¹°å¸‚åœºå•†å“** | `/inventory/market/products/:id/purchase` | `/api/v4/market/buy` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **æ’¤å›å¸‚åœºå•†å“** | `/inventory/market/products/:id/withdraw` | `/api/v4/market/manage` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **æ¶ˆè´¹äºŒç»´ç ** | `/consumption/qrcode/:user_id` | `/api/v4/shop/consumption/qrcode/:user_id` | âŒ ç¼ºå°‘ shop å‰ç¼€ |
| **æ¶ˆè´¹æäº¤** | `/consumption/submit` | `/api/v4/shop/consumption/*` | âŒ ç¼ºå°‘ shop å‰ç¼€ |
| **æ¶ˆè´¹å®¡æ ¸-å¾…å®¡åˆ—è¡¨** | `/consumption/pending` | `/api/v4/shop/audit/*` æˆ– `/api/v4/shop/consumption/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **æ¶ˆè´¹å®¡æ ¸-é€šè¿‡** | `/consumption/approve/:record_id` | `/api/v4/shop/audit/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **æ¶ˆè´¹å®¡æ ¸-æ‹’ç»** | `/consumption/reject/:record_id` | `/api/v4/shop/audit/*` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **å®¡æ ¸è®°å½•æ•°é‡** | `/consumption/my-recent-audits/count` | å¾…ç¡®è®¤ | âŒ å¾…ç¡®è®¤ |
| **å®¡æ ¸è®°å½•åˆ—è¡¨** | `/consumption/my-recent-audits` | å¾…ç¡®è®¤ | âŒ å¾…ç¡®è®¤ |
| **æ ¹æ®äºŒç»´ç è·å–ç”¨æˆ·** | `/consumption/user-info` | å¾…ç¡®è®¤ | âŒ å¾…ç¡®è®¤ |
| **å›¾ç‰‡ä¸Šä¼ ** | `/photo/upload` | âŒ å·²åºŸå¼ƒï¼Œå‰ç«¯ç”¨æˆ·ç«¯æ— æ­¤è·¯ç”±ï¼›å›¾ç‰‡ä¸Šä¼ å·²æ•´åˆåˆ°ç®¡ç†åå° `/api/v4/console/images` | âŒ å·²åºŸå¼ƒ |
| **æˆ‘çš„ä¸Šä¼ ** | `/photo/my-uploads` | âŒ å·²åºŸå¼ƒï¼Œåç«¯æ— æ­¤è·¯ç”± | âŒ å·²åºŸå¼ƒ |
| **ä¸Šä¼ ç»Ÿè®¡** | `/photo/my-stats` | âŒ å·²åºŸå¼ƒï¼Œåç«¯æ— æ­¤è·¯ç”± | âŒ å·²åºŸå¼ƒ |
| **å¾…å®¡æ ¸å›¾ç‰‡** | `/photo/pending-reviews` | âŒ å·²åºŸå¼ƒï¼Œå®¡æ ¸åŠŸèƒ½ç»Ÿä¸€å¹¶å…¥ `content_review_records` è¡¨ï¼ˆä»…æœ‰ consumption/merchant_points ä¸¤ç§å®¡æ ¸ç±»å‹ï¼Œæ—  image ç±»å‹ï¼‰ | âŒ å·²åºŸå¼ƒ |
| **å®¡æ ¸å›¾ç‰‡** | `/photo/review/:resource_id` | âŒ å·²åºŸå¼ƒï¼Œ`image_resources` è¡¨ä¸ºç©ºï¼ˆ0æ¡è®°å½•ï¼‰ï¼Œå›¾ç‰‡ç‹¬ç«‹å®¡æ ¸åŠŸèƒ½å·²å–æ¶ˆ | âŒ å·²åºŸå¼ƒ |
| **ç³»ç»Ÿå…¬å‘Š** | `/system/announcements` | `/api/v4/system/announcements` | âœ… åŒ¹é… |
| **é¦–é¡µå…¬å‘Š** | `/system/announcements/home` | `/api/v4/system/announcements/*` | âœ… åŒ¹é…ï¼ˆéœ€ç¡®è®¤ï¼‰ |
| **æäº¤åé¦ˆ** | `/system/feedback` | `/api/v4/system/feedback` | âœ… åŒ¹é… |
| **æˆ‘çš„åé¦ˆ** | `/system/feedback/my` | `/api/v4/system/feedback/*` | âœ… åŒ¹é…ï¼ˆéœ€ç¡®è®¤ï¼‰ |
| **ç³»ç»ŸçŠ¶æ€** | `/system/status` | `/api/v4/system/status` | âœ… åŒ¹é… |
| **åˆ›å»ºå®¢æœä¼šè¯** | `/system/chat/create` | `/api/v4/system/chat/*` | âœ… åŒ¹é…ï¼ˆéœ€ç¡®è®¤ï¼‰ |
| **å®¢æœä¼šè¯åˆ—è¡¨** | `/system/chat/sessions` | `/api/v4/system/chat/*` | âœ… åŒ¹é…ï¼ˆéœ€ç¡®è®¤ï¼‰ |
| **èŠå¤©å†å²** | `/system/chat/history/:session_id` | `/api/v4/system/chat/*` | âœ… åŒ¹é…ï¼ˆéœ€ç¡®è®¤ï¼‰ |
| **å‘é€æ¶ˆæ¯** | `/system/chat/send` | `/api/v4/system/chat/*` | âœ… åŒ¹é…ï¼ˆéœ€ç¡®è®¤ï¼‰ |
| **å¼¹çª—æ¨ªå¹…** | å‰ç«¯æœªè°ƒç”¨ | `/api/v4/system/popup-banners` | âŒ å‰ç«¯æœªå¯¹æ¥ |
| **ç®¡ç†å‘˜ç»Ÿè®¡** | `/admin/statistics/today` | `/api/v4/console/dashboard` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **ç®¡ç†å‘˜ç”¨æˆ·åˆ—è¡¨** | `/admin/users` | `/api/v4/console/user_management` | âŒ è·¯å¾„ä¸åŒ¹é… |
| **ç®¡ç†å‘˜èŠå¤©ä¼šè¯** | `/system/admin/chat/sessions` | `/api/v4/system/chat/*` æˆ– `/api/v4/console/customer-service/*` | âš ï¸ å¾…ç¡®è®¤ |

---

## å…­ã€æ–¹æ¡ˆï¼šæŒ‰é¡µé¢é€ä¸€é€‚é…

### ç¬¬1ç»„ï¼šâœ… åŸºæœ¬åŒ¹é…ï¼ˆå¾®è°ƒå³å¯ï¼‰

| é¡µé¢ | æ¶‰åŠAPI | æ”¹åŠ¨ |
|---|---|---|
| authï¼ˆç™»å½•ï¼‰ | login, quick-login, profile, verify, refresh | verify å¯èƒ½éœ€æ”¹ POSTâ†’GET |
| chatï¼ˆå®¢æœèŠå¤©ï¼‰ | system/chat/* | åŸºæœ¬åŒ¹é…ï¼Œéœ€ç¡®è®¤ç²¾ç¡®è·¯å¾„ |
| feedbackï¼ˆåé¦ˆï¼‰ | system/feedback | åŸºæœ¬åŒ¹é… |
| lotteryï¼ˆæŠ½å¥–ï¼‰ | campaigns, draw, history | åŸºæœ¬åŒ¹é…ï¼Œprizeså’Œconfigè·¯å¾„å‚æ•°ä½ç½®éœ€è°ƒæ•´ |

### ç¬¬2ç»„ï¼šâŒ è·¯å¾„ä¸åŒ¹é…ï¼ˆéœ€æ”¹ api.js ä¸­çš„è·¯å¾„ï¼‰

| é¡µé¢ | å½“å‰é”™è¯¯è·¯å¾„ | åº”æ”¹ä¸º | è¯´æ˜ |
|---|---|---|---|
| lotteryï¼ˆå¥–å“ï¼‰ | `/lottery/prizes/CODE` | `/lottery/CODE/prizes` | è·¯å¾„å‚æ•°ä½ç½®ä¸åŒ |
| lotteryï¼ˆé…ç½®ï¼‰ | `/lottery/config/CODE` | `/lottery/CODE/config` | åŒä¸Š |
| userï¼ˆç§¯åˆ†ä½™é¢ï¼‰ | `/points/balance/:user_id` | `/assets/balance/*` | éœ€è¯»backendè·¯ç”±ç¡®è®¤ç²¾ç¡®è·¯å¾„ |
| points-detailï¼ˆç§¯åˆ†å†å²ï¼‰ | `/points/transactions/:user_id` | `/assets/transactions/*` | éœ€è¯»backendè·¯ç”±ç¡®è®¤ |
| exchangeï¼ˆå•†å“åˆ—è¡¨ï¼‰ | `/inventory/products` | `/shop/exchange/items` | æ¨¡å—è·¯å¾„å˜äº† |
| exchangeï¼ˆæ‰§è¡Œå…‘æ¢ï¼‰ | `/inventory/exchange` | `/shop/exchange/` | åŒä¸Š |
| exchangeï¼ˆå…‘æ¢è®°å½•ï¼‰ | `/inventory/exchange-records` | `/shop/exchange/orders` | åŒä¸Š |
| trade/inventoryï¼ˆåº“å­˜ï¼‰ | `/inventory/user/:user_id` | `/backpack/*` | æ¨¡å—å®Œå…¨å˜äº† |
| trade/marketï¼ˆå¸‚åœºåˆ—è¡¨ï¼‰ | `/inventory/market/products` | `/market/listings` | æ¨¡å—å®Œå…¨å˜äº† |
| trade/marketï¼ˆè´­ä¹°ï¼‰ | `/inventory/market/products/:id/purchase` | `/market/buy` | åŒä¸Š |
| admin/consume-submit | `/consumption/submit` | `/shop/consumption/*` | éœ€åŠ shopå‰ç¼€ |
| admin/consume-submit | `/consumption/qrcode/:user_id` | `/shop/consumption/qrcode/:user_id` | åŒä¸Š |
| admin/audit-list | `/consumption/pending` | `/shop/audit/*` æˆ–ç±»ä¼¼ | éœ€ç¡®è®¤ |
| admin/audit-list | `/consumption/approve/:id` | `/shop/audit/*` | éœ€ç¡®è®¤ |
| admin/audit-list | `/consumption/reject/:id` | `/shop/audit/*` | éœ€ç¡®è®¤ |
| admin/admin-dashboard | `/admin/statistics/today` | `/console/dashboard` | éœ€ç¡®è®¤ |

### ç¬¬3ç»„ï¼šå‰ç«¯ç¼ºå¤±çš„åç«¯èƒ½åŠ›ï¼ˆéœ€æ–°å¢APIè°ƒç”¨ï¼‰

| åç«¯èƒ½åŠ› | è·¯ç”± | æ•°æ®åº“è®°å½• | å¯å¯¹æ¥çš„å‰ç«¯é¡µé¢ |
|---|---|---|---|
| å¼¹çª—æ¨ªå¹… | `/api/v4/system/popup-banners` | 4æ¡è®°å½• | é¦–é¡µ/å¼¹çª—å±•ç¤º |
| èµ„äº§è½¬æ¢è§„åˆ™ | `/api/v4/assets/conversion-rules` | - | ç”¨æˆ·ä¸­å¿ƒ/ç§¯åˆ†è½¬æ¢ |
| æ´»åŠ¨é¡µ | `/api/v4/activities` | - | camera/å‘ç°é¡µ |
| ä¸Šæ¶åˆ°å¸‚åœº | `/api/v4/market/sell` | - | inventoryé¡µå¢åŠ ä¸Šæ¶æ“ä½œ |
| èƒŒåŒ…ç³»ç»Ÿ | `/api/v4/backpack` | 5913æ¡item_instances | inventoryé¡µæ›¿æ¢ç°æœ‰API |
| ç”¨æˆ·è¯¦æƒ… | `/api/v4/user/me` | - | ç”¨æˆ·ä¸­å¿ƒ |
| å•†æˆ·ç§¯åˆ† | `/api/v4/merchant-points` | - | å•†æˆ·ç›¸å…³é¡µé¢ |
| å…‘æ¢è®¢å•æµç¨‹ | `/api/v4/shop/redemption/orders` | - | å…‘æ¢å®Œæ•´æµç¨‹ |

### ç¬¬4ç»„ï¼šå‰ç«¯æœ‰ä½†åç«¯æ— ï¼ˆéœ€åˆ é™¤æˆ–æ ‡è®°ä¸å¯ç”¨ï¼‰

| å‰ç«¯API | è¯´æ˜ |
|---|---|
| `getUserIdentity()` | ä»£ç ä¸­å·²æ ‡æ³¨ "API_NOT_IMPLEMENTED"ï¼Œéœ€åˆ é™¤æˆ–èµ° `/auth/profile` æ›¿ä»£ |
| `uploadImage()` | âŒ `/photo/upload` è·¯ç”±å·²åºŸå¼ƒï¼Œå›¾ç‰‡ä¸Šä¼ æ•´åˆåˆ°ç®¡ç†åå° `/api/v4/console/images`ï¼Œç”¨æˆ·ç«¯ä¸å†æœ‰ç‹¬ç«‹ä¸Šä¼ åŠŸèƒ½ |
| `getMyUploads()` | âŒ `/photo/my-uploads` è·¯ç”±å·²åºŸå¼ƒ |
| `getMyUploadStats()` | âŒ `/photo/my-stats` è·¯ç”±å·²åºŸå¼ƒ |
| `getPendingReviews()` | âŒ `/photo/pending-reviews` è·¯ç”±å·²åºŸå¼ƒï¼Œå®¡æ ¸ç»Ÿä¸€å¹¶å…¥ `content_review_records`ï¼ˆä»… consumption/merchant_points ç±»å‹ï¼‰ |
| `reviewImage()` | âŒ `/photo/review/:id` è·¯ç”±å·²åºŸå¼ƒï¼Œ`image_resources` è¡¨ä¸ºç©º |
| `getCurrentUserBalance()` | `/points/balance` è·¯å¾„ä¸å­˜åœ¨ï¼Œéœ€æ”¹ä¸º assets æ¨¡å—è·¯å¾„ |

---

## ä¸ƒã€å…·ä½“å®æ–½æ­¥éª¤

### æ­¥éª¤1ï¼šç¡®è®¤åç«¯æ¯ä¸ªè·¯ç”±çš„ç²¾ç¡®è·¯å¾„å’Œå‚æ•°

é€ä¸ªè¯»å–åç«¯è·¯ç”±æ–‡ä»¶ï¼ˆç‰¹åˆ«æ˜¯ä»¥ä¸‹å…³é”®æ–‡ä»¶ï¼‰ï¼Œç¡®è®¤æ¯ä¸ªAPIçš„ç²¾ç¡®URLã€HTTPæ–¹æ³•ã€è¯·æ±‚å‚æ•°ã€å“åº”æ ¼å¼ï¼š

- `routes/v4/assets/balance.js` â†’ ç§¯åˆ†ä½™é¢ç²¾ç¡®è·¯å¾„
- `routes/v4/assets/transactions.js` â†’ ç§¯åˆ†äº¤æ˜“å†å²ç²¾ç¡®è·¯å¾„
- `routes/v4/backpack/index.js` â†’ èƒŒåŒ…/åº“å­˜ç²¾ç¡®è·¯å¾„
- `routes/v4/shop/exchange/items.js` â†’ å…‘æ¢å•†å“åˆ—è¡¨
- `routes/v4/shop/exchange/exchange.js` â†’ æ‰§è¡Œå…‘æ¢
- `routes/v4/shop/exchange/orders.js` â†’ å…‘æ¢è®¢å•
- `routes/v4/shop/consumption/qrcode.js` â†’ æ¶ˆè´¹äºŒç»´ç 
- `routes/v4/shop/audit/index.js` â†’ æ¶ˆè´¹å®¡æ ¸
- `routes/v4/market/listings.js` â†’ å¸‚åœºåˆ—è¡¨
- `routes/v4/market/buy.js` â†’ å¸‚åœºè´­ä¹°
- `routes/v4/market/sell.js` â†’ å¸‚åœºä¸Šæ¶
- `routes/v4/system/chat.js` â†’ å®¢æœèŠå¤©ç²¾ç¡®è·¯å¾„
- `routes/v4/system/popup-banners.js` â†’ å¼¹çª—æ¨ªå¹…

### æ­¥éª¤2ï¼šä¿®æ”¹ `utils/api.js` ä¸­çš„è·¯å¾„

åªæ”¹è·¯å¾„å­—ç¬¦ä¸²ï¼Œä¸æ”¹å‡½æ•°ç­¾åå’Œé¡µé¢è°ƒç”¨æ–¹å¼ã€‚ä¾‹å¦‚ï¼š

```javascript
// æ”¹å‰
'/lottery/prizes/' + campaign_code
// æ”¹å
'/lottery/' + campaign_code + '/prizes'

// æ”¹å‰
'/inventory/user/' + user_id
// æ”¹å
'/backpack/...'  // ç²¾ç¡®è·¯å¾„å¾…æ­¥éª¤1ç¡®è®¤

// æ”¹å‰
'/points/balance/' + user_id
// æ”¹å
'/assets/...'  // ç²¾ç¡®è·¯å¾„å¾…æ­¥éª¤1ç¡®è®¤
```

### æ­¥éª¤3ï¼šè°ƒæ•´æ•°æ®æ ¼å¼è½¬æ¢

åç«¯è¿”å›çš„å­—æ®µåå¯èƒ½ä¸å‰ç«¯é¡µé¢æœŸæœ›çš„ä¸åŒï¼Œéœ€è¦åœ¨APIå±‚åšæ•°æ®è½¬æ¢ï¼ˆä¸æ”¹é¡µé¢WXML/WXSS/äº¤äº’é€»è¾‘ï¼‰

### æ­¥éª¤4ï¼šè¡¥é½ç¼ºå¤±çš„APIè°ƒç”¨

å¦‚ popup-bannersã€backpack ç­‰åç«¯å·²æœ‰ä½†å‰ç«¯æœªå¯¹æ¥çš„èƒ½åŠ›

### æ­¥éª¤5ï¼šåˆ é™¤/æ¸…ç†ä¸å­˜åœ¨çš„APIè°ƒç”¨

å¦‚ `getUserIdentity` ç­‰æ ‡è®°ä¸ºæœªå®ç°çš„API

---

## å…«ã€å‰ç«¯ç¯å¢ƒé…ç½®ç¡®è®¤

å½“å‰å‰ç«¯ç¯å¢ƒé…ç½®ï¼ˆ`config/env.js`ï¼‰ï¼š

| é…ç½®é¡¹ | å½“å‰å€¼ | è¯´æ˜ |
|---|---|---|
| CURRENT_ENV | `testing` | æµ‹è¯•ç¯å¢ƒ |
| API baseUrl | `https://omqktqrtntnn.sealosbja.site` | SealosåŸŸå |
| API prefix | `/api/v4` | V4ç»Ÿä¸€å¼•æ“ |
| WebSocket | `wss://omqktqrtntnn.sealosbja.site/ws` | WSSåè®® |
| ä¸‡èƒ½éªŒè¯ç  | `123456` | æµ‹è¯•é˜¶æ®µå¯ç”¨ |

---

## ä¹ã€æ•°æ®åº“è¿æ¥ä¿¡æ¯

| é…ç½®é¡¹ | å€¼ |
|---|---|
| DB_HOST | dbconn.sealosbja.site |
| DB_PORT | 42569 |
| DB_NAME | restaurant_points_dev |
| DB_USER | root |

---

## åã€ç»Ÿè®¡æ±‡æ€»

| æŒ‡æ ‡ | æ•°å€¼ |
|---|---|
| å‰ç«¯APIæ–¹æ³•æ€»æ•° | çº¦50ä¸ª |
| âœ… è·¯å¾„åŒ¹é… | çº¦12ä¸ªï¼ˆ24%ï¼‰ |
| âš ï¸ éœ€å¾®è°ƒ | çº¦5ä¸ªï¼ˆ10%ï¼‰ |
| âŒ è·¯å¾„ä¸åŒ¹é… | çº¦25ä¸ªï¼ˆ50%ï¼‰ |
| âŒ å¾…ç¡®è®¤ | çº¦8ä¸ªï¼ˆ16%ï¼‰ |
| åç«¯æœ‰ä½†å‰ç«¯ç¼ºå¤± | çº¦8ä¸ªèƒ½åŠ›æ¨¡å— |
| å‰ç«¯æœ‰ä½†åç«¯æ—  | çº¦3ä¸ªAPI |

**ç»“è®º**ï¼šå‰ç«¯çº¦ 50% çš„APIè·¯å¾„ä¸åç«¯ä¸åŒ¹é…ï¼Œéœ€è¦ç³»ç»Ÿæ€§åœ°ä¿®æ­£ `utils/api.js` ä¸­çš„è·¯å¾„æ˜ å°„ã€‚ä¿®æ”¹èŒƒå›´ä»…é™äºAPIè°ƒç”¨å±‚ï¼Œä¸æ¶‰åŠé¡µé¢ç»“æ„ã€æ ·å¼å’Œäº¤äº’é€»è¾‘ã€‚

---

## åä¸€ã€å…¨é‡æ’æŸ¥ï¼šå‰ç«¯è°ƒç”¨ vs åç«¯çœŸå®è·¯ç”±ç²¾ç¡®å¯¹ç…§ï¼ˆ2026-02-06 æ·±åº¦æ‰«æï¼‰

> ä»¥ä¸‹åŸºäºé€ä¸ªè¯»å–åç«¯è·¯ç”±æ–‡ä»¶ + grep å‰ç«¯å…¨éƒ¨é¡µé¢/ç»„ä»¶çš„ API è°ƒç”¨æ±‡æ€»

### Aç±»ï¼šå‰ç«¯è°ƒç”¨äº† api.js ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ï¼ˆé¡µé¢ä¼šç›´æ¥æŠ¥é”™ï¼‰

| å‰ç«¯é¡µé¢ | è°ƒç”¨çš„æ–¹æ³• | api.js ä¸­æ˜¯å¦å­˜åœ¨ | è¯´æ˜ |
|---|---|---|---|
| `pages/admin/chat-management` | `API.closeChatSession(sessionId)` | âŒ ä¸å­˜åœ¨ | api.js æ— æ­¤æ–¹æ³•ï¼Œè°ƒç”¨å¿…æŠ¥é”™ |
| `pages/admin/chat-management` | `API.updateAdminStatus(status)` | âŒ ä¸å­˜åœ¨ | api.js æ— æ­¤æ–¹æ³•ï¼Œè°ƒç”¨å¿…æŠ¥é”™ |
| `pages/admin/customer-service` | `API.endChatSession({...})` | âŒ ä¸å­˜åœ¨ | api.js æ— æ­¤æ–¹æ³•ï¼Œè°ƒç”¨å¿…æŠ¥é”™ |
| `pages/camera_backupï¼ˆæ—§å¤‡ä»½ï¼‰` | `API.getConsumeRecords({...})` | âŒ ä¸å­˜åœ¨ | api.js æ— æ­¤æ–¹æ³•ï¼Œæ—§å¤‡ä»½æ–‡ä»¶ |
| `components/auth-modal` | `API.sendVerificationCode(phone)` | âŒ ä¸å­˜åœ¨ï¼ˆå·²æ³¨é‡Šï¼‰ | å·²æ³¨é‡Šæ‰ä½†ä»£ç é€»è¾‘è¿˜å¼•ç”¨ |
| `pages/exchange` | `API.getProductFilterConfig()` | âŒ ä¸å­˜åœ¨ï¼ˆTODOæ³¨é‡Šï¼‰ | æ³¨é‡Šä¸­çš„ TODOï¼Œåç«¯æ— æ­¤API |

### Bç±»ï¼šapi.js ä¸­å­˜åœ¨ä½†åç«¯è·¯ç”±å·²åºŸå¼ƒï¼ˆè°ƒç”¨ä¼š404ï¼‰

| api.js æ–¹æ³• | å‰ç«¯è°ƒç”¨è·¯å¾„ | åç«¯å®é™…çŠ¶æ€ | å½±å“é¡µé¢ |
|---|---|---|---|
| `uploadImage()` | `/api/v4/photo/upload` | âŒ è·¯ç”±ä¸å­˜åœ¨ï¼Œapp.js æœªæŒ‚è½½ /photo | `pages/chat/chat.js`ï¼ˆèŠå¤©å‘å›¾ï¼‰ã€`camera_backup` |
| `getMyUploads()` | `/api/v4/photo/my-uploads` | âŒ è·¯ç”±ä¸å­˜åœ¨ | `pages/records/trade-upload-records`ï¼ˆä¸Šä¼ è®°å½•tabï¼‰ |
| `getMyUploadStats()` | `/api/v4/photo/my-stats` | âŒ è·¯ç”±ä¸å­˜åœ¨ | `pages/records/trade-upload-records`ï¼ˆä¸Šä¼ ç»Ÿè®¡ï¼‰ |
| `getPendingReviews()` | `/api/v4/photo/pending-reviews` | âŒ è·¯ç”±ä¸å­˜åœ¨ï¼Œå®¡æ ¸å¹¶å…¥ content_review_records | å‰ç«¯æ— ç›´æ¥é¡µé¢è°ƒç”¨ |
| `reviewImage()` | `/api/v4/photo/review/:id` | âŒ è·¯ç”±ä¸å­˜åœ¨ | å‰ç«¯æ— ç›´æ¥é¡µé¢è°ƒç”¨ |
| `getUserIdentity()` | è¿”å›ç¡¬ç¼–ç é”™è¯¯ | âŒ ä»£ç å·²æ ‡è®° API_NOT_IMPLEMENTED | `components/qrcode/qrcode.js` |

### Cç±»ï¼šapi.js æ–¹æ³•å­˜åœ¨ï¼Œä½†è·¯å¾„ä¸åç«¯ä¸åŒ¹é…ï¼ˆè°ƒç”¨ä¼š404æˆ–åŠŸèƒ½å¼‚å¸¸ï¼‰

| api.js æ–¹æ³• | å‰ç«¯è·¯å¾„ | åç«¯çœŸå®è·¯å¾„ | å½±å“é¡µé¢ |
|---|---|---|---|
| `getPointsBalance(user_id)` | `/points/balance/:user_id` | `/api/v4/assets/balance`ï¼ˆGETï¼Œé€šè¿‡tokenè·å–å½“å‰ç”¨æˆ·ï¼‰ | `pages/exchange`ã€`pages/points-detail` |
| `getCurrentUserBalance()` | `/points/balance` | `/api/v4/assets/balance` | `pages/exchange` |
| `getPointsTransactions()` | `/points/transactions/:user_id` | `/api/v4/assets/transactions`ï¼ˆGETï¼Œé€šè¿‡tokenè¯†åˆ«ç”¨æˆ·ï¼‰ | `pages/points-detail`ã€`pages/records` |
| `getUserStatistics()` | `/points/user/statistics/:user_id` | `/api/v4/lottery/statistics/:user_id` æˆ–ä¸å­˜åœ¨ | `pages/user` |
| `getLotteryPrizes(code)` | `/lottery/prizes/:code` | `/api/v4/lottery/:code/prizes` | `pages/lottery` |
| `getLotteryConfig(code)` | `/lottery/config/:code` | `/api/v4/lottery/:code/config` | `pages/lottery` |
| `getUserInventory(user_id)` | `/inventory/user/:user_id` | `/api/v4/backpack/`ï¼ˆGETï¼Œé€šè¿‡tokenè¯†åˆ«ç”¨æˆ·ï¼‰ | `pages/trade/inventory` |
| `getInventoryItem(item_id)` | `/inventory/item/:item_id` | `/api/v4/backpack/*`ï¼ˆéœ€ç¡®è®¤è¯¦æƒ…è·¯å¾„ï¼‰ | `pages/trade/inventory` |
| `useInventoryItem(item_id)` | `/inventory/use/:item_id` | `/api/v4/backpack/*`ï¼ˆéœ€ç¡®è®¤æ“ä½œè·¯å¾„ï¼‰ | `pages/trade/inventory` |
| `getExchangeProducts()` | `/inventory/products` | `/api/v4/shop/exchange/items` | `pages/exchange` |
| `exchangeProduct()` | `/inventory/exchange` | `/api/v4/shop/exchange/`ï¼ˆPOSTï¼‰ | `pages/exchange` |
| `getExchangeRecords()` | `/inventory/exchange-records` | `/api/v4/shop/exchange/orders` | `pages/exchange` |
| `cancelExchange()` | `/inventory/exchange-records/:id/cancel` | `/api/v4/shop/exchange/orders/:order_no/status` | `pages/exchange` |
| `generateVerificationCode()` | `/inventory/generate-code/:item_id` | åç«¯æ— å¯¹åº”è·¯ç”± | `pages/trade/inventory` |
| `transferInventoryItem()` | `/inventory/transfer` | åç«¯æ— å¯¹åº”è·¯ç”±ï¼ˆå¸‚åœºä¸Šæ¶åœ¨ /market/sell/listï¼‰ | `pages/trade/inventory` |
| `getTransferHistory()` | `/inventory/transfer-history` | åç«¯æ— å¯¹åº”è·¯ç”± | `pages/trade/inventory` |
| `getAdminInventoryStatistics()` | `/inventory/admin/statistics` | `/api/v4/console/*`ï¼ˆç®¡ç†åå°åŸŸï¼‰ | æ— ç›´æ¥é¡µé¢è°ƒç”¨ |
| `getMarketProducts()` | `/inventory/market/products` | `/api/v4/market/listings` | `pages/trade/market` |
| `getMarketProductDetail(id)` | `/inventory/market/products/:id` | `/api/v4/market/listings/:market_listing_id` | `pages/trade/market` |
| `purchaseMarketProduct(id)` | `/inventory/market/products/:id/purchase` | `/api/v4/market/listings/:market_listing_id/purchase` | `pages/trade/market` |
| `withdrawMarketProduct(id)` | `/inventory/market/products/:id/withdraw` | `/api/v4/market/manage/listings/:market_listing_id/withdraw` | `pages/trade/market` |
| `submitConsumption()` | `/consumption/submit` | `/api/v4/shop/consumption/submit` | `pages/admin/consume-submit` |
| `getUserInfoByQRCode()` | `/consumption/user-info` | `/api/v4/shop/consumption/user-info` | `pages/admin/consume-submit` |
| `getUserQRCode(user_id)` | `/consumption/qrcode/:user_id` | `/api/v4/shop/consumption/qrcode/:user_id` | `pages/lottery` |
| `getPendingConsumption()` | `/consumption/pending` | `/api/v4/console/consumption/pending`ï¼ˆadminåŸŸï¼ŒéshopåŸŸï¼‰ | `pages/admin/audit-list` |
| `approveConsumption(id)` | `/consumption/approve/:id` | `/api/v4/console/consumption/approve/:id`ï¼ˆadminåŸŸï¼‰ | `pages/admin/audit-list` |
| `rejectConsumption(id)` | `/consumption/reject/:id` | `/api/v4/console/consumption/reject/:id`ï¼ˆadminåŸŸï¼‰ | `pages/admin/audit-list` |
| `getMyRecentAuditsCount()` | `/consumption/my-recent-audits/count` | åç«¯æ— å¯¹åº”è·¯ç”±ï¼ˆæ¶ˆè´¹æŸ¥è¯¢åœ¨ `/shop/consumption/me`ï¼‰ | `pages/lottery` |
| `getMyRecentAudits()` | `/consumption/my-recent-audits` | åç«¯æ— å¯¹åº”è·¯ç”±ï¼ˆæ¶ˆè´¹æŸ¥è¯¢åœ¨ `/shop/consumption/me`ï¼‰ | `pages/lottery` |
| `getAdminTodayStats()` | `/admin/statistics/today` | `/api/v4/console/dashboard/*` | `pages/admin/admin-dashboard`ã€`customer-service` |
| `getAdminUsers()` | `/admin/users` | `/api/v4/console/user_management/*` | æ— ç›´æ¥é¡µé¢è°ƒç”¨ |
| `adminAdjustPoints()` | `/points/admin/adjust` | `/api/v4/console/asset-adjustment/*` | æ— ç›´æ¥é¡µé¢è°ƒç”¨ |
| `getAdminPointsStatistics()` | `/points/admin/statistics` | `/api/v4/console/*` | æ— ç›´æ¥é¡µé¢è°ƒç”¨ |

### Dç±»ï¼šå‰ç«¯é¡µé¢åŠŸèƒ½ä¾èµ–åç«¯ä½†åç«¯ä¸æ”¯æŒ

| å‰ç«¯åŠŸèƒ½ | é¡µé¢ | è¯´æ˜ |
|---|---|---|
| èŠå¤©å‘é€å›¾ç‰‡ | `pages/chat/chat.js` L1413 | è°ƒç”¨ `API.uploadImage()`ï¼Œä½† /photo/upload è·¯ç”±ä¸å­˜åœ¨ï¼ŒèŠå¤©å‘å›¾åŠŸèƒ½ä¸å¯ç”¨ |
| ä¸Šä¼ è®°å½•tab | `pages/records/trade-upload-records` | æ•´ä¸ª"ä¸Šä¼ è®°å½•"tab ä¾èµ– `API.getMyUploads()` å’Œ `API.getMyUploadStats()`ï¼Œä¸¤ä¸ªè·¯ç”±å‡ä¸å­˜åœ¨ |
| ç”¨æˆ·ä¸­å¿ƒ-ä¸Šä¼ ç»Ÿè®¡ | `pages/user/user.js` L656 | `getUploadStatistics()` æ³¨é‡Šè¯´"å¾…åç«¯å®ç°"ï¼Œå®é™…å·²åºŸå¼ƒ |
| äºŒç»´ç ç»„ä»¶ | `components/qrcode/qrcode.js` L149 | è°ƒç”¨ `API.getUserIdentity()`ï¼Œç¡¬ç¼–ç è¿”å›å¤±è´¥ |
| å‘é€éªŒè¯ç  | `components/auth-modal` L247 | `API.sendVerificationCode()` å·²æ³¨é‡Šï¼Œä½†æ•´ä½“é€»è¾‘ä»å¼•ç”¨ |
| å…³é—­/ç»“æŸå®¢æœä¼šè¯ | `pages/admin/chat-management` L565 | `API.closeChatSession()` ä¸å­˜åœ¨ï¼Œåç«¯ chat.js æ— å…³é—­ä¼šè¯è·¯ç”± |
| ç»“æŸå®¢æœä¼šè¯ | `pages/admin/customer-service` L1000 | `API.endChatSession()` ä¸å­˜åœ¨ |
| æ›´æ–°ç®¡ç†å‘˜åœ¨çº¿çŠ¶æ€ | `pages/admin/chat-management` L612 | `API.updateAdminStatus()` ä¸å­˜åœ¨ |
| æäº¤åé¦ˆå‚æ•°ä¸åŒ¹é… | `pages/feedback/feedback.js` L276 | å‰ç«¯è°ƒ `submitFeedback(content, imageData, category)` ä¼ 3å‚ï¼Œapi.jså®šä¹‰ `submitFeedback(type, content, contact)` å‚æ•°è¯­ä¹‰å¯¹ä¸ä¸Š |

### Eç±»ï¼šåç«¯æœ‰ä½†å‰ç«¯å®Œå…¨æœªå¯¹æ¥çš„èƒ½åŠ›

| åç«¯èƒ½åŠ› | è·¯ç”± | è¯´æ˜ |
|---|---|---|
| å¼¹çª—æ¨ªå¹… | `/api/v4/system/popup-banners` | æ•°æ®åº“æœ‰4æ¡è®°å½•ï¼Œå‰ç«¯æœªå¯¹æ¥ |
| å¸‚åœºä¸Šæ¶ | `/api/v4/market/sell/list` | ç”¨æˆ·ä¸Šæ¶ç‰©å“åˆ°å¸‚åœº |
| å¯å åŠ èµ„äº§ä¸Šæ¶ | `/api/v4/market/sell/fungible-assets/list` | ä¸Šæ¶ç§¯åˆ†ç­‰å¯å åŠ èµ„äº§ |
| å¸‚åœºç­›é€‰é¢æ¿ | `/api/v4/market/listings/facets` | å¸‚åœºåˆ†ç±»ç­›é€‰æ•°æ® |
| å¸‚åœºæŒ‚å•çŠ¶æ€ | `/api/v4/market/listing-status` | æŸ¥è¯¢è‡ªå·±çš„æŒ‚å•çŠ¶æ€ |
| èƒŒåŒ…ç»Ÿè®¡ | `/api/v4/backpack/stats` | èƒŒåŒ…ç‰©å“ç»Ÿè®¡ |
| èµ„äº§ä½™é¢æ˜ç»† | `/api/v4/assets/balances` | å¤šç§èµ„äº§ä½™é¢æŸ¥è¯¢ |
| èµ„äº§è½¬æ¢è§„åˆ™ | `/api/v4/assets/conversion-rules` | ç¢ç‰‡åˆæˆç­‰ |
| ç”¨æˆ·ä¸ªäººä¿¡æ¯ | `/api/v4/user/me` | ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ |
| æ¶ˆè´¹è®°å½•æŸ¥è¯¢ | `/api/v4/shop/consumption/me` | ç”¨æˆ·æŸ¥è‡ªå·±çš„æ¶ˆè´¹è®°å½• |
| æ¶ˆè´¹è®°å½•è¯¦æƒ… | `/api/v4/shop/consumption/detail/:id` | å•æ¡æ¶ˆè´¹è®°å½•è¯¦æƒ… |
| å•†å®¶æ¶ˆè´¹è®°å½•æŸ¥è¯¢ | `/api/v4/shop/consumption/merchant/list` | å•†å®¶æŸ¥è¯¢é—¨åº—æ¶ˆè´¹è®°å½• |
| å•†å®¶æ¶ˆè´¹ç»Ÿè®¡ | `/api/v4/shop/consumption/merchant/stats` | å•†å®¶é—¨åº—ç»Ÿè®¡ |
| å…‘æ¢å•†å“è¯¦æƒ… | `/api/v4/shop/exchange/items/:exchange_item_id` | å•ä¸ªå•†å“è¯¦æƒ… |
| å…‘æ¢è®¢å•è¯¦æƒ… | `/api/v4/shop/exchange/orders/:order_no` | å•ä¸ªè®¢å•è¯¦æƒ… |
| ç³»ç»Ÿå­—å…¸ | `/api/v4/system/dictionaries` | ä¸­æ–‡åŒ–æ˜¾ç¤ºåç§° |
| ç³»ç»Ÿé€šçŸ¥ | `/api/v4/system/notifications` | ç³»ç»Ÿé€šçŸ¥ |
| æ´»åŠ¨åˆ—è¡¨ | `/api/v4/activities` | æ´»åŠ¨åŠŸèƒ½ |

---

## åäºŒã€æœ€ç»ˆç»Ÿè®¡ï¼ˆæ›´æ–°ï¼‰

| æŒ‡æ ‡ | æ•°å€¼ |
|---|---|
| å‰ç«¯ api.js å®šä¹‰çš„æ–¹æ³•æ€»æ•° | 50ä¸ª |
| âœ… Aç±»ï¼šé¡µé¢è°ƒç”¨ä¸å­˜åœ¨çš„æ–¹æ³•ï¼ˆå¿…å´©ï¼‰ | 6å¤„ |
| âŒ Bç±»ï¼šapi.jsæ–¹æ³•å­˜åœ¨ä½†åç«¯è·¯ç”±å·²åºŸå¼ƒï¼ˆå¿…404ï¼‰ | 6ä¸ªæ–¹æ³• |
| âŒ Cç±»ï¼šè·¯å¾„ä¸åŒ¹é…éœ€ä¿®æ­£ | çº¦28ä¸ªæ–¹æ³• |
| âš ï¸ Dç±»ï¼šé¡µé¢åŠŸèƒ½ä¾èµ–ä¸å­˜åœ¨çš„åç«¯ï¼ˆåŠŸèƒ½ä¸å¯ç”¨ï¼‰ | 9å¤„ |
| ğŸ†• Eç±»ï¼šåç«¯æœ‰ä½†å‰ç«¯æœªå¯¹æ¥ | 18+ä¸ªèƒ½åŠ› |
| å‰ç«¯æœ‰ä½†åç«¯æ— çš„å®Œæ•´åŠŸèƒ½ | å›¾ç‰‡ä¸Šä¼ /å®¡æ ¸æ•´å¥—ï¼ˆ5ä¸ªAPIï¼‰+ getUserIdentityï¼ˆ1ä¸ªï¼‰ |

**ç»“è®º**ï¼šé—®é¢˜ä¸åªæ˜¯ photo å®¡æ ¸è¿™ä¸€ç±»ã€‚å‰ç«¯é¡¹ç›®ä¸­å­˜åœ¨ **6ç±»ç³»ç»Ÿæ€§é—®é¢˜**ï¼Œæ¶‰åŠçº¦ 50 å¤„éœ€è¦ä¿®æ”¹çš„ä½ç½®ã€‚æ ¸å¿ƒåŸå› æ˜¯å‰ç«¯ api.js çš„è·¯å¾„æ˜¯åŸºäºæ—§ç‰ˆè®¾è®¡æ–‡æ¡£ç¼–å†™çš„ï¼Œä¸åç«¯å®é™…è·¯ç”±ç»“æ„ï¼ˆç»è¿‡å¤šæ¬¡é‡æ„åçš„ V4.7.0 æ¶æ„ï¼‰å­˜åœ¨ç³»ç»Ÿæ€§åå·®ã€‚

---

## åä¸‰ã€ğŸ”´ å‰ç«¯æƒ³è¦ä½†åç«¯å·²æ”¾å¼ƒæˆ–åˆå¹¶çš„åŠŸèƒ½æ¸…å•ï¼ˆ2026-02-06 ç²¾ç¡®æ’æŸ¥ï¼‰

> ä»¥ä¸‹æ¯ä¸€æ¡éƒ½ç»è¿‡åç«¯è·¯ç”±æ–‡ä»¶é€è¡Œç¡®è®¤ + æ•°æ®åº“è¡¨ç»“æ„éªŒè¯

### 1. ğŸ“¸ å›¾ç‰‡ç‹¬ç«‹ä¸Šä¼ /å®¡æ ¸ â†’ å·²åºŸå¼ƒï¼Œå›¾ç‰‡å˜ä¸ºç®¡ç†åå°å†…éƒ¨å·¥å…·

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ `uploadImage()` | api.js L1587ã€chat.js L1413ã€camera_backup | âŒ `/photo/upload` è·¯ç”±ä¸å­˜åœ¨ï¼Œapp.js æœªæŒ‚è½½ |
| æŸ¥çœ‹æˆ‘çš„ä¸Šä¼  `getMyUploads()` | api.js L1826ã€trade-upload-records.js L430 | âŒ `/photo/my-uploads` è·¯ç”±ä¸å­˜åœ¨ |
| ä¸Šä¼ ç»Ÿè®¡ `getMyUploadStats()` | api.js L1845ã€trade-upload-records.js L452 | âŒ `/photo/my-stats` è·¯ç”±ä¸å­˜åœ¨ |
| å¾…å®¡æ ¸å›¾ç‰‡åˆ—è¡¨ `getPendingReviews()` | api.js L2065 | âŒ `/photo/pending-reviews` è·¯ç”±ä¸å­˜åœ¨ |
| å®¡æ ¸å›¾ç‰‡ `reviewImage()` | api.js L2083 | âŒ `/photo/review/:id` è·¯ç”±ä¸å­˜åœ¨ |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- `image_resources` è¡¨ **0æ¡è®°å½•**ï¼ˆä»æœªä½¿ç”¨ï¼‰
- `content_review_records` è¡¨ 422æ¡è®°å½•ï¼Œå®¡æ ¸ç±»å‹åªæœ‰ `consumption` å’Œ `merchant_points`ï¼Œ**æ²¡æœ‰ image ç±»å‹**
- å›¾ç‰‡ä¸Šä¼ å·²æ•´åˆä¸ºç®¡ç†åå°é€šç”¨å·¥å…·ï¼š`/api/v4/console/images`ï¼ˆä»…ç®¡ç†å‘˜å¯ç”¨ï¼‰
- **ç»“è®ºï¼šæ•´å¥—å›¾ç‰‡ä¸Šä¼ /å®¡æ ¸/æŸ¥çœ‹åŠŸèƒ½å·²è¢«åç«¯å½»åº•æ”¾å¼ƒï¼Œä¸å†é¢å‘ç”¨æˆ·ç«¯**

### 2. ğŸ”„ ç‰©å“ç›´æ¥è½¬ç§»/èµ é€ â†’ å·²åºŸå¼ƒï¼Œè¢«äº¤æ˜“å¸‚åœºï¼ˆmarketï¼‰å–ä»£

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| è½¬ç§»ç‰©å“ `transferInventoryItem()` | api.js L1447 | âŒ åç«¯æ—  `/inventory/transfer` è·¯ç”± |
| è½¬ç§»å†å² `getTransferHistory()` | api.js L1469 | âŒ åç«¯æ—  `/inventory/transfer-history` è·¯ç”± |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- æ•°æ®åº“**æ²¡æœ‰ç‹¬ç«‹çš„ transfer è¡¨**
- `item_instances` è¡¨æœ‰ `transferred` çŠ¶æ€ï¼ˆ330æ¡è®°å½•ï¼‰ï¼Œä½†è¿™æ˜¯é€šè¿‡å¸‚åœºäº¤æ˜“å®Œæˆçš„
- ç‰©å“æ‰€æœ‰æƒè½¬ç§»ç»Ÿä¸€é€šè¿‡ **å¸‚åœºäº¤æ˜“æµç¨‹** å®ç°ï¼š`/api/v4/market/sell/list`ï¼ˆä¸Šæ¶ï¼‰â†’ `/api/v4/market/listings/:id/purchase`ï¼ˆè´­ä¹°ï¼Œè‡ªåŠ¨è½¬ç§»æ‰€æœ‰æƒï¼‰
- **ç»“è®ºï¼šå‰ç«¯"ç›´æ¥è½¬ç§»/èµ é€"åŠŸèƒ½å·²è¢«åç«¯åºŸå¼ƒï¼Œç”¨å¸‚åœºä¹°å–æ›¿ä»£äº†ç‚¹å¯¹ç‚¹è½¬ç§»**

### 3. ğŸ”‘ ç‹¬ç«‹ç”Ÿæˆæ ¸é”€ç  â†’ å·²åˆå¹¶åˆ° redemptionï¼ˆæ ¸é”€è®¢å•ï¼‰ä½“ç³»

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| ç”Ÿæˆæ ¸é”€ç  `generateVerificationCode()` | api.js L1430ã€inventory.js L619 | âŒ `/inventory/generate-code/:item_id` è·¯ç”±ä¸å­˜åœ¨ |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- æ ¸é”€å·²é‡æ„ä¸ºå®Œæ•´çš„ **redemption_orders** ä½“ç³»ï¼ˆ1180æ¡è®°å½•ï¼‰
- æ–°æµç¨‹ï¼š`/api/v4/shop/redemption/orders`ï¼ˆPOSTï¼Œåˆ›å»ºæ ¸é”€è®¢å•è‡ªåŠ¨ç”Ÿæˆcode_hashï¼‰â†’ `/api/v4/shop/redemption/fulfill`ï¼ˆPOSTï¼Œæ ¸é”€ï¼‰
- **ç»“è®ºï¼šå‰ç«¯çš„"ç‹¬ç«‹ç”Ÿæˆæ ¸é”€ç "å·²åºŸå¼ƒï¼Œæ”¹ä¸ºåœ¨åˆ›å»ºæ ¸é”€è®¢å•æ—¶è‡ªåŠ¨ç”Ÿæˆ**

### 4. âŒ å–æ¶ˆå…‘æ¢ â†’ å·²åºŸå¼ƒï¼Œå…‘æ¢è®¢å•èµ°å®Œæ•´è®¢å•çŠ¶æ€æœº

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| å–æ¶ˆå…‘æ¢ `cancelExchange()` | api.js L1415 | âŒ `/inventory/exchange-records/:id/cancel` è·¯ç”±ä¸å­˜åœ¨ |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- `exchange_records` è¡¨ **0æ¡è®°å½•**ï¼ˆå…‘æ¢è®¢å•ç›®å‰å…¨éƒ¨èµ° `redemption_orders`ï¼‰
- å…‘æ¢è®¢å•çŠ¶æ€ç®¡ç†åœ¨ï¼š`/api/v4/shop/exchange/orders/:order_no/status`ï¼ˆPOSTï¼Œç®¡ç†å‘˜æ“ä½œï¼‰
- ç”¨æˆ·ç«¯å–æ¶ˆèµ°ï¼š`/api/v4/shop/redemption/orders/:order_id/cancel`
- **ç»“è®ºï¼šå‰ç«¯çš„ cancelExchange è·¯å¾„å’Œé€»è¾‘éƒ½å·²åºŸå¼ƒï¼Œéœ€æ”¹ç”¨ redemption è®¢å•å–æ¶ˆæµç¨‹**

### 5. ğŸ‘¤ ç‹¬ç«‹ç”¨æˆ·èº«ä»½æ¥å£ â†’ å·²åºŸå¼ƒï¼Œèº«ä»½ä¿¡æ¯åˆå¹¶åˆ° auth/profile å’Œ QRç 

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| è·å–ç”¨æˆ·èº«ä»½ `getUserIdentity()` | api.js L1017ã€qrcode.js L149 | âŒ ç¡¬ç¼–ç è¿”å› `API_NOT_IMPLEMENTED` |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- åç«¯æ—  `/auth/user-identity` è·¯ç”±ï¼Œä¹Ÿä»æœªè®¡åˆ’å®ç°
- ç”¨æˆ·ä¿¡æ¯é€šè¿‡ `/api/v4/auth/profile` è·å–
- äºŒç»´ç é€šè¿‡ `/api/v4/shop/consumption/qrcode/:user_id` è·å–ï¼ˆåŒ…å« qr_code å­—ç¬¦ä¸²å’Œç­¾åï¼‰
- **ç»“è®ºï¼šå‰ç«¯éœ€è¦ç»„åˆ profile + qrcode ä¸¤ä¸ªå·²æœ‰APIï¼Œä¸å†éœ€è¦ç‹¬ç«‹çš„ getUserIdentity**

### 6. ğŸ“© å‘é€çŸ­ä¿¡éªŒè¯ç  â†’ å·²åºŸå¼ƒï¼Œå½“å‰é˜¶æ®µç›´æ¥ç”¨ä¸‡èƒ½ç 

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| å‘é€éªŒè¯ç  `sendVerificationCode()` | auth-modal.js L247ï¼ˆå·²æ³¨é‡Šï¼‰ | âŒ åç«¯æ—  send-verification-code è·¯ç”± |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- `routes/v4/auth/` ç›®å½•ä¸‹**æ²¡æœ‰å‘é€éªŒè¯ç çš„è·¯ç”±**
- ç™»å½•ç›´æ¥ç”¨ `POST /api/v4/auth/login`ï¼Œbody ä¼  `{ mobile, verification_code }`
- å¼€å‘/æµ‹è¯•é˜¶æ®µä¸‡èƒ½éªŒè¯ç  `123456`
- **ç»“è®ºï¼šçŸ­ä¿¡éªŒè¯ç å‘é€åŠŸèƒ½åç«¯ä»æœªå®ç°ï¼Œå‰ç«¯åº”åˆ é™¤å‘é€æŒ‰é’®çš„ API è°ƒç”¨é€»è¾‘ï¼Œåªä¿ç•™è¾“å…¥æ¡†**

### 7. ğŸ”’ å®¢æœä¼šè¯å…³é—­/ç»“æŸ â†’ ç”¨æˆ·ç«¯æ— æƒæ“ä½œï¼Œå·²ç§»åˆ°ç®¡ç†åå° console

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| å…³é—­ä¼šè¯ `closeChatSession()` | chat-management.js L565 | âŒ api.js æ— æ­¤æ–¹æ³• |
| ç»“æŸä¼šè¯ `endChatSession()` | customer-service.js L1000 | âŒ api.js æ— æ­¤æ–¹æ³• |
| æ›´æ–°ç®¡ç†å‘˜çŠ¶æ€ `updateAdminStatus()` | chat-management.js L612 | âŒ api.js æ— æ­¤æ–¹æ³• |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- å…³é—­ä¼šè¯åŠŸèƒ½**åªå­˜åœ¨äºç®¡ç†åå°åŸŸ**ï¼š`/api/v4/console/customer-service/sessions/:id/close`ï¼ˆPOSTï¼‰
- è¯¥è·¯ç”±åœ¨ `/api/v4/console` ä¸‹ï¼Œéœ€è¦ admin æƒé™ï¼ˆrequireRoleLevel(100)ï¼‰
- ç”¨æˆ·ç«¯çš„ `/api/v4/system/chat/` è·¯ç”±åªæœ‰ï¼šåˆ›å»ºä¼šè¯ã€è·å–ä¼šè¯åˆ—è¡¨ã€è·å–æ¶ˆæ¯ã€å‘é€æ¶ˆæ¯ï¼ˆ4ä¸ªï¼‰ï¼Œ**æ²¡æœ‰å…³é—­/ç»“æŸæ“ä½œ**
- **ç»“è®ºï¼šç”¨æˆ·ç«¯å°ç¨‹åºä¸åº”æœ‰å…³é—­ä¼šè¯åŠŸèƒ½ã€‚å¦‚æœå°ç¨‹åºå†…çš„ç®¡ç†å‘˜é¡µé¢éœ€è¦æ­¤åŠŸèƒ½ï¼Œéœ€æ”¹è°ƒ console åŸŸçš„è·¯ç”±**

### 8. ğŸ“Š ç”¨æˆ·ç«¯æŸ¥çœ‹å®¡æ ¸è®°å½• â†’ åŠŸèƒ½è·¯å¾„ä¸åç«¯ä¸åŒ¹é…

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| å®¡æ ¸è®°å½•æ•°é‡ `getMyRecentAuditsCount()` | api.js L541ã€lottery.js L2476 | âŒ `/consumption/my-recent-audits/count` è·¯ç”±ä¸å­˜åœ¨ |
| æœ€è¿‘å®¡æ ¸è®°å½• `getMyRecentAudits()` | api.js L586ã€lottery.js L2521 | âŒ `/consumption/my-recent-audits` è·¯ç”±ä¸å­˜åœ¨ |

**åç«¯å®é™…çŠ¶æ€**ï¼š
- ç”¨æˆ·æŸ¥çœ‹è‡ªå·±çš„æ¶ˆè´¹è®°å½•èµ°ï¼š`/api/v4/shop/consumption/me`ï¼ˆGETï¼Œæ”¯æŒåˆ†é¡µå’ŒçŠ¶æ€ç­›é€‰ï¼‰
- æ²¡æœ‰ç‹¬ç«‹çš„"å®¡æ ¸è®°å½•"æ¦‚å¿µï¼Œæ¶ˆè´¹è®°å½•è‡ªå¸¦ `status` å­—æ®µï¼ˆpending/approved/rejectedï¼‰
- **ç»“è®ºï¼šå‰ç«¯éœ€è¦æ”¹ç”¨ `/shop/consumption/me` å¹¶é€šè¿‡ status å‚æ•°ç­›é€‰ï¼Œè€Œä¸æ˜¯ç‹¬ç«‹çš„å®¡æ ¸è®°å½•æ¥å£**

### 9. ğŸ“‹ åé¦ˆæäº¤å‚æ•°ç­¾åä¸åŒ¹é… â†’ æ¥å£å­˜åœ¨ä½†å‚æ•°å·²å˜

| å‰ç«¯åŠŸèƒ½ | å‰ç«¯ä»£ç ä½ç½® | åç«¯çŠ¶æ€ |
|---|---|---|
| æäº¤åé¦ˆ `submitFeedback()` | feedback.js L276 | âš ï¸ è·¯ç”±å­˜åœ¨ä½†å‚æ•°ä¸åŒ¹é… |

**å…·ä½“é—®é¢˜**ï¼š
- å‰ç«¯è°ƒç”¨ï¼š`API.submitFeedback(feedbackContent, imageData, selectedCategory)` â€” ä¼  (å†…å®¹, å›¾ç‰‡, åˆ†ç±»)
- api.js å®šä¹‰ï¼š`submitFeedback(type, content, contact)` â€” ç­¾å (ç±»å‹, å†…å®¹, è”ç³»æ–¹å¼)
- åç«¯æ¥æ”¶ï¼š`req.body.{ category, content, priority, attachments }` â€” å­—æ®µåå®Œå…¨ä¸åŒ
- **ç»“è®ºï¼šå‰ç«¯é¡µé¢è°ƒç”¨ã€api.js å‡½æ•°ç­¾åã€åç«¯æ¥æ”¶å‚æ•°ä¸‰æ–¹å…¨éƒ¨å¯¹ä¸ä¸Šï¼Œéœ€è¦ç»Ÿä¸€**

---

### æ±‡æ€»ï¼š9ä¸ª"å‰ç«¯æƒ³è¦ä½†åç«¯å·²æ”¾å¼ƒ/åˆå¹¶"çš„åŠŸèƒ½

| # | åŠŸèƒ½ | åç«¯å¤„ç†æ–¹å¼ | å‰ç«¯å½±å“èŒƒå›´ |
|---|---|---|---|
| 1 | å›¾ç‰‡ä¸Šä¼ /å®¡æ ¸ï¼ˆ5ä¸ªAPIï¼‰ | åºŸå¼ƒï¼Œå˜ä¸ºç®¡ç†åå°å†…éƒ¨å·¥å…· | chat.jsã€trade-upload-recordsã€user.js |
| 2 | ç‰©å“ç›´æ¥è½¬ç§»/èµ é€ï¼ˆ2ä¸ªAPIï¼‰ | åºŸå¼ƒï¼Œè¢«äº¤æ˜“å¸‚åœºæ›¿ä»£ | trade/inventory.js |
| 3 | ç‹¬ç«‹ç”Ÿæˆæ ¸é”€ç ï¼ˆ1ä¸ªAPIï¼‰ | åˆå¹¶åˆ° redemption è®¢å•ä½“ç³» | trade/inventory.js |
| 4 | å–æ¶ˆå…‘æ¢ï¼ˆ1ä¸ªAPIï¼‰ | åºŸå¼ƒï¼Œæ”¹èµ° redemption è®¢å•å–æ¶ˆ | exchange.js |
| 5 | ç‹¬ç«‹ç”¨æˆ·èº«ä»½æ¥å£ï¼ˆ1ä¸ªAPIï¼‰ | åºŸå¼ƒï¼Œç”¨ profile + qrcode ç»„åˆæ›¿ä»£ | qrcode ç»„ä»¶ |
| 6 | å‘é€çŸ­ä¿¡éªŒè¯ç ï¼ˆ1ä¸ªAPIï¼‰ | ä»æœªå®ç°ï¼Œä¸‡èƒ½ç æ›¿ä»£ | auth-modal ç»„ä»¶ |
| 7 | å®¢æœä¼šè¯å…³é—­ï¼ˆ3ä¸ªæ–¹æ³•è°ƒç”¨ï¼‰ | ç§»åˆ°ç®¡ç†åå° console åŸŸ | admin/chat-managementã€customer-service |
| 8 | ç”¨æˆ·å®¡æ ¸è®°å½•æŸ¥è¯¢ï¼ˆ2ä¸ªAPIï¼‰ | æ— ç‹¬ç«‹æ¥å£ï¼Œæ”¹ç”¨æ¶ˆè´¹è®°å½• + status ç­›é€‰ | lottery.js |
| 9 | åé¦ˆæäº¤å‚æ•° | æ¥å£åœ¨ä½†å‚æ•°ä¸‰æ–¹ä¸ä¸€è‡´ | feedback.js |

---

## åå››ã€ğŸ¯ äº§å“å†³ç­–è®°å½•ï¼ˆ2026-02-06ï¼‰

> ä»¥ä¸‹ä¸ºäº§å“è´Ÿè´£äººæ‹æ¿çš„å†³ç­–ï¼Œä½œä¸ºåç»­å‰ç«¯é€‚é…æ”¹é€ çš„æ‰§è¡Œä¾æ®ã€‚

### âœ… å†³å®š2ï¼šã€Œä¸Šä¼ è®°å½•ã€tab â†’ **Bï¼‰æ”¹é€ ä¸º"æ¶ˆè´¹è®°å½•"**

- **åŸçŠ¶**ï¼š`pages/records/trade-upload-records` çš„ Tab1"ä¸Šä¼ è®°å½•"ä¾èµ– `getMyUploads` + `getMyUploadStats`ï¼Œä¸¤ä¸ªAPIåç«¯å·²åºŸå¼ƒ
- **å†³ç­–**ï¼šå°†"ä¸Šä¼ è®°å½•"tab æ”¹é€ ä¸º **"æ¶ˆè´¹è®°å½•"** tab
- **å¯¹æ¥API**ï¼š`GET /api/v4/shop/consumption/me`ï¼ˆæŸ¥çœ‹ç”¨æˆ·è‡ªå·±çš„æ¶ˆè´¹ç§¯åˆ†è®°å½•ï¼Œæ”¯æŒåˆ†é¡µå’Œ status ç­›é€‰ï¼‰
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - Tab æ–‡æ¡ˆæ”¹ä¸º"æ¶ˆè´¹è®°å½•"
  - æ•°æ®åŠ è½½æ”¹è°ƒ `/shop/consumption/me`
  - æ•°æ®æ ¼å¼è½¬æ¢é€‚é…é¡µé¢å±•ç¤ºï¼ˆä¸æ”¹ WXML/WXSS ç»“æ„ï¼‰
  - åˆ é™¤ `getMyUploads`ã€`getMyUploadStats` ç›¸å…³è°ƒç”¨

### âœ… å†³å®š4ï¼šç‰©å“ã€Œè½¬ç§»/èµ é€ã€â†’ **Bï¼‰æ”¹ä¸ºè·³è½¬å¸‚åœºä¸Šæ¶**

- **åŸçŠ¶**ï¼šå‰ç«¯åº“å­˜é¡µé¢æœ‰"è½¬ç§»ç‰©å“ç»™å¥½å‹"åŠŸèƒ½ï¼Œè°ƒç”¨ `transferInventoryItem` å’Œ `getTransferHistory`ï¼Œåç«¯å·²åºŸå¼ƒ
- **å†³ç­–**ï¼šå°†"è½¬ç§»ç»™å¥½å‹"æ”¹ä¸º **"ä¸Šæ¶åˆ°å¸‚åœºå‡ºå”®"**
- **å¯¹æ¥API**ï¼š`POST /api/v4/market/sell/list`ï¼ˆä¸Šæ¶ç‰©å“åˆ°äº¤æ˜“å¸‚åœºï¼‰
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - æŒ‰é’®æ–‡æ¡ˆ/æ“ä½œæµç¨‹æ”¹ä¸º"ä¸Šæ¶åˆ°å¸‚åœº"
  - è°ƒç”¨ `/market/sell/list` æ›¿ä»£åŸæ¥çš„ `/inventory/transfer`
  - "è½¬ç§»å†å²"æ”¹ä¸ºè·³è½¬åˆ°äº¤æ˜“å¸‚åœºé¡µé¢æŸ¥çœ‹æŒ‚å•çŠ¶æ€ï¼ˆ`/market/listing-status`ï¼‰
  - åˆ é™¤ `transferInventoryItem`ã€`getTransferHistory` ç›¸å…³è°ƒç”¨

### âœ… å†³å®š6ï¼šäºŒç»´ç ç”Ÿæˆ â†’ **ç»„åˆ profile + qrcode ä¸¤ä¸ªAPI**

- **åŸçŠ¶**ï¼š`qrcode` ç»„ä»¶è°ƒç”¨ `getUserIdentity()`ï¼Œç¡¬ç¼–ç è¿”å›å¤±è´¥
- **å†³ç­–**ï¼šç»„åˆå·²æœ‰çš„ä¸¤ä¸ªåç«¯APIæ›¿ä»£
- **ç¡®è®¤**ï¼šäºŒç»´ç æ˜¯ç»™å•†å®¶æ‰«ç å½•å…¥æ¶ˆè´¹ç”¨çš„ âœ…
- **å¯¹æ¥API**ï¼š
  - `GET /api/v4/auth/profile` â†’ è·å– user_idã€nicknameã€phone
  - `GET /api/v4/shop/consumption/qrcode/:user_id` â†’ è·å–äºŒç»´ç å­—ç¬¦ä¸²ï¼ˆå« HMAC-SHA256 é˜²ä¼ªç­¾åï¼‰
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - å…ˆè°ƒ profile æ‹¿ user_id
  - å†è°ƒ qrcode API æ‹¿äºŒç»´ç å­—ç¬¦ä¸²
  - ç”¨äºŒç»´ç å­—ç¬¦ä¸²æ¸²æŸ“ QR ç å›¾ç‰‡
  - åˆ é™¤ `getUserIdentity` æ–¹æ³•åŠç›¸å…³è°ƒç”¨

### âœ… å†³å®š1ï¼šå°ç¨‹åºç®¡ç†å‘˜é¡µé¢ â†’ **ä¿ç•™4ä¸ªï¼Œç§»é™¤1ä¸ª**

- **åŸçŠ¶**ï¼šå°ç¨‹åºæœ‰5ä¸ªç®¡ç†å‘˜é¡µé¢ï¼Œåç«¯è¿™äº›åŠŸèƒ½åœ¨ `/api/v4/console/*` ä¸‹
- **å†³ç­–**ï¼šä¿ç•™ä»¥ä¸‹4ä¸ªé¡µé¢ï¼Œç§»é™¤ `admin-dashboard`
- **ä¿ç•™çš„é¡µé¢**ï¼š
  - `admin/consume-submit` â€” æ¶ˆè´¹å½•å…¥ï¼ˆå•†å®¶æ‰«ç ï¼‰ï¼Œæ”¹è°ƒ `/api/v4/shop/consumption/submit`
  - `admin/audit-list` â€” æ¶ˆè´¹å®¡æ ¸ï¼Œæ”¹è°ƒ `/api/v4/console/consumption/pending`ã€`/approve/:id`ã€`/reject/:id`
  - `admin/customer-service` â€” å®æ—¶å®¢æœï¼Œæ”¹è°ƒ `/api/v4/console/customer-service/sessions/*`
  - `admin/chat-management` â€” èŠå¤©å·¥ä½œå°ï¼Œæ”¹è°ƒ `/api/v4/console/customer-service/sessions/*`
- **ç§»é™¤çš„é¡µé¢**ï¼š
  - `admin/admin-dashboard` â€” ç®¡ç†å‘˜ä»ªè¡¨æ¿ï¼ˆç®¡ç†å‘˜ç»Ÿè®¡åŠŸèƒ½èµ°ç‹¬ç«‹åå°ï¼‰
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - ä» `app.json` çš„ pages åˆ—è¡¨ä¸­ç§»é™¤ `pages/admin/admin-dashboard/admin-dashboard`
  - 4ä¸ªä¿ç•™é¡µé¢çš„ API è·¯å¾„æ”¹ä¸ºå¯¹åº”çš„ console åŸŸè·¯ç”±
  - `customer-service` å’Œ `chat-management` ä¸­çš„ `closeChatSession`/`endChatSession`/`updateAdminStatus` æ”¹è°ƒ `/api/v4/console/customer-service/sessions/:id/close`

### âœ… å†³å®š3ï¼šèŠå¤©å‘å›¾ç‰‡ â†’ **å…ˆç æ‰ï¼Œç­‰åç«¯æä¾›èŠå¤©ä¸“ç”¨å›¾ç‰‡ä¸Šä¼ æ¥å£å†æ¢å¤**

- **åŸçŠ¶**ï¼š`pages/chat/chat.js` L1413 è°ƒç”¨ `API.uploadImage()` å‘é€å›¾ç‰‡æ¶ˆæ¯ï¼Œåç«¯ `/photo/upload` å·²åºŸå¼ƒ
- **å†³ç­–**ï¼šæš‚æ—¶ç¦ç”¨èŠå¤©å‘å›¾åŠŸèƒ½ï¼Œç­‰åç«¯æä¾›èŠå¤©ä¸“ç”¨å›¾ç‰‡ä¸Šä¼ æ¥å£åå†æ¢å¤
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - æ³¨é‡Šæ‰ `chat.js` ä¸­è°ƒç”¨ `API.uploadImage()` çš„ä»£ç è·¯å¾„
  - å‘å›¾æŒ‰é’®æ”¹ä¸ºæç¤º"å›¾ç‰‡å‘é€åŠŸèƒ½æš‚ä¸å¯ç”¨"æˆ–éšè—å‘å›¾å…¥å£
  - ä¿ç•™æ–‡å­—èŠå¤©åŠŸèƒ½ä¸å—å½±å“
  - åœ¨ä»£ç ä¸­æ ‡æ³¨ `// TODO: ç­‰åç«¯æä¾›èŠå¤©å›¾ç‰‡ä¸Šä¼ æ¥å£åæ¢å¤`

### âœ… å†³å®š5ï¼šã€Œå‘ç°ã€é¡µ â†’ **Bï¼‰ä¿æŒç°çŠ¶ï¼Œä»…ä½œä¸ºé™æ€å¯¼èˆªé¡µ**

- **åŸçŠ¶**ï¼š`pages/camera/camera` åŸºæœ¬æ˜¯é™æ€å¯¼èˆªé¡µï¼Œåç«¯æœ‰ `/api/v4/activities` å¯ç”¨
- **å†³ç­–**ï¼šä¸æ”¹ï¼Œä¿æŒé™æ€å¯¼èˆªé¡µ
- **è¯´æ˜**ï¼šæš‚ä¸å¯¹æ¥æ´»åŠ¨åˆ—è¡¨ APIï¼Œåç»­æœ‰éœ€æ±‚å†è¿­ä»£

### âœ… å†³å®š7ï¼šå¼¹çª—æ¨ªå¹… â†’ **Aï¼‰åŠ ä¸Šï¼Œåœ¨é¦–é¡µæˆ–æŠ½å¥–é¡µå±•ç¤º**

- **åŸçŠ¶**ï¼šåç«¯ `popup_banners` è¡¨æœ‰4æ¡è®°å½•ï¼Œå‰ç«¯å®Œå…¨æ²¡å¯¹æ¥
- **å†³ç­–**ï¼šåœ¨æŠ½å¥–é¡µå±•ç¤ºå¼¹çª—æ¨ªå¹…
- **å¯¹æ¥API**ï¼š`GET /api/v4/system/popup-banners`
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - åœ¨ `api.js` ä¸­æ–°å¢ `getPopupBanners()` æ–¹æ³•
  - åœ¨ `utils/index.js` çš„ API å¯¹è±¡ä¸­å¯¼å‡º
  - åœ¨æŠ½å¥–é¡µï¼ˆ`pages/lottery/lottery.js`ï¼‰åŠ è½½æ—¶è°ƒç”¨ï¼Œå±•ç¤ºå¼¹çª—æ¨ªå¹…
  - æ•°æ®æ ¼å¼é€‚é…é¡µé¢å±•ç¤ºï¼ˆä¸æ–°å¢é¡µé¢ç»“æ„ï¼Œå¤ç”¨ç°æœ‰å¼¹çª—ç»„ä»¶æˆ–ç®€å•æ¸²æŸ“ï¼‰

### âœ… å†³å®š8ï¼šå‘é€éªŒè¯ç æŒ‰é’® â†’ **Bï¼‰ä¿ç•™æŒ‰é’®ï¼Œç‚¹å‡»æç¤º"æš‚ä¸æ”¯æŒ"**

- **åŸçŠ¶**ï¼š`components/auth-modal` L247 è°ƒç”¨ `API.sendVerificationCode()`ï¼Œå·²æ³¨é‡Šï¼›åç«¯ä»æœªå®ç°çŸ­ä¿¡éªŒè¯ç å‘é€è·¯ç”±
- **å†³ç­–**ï¼šå‘é€æŒ‰é’®ä¿ç•™ï¼Œç‚¹å‡»æ—¶æç¤º"æš‚ä¸æ”¯æŒï¼Œè¯·è¾“å…¥éªŒè¯ç "
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - ä¿ç•™å‘é€æŒ‰é’® UIï¼Œä½†ç‚¹å‡»äº‹ä»¶æ”¹ä¸º `wx.showToast({ title: 'æš‚ä¸æ”¯æŒ', icon: 'none' })`
  - åˆ é™¤ `sendVerificationCode()` çš„ API è°ƒç”¨é€»è¾‘
  - éªŒè¯ç è¾“å…¥æ¡†ä¿ç•™ï¼Œæµ‹è¯•é˜¶æ®µç”¨ä¸‡èƒ½ç  `123456`
  - åœ¨ä»£ç ä¸­æ ‡æ³¨ `// TODO: ç­‰åç«¯æ¥å…¥çŸ­ä¿¡æœåŠ¡åæ¢å¤å‘é€åŠŸèƒ½`

### âœ… å†³å®š9ï¼šåº“å­˜é¡µã€Œç”Ÿæˆæ ¸é”€ç ã€â†’ **Aï¼‰æ”¹ä¸º"åˆ›å»ºæ ¸é”€è®¢å•"**

- **åŸçŠ¶**ï¼š`pages/trade/inventory.js` L619 è°ƒç”¨ `API.generateVerificationCode(item_id)`ï¼Œåç«¯ `/inventory/generate-code/:item_id` è·¯ç”±ä¸å­˜åœ¨
- **å†³ç­–**ï¼šæ”¹ä¸º"åˆ›å»ºæ ¸é”€è®¢å•"ï¼Œè°ƒç”¨åç«¯ redemption è®¢å•ä½“ç³»
- **å¯¹æ¥API**ï¼š`POST /api/v4/shop/redemption/orders`ï¼ˆåç«¯æ–°æµç¨‹ï¼Œåˆ›å»ºè®¢å•æ—¶è‡ªåŠ¨ç”Ÿæˆ code_hash æ ¸é”€ç ï¼‰
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - æŒ‰é’®æ–‡æ¡ˆä»"ç”Ÿæˆæ ¸é”€ç "æ”¹ä¸º"åˆ›å»ºæ ¸é”€è®¢å•"
  - è°ƒç”¨ `/shop/redemption/orders` æ›¿ä»£åŸæ¥çš„ `/inventory/generate-code`
  - è¿”å›çš„ code_hash æ¸²æŸ“ä¸ºäºŒç»´ç /æ ¸é”€ç å±•ç¤º
  - åˆ é™¤ `generateVerificationCode()` æ–¹æ³•ï¼ˆå·²åœ¨æ­¥éª¤3ä¸­åˆ—å…¥ï¼‰
  - åœ¨ `api.js` ä¸­æ–°å¢ `createRedemptionOrder(params)` æ–¹æ³•

### âœ… å†³å®š10ï¼šç”¨æˆ·ä¸­å¿ƒã€Œä¸Šä¼ ç»Ÿè®¡ã€â†’ **Bï¼‰æ›¿æ¢ä¸ºå…¶ä»–ç»Ÿè®¡**

- **åŸçŠ¶**ï¼š`pages/user/user.js` L656 è°ƒç”¨ `getUploadStatistics()`ï¼Œæ³¨é‡Šå†™"å¾…åç«¯å®ç°"ï¼Œå®é™…å·²åºŸå¼ƒ
- **å†³ç­–**ï¼šæ›¿æ¢ä¸ºæ¶ˆè´¹è®°å½•ç»Ÿè®¡ + èƒŒåŒ…ç‰©å“ç»Ÿè®¡
- **å¯¹æ¥API**ï¼š
  - `GET /api/v4/shop/consumption/me`ï¼ˆæ¶ˆè´¹è®°å½•ï¼Œæ”¯æŒåˆ†é¡µå’Œ status ç­›é€‰ï¼‰â†’ ç»Ÿè®¡æ¶ˆè´¹æ¬¡æ•°/æ€»ç§¯åˆ†
  - `GET /api/v4/backpack/stats`ï¼ˆèƒŒåŒ…ç»Ÿè®¡ï¼‰â†’ ç»Ÿè®¡ç‰©å“æ•°é‡/ç±»å‹åˆ†å¸ƒ
- **æ‰§è¡Œæ–¹å¼**ï¼š
  - ç”¨æˆ·ä¸­å¿ƒåŸ"ä¸Šä¼ ç»Ÿè®¡"åŒºåŸŸæ”¹ä¸ºå±•ç¤º"æ¶ˆè´¹ç»Ÿè®¡"å’Œ"èƒŒåŒ…ç»Ÿè®¡"
  - æ•°æ®ä»ä¸Šè¿°ä¸¤ä¸ª API è·å–å¹¶æ ¼å¼åŒ–å±•ç¤º
  - åˆ é™¤ `getUploadStatistics` ç›¸å…³è°ƒç”¨
  - ä¸æ”¹é¡µé¢æ•´ä½“å¸ƒå±€ç»“æ„ï¼Œåªæ›¿æ¢æ•°æ®æºå’Œæ–‡æ¡ˆ

---

### ğŸ“‹ å…¨éƒ¨å†³ç­–æ±‡æ€»

| # | å†³ç­–äº‹é¡¹ | å†³ç­–ç»“æœ | çŠ¶æ€ |
|---|---|---|---|
| 1 | å°ç¨‹åºç®¡ç†å‘˜é¡µé¢ | ä¿ç•™4ä¸ªï¼ˆconsume-submit/audit-list/customer-service/chat-managementï¼‰ï¼Œç§»é™¤ admin-dashboard | âœ… å·²å†³å®š |
| 2 | ä¸Šä¼ è®°å½• tab | æ”¹é€ ä¸º"æ¶ˆè´¹è®°å½•"ï¼Œå¯¹æ¥ `/shop/consumption/me` | âœ… å·²å†³å®š |
| 3 | èŠå¤©å‘å›¾ç‰‡ | å…ˆç æ‰ï¼Œç­‰åç«¯æä¾›èŠå¤©ä¸“ç”¨å›¾ç‰‡ä¸Šä¼ æ¥å£å†æ¢å¤ | âœ… å·²å†³å®š |
| 4 | ç‰©å“è½¬ç§»/èµ é€ | æ”¹ä¸ºè·³è½¬å¸‚åœºä¸Šæ¶ï¼Œå¯¹æ¥ `/market/sell/list` | âœ… å·²å†³å®š |
| 5 | ã€Œå‘ç°ã€é¡µå†…å®¹ | ä¿æŒç°çŠ¶ï¼Œé™æ€å¯¼èˆªé¡µä¸æ”¹ | âœ… å·²å†³å®š |
| 6 | äºŒç»´ç ç”Ÿæˆ | ç»„åˆ profile + qrcode ä¸¤ä¸ªAPI | âœ… å·²å†³å®š |
| 7 | å¼¹çª—æ¨ªå¹… | åŠ ä¸Šï¼Œåœ¨æŠ½å¥–é¡µå±•ç¤ºï¼Œå¯¹æ¥ `/system/popup-banners` | âœ… å·²å†³å®š |
| 8 | å‘é€éªŒè¯ç æŒ‰é’® | æŒ‰é’®ä¿ç•™ï¼Œç‚¹å‡»æç¤º"æš‚ä¸æ”¯æŒ"ï¼›åç«¯ä»æœªå®ç°çŸ­ä¿¡å‘é€ï¼Œæµ‹è¯•é˜¶æ®µç”¨ä¸‡èƒ½ç  `123456` | âœ… å·²å†³å®š |
| 9 | åº“å­˜é¡µã€Œç”Ÿæˆæ ¸é”€ç ã€æŒ‰é’® | æ”¹ä¸º"åˆ›å»ºæ ¸é”€è®¢å•"ï¼Œè°ƒç”¨ `/shop/redemption/orders`ï¼ˆPOSTï¼Œåç«¯æ–°æµç¨‹è‡ªåŠ¨ç”Ÿæˆæ ¸é”€ç ï¼‰ | âœ… å·²å†³å®š |
| 10 | ç”¨æˆ·ä¸­å¿ƒã€Œä¸Šä¼ ç»Ÿè®¡ã€åŒºåŸŸ | æ›¿æ¢ä¸ºå…¶ä»–ç»Ÿè®¡ï¼ˆæ¶ˆè´¹è®°å½•ç»Ÿè®¡ã€èƒŒåŒ…ç‰©å“ç»Ÿè®¡ï¼‰ï¼Œå¯¹æ¥ `/shop/consumption/me` + `/backpack/stats` | âœ… å·²å†³å®š |

---

## åäº”ã€ğŸ”§ æ‰§è¡Œæ­¥éª¤ï¼ˆä»… API å¯¹æ¥å±‚ï¼Œä¸æ¶‰åŠé¡µé¢æ”¹é€ ï¼‰

> **èŒƒå›´**ï¼šåªæ”¹ `utils/api.js`ï¼ˆAPI è·¯å¾„å’Œæ–¹æ³•ï¼‰+ `utils/index.js`ï¼ˆå¯¼å‡ºï¼‰ï¼Œä¸åŠ¨ä»»ä½•é¡µé¢æ–‡ä»¶ï¼ˆjs/wxml/wxssï¼‰  
> **åŸåˆ™**ï¼šå…ˆç¡®è®¤åç«¯ç²¾ç¡®è·¯å¾„ â†’ å†æ”¹å‰ç«¯ api.js â†’ æœ€åæ›´æ–°å¯¼å‡º

---

### æ­¥éª¤1ï¼šè¯»åç«¯è·¯ç”±æ–‡ä»¶ï¼Œç¡®è®¤ç²¾ç¡®è·¯å¾„

é€ä¸ªè¯»å–ä»¥ä¸‹åç«¯è·¯ç”±æ–‡ä»¶ï¼Œäº§å‡ºæ¯ä¸ª API çš„ç²¾ç¡® URLã€HTTP æ–¹æ³•ã€è¯·æ±‚å‚æ•°ã€å“åº”æ ¼å¼ã€‚

| # | è¦è¯»çš„åç«¯æ–‡ä»¶ | è¦ç¡®è®¤çš„å‰ç«¯æ–¹æ³• |
|---|---|---|
| 1 | `routes/v4/assets/balance.js` | `getPointsBalance`, `getCurrentUserBalance` |
| 2 | `routes/v4/assets/transactions.js` | `getPointsTransactions` |
| 3 | `routes/v4/backpack/index.js` | `getUserInventory`, `getInventoryItem`, `useInventoryItem` |
| 4 | `routes/v4/shop/exchange/items.js` | `getExchangeProducts` |
| 5 | `routes/v4/shop/exchange/exchange.js` | `exchangeProduct` |
| 6 | `routes/v4/shop/exchange/orders.js` | `getExchangeRecords`, `cancelExchange` |
| 7 | `routes/v4/shop/consumption/qrcode.js` | `getUserQRCode`, `getUserInfoByQRCode`, `submitConsumption` |
| 8 | `routes/v4/shop/audit/index.js` | `getPendingConsumption`, `approveConsumption`, `rejectConsumption` |
| 9 | `routes/v4/market/listings.js` | `getMarketProducts`, `getMarketProductDetail` |
| 10 | `routes/v4/market/buy.js` | `purchaseMarketProduct` |
| 11 | `routes/v4/market/sell.js` | æ–°å¢ `sellToMarket`ï¼ˆå†³ç­–4ï¼‰ |
| 12 | `routes/v4/market/manage.js` | `withdrawMarketProduct` |
| 13 | `routes/v4/system/chat.js` | `createChatSession`, `getChatSessions`, `getChatHistory`, `sendChatMessage` |
| 14 | `routes/v4/system/popup-banners.js` | æ–°å¢ `getPopupBanners`ï¼ˆå†³ç­–7ï¼‰ |
| 15 | `routes/v4/system/feedback.js` | `submitFeedback`ï¼ˆå‚æ•°ç­¾åå¯¹é½ï¼‰ |
| 16 | `routes/v4/lottery/` ä¸‹ draw.js + campaigns.js + history.js | `getLotteryPrizes`, `getLotteryConfig`, `performLottery`, `getLotteryHistory`, `getLotteryCampaigns` |
| 17 | `routes/v4/auth/` ä¸‹ login.js + profile.js + token.js | `verifyToken`ï¼ˆç¡®è®¤ GET è¿˜æ˜¯ POSTï¼‰ |
| 18 | `routes/v4/console/customer-service/index.js` | `getAdminChatSessions`, `getAdminChatHistory`ï¼ˆå†³ç­–1ï¼‰ |
| 19 | `routes/v4/console/` ä¸‹æ¶ˆè´¹å®¡æ ¸ç›¸å…³ | `getPendingConsumption`, `approveConsumption`, `rejectConsumption` çœŸå®è·¯å¾„ |
| 20 | `routes/v4/user/index.js` | `getUserStatistics` æ˜¯å¦å­˜åœ¨ |
| 21 | `routes/v4/shop/consumption/` ä¸‹ç”¨æˆ·æ¶ˆè´¹æŸ¥è¯¢ | æ–°å¢ `getMyConsumptionRecords`ï¼ˆå†³ç­–2ã€å†³ç­–8æ›¿ä»£ï¼‰ |
| 22 | `routes/v4/shop/redemption/orders.js` | `cancelExchange` æ›¿ä»£è·¯å¾„ |

**äº§å‡ºç‰©**ï¼šæ­¥éª¤1å®Œæˆåï¼Œåœ¨æœ¬æ–‡æ¡£è¡¥å……ä¸€ä¸ªã€Œç²¾ç¡®è·¯å¾„æ˜ å°„è¡¨ã€ã€‚

---

### æ­¥éª¤2ï¼šä¿®æ­£ api.js ä¸­å·²æœ‰æ–¹æ³•çš„è·¯å¾„ï¼ˆçº¦28ä¸ªæ–¹æ³•ï¼‰

åªæ”¹ `apiClient.request()` çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆè·¯å¾„å­—ç¬¦ä¸²ï¼‰ï¼Œä¸æ”¹å‡½æ•°ç­¾åã€ä¸æ”¹é¡µé¢è°ƒç”¨æ–¹å¼ã€‚

#### 2.1 ç§¯åˆ†æ¨¡å—ï¼ˆ`/points/*` â†’ `/assets/*`ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹åï¼ˆå¾…æ­¥éª¤1ç¡®è®¤ç²¾ç¡®å€¼ï¼‰ |
|---|---|---|
| `getCurrentUserBalance()` | `/points/balance` | `/assets/balance` |
| `getPointsBalance(user_id)` | `/points/balance/${user_id}` | `/assets/balance/...`ï¼ˆå¯èƒ½é€šè¿‡tokenè¯†åˆ«ï¼Œä¸éœ€è¦user_idï¼‰ |
| `getPointsTransactions()` | `/points/transactions/${user_id}` | `/assets/transactions` |
| `getUserStatistics()` | `/points/user/statistics/${user_id}` | å¾…ç¡®è®¤ |
| `adminAdjustPoints()` | `/points/admin/adjust` | `/console/asset-adjustment/...` |
| `getAdminPointsStatistics()` | `/points/admin/statistics` | `/console/...` |

#### 2.2 æŠ½å¥–æ¨¡å—ï¼ˆè·¯å¾„å‚æ•°ä½ç½®è°ƒæ•´ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `getLotteryPrizes(code)` | `/lottery/prizes/${code}` | `/lottery/${code}/prizes` |
| `getLotteryConfig(code)` | `/lottery/config/${code}` | `/lottery/${code}/config` |

#### 2.3 åº“å­˜æ¨¡å—ï¼ˆ`/inventory/*` â†’ `/backpack/*`ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `getUserInventory()` | `/inventory/user/${user_id}` | `/backpack/`ï¼ˆé€šè¿‡tokenè¯†åˆ«ç”¨æˆ·ï¼‰ |
| `getInventoryItem()` | `/inventory/item/${item_id}` | `/backpack/...` |
| `useInventoryItem()` | `/inventory/use/${item_id}` | `/backpack/...` |

#### 2.4 å…‘æ¢æ¨¡å—ï¼ˆ`/inventory/*` â†’ `/shop/exchange/*`ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `getExchangeProducts()` | `/inventory/products` | `/shop/exchange/items` |
| `exchangeProduct()` | `/inventory/exchange` | `/shop/exchange/` |
| `getExchangeRecords()` | `/inventory/exchange-records` | `/shop/exchange/orders` |
| `cancelExchange()` | `/inventory/exchange-records/${id}/cancel` | `/shop/redemption/orders/${id}/cancel` |

#### 2.5 å¸‚åœºæ¨¡å—ï¼ˆ`/inventory/market/*` â†’ `/market/*`ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `getMarketProducts()` | `/inventory/market/products` | `/market/listings` |
| `getMarketProductDetail(id)` | `/inventory/market/products/${id}` | `/market/listings/${id}` |
| `purchaseMarketProduct(id)` | `/inventory/market/products/${id}/purchase` | `/market/listings/${id}/purchase` |
| `withdrawMarketProduct(id)` | `/inventory/market/products/${id}/withdraw` | `/market/manage/listings/${id}/withdraw` |

#### 2.6 æ¶ˆè´¹æ¨¡å—ï¼ˆ`/consumption/*` â†’ `/shop/consumption/*`ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `submitConsumption()` | `/consumption/submit` | `/shop/consumption/submit` |
| `getUserInfoByQRCode()` | `/consumption/user-info` | `/shop/consumption/user-info` |
| `getUserQRCode(user_id)` | `/consumption/qrcode/${user_id}` | `/shop/consumption/qrcode/${user_id}` |

#### 2.7 å®¡æ ¸æ¨¡å—ï¼ˆ`/consumption/*` â†’ `/console/consumption/*`ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `getPendingConsumption()` | `/consumption/pending` | `/console/consumption/pending` |
| `approveConsumption(id)` | `/consumption/approve/${id}` | `/console/consumption/approve/${id}` |
| `rejectConsumption(id)` | `/consumption/reject/${id}` | `/console/consumption/reject/${id}` |

#### 2.8 ç®¡ç†å‘˜æ¨¡å—ï¼ˆ`/admin/*` â†’ `/console/*`ï¼‰

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `getAdminTodayStats()` | `/admin/statistics/today` | `/console/dashboard/...` |
| `getAdminUsers()` | `/admin/users` | `/console/user_management/...` |
| `getAdminChatSessions()` | `/system/admin/chat/sessions` | `/console/customer-service/sessions` |
| `getAdminChatHistory()` | `/system/admin/chat/sessions/${id}/messages` | `/console/customer-service/sessions/${id}/messages` |

#### 2.9 è®¤è¯æ¨¡å—

| æ–¹æ³• | æ”¹å‰ | æ”¹å |
|---|---|---|
| `verifyToken()` | `POST /auth/verify` | `GET /auth/verify`ï¼ˆå¾…ç¡®è®¤HTTPæ–¹æ³•ï¼‰ |

#### 2.10 åé¦ˆæ¨¡å—ï¼ˆå‚æ•°ä¿®æ­£ï¼‰

| æ–¹æ³• | é—®é¢˜ | ä¿®æ­£æ–¹å¼ |
|---|---|---|
| `submitFeedback(type, content, contact)` | å‰ç«¯ç­¾å vs åç«¯å­—æ®µåä¸ä¸€è‡´ | ä¿æŒå‡½æ•°ç­¾åä¸å˜ï¼Œå†…éƒ¨ request body å­—æ®µåæ”¹ä¸ºåç«¯è¦æ±‚çš„ `category`/`content`/`priority`/`attachments` |

---

### æ­¥éª¤3ï¼šåˆ é™¤å·²åºŸå¼ƒçš„ API æ–¹æ³•ï¼ˆ12ä¸ªï¼‰

ä» `api.js` åˆ é™¤å‡½æ•°å®ç° + ä» `module.exports` ç§»é™¤ + ä» `utils/index.js` ç§»é™¤ï¼š

| # | åˆ é™¤çš„æ–¹æ³• | åºŸå¼ƒåŸå›  |
|---|---|---|
| 1 | `uploadImage()` | `/photo/upload` å·²åºŸå¼ƒ |
| 2 | `getMyUploads()` | `/photo/my-uploads` å·²åºŸå¼ƒ |
| 3 | `getMyUploadStats()` | `/photo/my-stats` å·²åºŸå¼ƒ |
| 4 | `getPendingReviews()` | `/photo/pending-reviews` å·²åºŸå¼ƒ |
| 5 | `reviewImage()` | `/photo/review/:id` å·²åºŸå¼ƒ |
| 6 | `getUserIdentity()` | ç¡¬ç¼–ç è¿”å›å¤±è´¥ï¼Œç”¨ profile + qrcode æ›¿ä»£ |
| 7 | `generateVerificationCode()` | æ ¸é”€å·²åˆå¹¶åˆ° redemption ä½“ç³» |
| 8 | `transferInventoryItem()` | è¢«å¸‚åœºäº¤æ˜“æ›¿ä»£ |
| 9 | `getTransferHistory()` | è¢«å¸‚åœºäº¤æ˜“æ›¿ä»£ |
| 10 | `getMyRecentAuditsCount()` | æ”¹ç”¨ `/shop/consumption/me` + status ç­›é€‰ |
| 11 | `getMyRecentAudits()` | åŒä¸Š |
| 12 | `getAdminInventoryStatistics()` | ç®¡ç†åå°åŸŸï¼Œå°ç¨‹åºä¸ç›´æ¥è°ƒç”¨ |

---

### æ­¥éª¤4ï¼šæ–°å¢ API æ–¹æ³•ï¼ˆ5ä¸ª â€” å†³ç­–é©±åŠ¨ï¼Œå½“å‰é˜¶æ®µå¿…é¡»ï¼‰

åœ¨ `api.js` ä¸­æ–°å¢ï¼Œå¹¶åœ¨ `module.exports` + `utils/index.js` åŒæ­¥å¯¼å‡ºï¼š

| # | æ–°å¢æ–¹æ³•å | è·¯å¾„ | HTTPæ–¹æ³• | ç”¨é€” | å¯¹åº”å†³ç­– |
|---|---|---|---|---|---|
| 1 | `getPopupBanners()` | `/system/popup-banners` | GET | å¼¹çª—æ¨ªå¹… | å†³ç­–7 |
| 2 | `sellToMarket(params)` | `/market/sell/list` | POST | ä¸Šæ¶ç‰©å“åˆ°å¸‚åœº | å†³ç­–4 |
| 3 | `getMyConsumptionRecords(params)` | `/shop/consumption/me` | GET | ç”¨æˆ·æ¶ˆè´¹è®°å½•ï¼ˆæ”¯æŒåˆ†é¡µ+statusç­›é€‰ï¼‰ | å†³ç­–2/8 |
| 4 | `getMyListingStatus()` | `/market/listing-status` | GET | æŸ¥è¯¢æŒ‚å•çŠ¶æ€ | å†³ç­–4 |
| 5 | `createRedemptionOrder(params)` | `/shop/redemption/orders` | POST | åˆ›å»ºæ ¸é”€è®¢å•ï¼ˆè‡ªåŠ¨ç”Ÿæˆæ ¸é”€ç ï¼‰ | å†³ç­–9 |

---

### æ­¥éª¤4.5ï¼šé¢„ç•™ API æ–¹æ³•ï¼ˆåç«¯å·²æœ‰èƒ½åŠ›ï¼Œå‰ç«¯ç°æœ‰é¡µé¢å¯æ‰¿è½½ï¼Œå½“å‰ä»…é“ºç®¡é“ï¼‰

> **åŸåˆ™**ï¼šåç«¯æœ‰èƒ½åŠ› + å‰ç«¯æœ‰ç°æˆé¡µé¢èƒ½æ”¾ â†’ api.js åŠ æ–¹æ³•å®šä¹‰å’Œæ­£ç¡®è·¯å¾„ï¼Œä½†**ä¸æ”¹é¡µé¢æ–‡ä»¶**ï¼Œé¡µé¢æ¥å…¥æ”¾åˆ°ä¸‹ä¸€é˜¶æ®µã€‚
> åç«¯æœ‰èƒ½åŠ› + å‰ç«¯æ²¡æœ‰é¡µé¢æ‰¿è½½ â†’ api.js é¢„ç•™æ–¹æ³•ï¼Œ**ä¸å»ºæ–°é¡µé¢**ï¼Œç­‰äº§å“æ’æœŸã€‚

#### 4.5.1 å¯æ¥å…¥ç°æœ‰é¡µé¢çš„åç«¯èƒ½åŠ›ï¼ˆapi.js åŠ æ–¹æ³•ï¼Œé¡µé¢æ”¹é€ é˜¶æ®µå†æ¥å…¥ï¼‰

| # | æ–°å¢æ–¹æ³•å | è·¯å¾„ | HTTPæ–¹æ³• | å¯æ¥å…¥çš„ç°æœ‰é¡µé¢ | è¯´æ˜ |
|---|---|---|---|---|---|
| 1 | `getMarketFacets()` | `/market/listings/facets` | GET | `pages/trade/market` | å¸‚åœºåˆ†ç±»ç­›é€‰æ•°æ® |
| 2 | `sellFungibleAssets(params)` | `/market/sell/fungible-assets/list` | POST | `pages/trade/inventory` | ä¸Šæ¶ç§¯åˆ†ç­‰å¯å åŠ èµ„äº§ |
| 3 | `getAssetBalances()` | `/assets/balances` | GET | `pages/user/user` | å¤šç§èµ„äº§ï¼ˆç§¯åˆ†/é’»çŸ³/ç¢ç‰‡ï¼‰ä½™é¢æ˜ç»† |
| 4 | `getConversionRules()` | `/assets/conversion-rules` | GET | `pages/user/user` æˆ– `pages/exchange` | ç¢ç‰‡åˆæˆç­‰èµ„äº§è½¬æ¢è§„åˆ™ |
| 5 | `getUserMe()` | `/user/me` | GET | `pages/user/user` | ç”¨æˆ·ä¸ªäººè¯¦ç»†ä¿¡æ¯ |
| 6 | `getConsumptionDetail(id)` | `/shop/consumption/detail/${id}` | GET | `pages/records/trade-upload-records` | å•æ¡æ¶ˆè´¹è®°å½•è¯¦æƒ… |
| 7 | `getMerchantConsumptions(params)` | `/shop/consumption/merchant/list` | GET | `pages/admin/consume-submit` | å•†å®¶æŸ¥é—¨åº—æ¶ˆè´¹è®°å½• |
| 8 | `getMerchantConsumptionStats()` | `/shop/consumption/merchant/stats` | GET | `pages/admin/consume-submit` | å•†å®¶é—¨åº—æ¶ˆè´¹ç»Ÿè®¡ |
| 9 | `getExchangeItemDetail(id)` | `/shop/exchange/items/${id}` | GET | `pages/exchange/exchange` | å…‘æ¢å•†å“è¯¦æƒ… |
| 10 | `getExchangeOrderDetail(order_no)` | `/shop/exchange/orders/${order_no}` | GET | `pages/exchange/exchange` | å…‘æ¢è®¢å•è¯¦æƒ… |
| 11 | `getDictionaries(params)` | `/system/dictionaries` | GET | å…¨å±€å…¬ç”¨ | ç³»ç»Ÿå­—å…¸ï¼Œç”¨äºä¸­æ–‡åŒ–å„ç±»æšä¸¾æ˜¾ç¤ºå |

#### 4.5.2 éœ€è¦æ–°é¡µé¢æ‰¿è½½çš„åç«¯èƒ½åŠ›ï¼ˆapi.js é¢„ç•™æ–¹æ³•ï¼Œæš‚ä¸å¯¹æ¥ï¼‰

| # | æ–°å¢æ–¹æ³•å | è·¯å¾„ | HTTPæ–¹æ³• | è¯´æ˜ | å¤‡æ³¨ |
|---|---|---|---|---|---|
| 12 | `getNotifications(params)` | `/system/notifications` | GET | ç³»ç»Ÿé€šçŸ¥åˆ—è¡¨ | éœ€ç‹¬ç«‹é€šçŸ¥é¡µé¢ï¼Œç­‰äº§å“æ’æœŸ |
| 13 | `getActivities(params)` | `/activities` | GET | æ´»åŠ¨åˆ—è¡¨ | å†³ç­–5å·²å®šã€Œå‘ç°é¡µä¿æŒé™æ€ã€ï¼Œæš‚ä¸å¯¹æ¥ |

---

### æ­¥éª¤5ï¼šæ›´æ–° utils/index.js å¯¼å‡º

1. åˆ é™¤æ­¥éª¤3ä¸­12ä¸ªåºŸå¼ƒæ–¹æ³•çš„å¯¼å‡ºè¡Œ
2. æ–°å¢æ­¥éª¤4ä¸­5ä¸ªæ–¹æ³• + æ­¥éª¤4.5ä¸­13ä¸ªæ–¹æ³•çš„å¯¼å‡ºè¡Œï¼ˆå…±18ä¸ªæ–°å¢ï¼‰
3. æ ¼å¼ï¼š`methodName: apiFunctions.methodName,`

---

### æ­¥éª¤6ï¼šå…¨é‡éªŒè¯

```bash
# æ£€æŸ¥æ—§è·¯å¾„æ˜¯å¦å·²å…¨éƒ¨æ¸…é™¤
grep -n "'/points/" utils/api.js          # åº”0ç»“æœ
grep -n "'/inventory/" utils/api.js       # åº”0ç»“æœ
grep -n "'/consumption/" utils/api.js     # åº”0ç»“æœï¼ˆæ”¹ä¸º /shop/consumption æˆ– /console/consumptionï¼‰
grep -n "'/admin/" utils/api.js           # åº”0ç»“æœï¼ˆæ”¹ä¸º /console/ï¼‰
grep -n "'/photo/" utils/api.js           # åº”0ç»“æœï¼ˆå·²åˆ é™¤ï¼‰

# æ£€æŸ¥å¯¼å‡ºé“¾å®Œæ•´æ€§ï¼šapi.js å¯¼å‡ºçš„æ–¹æ³• = index.js å¯¼å‡ºçš„æ–¹æ³•
grep "apiFunctions\." utils/index.js | wc -l
grep -c "^\s\+\w\+," utils/api.js        # module.exports ä¸­çš„æ–¹æ³•æ•°åº”ä¸€è‡´
```

---

### ğŸ“Š æ€»æ”¹åŠ¨èŒƒå›´

| æ–‡ä»¶ | æ”¹åŠ¨å†…å®¹ |
|---|---|
| `utils/api.js` | ä¿®æ­£28ä¸ªè·¯å¾„ + åˆ é™¤12ä¸ªæ–¹æ³• + æ–°å¢18ä¸ªæ–¹æ³•ï¼ˆ5ä¸ªå†³ç­–é©±åŠ¨ + 13ä¸ªé¢„ç•™ï¼‰ + ä¿®æ­£1ä¸ªå‚æ•°ç­¾å |
| `utils/index.js` | åˆ é™¤12ä¸ªå¯¼å‡º + æ–°å¢18ä¸ªå¯¼å‡º |
| **æ€»è®¡** | **ä»…2ä¸ªæ–‡ä»¶** |

