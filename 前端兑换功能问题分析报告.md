# å‰ç«¯å…‘æ¢åŠŸèƒ½é—®é¢˜åˆ†ææŠ¥å‘Š

**é—®é¢˜å½’å±**: å‰ç«¯é—®é¢˜
**åç«¯çŠ¶æ€**: å®Œå…¨æ­£å¸¸
**ç”Ÿæˆæ—¶é—´**: 2025å¹´7æœˆ19æ—¥

## ğŸ” é—®é¢˜ç°è±¡

å‰ç«¯å…‘æ¢é¡µé¢æ˜¾ç¤ºï¼š
- ğŸ”º æ— äº§å“æ•°æ® | æ£€æŸ¥åç«¯APIè¿”å›
- Consoleé”™è¯¯ï¼šä¸šåŠ¡é”™è¯¯: 4000 è·å–å•†å“åˆ—è¡¨å¤±è´¥
- å•†å“åŠ è½½å¤±è´¥

## âœ… åç«¯éªŒè¯ç»“æœï¼ˆæ— é—®é¢˜ï¼‰

### 1. æ•°æ®åº“æ•°æ®æ­£å¸¸
```json
{
  "å•†å“æ•°é‡": 3,
  "ç¤ºä¾‹å•†å“": {
    "commodity_id": 12,
    "name": "ç‰çŸ³1",
    "description": "1", 
    "category": "å®ç‰©å•†å“",
    "exchange_points": 5000,
    "stock": 10,
    "status": "active"
  }
}
```

### 2. APIæ–¹æ³•å·¥ä½œæ­£å¸¸
æµ‹è¯• `CommodityPool.getProductsForFrontend()` æ–¹æ³•ï¼š
```json
{
  "code": 0,
  "msg": "success",
  "data": {
    "products": [
      {
        "id": 12,
        "commodity_id": 12,
        "name": "ç‰çŸ³1",
        "description": "1",
        "category": "å®ç‰©å•†å“",
        "exchange_points": 5000,
        "stock": 10,
        "image": null,
        "is_hot": false,
        "rating": "5.00",
        "sales_count": 0,
        "status": "available"
      }
    ],
    "total": 3,
    "page": 1,
    "limit": 20,
    "has_more": false,
    "categories": ["å®ç‰©å•†å“"]
  }
}
```

### 3. è·¯ç”±æ³¨å†Œæ­£ç¡®
- è·¯ç”±è·¯å¾„: `/api/exchange/products`
- æ–¹æ³•: GET
- è®¤è¯: éœ€è¦Bearer Token

## ğŸ”´ å‰ç«¯éœ€è¦æ£€æŸ¥çš„é—®é¢˜

### 1. APIè°ƒç”¨è·¯å¾„æ£€æŸ¥
**æ£€æŸ¥å‰ç«¯æ˜¯å¦è°ƒç”¨æ­£ç¡®çš„APIè·¯å¾„**ï¼š
```javascript
// âœ… æ­£ç¡®çš„APIè·¯å¾„
GET /api/exchange/products

// âŒ å¯èƒ½çš„é”™è¯¯è·¯å¾„
GET /api/exchange/product
GET /exchange/products  
GET /api/products
```

### 2. è¯·æ±‚å¤´æ£€æŸ¥
**ç¡®ä¿å‰ç«¯æ­£ç¡®ä¼ é€’Authorization header**ï¼š
```javascript
// âœ… æ­£ç¡®çš„è¯·æ±‚å¤´
headers: {
  'Authorization': 'Bearer ' + token,
  'Content-Type': 'application/json'
}

// âŒ å¸¸è§é”™è¯¯
// 1. ç¼ºå°‘ Authorization å¤´
// 2. Tokenæ ¼å¼é”™è¯¯
// 3. Tokenè¿‡æœŸ
```

### 3. å“åº”å¤„ç†æ£€æŸ¥
**æ£€æŸ¥å‰ç«¯å¦‚ä½•å¤„ç†APIå“åº”**ï¼š
```javascript
// âœ… æ­£ç¡®çš„å“åº”å¤„ç†
if (response.code === 0) {
  // æˆåŠŸå¤„ç† response.data.products
} else {
  // é”™è¯¯å¤„ç† response.msg
}

// âŒ å¯èƒ½çš„é—®é¢˜
// 1. æœŸæœ›ä¸åŒçš„å“åº”æ ¼å¼
// 2. æ²¡æœ‰æ­£ç¡®è§£æ response.data.products
// 3. é”™è¯¯ç åˆ¤æ–­é€»è¾‘é”™è¯¯
```

### 4. è¯·æ±‚å‚æ•°æ£€æŸ¥
**æ£€æŸ¥å‰ç«¯ä¼ é€’çš„æŸ¥è¯¢å‚æ•°**ï¼š
```javascript
// âœ… æ”¯æŒçš„å‚æ•°
{
  category: 'all' | 'å®ç‰©å•†å“',  // å•†å“åˆ†ç±»
  sort: 'default' | 'points-asc' | 'points-desc' | 'newest',
  page: 1,
  limit: 20
}
```

## ğŸ› ï¸ å‰ç«¯è°ƒè¯•å»ºè®®

### 1. æ·»åŠ è¯¦ç»†æ—¥å¿—
```javascript
console.log('APIè¯·æ±‚URL:', apiUrl);
console.log('è¯·æ±‚headers:', headers);
console.log('APIå“åº”çŠ¶æ€:', response.status);
console.log('APIå“åº”å†…å®¹:', response.data);
```

### 2. æ£€æŸ¥ç½‘ç»œè¯·æ±‚
åœ¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·çš„Networké¢æ¿ï¼š
- ç¡®è®¤è¯·æ±‚URLæ˜¯å¦æ­£ç¡®
- æ£€æŸ¥è¯·æ±‚çŠ¶æ€ç ï¼ˆåº”è¯¥æ˜¯200ï¼‰
- æŸ¥çœ‹å“åº”å†…å®¹æ˜¯å¦æ­£ç¡®

### 3. Tokenæœ‰æ•ˆæ€§éªŒè¯
**å½“å‰æœ‰æ•ˆçš„æµ‹è¯•token**ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰ï¼š
```
ç”¨æˆ·ID: 31
æ‰‹æœºå·: 13612227938
ç®¡ç†å‘˜: true
```

### 4. é”™è¯¯ç å¯¹ç…§è¡¨
```javascript
// åç«¯è¿”å›çš„é”™è¯¯ç 
0: 'success',           // æˆåŠŸ
4000: 'è·å–å•†å“åˆ—è¡¨å¤±è´¥',  // é€šç”¨é”™è¯¯
4001: 'å‚æ•°é”™è¯¯',        // å‚æ•°éªŒè¯å¤±è´¥
401: 'æœªæˆæƒè®¿é—®'        // Tokenæ— æ•ˆ
```

## ğŸ”§ å¯èƒ½çš„è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ1: æ£€æŸ¥APIè°ƒç”¨ä»£ç 
```javascript
// æ£€æŸ¥å‰ç«¯APIè°ƒç”¨æ˜¯å¦æ­£ç¡®
try {
  const response = await fetch('/api/exchange/products', {
    method: 'GET',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    }
  });
  
  const data = await response.json();
  console.log('APIå“åº”:', data);
  
  if (data.code === 0) {
    // æˆåŠŸå¤„ç†å•†å“æ•°æ®
    setProducts(data.data.products);
  } else {
    console.error('APIé”™è¯¯:', data.msg);
  }
} catch (error) {
  console.error('è¯·æ±‚å¤±è´¥:', error);
}
```

### æ–¹æ¡ˆ2: æ£€æŸ¥çŠ¶æ€ç®¡ç†
```javascript
// æ£€æŸ¥å‰ç«¯çŠ¶æ€ç®¡ç†æ˜¯å¦æ­£ç¡®
const [products, setProducts] = useState([]);
const [loading, setLoading] = useState(true);
const [error, setError] = useState(null);

// ç¡®ä¿æ­£ç¡®æ›´æ–°çŠ¶æ€
if (data.code === 0 && data.data.products) {
  setProducts(data.data.products);
  setError(null);
} else {
  setError(data.msg || 'è·å–å•†å“åˆ—è¡¨å¤±è´¥');
  setProducts([]);
}
setLoading(false);
```

### æ–¹æ¡ˆ3: æ£€æŸ¥æ•°æ®æ¸²æŸ“
```javascript
// æ£€æŸ¥ç»„ä»¶æ¸²æŸ“é€»è¾‘
{loading ? (
  <div>åŠ è½½ä¸­...</div>
) : error ? (
  <div>é”™è¯¯: {error}</div>
) : products.length > 0 ? (
  products.map(product => (
    <div key={product.id}>
      {product.name} - {product.exchange_points}ç§¯åˆ†
    </div>
  ))
) : (
  <div>æš‚æ— å•†å“æ•°æ®</div>
)}
```

## ğŸ“ åç«¯æ”¯æŒä¿¡æ¯

### APIæ¥å£æ–‡æ¡£
- **æ¥å£åœ°å€**: GET /api/exchange/products
- **è®¤è¯æ–¹å¼**: Bearer Token
- **å“åº”æ ¼å¼**: JSON
- **æˆåŠŸç **: 0
- **é”™è¯¯ç **: 4000

### æµ‹è¯•å‘½ä»¤
å¯ä»¥åœ¨æµè§ˆå™¨Consoleä¸­æµ‹è¯•ï¼š
```javascript
fetch('/api/exchange/products', {
  headers: {
    'Authorization': 'Bearer ' + localStorage.getItem('token')
  }
}).then(r => r.json()).then(data => console.log(data));
```

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³æ£€æŸ¥**: å‰ç«¯APIè°ƒç”¨çš„URLå’Œè¯·æ±‚å¤´
2. **æ·»åŠ æ—¥å¿—**: åœ¨APIè°ƒç”¨å‰åæ·»åŠ è¯¦ç»†æ—¥å¿—
3. **éªŒè¯Token**: ç¡®è®¤Tokenæ˜¯å¦æœ‰æ•ˆä¸”æ­£ç¡®ä¼ é€’
4. **æ£€æŸ¥å“åº”å¤„ç†**: ç¡®è®¤å‰ç«¯æ­£ç¡®è§£æåç«¯å“åº”

---
**åç«¯ç¡®è®¤**: æ•°æ®åº“å’ŒAPIå®Œå…¨æ­£å¸¸ï¼Œé—®é¢˜åœ¨å‰ç«¯è°ƒç”¨æˆ–å“åº”å¤„ç†ç¯èŠ‚ã€‚ 