# ğŸ”Œ æ¥å£å¯¹æ¥è§„èŒƒæ–‡æ¡£ - é¤å…ç§¯åˆ†æŠ½å¥–ç³»ç»Ÿv2.0

> **å‰åç«¯APIæ¥å£å¯¹æ¥å®Œæ•´è§„èŒƒ** - åŸºäºv2.0å¤šä¸šåŠ¡çº¿åˆ†å±‚å­˜å‚¨æ¶æ„çš„æƒå¨æ¥å£æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£åŸºæœ¬ä¿¡æ¯

### æ–‡æ¡£å®šä½
- **ç›®æ ‡ç”¨æˆ·**ï¼šå‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆã€ç§»åŠ¨ç«¯å¼€å‘å·¥ç¨‹å¸ˆã€æ¥å£æµ‹è¯•å·¥ç¨‹å¸ˆ
- **æ–‡æ¡£æ€§è´¨**ï¼šAPIæ¥å£è§„èŒƒã€å‰åç«¯å¯¹æ¥æ ‡å‡†
- **è¦†ç›–èŒƒå›´**ï¼šå®Œæ•´çš„REST APIæ¥å£v2.0
- **æ›´æ–°æ—¶é—´**ï¼š2025å¹´07æœˆ29æ—¥ 23:52:11 UTC
- **ä½¿ç”¨æ¨¡å‹**ï¼šClaude Sonnet 4
- **åŸºäºä»£ç **ï¼šå®é™…è¿è¡Œçš„v2.0å®Œæ•´ä¸šåŠ¡æ¶æ„ä»£ç ï¼ˆapp.js 523è¡Œ + 6ä¸ªv2è·¯ç”±æ¨¡å— + 9ä¸ªä¸šåŠ¡æœåŠ¡ï¼‰

### ğŸ”´ æ ¸å¿ƒå¯¹æ¥è¦ç‚¹v2.0
- **æœåŠ¡åœ°å€**ï¼š
  - å…¬ç½‘åœ°å€ï¼š`https://rqchrlqndora.sealosbja.site`
  - å†…ç½‘åœ°å€ï¼š`http://devbox1.ns-br0za7uc.svc.cluster.local:3000`
- **APIå‰ç¼€**ï¼š`/api/v2`
- **è®¤è¯æ–¹å¼**ï¼šJWT Bearer Token
- **æ•°æ®æ ¼å¼**ï¼šJSON
- **å­—ç¬¦ç¼–ç **ï¼šUTF-8
- **æ¶æ„ç‰ˆæœ¬**ï¼šv2.0å¤šä¸šåŠ¡çº¿åˆ†å±‚å­˜å‚¨æ¶æ„

### ğŸš§ å¼€å‘é˜¶æ®µç‰¹æ®Šè¯´æ˜
> **âš ï¸ é‡è¦æé†’**ï¼šå½“å‰ä¸ºå¼€å‘é˜¶æ®µï¼Œè®¤è¯å’Œæƒé™æœ‰ç‰¹æ®Šå¤„ç†ï¼š

- ğŸ“± **ç™»å½•æ–¹å¼**ï¼šæ‰€æœ‰ç”¨æˆ·ï¼ˆåŒ…æ‹¬ç®¡ç†å‘˜ï¼‰ç»Ÿä¸€ä½¿ç”¨æ‰‹æœºå· + 123456ä¸‡èƒ½éªŒè¯ç ç™»å½•
- ğŸ” **æƒé™è¯†åˆ«**ï¼šç™»å½•åæ ¹æ®å“åº”æ•°æ®ä¸­çš„`is_admin`å­—æ®µè¯†åˆ«ç®¡ç†å‘˜æƒé™
- ğŸ“ **çŸ­ä¿¡éªŒè¯**ï¼šå¼€å‘é˜¶æ®µè·³è¿‡çœŸå®çŸ­ä¿¡å‘é€ï¼Œä½¿ç”¨ä¸‡èƒ½éªŒè¯ç 123456
- ğŸ’¡ **æµ‹è¯•å»ºè®®**ï¼šå¯ä½¿ç”¨ä»»æ„11ä½æ‰‹æœºå· + 123456è¿›è¡Œç™»å½•æµ‹è¯•

## ğŸ“Š ç»Ÿä¸€å“åº”æ ¼å¼è§„èŒƒ

### æ ‡å‡†å“åº”ç»“æ„
```json
{
  "code": 0,        // çŠ¶æ€ç ï¼š0-æˆåŠŸï¼Œé0-å¤±è´¥
  "msg": "success", // å“åº”æ¶ˆæ¯
  "data": {}        // å“åº”æ•°æ®ï¼Œå¯ä¸ºnull
}
```

### çŠ¶æ€ç åˆ†ç±»
| çŠ¶æ€ç èŒƒå›´ | å«ä¹‰ | ç¤ºä¾‹ |
|-----------|------|------|
| 0 | è¯·æ±‚æˆåŠŸ | 0 |
| 1000-1999 | å®¢æˆ·ç«¯å‚æ•°é”™è¯¯ | 1001-å‚æ•°é”™è¯¯ï¼Œ1002-éªŒè¯å¤±è´¥ |
| 2000-2999 | è®¤è¯æˆæƒé”™è¯¯ | 2001-Tokenæ— æ•ˆï¼Œ2002-æƒé™ä¸è¶³ |
| 3000-3999 | ä¸šåŠ¡é€»è¾‘é”™è¯¯ | 3001-ç§¯åˆ†ä¸è¶³ï¼Œ3002-åº“å­˜ä¸è¶³ |
| 4000-4999 | èµ„æºä¸å­˜åœ¨é”™è¯¯ | 4001-ç”¨æˆ·ä¸å­˜åœ¨ï¼Œ4002-å•†å“ä¸å­˜åœ¨ |
| 5000-5999 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | 5000-ç³»ç»Ÿå¼‚å¸¸ï¼Œ5001-æ•°æ®åº“é”™è¯¯ |

## ğŸ” è®¤è¯æˆæƒæ¥å£v2.0

> **æ³¨æ„**ï¼šå½“å‰v2.0æ¶æ„æš‚æœªå®ç°ç‹¬ç«‹çš„è®¤è¯æ¥å£ï¼Œè®¤è¯é€»è¾‘éœ€è¦é…åˆç”¨æˆ·ç®¡ç†ç³»ç»Ÿå®ç°ã€‚ä»¥ä¸‹ä¸ºè®¾è®¡è§„èŒƒï¼š

### 2.1 ç”¨æˆ·ç™»å½•æ¥å£ï¼ˆå¾…å®ç°ï¼‰

#### POST /api/v2/auth/login
**åŠŸèƒ½æè¿°**: ç”¨æˆ·ç™»å½•è·å–JWT Tokenï¼ˆå¼€å‘é˜¶æ®µä½¿ç”¨ä¸‡èƒ½éªŒè¯ç ï¼‰

**è¯·æ±‚å‚æ•°**:
```json
{
  "mobile": "13800138000",    // æ‰‹æœºå·ï¼Œ11ä½æ•°å­—
  "code": "123456"            // å¼€å‘é˜¶æ®µä¸‡èƒ½éªŒè¯ç ï¼š123456
}
```

**å“åº”æ ¼å¼**:
```json
// âœ… æˆåŠŸå“åº”
{
  "code": 0,
  "msg": "ç™»å½•æˆåŠŸ",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "userInfo": {
      "userId": "uuid-string",
      "mobile": "13800138000",
      "nickname": "ç”¨æˆ·æ˜µç§°",
      "isAdmin": false,         // ç®¡ç†å‘˜æ ‡è¯†
      "points": 1000,           // ç”¨æˆ·ç§¯åˆ†  
      "avatar": "å¤´åƒURL"
    },
    "expiresIn": 604800         // Tokenæœ‰æ•ˆæœŸï¼ˆç§’ï¼‰
  },
  "timestamp": "2025-07-28T20:15:37.000Z"
}

// âŒ é”™è¯¯å“åº”
{
  "code": 1002,
  "msg": "éªŒè¯ç é”™è¯¯",
  "data": null,
  "timestamp": "2025-07-28T20:15:37.000Z"
}
```

### 2.2 JWT TokenéªŒè¯æœºåˆ¶

å½“å‰ç³»ç»Ÿå·²å®ç°å®Œæ•´çš„JWTéªŒè¯ä¸­é—´ä»¶ï¼Œè®¤è¯æµç¨‹å¦‚ä¸‹ï¼š

**è¯·æ±‚å¤´æ ¼å¼**:
```http
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**TokenéªŒè¯é€»è¾‘**:
1. æå–Authorizationå¤´ä¸­çš„Bearer Token
2. éªŒè¯Tokenç­¾åå’Œæœ‰æ•ˆæœŸ
3. ä»æ•°æ®åº“è·å–ç”¨æˆ·ä¿¡æ¯
4. æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ï¼ˆæ˜¯å¦è¢«ç¦ç”¨ï¼‰
5. å°†ç”¨æˆ·ä¿¡æ¯æ³¨å…¥req.userå¯¹è±¡

**è®¤è¯é”™è¯¯ç **:
| é”™è¯¯ç  | å«ä¹‰ | HTTPçŠ¶æ€ç  |
|-------|------|-----------|
| 4001 | ç¼ºå°‘è®¿é—®ä»¤ç‰Œ | 401 |
| 4002 | è®¿é—®ä»¤ç‰Œæ— æ•ˆæˆ–å·²è¿‡æœŸ | 401 |
| 4003 | ç”¨æˆ·ä¸å­˜åœ¨æˆ–å·²è¢«ç¦ç”¨ | 401 |
| 4005 | éœ€è¦ç®¡ç†å‘˜æƒé™ | 403 |

## ğŸ—„ï¸ ç»Ÿä¸€èµ„æºç®¡ç†API v2.0

### 3.1 åˆ›å»ºå›¾ç‰‡èµ„æº

#### POST /api/v2/resources
**åŠŸèƒ½æè¿°**: ä¸Šä¼ å¹¶åˆ›å»ºå›¾ç‰‡èµ„æºï¼ˆæ”¯æŒä¸šåŠ¡åˆ†ç±»å­˜å‚¨ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**è¯·æ±‚å‚æ•°**:
```http
Content-Type: multipart/form-data

image: <file>                    // å›¾ç‰‡æ–‡ä»¶ï¼ˆå¿…éœ€ï¼‰
businessType: "lottery"          // ä¸šåŠ¡ç±»å‹ï¼šlottery/exchange/trade/uploads
category: "prizes"               // ä¸šåŠ¡åˆ†ç±»
contextId: "1"                   // ä¸Šä¸‹æ–‡IDï¼ˆç”¨æˆ·ID/å•†å“IDç­‰ï¼‰
isActive: "true"                 // æ˜¯å¦æ´»è·ƒèµ„æº
priority: "high"                 // ä¼˜å…ˆçº§ï¼šhigh/normal/low
description: "å¥–å“å›¾ç‰‡"          // æè¿°ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "å›¾ç‰‡èµ„æºåˆ›å»ºæˆåŠŸ",
  "data": {
    "resourceId": "550e8400-e29b-41d4-a716-446655440000",
    "businessType": "lottery",
    "category": "prizes",
    "contextId": 1,
    "userId": 31,
    "storageLayer": "hot",
    "filePath": "hot/lottery/prizes/20250728_LOT_1_a1b2c3d4.jpg",
    "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/hot/lottery/prizes/20250728_LOT_1_a1b2c3d4.jpg",
    "thumbnailPaths": {
      "small": "hot/lottery/prizes/thumbnails/small/20250728_LOT_1_a1b2c3d4_small.jpg",
      "medium": "hot/lottery/prizes/thumbnails/medium/20250728_LOT_1_a1b2c3d4_medium.jpg",
      "large": "hot/lottery/prizes/thumbnails/large/20250728_LOT_1_a1b2c3d4_large.jpg"
    },
    "originalFilename": "prize1.jpg",
    "fileSize": 2048576,
    "mimeType": "image/jpeg",
    "dimensions": {
      "width": 1920,
      "height": 1080
    },
    "status": "active",
    "createdAt": "2025-07-28T20:15:37.000Z"
  }
}
```

### 3.2 æ‰¹é‡ä¸Šä¼ å›¾ç‰‡èµ„æº

#### POST /api/v2/resources/batch
**åŠŸèƒ½æè¿°**: æ‰¹é‡ä¸Šä¼ å›¾ç‰‡èµ„æºï¼ˆæœ€å¤š5ä¸ªæ–‡ä»¶ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**è¯·æ±‚å‚æ•°**:
```http
Content-Type: multipart/form-data

images: <files[]>                // å›¾ç‰‡æ–‡ä»¶æ•°ç»„ï¼ˆæœ€å¤š5ä¸ªï¼‰
businessType: "exchange"         // ä¸šåŠ¡ç±»å‹
category: "products"             // ä¸šåŠ¡åˆ†ç±»
contextId: "123"                 // ä¸Šä¸‹æ–‡ID
isActive: "true"                 // æ˜¯å¦æ´»è·ƒèµ„æº
priority: "normal"               // ä¼˜å…ˆçº§
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "æ‰¹é‡ä¸Šä¼ æˆåŠŸ",
  "data": {
    "uploadCount": 3,
    "resources": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440001",
        "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
        "originalFilename": "product1.jpg"
      },
      // ... æ›´å¤šèµ„æº
    ],
    "statistics": {
      "totalSize": 6291456,
      "averageSize": 2097152,
      "storageLayer": "hot"
    }
  }
}
```

### 3.3 æŸ¥è¯¢å›¾ç‰‡èµ„æºåˆ—è¡¨

#### GET /api/v2/resources
**åŠŸèƒ½æè¿°**: æŸ¥è¯¢å›¾ç‰‡èµ„æºåˆ—è¡¨ï¼ˆæ”¯æŒç­›é€‰å’Œåˆ†é¡µï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**æŸ¥è¯¢å‚æ•°**:
```http
GET /api/v2/resources?businessType=lottery&category=prizes&status=active&page=1&limit=20&orderBy=created_at&order=DESC
```

| å‚æ•° | ç±»å‹ | å¿…éœ€ | æè¿° |
|------|------|------|------|
| businessType | string | å¦ | ä¸šåŠ¡ç±»å‹ç­›é€‰ |
| category | string | å¦ | åˆ†ç±»ç­›é€‰ |
| status | string | å¦ | çŠ¶æ€ç­›é€‰ï¼šactive/archived/deleted |
| page | number | å¦ | é¡µç ï¼Œé»˜è®¤1 |
| limit | number | å¦ | æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§100 |
| orderBy | string | å¦ | æ’åºå­—æ®µï¼Œé»˜è®¤created_at |
| order | string | å¦ | æ’åºæ–¹å‘ï¼šASC/DESCï¼Œé»˜è®¤DESC |

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "æŸ¥è¯¢æˆåŠŸ",
  "data": {
    "resources": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440000",
        "businessType": "lottery",
        "category": "prizes",
        "contextId": 1,
        "storageLayer": "hot",
        "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
        "thumbnails": {
          "small": "...",
          "medium": "...",
          "large": "..."
        },
        "originalFilename": "prize1.jpg",
        "fileSize": 2048576,
        "mimeType": "image/jpeg",
        "dimensions": {
          "width": 1920,
          "height": 1080
        },
        "status": "active",
        "accessCount": 156,
        "lastAccessedAt": "2025-07-28T19:30:15.000Z",
        "createdAt": "2025-07-28T20:15:37.000Z"
      }
      // ... æ›´å¤šèµ„æº
    ],
    "pagination": {
      "currentPage": 1,
      "totalPages": 5,
      "totalCount": 95,
      "pageSize": 20,
      "hasNextPage": true,
      "hasPrevPage": false
    },
    "statistics": {
      "totalResources": 95,
      "totalSize": 199229440,
      "storageDistribution": {
        "hot": 45,
        "standard": 35,
        "archive": 15
      }
    }
  }
}
```

### 3.4 è·å–å•ä¸ªèµ„æºè¯¦æƒ…

#### GET /api/v2/resources/:resourceId
**åŠŸèƒ½æè¿°**: è·å–æŒ‡å®šèµ„æºçš„è¯¦ç»†ä¿¡æ¯
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "è·å–æˆåŠŸ",
  "data": {
    "resourceId": "550e8400-e29b-41d4-a716-446655440000",
    "businessType": "lottery",
    "category": "prizes", 
    "contextId": 1,
    "userId": 31,
    "storageLayer": "hot",
    "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
    "thumbnailPaths": {
      "small": "...",
      "medium": "...",
      "large": "..."
    },
    "originalFilename": "prize1.jpg",
    "fileSize": 2048576,
    "mimeType": "image/jpeg",
    "dimensions": {
      "width": 1920,
      "height": 1080
    },
    "status": "active",
    "accessCount": 156,
    "lastAccessedAt": "2025-07-28T19:30:15.000Z",
    "metadata": {
      "uploadUserAgent": "Mozilla/5.0...",
      "uploadIp": "192.168.1.100",
      "compressionRatio": 0.85,
      "colorProfile": "sRGB"
    },
    "createdAt": "2025-07-28T20:15:37.000Z",
    "updatedAt": "2025-07-28T20:15:37.000Z"
  }
}
```

### 3.5 æ›´æ–°èµ„æºä¿¡æ¯

#### PUT /api/v2/resources/:resourceId
**åŠŸèƒ½æè¿°**: æ›´æ–°å›¾ç‰‡èµ„æºçš„å…ƒæ•°æ®ä¿¡æ¯
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯ï¼ˆåªèƒ½æ›´æ–°è‡ªå·±çš„èµ„æºæˆ–ç®¡ç†å‘˜æƒé™ï¼‰

**è¯·æ±‚å‚æ•°**:
```json
{
  "category": "new_category",      // æ›´æ–°åˆ†ç±»
  "status": "archived",           // æ›´æ–°çŠ¶æ€
  "metadata": {                   // æ›´æ–°å…ƒæ•°æ®
    "description": "æ›´æ–°åçš„æè¿°",
    "tags": ["tag1", "tag2"]
  }
}
```

### 3.6 åˆ é™¤èµ„æºï¼ˆè½¯åˆ é™¤ï¼‰

#### DELETE /api/v2/resources/:resourceId
**åŠŸèƒ½æè¿°**: è½¯åˆ é™¤å›¾ç‰‡èµ„æºï¼ˆä¸ä¼šçœŸæ­£åˆ é™¤æ–‡ä»¶ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯ï¼ˆåªèƒ½åˆ é™¤è‡ªå·±çš„èµ„æºæˆ–ç®¡ç†å‘˜æƒé™ï¼‰

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "èµ„æºåˆ é™¤æˆåŠŸ",
  "data": {
    "resourceId": "550e8400-e29b-41d4-a716-446655440000",
    "status": "deleted",
    "deletedAt": "2025-07-28T20:15:37.000Z"
  }
}
```

## ğŸ° æŠ½å¥–ä¸šåŠ¡API v2.0

### 4.1 è·å–å¥–å“å›¾ç‰‡èµ„æº

#### GET /api/v2/lottery/prizes/:prizeId
**åŠŸèƒ½æè¿°**: è·å–ç‰¹å®šå¥–å“çš„å›¾ç‰‡èµ„æº
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "è·å–æˆåŠŸ",
  "data": {
    "prizeId": 123,
    "resources": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440000",
        "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
        "thumbnails": {
          "small": "...",
          "medium": "...",
          "large": "..."
        },
        "originalFilename": "prize_main.jpg",
        "dimensions": {
          "width": 800,
          "height": 600
        }
      }
    ],
    "statistics": {
      "totalImages": 3,
      "totalSize": 5242880,
      "lastUpdated": "2025-07-28T18:30:00.000Z"
    }
  }
}
```

### 4.2 ä¸Šä¼ å¥–å“å›¾ç‰‡ï¼ˆç®¡ç†å‘˜ï¼‰

#### POST /api/v2/lottery/prizes/:prizeId/images
**åŠŸèƒ½æè¿°**: ä¸ºç‰¹å®šå¥–å“ä¸Šä¼ å›¾ç‰‡èµ„æº
**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™

**è¯·æ±‚å‚æ•°**:
```http
Content-Type: multipart/form-data

images: <files[]>                // å›¾ç‰‡æ–‡ä»¶æ•°ç»„
isActive: "true"                 // æ˜¯å¦æ¿€æ´»
priority: "high"                 // ä¼˜å…ˆçº§
description: "å¥–å“ä¸»å›¾"          // æè¿°
```

### 4.3 è·å–è½¬ç›˜ç›¸å…³å›¾ç‰‡

#### GET /api/v2/lottery/wheels
**åŠŸèƒ½æè¿°**: è·å–æŠ½å¥–è½¬ç›˜ç›¸å…³çš„å›¾ç‰‡èµ„æº
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**æŸ¥è¯¢å‚æ•°**:
```http
GET /api/v2/lottery/wheels?status=active&limit=10
```

### 4.4 è·å–æŠ½å¥–æ¨ªå¹…å›¾ç‰‡

#### GET /api/v2/lottery/banners
**åŠŸèƒ½æè¿°**: è·å–æŠ½å¥–æ´»åŠ¨æ¨ªå¹…å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### 4.5 è·å–æŠ½å¥–ç»“æœå›¾ç‰‡

#### GET /api/v2/lottery/results
**åŠŸèƒ½æè¿°**: è·å–æŠ½å¥–ç»“æœå±•ç¤ºç›¸å…³å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

## ğŸ›ï¸ å…‘æ¢ä¸šåŠ¡API v2.0

### 5.1 è·å–å•†å“å›¾ç‰‡èµ„æº

#### GET /api/v2/exchange/products/:productId
**åŠŸèƒ½æè¿°**: è·å–ç‰¹å®šå•†å“çš„å›¾ç‰‡èµ„æº
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "è·å–æˆåŠŸ",
  "data": {
    "productId": 456,
    "resources": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440001",
        "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
        "thumbnails": {
          "small": "...",
          "medium": "...",
          "large": "..."
        },
        "originalFilename": "product_detail.jpg",
        "isPrimary": true,           // æ˜¯å¦ä¸»å›¾
        "displayOrder": 1            // æ˜¾ç¤ºé¡ºåº
      }
    ],
    "statistics": {
      "totalImages": 5,
      "primaryImage": "...",
      "lastUpdated": "2025-07-28T17:45:00.000Z"
    }
  }
}
```

### 5.2 ä¸Šä¼ å•†å“å›¾ç‰‡ï¼ˆç®¡ç†å‘˜ï¼‰

#### POST /api/v2/exchange/products/:productId/images
**åŠŸèƒ½æè¿°**: ä¸ºç‰¹å®šå•†å“ä¸Šä¼ å›¾ç‰‡èµ„æº
**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™

### 5.3 è·å–å…‘æ¢åˆ†ç±»å›¾ç‰‡

#### GET /api/v2/exchange/categories
**åŠŸèƒ½æè¿°**: è·å–å…‘æ¢å•†å“åˆ†ç±»å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### 5.4 è·å–ä¿ƒé”€æ´»åŠ¨å›¾ç‰‡

#### GET /api/v2/exchange/promotions
**åŠŸèƒ½æè¿°**: è·å–å…‘æ¢ä¿ƒé”€æ´»åŠ¨å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

## ğŸª äº¤æ˜“ä¸šåŠ¡API v2.0

### 6.1 è·å–äº¤æ˜“ç‰©å“å›¾ç‰‡

#### GET /api/v2/trade/items/:itemId
**åŠŸèƒ½æè¿°**: è·å–ç‰¹å®šäº¤æ˜“ç‰©å“çš„å›¾ç‰‡èµ„æº
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### 6.2 ä¸Šä¼ äº¤æ˜“ç‰©å“å›¾ç‰‡

#### POST /api/v2/trade/items/:itemId/images
**åŠŸèƒ½æè¿°**: ä¸ºç‰¹å®šäº¤æ˜“ç‰©å“ä¸Šä¼ å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### 6.3 è·å–äº¤æ˜“æ¨ªå¹…å›¾ç‰‡

#### GET /api/v2/trade/banners
**åŠŸèƒ½æè¿°**: è·å–äº¤æ˜“ç›¸å…³æ¨ªå¹…å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### 6.4 è·å–äº¤æ˜“è®°å½•å›¾ç‰‡

#### GET /api/v2/trade/transactions
**åŠŸèƒ½æè¿°**: è·å–äº¤æ˜“è®°å½•ç›¸å…³å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

## ğŸ“¤ ç”¨æˆ·ä¸Šä¼ API v2.0

### 7.1 ç”¨æˆ·æäº¤å›¾ç‰‡å®¡æ ¸

#### POST /api/v2/uploads/submit
**åŠŸèƒ½æè¿°**: ç”¨æˆ·æäº¤å›¾ç‰‡è¿›è¡Œå®¡æ ¸ï¼ˆæ¶ˆè´¹å°ç¥¨ç­‰ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**è¯·æ±‚å‚æ•°**:
```http
Content-Type: multipart/form-data

images: <files[]>                // å›¾ç‰‡æ–‡ä»¶æ•°ç»„ï¼ˆæœ€å¤š3ä¸ªï¼‰
description: "æ¶ˆè´¹å°ç¥¨å®¡æ ¸"       // æè¿°ä¿¡æ¯
consumptionAmount: "98.50"       // æ¶ˆè´¹é‡‘é¢ï¼ˆå¯é€‰ï¼‰
merchantInfo: "XXé¤å…"           // å•†æˆ·ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "æäº¤æˆåŠŸï¼Œç­‰å¾…å®¡æ ¸",
  "data": {
    "submissionId": "550e8400-e29b-41d4-a716-446655440002",
    "uploadedResources": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440003",
        "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
        "originalFilename": "receipt1.jpg"
      }
    ],
    "reviewStatus": "pending",
    "estimatedReviewTime": "2-4å°æ—¶",
    "submittedAt": "2025-07-28T20:15:37.000Z"
  }
}
```

### 7.2 è·å–æˆ‘çš„æäº¤è®°å½•

#### GET /api/v2/uploads/my-submissions
**åŠŸèƒ½æè¿°**: è·å–å½“å‰ç”¨æˆ·çš„å›¾ç‰‡æäº¤è®°å½•
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**æŸ¥è¯¢å‚æ•°**:
```http
GET /api/v2/uploads/my-submissions?status=pending&page=1&limit=10
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "è·å–æˆåŠŸ",
  "data": {
    "submissions": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440003",
        "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
        "originalFilename": "receipt1.jpg",
        "reviewStatus": "approved",
        "reviewReason": "å®¡æ ¸é€šè¿‡ï¼Œå¥–åŠ±ç§¯åˆ†100åˆ†",
        "pointsAwarded": 100,
        "consumptionAmount": 98.50,
        "submittedAt": "2025-07-28T18:30:00.000Z",
        "reviewedAt": "2025-07-28T19:15:00.000Z"
      }
    ],
    "pagination": {
      "currentPage": 1,
      "totalPages": 3,
      "totalCount": 25,
      "pageSize": 10
    },
    "statistics": {
      "totalSubmissions": 25,
      "approved": 18,
      "pending": 4,
      "rejected": 3,
      "totalPointsEarned": 1850
    }
  }
}
```

### 7.3 è·å–å¾…å®¡æ ¸å›¾ç‰‡åˆ—è¡¨ï¼ˆç®¡ç†å‘˜ï¼‰

#### GET /api/v2/uploads/pending-reviews
**åŠŸèƒ½æè¿°**: è·å–å¾…å®¡æ ¸çš„ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡åˆ—è¡¨
**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™

**æŸ¥è¯¢å‚æ•°**:
```http
GET /api/v2/uploads/pending-reviews?limit=50&orderBy=created_at&order=ASC
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "è·å–æˆåŠŸ",
  "data": {
    "pendingReviews": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440004",
        "userId": 31,
        "userInfo": {
          "mobile": "13800138000",
          "nickname": "å¼ ä¸‰"
        },
        "cdnUrl": "https://br0za7uc-tiangong.objectstorageapi.bja.sealos.run/...",
        "originalFilename": "receipt_20250728.jpg",
        "fileSize": 1048576,
        "consumptionAmount": 156.80,
        "description": "æ™šé¤æ¶ˆè´¹å°ç¥¨",
        "submittedAt": "2025-07-28T19:30:00.000Z",
        "waitingTime": "45åˆ†é’Ÿ"
      }
    ],
    "totalPending": 12,
    "averageWaitTime": "2.5å°æ—¶"
  }
}
```

### 7.4 å®¡æ ¸å•ä¸ªå›¾ç‰‡ï¼ˆç®¡ç†å‘˜ï¼‰

#### POST /api/v2/uploads/review/:resourceId
**åŠŸèƒ½æè¿°**: ç®¡ç†å‘˜å®¡æ ¸å•ä¸ªç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡
**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™

**è¯·æ±‚å‚æ•°**:
```json
{
  "action": "approve",             // å®¡æ ¸åŠ¨ä½œï¼šapprove/reject
  "reason": "ç¬¦åˆè¦æ±‚ï¼Œå¥–åŠ±ç§¯åˆ†",   // å®¡æ ¸è¯´æ˜
  "pointsAwarded": 120,            // å¥–åŠ±ç§¯åˆ†ï¼ˆapproveæ—¶ï¼‰
  "consumptionAmount": 156.80      // ç¡®è®¤æ¶ˆè´¹é‡‘é¢ï¼ˆå¯é€‰ï¼‰
}
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "å®¡æ ¸å®Œæˆ",
  "data": {
    "resourceId": "550e8400-e29b-41d4-a716-446655440004",
    "reviewStatus": "approved",
    "reviewReason": "ç¬¦åˆè¦æ±‚ï¼Œå¥–åŠ±ç§¯åˆ†",
    "pointsAwarded": 120,
    "reviewedAt": "2025-07-28T20:15:37.000Z",
    "reviewerId": 1
  }
}
```

### 7.5 æ‰¹é‡å®¡æ ¸å›¾ç‰‡ï¼ˆç®¡ç†å‘˜ï¼‰

#### POST /api/v2/uploads/batch-review
**åŠŸèƒ½æè¿°**: ç®¡ç†å‘˜æ‰¹é‡å®¡æ ¸ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡
**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™

**è¯·æ±‚å‚æ•°**:
```json
{
  "reviews": [
    {
      "resourceId": "550e8400-e29b-41d4-a716-446655440004",
      "action": "approve",
      "reason": "å®¡æ ¸é€šè¿‡",
      "pointsAwarded": 100
    },
    {
      "resourceId": "550e8400-e29b-41d4-a716-446655440005", 
      "action": "reject",
      "reason": "å›¾ç‰‡ä¸æ¸…æ™°"
    }
  ]
}
```

### 7.6 åˆ é™¤ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡

#### DELETE /api/v2/uploads/:resourceId
**åŠŸèƒ½æè¿°**: ç”¨æˆ·åˆ é™¤è‡ªå·±ä¸Šä¼ çš„å›¾ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯ï¼ˆåªèƒ½åˆ é™¤è‡ªå·±çš„ä¸Šä¼ ï¼‰

## ğŸ›¡ï¸ ç®¡ç†å‘˜ä¸“ç”¨API v2.0

### 8.1 ç³»ç»Ÿæ¦‚è§ˆä¿¡æ¯

#### GET /api/v2/admin/overview
**åŠŸèƒ½æè¿°**: è·å–ç³»ç»Ÿæ•´ä½“æ¦‚è§ˆä¿¡æ¯
**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "ç³»ç»Ÿæ¦‚è§ˆä¿¡æ¯è·å–æˆåŠŸ",
  "data": {
    "overview": {
      "totalResources": 15423,
      "businessStats": [
        {
          "business_type": "lottery",
          "count": 5241,
          "total_size": 125829632
        },
        {
          "business_type": "exchange", 
          "count": 4156,
          "total_size": 98765432
        },
        {
          "business_type": "trade",
          "count": 3012,
          "total_size": 76543210
        },
        {
          "business_type": "uploads",
          "count": 3014,
          "total_size": 89123456
        }
      ],
      "storageStats": [
        {
          "storage_layer": "hot",
          "count": 6891,
          "total_size": 165432108
        },
        {
          "storage_layer": "standard",
          "count": 5234,
          "total_size": 125678912
        },
        {
          "storage_layer": "archive",
          "count": 3298,
          "total_size": 99150412
        }
      ]
    },
    "recentUploads": [
      {
        "resourceId": "550e8400-e29b-41d4-a716-446655440006",
        "businessType": "uploads",
        "category": "pending_review",
        "originalFilename": "receipt_latest.jpg",
        "fileSize": 2048576,
        "createdAt": "2025-07-28T20:10:00.000Z"
      }
    ],
    "systemInfo": {
      "version": "2.0.0",
      "nodeVersion": "v18.17.0",
      "uptime": 86400,
      "timestamp": "2025-07-28T20:15:37.000Z"
    }
  }
}
```

### 8.2 å­˜å‚¨ç»Ÿè®¡ä¿¡æ¯

#### GET /api/v2/resources/stats/storage
**åŠŸèƒ½æè¿°**: è·å–è¯¦ç»†çš„å­˜å‚¨ç»Ÿè®¡ä¿¡æ¯
**æƒé™è¦æ±‚**: ç®¡ç†å‘˜æƒé™

## ğŸ“– APIä½¿ç”¨ç¤ºä¾‹

### å‰ç«¯JavaScriptè°ƒç”¨ç¤ºä¾‹

#### 1. ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡å®¡æ ¸
```javascript
// ä¸Šä¼ å›¾ç‰‡è¿›è¡Œå®¡æ ¸
async function submitImageForReview(files, description) {
  const formData = new FormData();
  
  // æ·»åŠ æ–‡ä»¶
  files.forEach(file => {
    formData.append('images', file);
  });
  
  // æ·»åŠ æè¿°
  formData.append('description', description);
  
  try {
    const response = await fetch('/api/v2/uploads/submit', {
      method: 'POST',
      headers: {
        'Authorization': `Bearer ${localStorage.getItem('token')}`
      },
      body: formData
    });
    
    const result = await response.json();
    
    if (result.code === 0) {
      console.log('ä¸Šä¼ æˆåŠŸ:', result.data);
      return result.data;
    } else {
      throw new Error(result.msg);
    }
  } catch (error) {
    console.error('ä¸Šä¼ å¤±è´¥:', error);
    throw error;
  }
}
```

#### 2. è·å–èµ„æºåˆ—è¡¨
```javascript
// è·å–æŠ½å¥–å¥–å“å›¾ç‰‡åˆ—è¡¨
async function getLotteryPrizeImages(prizeId) {
  try {
    const response = await fetch(`/api/v2/lottery/prizes/${prizeId}`, {
      headers: {
        'Authorization': `Bearer ${localStorage.getItem('token')}`
      }
    });
    
    const result = await response.json();
    
    if (result.code === 0) {
      return result.data.resources;
    } else {
      throw new Error(result.msg);
    }
  } catch (error) {
    console.error('è·å–å›¾ç‰‡å¤±è´¥:', error);
    throw error;
  }
}
```

#### 3. ç®¡ç†å‘˜æ‰¹é‡å®¡æ ¸
```javascript
// ç®¡ç†å‘˜æ‰¹é‡å®¡æ ¸ç”¨æˆ·ä¸Šä¼ 
async function batchReviewUploads(reviews) {
  try {
    const response = await fetch('/api/v2/uploads/batch-review', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${localStorage.getItem('token')}`
      },
      body: JSON.stringify({ reviews })
    });
    
    const result = await response.json();
    
    if (result.code === 0) {
      console.log('æ‰¹é‡å®¡æ ¸å®Œæˆ:', result.data);
      return result.data;
    } else {
      throw new Error(result.msg);
    }
  } catch (error) {
    console.error('æ‰¹é‡å®¡æ ¸å¤±è´¥:', error);
    throw error;
  }
}
```

## ğŸ” æ•…éšœæ’æŸ¥æŒ‡å—

### å¸¸è§é”™è¯¯åŠè§£å†³æ–¹æ¡ˆ

#### 1. è®¤è¯ç›¸å…³é”™è¯¯
| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | è§£å†³æ–¹æ¡ˆ |
|-------|---------|---------|
| 4001 | ç¼ºå°‘è®¿é—®ä»¤ç‰Œ | æ£€æŸ¥è¯·æ±‚å¤´æ˜¯å¦åŒ…å«Authorizationå­—æ®µ |
| 4002 | è®¿é—®ä»¤ç‰Œæ— æ•ˆæˆ–å·²è¿‡æœŸ | é‡æ–°ç™»å½•è·å–æ–°Token |
| 4003 | ç”¨æˆ·ä¸å­˜åœ¨æˆ–å·²è¢«ç¦ç”¨ | æ£€æŸ¥ç”¨æˆ·çŠ¶æ€ï¼Œè”ç³»ç®¡ç†å‘˜ |
| 4005 | éœ€è¦ç®¡ç†å‘˜æƒé™ | ç¡®è®¤å½“å‰ç”¨æˆ·æ˜¯å¦å…·æœ‰ç®¡ç†å‘˜æƒé™ |

#### 2. æ–‡ä»¶ä¸Šä¼ é”™è¯¯
| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | è§£å†³æ–¹æ¡ˆ |
|-------|---------|---------|
| 1001 | æ–‡ä»¶å¤§å°è¶…é™ | å‹ç¼©æ–‡ä»¶æˆ–é€‰æ‹©è¾ƒå°çš„æ–‡ä»¶ |
| 1002 | ä¸æ”¯æŒçš„æ–‡ä»¶ç±»å‹ | ç¡®ä¿æ–‡ä»¶ä¸ºjpg/jpeg/png/webpæ ¼å¼ |
| 1003 | æœªä¸Šä¼ æ–‡ä»¶ | ç¡®ä¿è¡¨å•åŒ…å«fileå­—æ®µ |
| 5001 | å­˜å‚¨æœåŠ¡å¼‚å¸¸ | è”ç³»æŠ€æœ¯æ”¯æŒæ£€æŸ¥å­˜å‚¨æœåŠ¡çŠ¶æ€ |

#### 3. ä¸šåŠ¡é€»è¾‘é”™è¯¯
| é”™è¯¯ç  | é”™è¯¯ä¿¡æ¯ | è§£å†³æ–¹æ¡ˆ |
|-------|---------|---------|
| 3001 | ç§¯åˆ†ä¸è¶³ | å……å€¼ç§¯åˆ†æˆ–é™ä½æ¶ˆè´¹ |
| 3002 | åº“å­˜ä¸è¶³ | é€‰æ‹©å…¶ä»–å•†å“æˆ–ç­‰å¾…è¡¥è´§ |
| 4001 | èµ„æºä¸å­˜åœ¨ | æ£€æŸ¥èµ„æºIDæ˜¯å¦æ­£ç¡® |
| 4002 | å•†å“ä¸å­˜åœ¨ | æ£€æŸ¥å•†å“IDæ˜¯å¦æ­£ç¡® |

### è°ƒè¯•å·¥å…·

#### 1. APIå¥åº·æ£€æŸ¥
```bash
curl -f http://localhost:3000/health
```

#### 2. APIæ–‡æ¡£æŸ¥çœ‹
```bash
curl http://localhost:3000/api/v2/docs
```

#### 3. ç³»ç»Ÿä¿¡æ¯æŸ¥çœ‹
```bash
curl http://localhost:3000/api/v2
```

## ğŸ° æ ¸å¿ƒä¸šåŠ¡APIæ¥å£ v3.0ï¼ˆ2025å¹´07æœˆ29æ—¥æ–°å¢ï¼‰

### ğŸ”´ æŠ½å¥–ç³»ç»ŸAPI

#### POST /api/v2/lottery/draw
**åŠŸèƒ½æè¿°**: æ‰§è¡ŒæŠ½å¥–ï¼ˆæ”¯æŒå•æŠ½å’Œè¿æŠ½ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**è¯·æ±‚å‚æ•°**:
```json
{
  "drawType": "single",     // æŠ½å¥–ç±»å‹ï¼šsingle/triple/five/ten
  "drawCount": 1,           // æŠ½å¥–æ¬¡æ•°
  "costPoints": 100,        // æ¶ˆè€—ç§¯åˆ†
  "clientInfo": {}          // å®¢æˆ·ç«¯ä¿¡æ¯
}
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "æŠ½å¥–æˆåŠŸ",
  "data": {
    "results": [
      {
        "winningIndex": 3,
        "prize": {
          "prizeId": "prize-4",
          "name": "ç”œå“1ä»½",
          "type": "å®ç‰©",
          "exchangeCode": "TG20250729001"
        }
      }
    ],
    "userStatus": {
      "remainingPoints": 1500,
      "todayDrawCount": 5
    }
  }
}
```

#### GET /api/v2/lottery/config
**åŠŸèƒ½æè¿°**: è·å–æŠ½å¥–é…ç½®ï¼ˆè½¬ç›˜ç»˜åˆ¶æ•°æ®ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### ğŸ›ï¸ å•†å“å…‘æ¢ç³»ç»ŸAPI

#### GET /api/v2/exchange/products
**åŠŸèƒ½æè¿°**: è·å–å•†å“åˆ—è¡¨ï¼ˆæ”¯æŒåŒç©ºé—´ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**æŸ¥è¯¢å‚æ•°**:
```
space=lucky          // ç©ºé—´ç±»å‹ï¼šlucky/premium
page=1               // é¡µç 
pageSize=20          // æ¯é¡µæ•°é‡
category=all         // å•†å“åˆ†ç±»
```

#### POST /api/v2/exchange/redeem
**åŠŸèƒ½æè¿°**: æ‰§è¡Œå•†å“å…‘æ¢
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

**è¯·æ±‚å‚æ•°**:
```json
{
  "productId": 15,
  "quantity": 2,
  "totalPoints": 1000,
  "space": "lucky"
}
```

#### GET /api/v2/exchange/premium-status
**åŠŸèƒ½æè¿°**: è·å–è‡»é€‰ç©ºé—´è§£é”çŠ¶æ€
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

#### POST /api/v2/exchange/unlock-premium
**åŠŸèƒ½æè¿°**: è§£é”è‡»é€‰ç©ºé—´
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### ğŸ” ç®¡ç†å‘˜å®¡æ ¸ç³»ç»ŸAPI

#### GET /api/v2/admin/pending-reviews
**åŠŸèƒ½æè¿°**: è·å–å¾…å®¡æ ¸åˆ—è¡¨
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™

#### POST /api/v2/admin/review-photo
**åŠŸèƒ½æè¿°**: å®¡æ ¸å•ä¸ªç…§ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™

**è¯·æ±‚å‚æ•°**:
```json
{
  "uploadId": "up_1722249322",
  "action": "approve",
  "amount": 88.5,
  "points": 885,
  "reason": "å®¡æ ¸é€šè¿‡"
}
```

#### POST /api/v2/admin/batch-review
**åŠŸèƒ½æè¿°**: æ‰¹é‡å®¡æ ¸ç…§ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™

### ğŸ’° ç§¯åˆ†ç®¡ç†ç³»ç»ŸAPI

#### GET /api/v2/points/balance
**åŠŸèƒ½æè¿°**: è·å–ç”¨æˆ·ç§¯åˆ†ä½™é¢
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

#### GET /api/v2/points/records
**åŠŸèƒ½æè¿°**: è·å–ç§¯åˆ†è®°å½•
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

#### GET /api/v2/points/statistics
**åŠŸèƒ½æè¿°**: è·å–ç§¯åˆ†ç»Ÿè®¡æ•°æ®
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### ğŸ”„ äº¤æ˜“ç³»ç»ŸAPI

#### POST /api/v2/trade/transfer
**åŠŸèƒ½æè¿°**: æ‰§è¡Œç§¯åˆ†è½¬è´¦
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

#### GET /api/v2/trade/records
**åŠŸèƒ½æè¿°**: è·å–äº¤æ˜“è®°å½•
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

#### GET /api/v2/trade/details/:tradeId
**åŠŸèƒ½æè¿°**: è·å–äº¤æ˜“è¯¦æƒ…
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯

### ğŸ“¡ WebSocketå®æ—¶é€šä¿¡

#### è¿æ¥åœ°å€
```
wss://domain.com/ws?token={jwt_token}
```

#### æ¶ˆæ¯ç±»å‹
- `points_update`: ç§¯åˆ†å˜åŠ¨æ¨é€
- `review_result`: å®¡æ ¸ç»“æœæ¨é€
- `stock_updated`: åº“å­˜å˜åŠ¨æ¨é€
- `heartbeat`: å¿ƒè·³æ¶ˆæ¯

## ğŸ° æ ¸å¿ƒä¸šåŠ¡APIæ¥å£ v3.0ï¼ˆ2025å¹´07æœˆ29æ—¥æ–°å¢ï¼‰

### ğŸ”´ æŠ½å¥–ç³»ç»ŸAPI

#### POST /api/v2/lottery/draw
**åŠŸèƒ½æè¿°**: æ‰§è¡ŒæŠ½å¥–ï¼ˆæ”¯æŒå•æŠ½å’Œè¿æŠ½ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "drawType": "single",     // æŠ½å¥–ç±»å‹ï¼šsingle/triple/five/ten
  "drawCount": 1,           // æŠ½å¥–æ¬¡æ•°
  "costPoints": 100,        // æ¶ˆè€—ç§¯åˆ†
  "clientInfo": {}          // å®¢æˆ·ç«¯ä¿¡æ¯
}
```

**å“åº”æ ¼å¼**:
```json
{
  "code": 0,
  "msg": "æŠ½å¥–æˆåŠŸ",
  "data": {
    "results": [
      {
        "winningIndex": 3,
        "prize": {
          "prizeId": "prize-4",
          "name": "ç”œå“1ä»½",
          "type": "å®ç‰©",
          "exchangeCode": "TG20250729001"
        }
      }
    ],
    "userStatus": {
      "remainingPoints": 1500,
      "todayDrawCount": 5
    }
  }
}
```

#### GET /api/v2/lottery/config
**åŠŸèƒ½æè¿°**: è·å–æŠ½å¥–é…ç½®ï¼ˆè½¬ç›˜ç»˜åˆ¶æ•°æ®ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### GET /api/v2/lottery/records
**åŠŸèƒ½æè¿°**: è·å–ç”¨æˆ·æŠ½å¥–è®°å½•
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### GET /api/v2/lottery/statistics
**åŠŸèƒ½æè¿°**: è·å–æŠ½å¥–ç»Ÿè®¡æ•°æ®
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

### ğŸ›ï¸ å•†å“å…‘æ¢ç³»ç»ŸAPI

#### GET /api/v2/exchange/products
**åŠŸèƒ½æè¿°**: è·å–å•†å“åˆ—è¡¨ï¼ˆæ”¯æŒå¹¸è¿ç©ºé—´å’Œè‡»é€‰ç©ºé—´ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "space": "lucky",         // ç©ºé—´ç±»å‹: lucky/premium
  "page": 1,                // åˆ†é¡µé¡µç 
  "pageSize": 20,           // æ¯é¡µæ•°é‡
  "category": "all",        // å•†å“åˆ†ç±»ç­›é€‰
  "sortBy": "default"       // æ’åºæ–¹å¼
}
```

#### GET /api/v2/exchange/premium-status
**åŠŸèƒ½æè¿°**: è·å–è‡»é€‰ç©ºé—´è§£é”çŠ¶æ€
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### POST /api/v2/exchange/unlock-premium
**åŠŸèƒ½æè¿°**: è§£é”è‡»é€‰ç©ºé—´
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### POST /api/v2/exchange/redeem
**åŠŸèƒ½æè¿°**: å…‘æ¢å•†å“
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "productId": 15,          // å•†å“ID
  "quantity": 2,            // å…‘æ¢æ•°é‡
  "totalPoints": 1000,      // æ€»æ¶ˆè€—ç§¯åˆ†
  "space": "lucky"          // æ‰€å±ç©ºé—´
}
```

#### GET /api/v2/exchange/orders
**åŠŸèƒ½æè¿°**: è·å–å…‘æ¢è®°å½•
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### GET /api/v2/exchange/statistics
**åŠŸèƒ½æè¿°**: è·å–å…‘æ¢ç»Ÿè®¡æ•°æ®ï¼ˆç®¡ç†å‘˜ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

### ğŸ’° äº¤æ˜“ç³»ç»ŸAPI

#### POST /api/v2/trade/transfer
**åŠŸèƒ½æè¿°**: æ‰§è¡Œç§¯åˆ†è½¬è´¦
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "toUserId": 456,          // æ¥æ”¶æ–¹ç”¨æˆ·ID
  "amount": 500,            // è½¬è´¦é‡‘é¢
  "reason": "ç§¯åˆ†è½¬è´¦",     // è½¬è´¦åŸå› 
  "password": "123456"      // äº¤æ˜“å¯†ç ï¼ˆå¯é€‰ï¼‰
}
```

#### GET /api/v2/trade/records
**åŠŸèƒ½æè¿°**: è·å–äº¤æ˜“è®°å½•
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### GET /api/v2/trade/details/:tradeId
**åŠŸèƒ½æè¿°**: è·å–äº¤æ˜“è¯¦æƒ…
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### GET /api/v2/trade/statistics
**åŠŸèƒ½æè¿°**: è·å–äº¤æ˜“ç»Ÿè®¡æ•°æ®ï¼ˆç®¡ç†å‘˜ï¼‰
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

### ğŸ” ç®¡ç†å‘˜å®¡æ ¸ç³»ç»ŸAPI

#### GET /api/v2/admin/pending-reviews
**åŠŸèƒ½æè¿°**: è·å–å¾…å®¡æ ¸åˆ—è¡¨
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "page": 1,                // åˆ†é¡µé¡µç 
  "pageSize": 20,           // æ¯é¡µæ•°é‡
  "period": "week",         // æ—¶é—´èŒƒå›´ï¼štoday/week/month/all
  "status": "pending",      // å®¡æ ¸çŠ¶æ€ï¼špending/approved/rejected/all
  "sortBy": "upload_time_desc" // æ’åºæ–¹å¼
}
```

#### POST /api/v2/admin/review-photo
**åŠŸèƒ½æè¿°**: å®¡æ ¸å•ä¸ªç…§ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "uploadId": "up_1722249322", // ä¸Šä¼ è®°å½•ID
  "action": "approve",         // å®¡æ ¸åŠ¨ä½œï¼šapprove/reject
  "amount": 88.5,              // æ¶ˆè´¹é‡‘é¢
  "points": 885,               // å¥–åŠ±ç§¯åˆ†
  "reason": "å®¡æ ¸é€šè¿‡"         // å®¡æ ¸å¤‡æ³¨
}
```

#### POST /api/v2/admin/batch-review
**åŠŸèƒ½æè¿°**: æ‰¹é‡å®¡æ ¸ç…§ç‰‡
**æƒé™è¦æ±‚**: éœ€è¦ç®¡ç†å‘˜æƒé™
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

**è¯·æ±‚å‚æ•°**:
```json
{
  "reviews": [
    {
      "uploadId": "up_1722249322",
      "action": "approve",
      "amount": 88.5,
      "points": 885,
      "reason": "æ‰¹é‡å®¡æ ¸é€šè¿‡"
    }
  ],
  "batchId": "batch_1722249322"
}
```

### ğŸ“Š ç§¯åˆ†ç®¡ç†ç³»ç»ŸAPI

#### GET /api/v2/points/balance
**åŠŸèƒ½æè¿°**: è·å–ç”¨æˆ·ç§¯åˆ†ä½™é¢
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### GET /api/v2/points/records
**åŠŸèƒ½æè¿°**: è·å–ç§¯åˆ†è®°å½•
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### GET /api/v2/points/statistics
**åŠŸèƒ½æè¿°**: è·å–ç§¯åˆ†ç»Ÿè®¡æ•°æ®
**æƒé™è¦æ±‚**: éœ€è¦è®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

### ğŸ“¡ WebSocketå®æ—¶é€šä¿¡

#### WebSocketè¿æ¥åœ°å€
**è¿æ¥åœ°å€**: `wss://domain.com/ws`
**è®¤è¯æ–¹å¼**: URLå‚æ•°Tokenè®¤è¯
**å®ç°çŠ¶æ€**: âœ… å·²å®Œæˆ

#### æ”¯æŒçš„æ¶ˆæ¯ç±»å‹
- `points_update`: ç§¯åˆ†å˜åŠ¨æ¨é€
- `review_result`: å®¡æ ¸ç»“æœæ¨é€
- `stock_updated`: åº“å­˜å˜åŠ¨æ¨é€
- `lottery_result`: æŠ½å¥–ç»“æœæ¨é€
- `system_notification`: ç³»ç»Ÿé€šçŸ¥æ¨é€

## ğŸ“š ä¸šåŠ¡ç±»å‹å’Œåˆ†ç±»è¯´æ˜

### ä¸šåŠ¡ç±»å‹å®šä¹‰
| ä¸šåŠ¡ç±»å‹ | è‹±æ–‡æ ‡è¯† | æè¿° | ä¸»è¦åˆ†ç±» |
|---------|---------|------|---------|
| æŠ½å¥–ä¸šåŠ¡ | lottery | æŠ½å¥–æ´»åŠ¨ç›¸å…³å›¾ç‰‡ | prizes, wheels, banners, results |
| å…‘æ¢ä¸šåŠ¡ | exchange | ç§¯åˆ†å…‘æ¢å•†å“å›¾ç‰‡ | products, categories, promotions |
| äº¤æ˜“ä¸šåŠ¡ | trade | ç”¨æˆ·äº¤æ˜“ç›¸å…³å›¾ç‰‡ | items, banners, transactions |
| ç”¨æˆ·ä¸Šä¼  | uploads | ç”¨æˆ·æäº¤å®¡æ ¸å›¾ç‰‡ | pending_review, approved, rejected |

### å­˜å‚¨å±‚çº§ç­–ç•¥
| å­˜å‚¨å±‚çº§ | è‹±æ–‡æ ‡è¯† | ç‰¹ç‚¹ | é€‚ç”¨åœºæ™¯ |
|---------|---------|------|---------|
| çƒ­å­˜å‚¨ | hot | å¿«é€Ÿè®¿é—®ï¼Œé«˜æˆæœ¬ | æ–°ä¸Šä¼ ã€æ´»è·ƒèµ„æº |
| æ ‡å‡†å­˜å‚¨ | standard | å¹³è¡¡æ€§èƒ½å’Œæˆæœ¬ | ä¸­æœŸå­˜å‚¨èµ„æº |
| å½’æ¡£å­˜å‚¨ | archive | ä½æˆæœ¬ï¼Œè®¿é—®è¾ƒæ…¢ | é•¿æœŸå­˜å‚¨èµ„æº |

### å­—æ®µè½¬æ¢è¯´æ˜

ç³»ç»Ÿå†…ç½®è‡ªåŠ¨å­—æ®µè½¬æ¢åŠŸèƒ½ï¼Œå‰ç«¯æ— éœ€æ‰‹åŠ¨å¤„ç†ä»¥ä¸‹å­—æ®µæ˜ å°„ï¼š

| æ•°æ®åº“å­—æ®µ | å‰ç«¯å­—æ®µ | è¯´æ˜ |
|-----------|---------|------|
| user_id | userId | ç”¨æˆ·ID |
| resource_id | resourceId | èµ„æºID |
| business_type | businessType | ä¸šåŠ¡ç±»å‹ |
| created_at | createdAt | åˆ›å»ºæ—¶é—´ |
| updated_at | updatedAt | æ›´æ–°æ—¶é—´ |
| file_size | fileSize | æ–‡ä»¶å¤§å° |
| mime_type | mimeType | MIMEç±»å‹ |
| storage_layer | storageLayer | å­˜å‚¨å±‚çº§ |
| original_filename | originalFilename | åŸå§‹æ–‡ä»¶å |
| access_count | accessCount | è®¿é—®æ¬¡æ•° |
| last_accessed_at | lastAccessedAt | æœ€åè®¿é—®æ—¶é—´ |

## ğŸš€ æ¥å£æ€§èƒ½è¯´æ˜

### æ€§èƒ½æŒ‡æ ‡
| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|-------|------|
| APIå“åº”æ—¶é—´ | <100ms | æ™®é€šæŸ¥è¯¢æ¥å£ |
| æ–‡ä»¶ä¸Šä¼ æ—¶é—´ | <2s | å•ä¸ªæ–‡ä»¶ä¸Šä¼  |
| æ‰¹é‡ä¸Šä¼ æ—¶é—´ | <5s | 5ä¸ªæ–‡ä»¶æ‰¹é‡ä¸Šä¼  |
| æ•°æ®åº“æŸ¥è¯¢æ—¶é—´ | <50ms | å•æ¬¡æ•°æ®åº“æŸ¥è¯¢ |
| ç¼“å­˜å‘½ä¸­ç‡ | >80% | è·¯å¾„ç”Ÿæˆå’Œé…ç½®ç¼“å­˜ |

### å¹¶å‘æ”¯æŒ
- **å¹¶å‘ç”¨æˆ·æ•°**: 1000+
- **å¹¶å‘ä¸Šä¼ **: 100ä¸ªæ–‡ä»¶åŒæ—¶ä¸Šä¼ 
- **APIå¹¶å‘**: 500ä¸ªå¹¶å‘è¯·æ±‚
- **æ•°æ®åº“è¿æ¥æ± **: 20ä¸ªæœ€å¤§è¿æ¥

---

**æ¥å£è®¾è®¡åŸåˆ™**: RESTfulè®¾è®¡ã€ç»Ÿä¸€å“åº”æ ¼å¼ã€å®Œæ•´é”™è¯¯å¤„ç†ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨å¯é 

> æœ¬æ–‡æ¡£åŸºäºv2.0å¤šä¸šåŠ¡çº¿åˆ†å±‚å­˜å‚¨æ¶æ„çš„å®é™…APIå®ç°ï¼Œç¡®ä¿æ¥å£æ–‡æ¡£ä¸åç«¯ä»£ç å®Œå…¨ä¸€è‡´ï¼Œä¸ºå‰åç«¯å¯¹æ¥æä¾›å‡†ç¡®å¯é çš„æŠ€æœ¯å‚è€ƒã€‚ 