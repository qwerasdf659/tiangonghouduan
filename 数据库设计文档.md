# é¤å…ç§¯åˆ†æŠ½å¥–ç³»ç»Ÿ - æ•°æ®åº“è®¾è®¡æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v2.0  
**åˆ›å»ºæ—¶é—´**: 2025å¹´09æœˆ19æ—¥ UTC  
**æ›´æ–°æ—¶é—´**: 2025å¹´09æœˆ19æ—¥ 20:19:01 UTC  
**æ•°æ®åº“å¼•æ“**: MySQL  
**å­—ç¬¦é›†**: utf8mb4  
**æ—¶åŒº**: UTC+8 (åŒ—äº¬æ—¶é—´)  

## ğŸ“Š æ•°æ®åº“æ¦‚è§ˆ

æœ¬é¡¹ç›®ä½¿ç”¨MySQLæ•°æ®åº“ï¼Œé‡‡ç”¨Sequelize ORMæ¡†æ¶è¿›è¡Œæ•°æ®è®¿é—®ã€‚æ•°æ®åº“è®¾è®¡éµå¾ªé¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)åŸåˆ™ï¼Œå°†ä¸šåŠ¡åŠŸèƒ½æŒ‰ç…§é¢†åŸŸè¿›è¡Œæ¨¡å—åŒ–åˆ†ç¦»ã€‚

### ğŸ”§ æ•°æ®åº“é…ç½®

**æ•°æ®åº“è¿æ¥é…ç½®**:
- **ä¸»æœº**: ä»ç¯å¢ƒå˜é‡ `DB_HOST` è¯»å–
- **ç«¯å£**: ä»ç¯å¢ƒå˜é‡ `DB_PORT` è¯»å– (é»˜è®¤3306)
- **æ•°æ®åº“å**: ä»ç¯å¢ƒå˜é‡ `DB_NAME` è¯»å–
- **ç”¨æˆ·å**: ä»ç¯å¢ƒå˜é‡ `DB_USER` è¯»å–
- **å¯†ç **: ä»ç¯å¢ƒå˜é‡ `DB_PASSWORD` è¯»å–
- **å­—ç¬¦é›†**: utf8mb4_unicode_ci
- **æ—¶åŒº**: +08:00 (åŒ—äº¬æ—¶é—´)

**è¿æ¥æ± é…ç½®**:
- **æœ€å¤§è¿æ¥æ•°**: 50
- **æœ€å°è¿æ¥æ•°**: 5
- **è·å–è¿æ¥è¶…æ—¶**: 60ç§’
- **ç©ºé—²è¿æ¥æ—¶é—´**: 5åˆ†é’Ÿ
- **è¿æ¥æ¸…ç†é—´éš”**: 1åˆ†é’Ÿ

**æ•°æ®åº“ç‰¹æ€§**:
- æ”¯æŒJSONå­—æ®µç±»å‹
- å¯ç”¨å¤§æ•°å­—æ”¯æŒ
- è‡ªåŠ¨å¤„ç†è¿æ¥æ–­å¼€
- å¼€å‘ç¯å¢ƒå¯ç”¨SQLæ—¥å¿—

### ğŸ“‹ è¡¨ç»“æ„æ€»è§ˆ

å½“å‰æ•°æ®åº“åŒ…å« **35+** ä¸ªæ•°æ®è¡¨ï¼ŒæŒ‰åŠŸèƒ½æ¨¡å—åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š

1. **ç”¨æˆ·ç®¡ç†æ¨¡å—** (3å¼ è¡¨)
   - `users` - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯
   - `admin_users` - ç®¡ç†å‘˜ç”¨æˆ·
   - `user_sessions` - ç”¨æˆ·ä¼šè¯ç®¡ç†

2. **ç§¯åˆ†ç³»ç»Ÿæ¨¡å—** (3å¼ è¡¨)
   - `user_points_accounts` - ç”¨æˆ·ç§¯åˆ†è´¦æˆ·
   - `points_transactions` - ç§¯åˆ†äº¤æ˜“è®°å½•
   - `trade_records` - äº¤æ˜“è®°å½•

3. **æŠ½å¥–ç³»ç»Ÿæ¨¡å—** (6å¼ è¡¨)
   - `lottery_campaigns` - æŠ½å¥–æ´»åŠ¨é…ç½®
   - `lottery_records` - æŠ½å¥–è®°å½•
   - `lottery_prizes` - å¥–å“é…ç½®
   - `lottery_draws` - æŠ½å¥–æ‰§è¡Œè®°å½•
   - `prize_distributions` - å¥–å“åˆ†å‘è®°å½•
   - `lottery_pity` - ä¿åº•æœºåˆ¶

4. **ä¸šåŠ¡åŠŸèƒ½æ¨¡å—** (7å¼ è¡¨)
   - `user_inventory` - ç”¨æˆ·åº“å­˜
   - `products` - å•†å“ç®¡ç†
   - `exchange_records` - å…‘æ¢è®°å½•
   - `business_events` - ä¸šåŠ¡äº‹ä»¶
   - `image_resources` - å›¾ç‰‡èµ„æº
   - `upload_review` - ä¸Šä¼ å®¡æ ¸
   - `business_configs` - ä¸šåŠ¡é…ç½®

5. **ä»»åŠ¡ç³»ç»Ÿæ¨¡å—** (3å¼ è¡¨)
   - `user_tasks` - ç”¨æˆ·ä»»åŠ¡
   - `task_templates` - ä»»åŠ¡æ¨¡æ¿
   - `scheduled_tasks` - å®šæ—¶ä»»åŠ¡

6. **å®¢æœèŠå¤©æ¨¡å—** (4å¼ è¡¨)
   - `customer_sessions` - å®¢æœä¼šè¯
   - `chat_messages` - èŠå¤©æ¶ˆæ¯
   - `quick_replies` - å¿«æ·å›å¤
   - `admin_status` - ç®¡ç†å‘˜çŠ¶æ€

7. **ç»Ÿä¸€å¼•æ“æ¨¡å—** (5å¼ è¡¨)
   - `lottery_execution_logs` - æŠ½å¥–æ‰§è¡Œæ—¥å¿—
   - `lottery_engine_configs` - æŠ½å¥–å¼•æ“é…ç½®
   - `decision_records` - å†³ç­–è®°å½•
   - `probability_logs` - æ¦‚ç‡æ—¥å¿—
   - `system_metrics` - ç³»ç»ŸæŒ‡æ ‡

8. **ç³»ç»Ÿç®¡ç†æ¨¡å—** (4å¼ è¡¨)
   - `login_logs` - ç™»å½•æ—¥å¿—
   - `user_specific_prize_queues` - ç”¨æˆ·ä¸“å±å¥–å“é˜Ÿåˆ—
   - `user_pool_access` - ç”¨æˆ·æ± è®¿é—®
   - `task_progress_logs` - ä»»åŠ¡è¿›åº¦æ—¥å¿—

### ğŸ”— æ•°æ®åº“å…³ç³»ç‰¹ç‚¹

- **å¤–é”®çº¦æŸ**: ä½¿ç”¨Sequelizeå…³è”è€Œéæ•°æ®åº“çº§å¤–é”®
- **çº§è”æ“ä½œ**: é€šè¿‡ORMé…ç½®çº§è”åˆ é™¤
- **ç´¢å¼•ä¼˜åŒ–**: æ ¸å¿ƒæŸ¥è¯¢å­—æ®µå»ºç«‹å¤åˆç´¢å¼•
- **JSONå­—æ®µ**: çµæ´»å­˜å‚¨é…ç½®å’Œå…ƒæ•°æ®
- **æ—¶é—´å­—æ®µ**: ç»Ÿä¸€ä½¿ç”¨UTCæ—¶é—´å­˜å‚¨

### ğŸ“ˆ æ•°æ®è§„æ¨¡

æ ¹æ®å½“å‰æ•°æ®ç»Ÿè®¡ï¼š
- **ç”¨æˆ·æ•°æ®**: çº¦100+ç”¨æˆ·è®°å½•
- **æŠ½å¥–è®°å½•**: çº¦97æ¡æŠ½å¥–è®°å½•
- **ç§¯åˆ†äº¤æ˜“**: æ´»è·ƒçš„äº¤æ˜“è®°å½•
- **ç³»ç»Ÿé…ç½®**: å®Œæ•´çš„ä¸šåŠ¡é…ç½®æ•°æ®

## ğŸ”‘ ä¸»è¦è®¾è®¡åŸåˆ™

1. **é¢†åŸŸåˆ†ç¦»**: æŒ‰ä¸šåŠ¡é¢†åŸŸåˆ’åˆ†è¡¨ç»“æ„
2. **æ•°æ®ä¸€è‡´æ€§**: å…³é”®ä¸šåŠ¡æ•°æ®å¼ºä¸€è‡´æ€§
3. **æ€§èƒ½ä¼˜åŒ–**: åˆç†çš„ç´¢å¼•è®¾è®¡å’ŒæŸ¥è¯¢ä¼˜åŒ–
4. **æ‰©å±•æ€§**: æ”¯æŒä¸šåŠ¡åŠŸèƒ½çš„å¿«é€Ÿæ‰©å±•
5. **å®‰å…¨æ€§**: æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
6. **ç›‘æ§æ€§**: å®Œæ•´çš„æ“ä½œæ—¥å¿—å’Œå®¡è®¡è·Ÿè¸ª

---

## ğŸ‘¥ ç”¨æˆ·ç®¡ç†æ¨¡å—

### 1. users - ç”¨æˆ·åŸºæœ¬ä¿¡æ¯è¡¨

**è¡¨å**: `users`  
**æ¨¡å‹**: `User`  
**ä¸»è¦åŠŸèƒ½**: å­˜å‚¨ç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ã€ç™»å½•çŠ¶æ€å’Œåå¥½è®¾ç½®

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `user_id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | ç”¨æˆ·å”¯ä¸€æ ‡è¯† |
| `mobile` | VARCHAR(20) | NOT NULL, UNIQUE | - | æ‰‹æœºå·ç  |
| `nickname` | VARCHAR(50) | NULL | - | ç”¨æˆ·æ˜µç§° |
| `is_admin` | BOOLEAN | NOT NULL | false | æ˜¯å¦ä¸ºç®¡ç†å‘˜ |
| `history_total_points` | INTEGER | NOT NULL | 0 | å†å²ç´¯è®¡æ€»ç§¯åˆ†ï¼ˆç”¨äºè‡»é€‰ç©ºé—´è§£é”ï¼‰ |
| `status` | ENUM | NOT NULL | 'active' | ç”¨æˆ·çŠ¶æ€ï¼šactive/inactive/banned |
| `last_login` | DATETIME | NULL | - | æœ€åç™»å½•æ—¶é—´ |
| `login_count` | INTEGER | NOT NULL | 0 | ç™»å½•æ¬¡æ•°ç»Ÿè®¡ |
| `registration_date` | DATETIME | NOT NULL | NOW() | æ³¨å†Œæ—¶é—´ |
| `preferences` | JSON | NULL | - | ç”¨æˆ·åå¥½è®¾ç½® |
| `consecutive_fail_count` | INTEGER | NOT NULL | 0 | è¿ç»­æœªä¸­å¥–æ¬¡æ•°ï¼ˆä¿åº•æœºåˆ¶ï¼‰ |
| `created_at` | TIMESTAMP | NOT NULL | - | è®°å½•åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | è®°å½•æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `user_id` | ä¸»é”®ç´¢å¼• |
| `mobile` | å”¯ä¸€ | `mobile` | æ‰‹æœºå·å”¯ä¸€ç´¢å¼• |
| `idx_status_admin` | æ™®é€š | `status`, `is_admin` | çŠ¶æ€å’Œæƒé™ç»„åˆç´¢å¼• |
| `idx_history_points` | æ™®é€š | `history_total_points` | å†å²ç§¯åˆ†ç´¢å¼• |
| `idx_last_login` | æ™®é€š | `last_login` | æœ€åç™»å½•æ—¶é—´ç´¢å¼• |

#### å…³è”å…³ç³»

- **ä¸€å¯¹ä¸€**: `UserPointsAccount` (ç§¯åˆ†è´¦æˆ·)
- **ä¸€å¯¹å¤š**: `PointsTransaction` (ç§¯åˆ†äº¤æ˜“è®°å½•)
- **ä¸€å¯¹å¤š**: `LotteryRecord` (æŠ½å¥–è®°å½•)
- **ä¸€å¯¹å¤š**: `PrizeDistribution` (å¥–å“åˆ†å‘è®°å½•)
- **ä¸€å¯¹å¤š**: `UserInventory` (ç”¨æˆ·åº“å­˜)
- **ä¸€å¯¹å¤š**: `UserTask` (ç”¨æˆ·ä»»åŠ¡)
- **ä¸€å¯¹å¤š**: `LoginLog` (ç™»å½•æ—¥å¿—)
- **ä¸€å¯¹å¤š**: `UserSession` (ç”¨æˆ·ä¼šè¯)

### 2. admin_users - ç®¡ç†å‘˜ç”¨æˆ·è¡¨

**è¡¨å**: `admin_users`  
**æ¨¡å‹**: `AdminUser`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†å‘˜è´¦æˆ·ç®¡ç†ï¼Œæ”¯æŒå¯†ç åŠ å¯†ã€è´¦å·é”å®šã€MFAç­‰å®‰å…¨åŠŸèƒ½

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | ç®¡ç†å‘˜ID |
| `username` | VARCHAR(50) | NOT NULL, UNIQUE | - | ç®¡ç†å‘˜ç”¨æˆ·å |
| `password_hash` | VARCHAR(255) | NOT NULL | - | BCryptå¯†ç å“ˆå¸Œ |
| `phone` | VARCHAR(11) | NULL | - | ç»‘å®šæ‰‹æœºå· |
| `email` | VARCHAR(100) | NULL | - | é‚®ç®±åœ°å€ |
| `role` | ENUM | NOT NULL | 'admin' | è§’è‰²ï¼šadmin/super_admin |
| `status` | ENUM | NOT NULL | 'active' | çŠ¶æ€ï¼šactive/inactive/banned |
| `mfa_enabled` | TINYINT | NOT NULL | 0 | äºŒæ¬¡éªŒè¯å¯ç”¨çŠ¶æ€ |
| `mfa_secret` | VARCHAR(32) | NULL | - | MFAå¯†é’¥ |
| `last_sms_time` | DATETIME | NULL | - | æœ€åå‘é€çŸ­ä¿¡æ—¶é—´ |
| `login_fail_count` | TINYINT | NOT NULL | 0 | ç™»å½•å¤±è´¥æ¬¡æ•° |
| `locked_until` | DATETIME | NULL | - | é”å®šåˆ°æœŸæ—¶é—´ |
| `last_login_at` | DATETIME | NULL | - | æœ€åç™»å½•æ—¶é—´ |
| `last_login_ip` | VARCHAR(45) | NULL | - | æœ€åç™»å½•IP |
| `password_changed_at` | DATETIME | NULL | - | å¯†ç æœ€åä¿®æ”¹æ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `username` | å”¯ä¸€ | `username` | ç”¨æˆ·åå”¯ä¸€ç´¢å¼• |
| `idx_status_role` | æ™®é€š | `status`, `role` | çŠ¶æ€å’Œè§’è‰²ç»„åˆç´¢å¼• |
| `idx_locked_until` | æ™®é€š | `locked_until` | é”å®šæ—¶é—´ç´¢å¼• |

#### å®‰å…¨ç‰¹æ€§

- **å¯†ç ç­–ç•¥**: BCryptåŠ å¯†ï¼Œè‡³å°‘8ä½åŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦
- **è´¦å·é”å®š**: å¤±è´¥3æ¬¡é”å®š30åˆ†é’Ÿ
- **MFAæ”¯æŒ**: äºŒæ¬¡éªŒè¯åŠŸèƒ½
- **æ“ä½œå®¡è®¡**: å®Œæ•´çš„ç™»å½•å’Œæ“ä½œæ—¥å¿—

#### å…³è”å…³ç³»

- **ä¸€å¯¹ä¸€**: `AdminStatus` (ç®¡ç†å‘˜çŠ¶æ€)
- **ä¸€å¯¹å¤š**: `LoginLog` (ç™»å½•æ—¥å¿—)
- **ä¸€å¯¹å¤š**: `UserSession` (ä¼šè¯ç®¡ç†)

### 3. user_sessions - ç”¨æˆ·ä¼šè¯ç®¡ç†è¡¨

**è¡¨å**: `user_sessions`  
**æ¨¡å‹**: `UserSession`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç”¨æˆ·ç™»å½•ä¼šè¯çŠ¶æ€å’Œå®‰å…¨æ§åˆ¶

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `session_id` | VARCHAR(128) | PRIMARY KEY | - | ä¼šè¯å”¯ä¸€æ ‡è¯† |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `user_type` | ENUM | NOT NULL | 'user' | ç”¨æˆ·ç±»å‹ï¼šuser/admin |
| `token` | VARCHAR(255) | NOT NULL | - | ä¼šè¯Token |
| `refresh_token` | VARCHAR(255) | NULL | - | åˆ·æ–°Token |
| `ip_address` | VARCHAR(45) | NULL | - | ç™»å½•IPåœ°å€ |
| `user_agent` | TEXT | NULL | - | ç”¨æˆ·ä»£ç†ä¿¡æ¯ |
| `login_time` | DATETIME | NOT NULL | - | ç™»å½•æ—¶é—´ |
| `last_activity` | DATETIME | NOT NULL | - | æœ€åæ´»åŠ¨æ—¶é—´ |
| `expires_at` | DATETIME | NOT NULL | - | ä¼šè¯è¿‡æœŸæ—¶é—´ |
| `is_active` | BOOLEAN | NOT NULL | true | æ˜¯å¦æ´»è·ƒ |
| `logout_time` | DATETIME | NULL | - | ç™»å‡ºæ—¶é—´ |
| `device_info` | JSON | NULL | - | è®¾å¤‡ä¿¡æ¯ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `session_id` | ä¸»é”®ç´¢å¼• |
| `idx_user_active` | æ™®é€š | `user_id`, `is_active` | ç”¨æˆ·æ´»è·ƒä¼šè¯ç´¢å¼• |
| `idx_expires_at` | æ™®é€š | `expires_at` | è¿‡æœŸæ—¶é—´ç´¢å¼• |
| `idx_token` | æ™®é€š | `token` | Tokenç´¢å¼• |

#### ä¼šè¯ç®¡ç†ç‰¹æ€§

- **è‡ªåŠ¨è¿‡æœŸ**: æ”¯æŒä¼šè¯è‡ªåŠ¨è¿‡æœŸ
- **è®¾å¤‡è¿½è¸ª**: è®°å½•ç™»å½•è®¾å¤‡ä¿¡æ¯
- **å®‰å…¨æ§åˆ¶**: IPåœ°å€å’Œç”¨æˆ·ä»£ç†éªŒè¯
- **Tokenåˆ·æ–°**: æ”¯æŒTokenåˆ·æ–°æœºåˆ¶

---

## ğŸ° æŠ½å¥–ç³»ç»Ÿæ¨¡å—

### 1. lottery_campaigns - æŠ½å¥–æ´»åŠ¨é…ç½®è¡¨

**è¡¨å**: `lottery_campaigns`  
**æ¨¡å‹**: `LotteryCampaign`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†æŠ½å¥–æ´»åŠ¨çš„å®Œæ•´é…ç½®ï¼Œæ”¯æŒå¤šç§æŠ½å¥–ç±»å‹å’Œæ¦‚ç‡ç®—æ³•

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `campaign_id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | æ´»åŠ¨å”¯ä¸€æ ‡è¯† |
| `campaign_name` | VARCHAR(255) | NOT NULL | - | æ´»åŠ¨åç§° |
| `campaign_code` | VARCHAR(100) | NOT NULL, UNIQUE | - | æ´»åŠ¨ä»£ç ï¼ˆå”¯ä¸€ï¼‰ |
| `campaign_type` | ENUM | NOT NULL | - | æ´»åŠ¨ç±»å‹ï¼šdaily/weekly/event/permanent |
| `cost_per_draw` | DECIMAL(10,2) | NOT NULL | - | æ¯æ¬¡æŠ½å¥–æ¶ˆè€—ç§¯åˆ† |
| `max_draws_per_user_daily` | INTEGER | NOT NULL | 1 | æ¯ç”¨æˆ·æ¯æ—¥æœ€å¤§æŠ½å¥–æ¬¡æ•° |
| `max_draws_per_user_total` | INTEGER | NULL | - | æ¯ç”¨æˆ·æ€»æœ€å¤§æŠ½å¥–æ¬¡æ•° |
| `total_prize_pool` | DECIMAL(15,2) | NOT NULL | 0.0 | æ€»å¥–æ± ä»·å€¼ |
| `remaining_prize_pool` | DECIMAL(15,2) | NOT NULL | 0.0 | å‰©ä½™å¥–æ± ä»·å€¼ |
| `prize_distribution_config` | JSON | NOT NULL | - | å¥–å“åˆ†å¸ƒé…ç½® |
| `start_time` | DATETIME | NOT NULL | - | æ´»åŠ¨å¼€å§‹æ—¶é—´ |
| `end_time` | DATETIME | NOT NULL | - | æ´»åŠ¨ç»“æŸæ—¶é—´ |
| `daily_reset_time` | TIME | NOT NULL | '00:00:00' | æ¯æ—¥é‡ç½®æ—¶é—´ |
| `banner_image_url` | VARCHAR(500) | NULL | - | æ´»åŠ¨æ¨ªå¹…å›¾ç‰‡ |
| `description` | TEXT | NULL | - | æ´»åŠ¨æè¿° |
| `rules_text` | TEXT | NULL | - | æ´»åŠ¨è§„åˆ™è¯´æ˜ |
| `status` | ENUM | NOT NULL | 'draft' | æ´»åŠ¨çŠ¶æ€ï¼šdraft/active/paused/ended/cancelled |
| `is_featured` | BOOLEAN | NOT NULL | false | æ˜¯å¦ä¸ºç‰¹è‰²æ´»åŠ¨ |
| `total_participants` | INTEGER | NOT NULL | 0 | æ€»å‚ä¸äººæ•° |
| `total_draws` | INTEGER | NOT NULL | 0 | æ€»æŠ½å¥–æ¬¡æ•° |
| `total_prizes_awarded` | INTEGER | NOT NULL | 0 | æ€»ä¸­å¥–æ¬¡æ•° |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `campaign_id` | ä¸»é”®ç´¢å¼• |
| `unique_campaign_code` | å”¯ä¸€ | `campaign_code` | æ´»åŠ¨ä»£ç å”¯ä¸€ç´¢å¼• |
| `idx_lc_status` | æ™®é€š | `status` | çŠ¶æ€ç´¢å¼• |
| `idx_lc_campaign_type` | æ™®é€š | `campaign_type` | æ´»åŠ¨ç±»å‹ç´¢å¼• |
| `idx_lc_time_range` | æ™®é€š | `start_time`, `end_time` | æ—¶é—´èŒƒå›´ç´¢å¼• |
| `idx_lc_is_featured` | æ™®é€š | `is_featured` | ç‰¹è‰²æ´»åŠ¨ç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **çŠ¶æ€æ£€æŸ¥**: `isActive()`, `isUpcoming()`, `isEnded()`
- **å‚ä¸éªŒè¯**: `canUserParticipate()`, `checkDrawCost()`
- **ç»Ÿè®¡ä¿¡æ¯**: `getPrizePoolStats()`, `getParticipationStats()`
- **å¥åº·æ£€æŸ¥**: `getHealthStatus()`

#### å…³è”å…³ç³»

- **ä¸€å¯¹å¤š**: `LotteryPrize` (æ´»åŠ¨å¥–å“)
- **ä¸€å¯¹å¤š**: `LotteryRecord` (æŠ½å¥–è®°å½•)
- **ä¸€å¯¹å¤š**: `LotteryDraw` (æŠ½å¥–æ‰§è¡Œè®°å½•)

### 2. lottery_records - æŠ½å¥–è®°å½•è¡¨

**è¡¨å**: `lottery_records`  
**æ¨¡å‹**: `LotteryRecord`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç”¨æˆ·çš„æŠ½å¥–æ´»åŠ¨å†å²å’Œç»“æœ

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `draw_id` | VARCHAR(50) | PRIMARY KEY | - | æŠ½å¥–è®°å½•å”¯ä¸€ID |
| `user_id` | INTEGER | NOT NULL | - | å‚ä¸æŠ½å¥–çš„ç”¨æˆ·ID |
| `prize_id` | INTEGER | NULL | - | è·å¾—çš„å¥–å“ID |
| `prize_name` | VARCHAR(100) | NULL | - | å¥–å“åç§° |
| `prize_type` | ENUM | NULL | - | å¥–å“ç±»å‹ï¼špoints/product/coupon/special |
| `prize_value` | INTEGER | NULL | - | å¥–å“ä»·å€¼ï¼ˆç§¯åˆ†æ•°é‡æˆ–å•†å“ä»·å€¼ï¼‰ |
| `draw_type` | ENUM | NULL | - | æŠ½å¥–ç±»å‹ï¼šsingle/triple/five/ten |
| `draw_sequence` | INTEGER | NULL | - | åœ¨æ‰¹æ¬¡ä¸­çš„æŠ½å¥–åºå· |
| `is_pity` | BOOLEAN | NOT NULL | false | æ˜¯å¦è§¦å‘ä¿åº•æœºåˆ¶ |
| `cost_points` | INTEGER | NULL | - | æœ¬æ¬¡æŠ½å¥–æ¶ˆè€—çš„ç§¯åˆ† |
| `stop_angle` | DECIMAL(5,2) | NULL | - | è½¬ç›˜åœæ­¢è§’åº¦ï¼ˆè½¬ç›˜æŠ½å¥–ä½¿ç”¨ï¼‰ |
| `batch_id` | VARCHAR(50) | NULL | - | æ‰¹æ¬¡æŠ½å¥–çš„æ‰¹æ¬¡ID |
| `draw_count` | INTEGER | NULL | - | æœ¬æ¬¡æŠ½å¥–åŒ…å«çš„æ¬¡æ•°ï¼ˆè¿æŠ½ä½¿ç”¨ï¼‰ |
| `prize_description` | TEXT | NULL | - | å¥–å“è¯¦ç»†æè¿° |
| `prize_image` | VARCHAR(500) | NULL | - | å¥–å“å›¾ç‰‡URL |
| `is_winner` | BOOLEAN | NULL | false | **æ˜¯å¦ä¸­å¥–ï¼ˆæ ¸å¿ƒä¸šåŠ¡å­—æ®µï¼‰** |
| `guarantee_triggered` | BOOLEAN | NULL | false | æ˜¯å¦è§¦å‘äº†ä¿åº• |
| `remaining_guarantee` | INTEGER | NULL | - | æŠ½å¥–åå‰©ä½™çš„ä¿åº•æ¬¡æ•° |
| `draw_config` | JSON | NULL | - | æŠ½å¥–æ—¶çš„é…ç½®å‚æ•° |
| `result_metadata` | JSON | NULL | - | æŠ½å¥–ç»“æœçš„å…ƒæ•°æ® |
| `ip_address` | VARCHAR(45) | NULL | - | ç”¨æˆ·IPåœ°å€ |
| `user_agent` | TEXT | NULL | - | ç”¨æˆ·æµè§ˆå™¨ä¿¡æ¯ |
| `lottery_id` | CHAR(36) | NOT NULL | - | å…³è”çš„æŠ½å¥–æ´»åŠ¨ID |
| `created_at` | DATETIME | NOT NULL | NOW() | æŠ½å¥–æ—¶é—´ |
| `updated_at` | DATETIME | NOT NULL | NOW() | è®°å½•æ›´æ–°æ—¶é—´ |

#### æ ¸å¿ƒä¸šåŠ¡å­—æ®µè¯´æ˜

**`is_winner` å­—æ®µ** - æŠ½å¥–æˆåŠŸæ ‡å‡†ï¼š
- **true**: æœ¬æ¬¡æŠ½å¥–è·å¾—æœ‰ä»·å€¼å¥–å“ï¼ˆéç©ºå¥–ã€éè°¢è°¢å‚ä¸ï¼‰
- **false**: æœ¬æ¬¡æŠ½å¥–æœªä¸­å¥–æˆ–è·å¾—æ— ä»·å€¼å¥–åŠ±
- **ä¸šåŠ¡é€»è¾‘**: ä¸­å¥–åˆ¤æ–­æ ‡å‡†ä¸ºè·å¾—çš„å¥–å“å…·æœ‰å®é™…ä»·å€¼
- **ä½¿ç”¨åœºæ™¯**: ä¸­å¥–ç»Ÿè®¡ã€ä¸­å¥–ç‡è®¡ç®—ã€ä¿åº•æœºåˆ¶è§¦å‘ã€å¥–å“å‘æ”¾æµç¨‹

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `draw_id` | ä¸»é”®ç´¢å¼• |
| `idx_user_id` | æ™®é€š | `user_id` | ç”¨æˆ·IDç´¢å¼• |
| `idx_prize_id` | æ™®é€š | `prize_id` | å¥–å“IDç´¢å¼• |
| `idx_prize_type` | æ™®é€š | `prize_type` | å¥–å“ç±»å‹ç´¢å¼• |
| `idx_draw_type` | æ™®é€š | `draw_type` | æŠ½å¥–ç±»å‹ç´¢å¼• |
| `idx_is_pity` | æ™®é€š | `is_pity` | ä¿åº•ç´¢å¼• |
| `idx_batch_id` | æ™®é€š | `batch_id` | æ‰¹æ¬¡IDç´¢å¼• |
| `idx_created_at` | æ™®é€š | `created_at` | åˆ›å»ºæ—¶é—´ç´¢å¼• |
| `idx_user_created` | æ™®é€š | `user_id`, `created_at` | ç”¨æˆ·æ—¶é—´ç»„åˆç´¢å¼• |

#### ç»Ÿè®¡æ–¹æ³•

- **ç”¨æˆ·è®°å½•**: `getUserRecords()` - è·å–ç”¨æˆ·æŠ½å¥–è®°å½•
- **ç”¨æˆ·ç»Ÿè®¡**: `getUserLotteryStats()` - è·å–ç”¨æˆ·æŠ½å¥–ç»Ÿè®¡
- **åˆ›å»ºè®°å½•**: `createRecord()` - åˆ›å»ºæŠ½å¥–è®°å½•

#### å…³è”å…³ç³»

- **å±äº**: `User` (æŠ½å¥–ç”¨æˆ·)
- **å±äº**: `LotteryPrize` (ä¸­å¥–å¥–å“)
- **å±äº**: `LotteryCampaign` (æŠ½å¥–æ´»åŠ¨)
- **ä¸€å¯¹å¤š**: `PrizeDistribution` (å¥–å“åˆ†å‘è®°å½•)

### 3. lottery_prizes - å¥–å“é…ç½®è¡¨

**è¡¨å**: `lottery_prizes`  
**æ¨¡å‹**: `LotteryPrize`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†æŠ½å¥–æ´»åŠ¨ä¸­çš„å¥–å“é…ç½®ã€åº“å­˜å’Œä¸­å¥–æ¦‚ç‡

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `prize_id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | å¥–å“å”¯ä¸€æ ‡è¯† |
| `campaign_id` | INTEGER | NOT NULL | - | æ‰€å±æ´»åŠ¨ID |
| `prize_name` | VARCHAR(255) | NOT NULL | - | å¥–å“åç§° |
| `prize_type` | ENUM | NOT NULL | - | å¥–å“ç±»å‹ï¼špoints/physical/virtual/coupon/service |
| `prize_value` | DECIMAL(10,2) | NOT NULL | - | å¥–å“ä»·å€¼ |
| `win_probability` | DECIMAL(8,6) | NOT NULL | - | ä¸­å¥–æ¦‚ç‡ï¼ˆ0-1ä¹‹é—´ï¼‰ |
| `stock_quantity` | INTEGER | NULL | - | åº“å­˜æ•°é‡ï¼ˆNULLè¡¨ç¤ºæ— é™ï¼‰ |
| `max_daily_wins` | INTEGER | NULL | - | æ¯æ—¥æœ€å¤§ä¸­å¥–æ¬¡æ•° |
| `daily_win_count` | INTEGER | NOT NULL | 0 | å½“æ—¥ä¸­å¥–æ¬¡æ•° |
| `total_win_count` | INTEGER | NOT NULL | 0 | æ€»ä¸­å¥–æ¬¡æ•° |
| `description` | TEXT | NULL | - | å¥–å“æè¿° |
| `image_url` | VARCHAR(500) | NULL | - | å¥–å“å›¾ç‰‡URL |
| `image_id` | INTEGER | NULL | - | å…³è”å›¾ç‰‡èµ„æºID |
| `sort_order` | INTEGER | NOT NULL | 0 | æ˜¾ç¤ºæ’åº |
| `status` | ENUM | NOT NULL | 'active' | çŠ¶æ€ï¼šactive/inactive/out_of_stock/expired |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ä¸šåŠ¡æ–¹æ³•

- **å¯ç”¨æ€§æ£€æŸ¥**: `isAvailable()`, `isOutOfStock()`
- **æ¦‚ç‡è®¡ç®—**: `getWinProbabilityPercent()`
- **åº“å­˜ç®¡ç†**: `updateStock()`, `incrementWinCount()`
- **æ•°æ®éªŒè¯**: `validatePrize()`

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `prize_id` | ä¸»é”®ç´¢å¼• |
| `idx_campaign_active` | æ™®é€š | `campaign_id`, `status` | æ´»åŠ¨çŠ¶æ€ç»„åˆç´¢å¼• |
| `idx_prize_type` | æ™®é€š | `prize_type` | å¥–å“ç±»å‹ç´¢å¼• |
| `idx_sort_order` | æ™®é€š | `sort_order` | æ’åºç´¢å¼• |

#### å…³è”å…³ç³»

- **å±äº**: `LotteryCampaign` (æŠ½å¥–æ´»åŠ¨)
- **å±äº**: `ImageResources` (å›¾ç‰‡èµ„æº)
- **ä¸€å¯¹å¤š**: `LotteryRecord` (ä¸­å¥–è®°å½•)
- **ä¸€å¯¹å¤š**: `PrizeDistribution` (å¥–å“åˆ†å‘è®°å½•)

### 4. lottery_draws - æŠ½å¥–æ‰§è¡Œè®°å½•è¡¨

**è¡¨å**: `lottery_draws`  
**æ¨¡å‹**: `LotteryDraw`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•æŠ½å¥–çš„æ‰§è¡Œè¿‡ç¨‹å’Œç®—æ³•ç»†èŠ‚

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `draw_id` | VARCHAR(50) | PRIMARY KEY | - | æŠ½å¥–æ‰§è¡ŒID |
| `user_id` | INTEGER | NOT NULL | - | æ‰§è¡ŒæŠ½å¥–çš„ç”¨æˆ·ID |
| `campaign_id` | INTEGER | NOT NULL | - | æŠ½å¥–æ´»åŠ¨ID |
| `prize_id` | INTEGER | NULL | - | ä¸­å¥–å¥–å“ID |
| `algorithm_type` | ENUM | NOT NULL | - | ç®—æ³•ç±»å‹ï¼šrandom/weighted/guarantee |
| `draw_parameters` | JSON | NOT NULL | - | æŠ½å¥–å‚æ•°é…ç½® |
| `probability_data` | JSON | NULL | - | æ¦‚ç‡è®¡ç®—æ•°æ® |
| `execution_time_ms` | INTEGER | NOT NULL | - | æ‰§è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `status` | ENUM | NOT NULL | 'completed' | çŠ¶æ€ï¼špending/running/completed/failed |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### å…³è”å…³ç³»

- **å±äº**: `User` (æ‰§è¡Œç”¨æˆ·)
- **å±äº**: `LotteryCampaign` (æŠ½å¥–æ´»åŠ¨)
- **å±äº**: `LotteryPrize` (ä¸­å¥–å¥–å“)

### 5. prize_distributions - å¥–å“åˆ†å‘è®°å½•è¡¨

**è¡¨å**: `prize_distributions`  
**æ¨¡å‹**: `PrizeDistribution`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†å¥–å“çš„åˆ†å‘çŠ¶æ€å’Œæµç¨‹è·Ÿè¸ª

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `distribution_id` | VARCHAR(50) | PRIMARY KEY | - | åˆ†å‘è®°å½•ID |
| `draw_id` | VARCHAR(50) | NOT NULL | - | å…³è”æŠ½å¥–è®°å½•ID |
| `user_id` | INTEGER | NOT NULL | - | è·å¥–ç”¨æˆ·ID |
| `prize_id` | INTEGER | NOT NULL | - | å¥–å“ID |
| `prize_snapshot` | TEXT | NOT NULL | - | å¥–å“ä¿¡æ¯å¿«ç…§ï¼ˆJSONï¼‰ |
| `distribution_type` | ENUM | NOT NULL | 'auto' | åˆ†å‘ç±»å‹ï¼šauto/manual/batch |
| `distribution_status` | ENUM | NOT NULL | 'pending' | åˆ†å‘çŠ¶æ€ï¼špending/processing/distributed/failed/cancelled |
| `distribution_method` | ENUM | NOT NULL | - | åˆ†å‘æ–¹å¼ï¼špoints/inventory/voucher/manual |
| `verification_code` | VARCHAR(32) | NULL | - | å…‘æ¢éªŒè¯ç  |
| `distributed_at` | DATETIME | NULL | - | åˆ†å‘å®Œæˆæ—¶é—´ |
| `expires_at` | DATETIME | NULL | - | è¿‡æœŸæ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### å…³è”å…³ç³»

- **å±äº**: `LotteryRecord` (æŠ½å¥–è®°å½•)
- **å±äº**: `User` (è·å¥–ç”¨æˆ·)
- **å±äº**: `LotteryPrize` (å¥–å“)

### 6. lottery_pity - ä¿åº•æœºåˆ¶é…ç½®è¡¨

**è¡¨å**: `lottery_pity`  
**æ¨¡å‹**: `LotteryPity`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†æŠ½å¥–ä¿åº•æœºåˆ¶çš„é…ç½®å’ŒçŠ¶æ€

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `pity_id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | ä¿åº•é…ç½®ID |
| `campaign_id` | INTEGER | NOT NULL | - | å…³è”æ´»åŠ¨ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `pity_threshold` | INTEGER | NOT NULL | - | ä¿åº•è§¦å‘é˜ˆå€¼ |
| `current_count` | INTEGER | NOT NULL | 0 | å½“å‰æœªä¸­å¥–æ¬¡æ•° |
| `guaranteed_prize_id` | INTEGER | NULL | - | ä¿åº•å¥–å“ID |
| `is_triggered` | BOOLEAN | NOT NULL | false | æ˜¯å¦å·²è§¦å‘ä¿åº• |
| `triggered_at` | DATETIME | NULL | - | è§¦å‘æ—¶é—´ |
| `reset_at` | DATETIME | NULL | - | é‡ç½®æ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

---

## ğŸ’° ç§¯åˆ†ç³»ç»Ÿæ¨¡å—

### 1. user_points_accounts - ç”¨æˆ·ç§¯åˆ†è´¦æˆ·è¡¨

**è¡¨å**: `user_points_accounts`  
**æ¨¡å‹**: `UserPointsAccount`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç”¨æˆ·ç§¯åˆ†ä½™é¢ã€ç­‰çº§ã€è¡Œä¸ºè¯„åˆ†å’Œä¸ªæ€§åŒ–åå¥½

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `account_id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | è´¦æˆ·å”¯ä¸€æ ‡è¯† |
| `user_id` | INTEGER | NOT NULL, UNIQUE | - | å…³è”ç”¨æˆ·ID |
| `current_balance` | DECIMAL(15,2) | NOT NULL | 0.00 | å½“å‰ç§¯åˆ†ä½™é¢ |
| `total_earned` | DECIMAL(15,2) | NOT NULL | 0.00 | å†å²æ€»è·å¾—ç§¯åˆ† |
| `total_spent` | DECIMAL(15,2) | NOT NULL | 0.00 | å†å²æ€»æ¶ˆè´¹ç§¯åˆ† |
| `account_level` | ENUM | NOT NULL | 'bronze' | è´¦æˆ·ç­‰çº§ï¼šbronze/silver/gold/diamond |
| `behavior_score` | INTEGER | NOT NULL | 50 | è¡Œä¸ºè¯„åˆ†ï¼ˆ0-100ï¼‰ |
| `activity_level` | ENUM | NOT NULL | 'low' | æ´»è·ƒåº¦ï¼šlow/medium/high/premium |
| `preference_tags` | JSON | NULL | - | åå¥½æ ‡ç­¾ |
| `last_activity_time` | DATETIME | NULL | - | æœ€åæ´»åŠ¨æ—¶é—´ |
| `last_behavior_time` | DATETIME | NULL | - | æœ€åè¡Œä¸ºè®°å½•æ—¶é—´ |
| `is_active` | BOOLEAN | NOT NULL | true | è´¦æˆ·æ˜¯å¦æ´»è·ƒ |
| `freeze_reason` | VARCHAR(255) | NULL | - | å†»ç»“åŸå›  |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ä¸šåŠ¡æ–¹æ³•

- **ç­‰çº§ç®¡ç†**: `getLevelInfo()`, `getPointsToNextLevel()`, `checkForLevelUp()`
- **ç§¯åˆ†è®¡ç®—**: `calculatePointsBonus()`
- **è¡Œä¸ºè¯„åˆ†**: `updateBehaviorScore()`, `updateActivityLevel()`
- **å¥åº·æ£€æŸ¥**: `checkAccountHealth()`

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `account_id` | ä¸»é”®ç´¢å¼• |
| `user_id` | å”¯ä¸€ | `user_id` | ç”¨æˆ·IDå”¯ä¸€ç´¢å¼• |
| `idx_level_active` | æ™®é€š | `account_level`, `is_active` | ç­‰çº§æ´»è·ƒåº¦ç´¢å¼• |
| `idx_balance` | æ™®é€š | `current_balance` | ä½™é¢ç´¢å¼• |

#### å…³è”å…³ç³»

- **å±äº**: `User` (å…³è”ç”¨æˆ·)
- **ä¸€å¯¹å¤š**: `PointsTransaction` (ç§¯åˆ†äº¤æ˜“è®°å½•)

### 2. points_transactions - ç§¯åˆ†äº¤æ˜“è®°å½•è¡¨

**è¡¨å**: `points_transactions`  
**æ¨¡å‹**: `PointsTransaction`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•æ‰€æœ‰ç§¯åˆ†å˜åŠ¨çš„è¯¦ç»†å†å²

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `transaction_id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | äº¤æ˜“ID |
| `account_id` | BIGINT | NOT NULL | - | è´¦æˆ·ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `transaction_type` | ENUM | NOT NULL | - | äº¤æ˜“ç±»å‹ï¼šearn/spend/transfer/adjustment |
| `amount` | DECIMAL(15,2) | NOT NULL | - | å˜åŠ¨é‡‘é¢ï¼ˆæ­£æ•°ä¸ºæ”¶å…¥ï¼Œè´Ÿæ•°ä¸ºæ”¯å‡ºï¼‰ |
| `balance_before` | DECIMAL(15,2) | NOT NULL | - | äº¤æ˜“å‰ä½™é¢ |
| `balance_after` | DECIMAL(15,2) | NOT NULL | - | äº¤æ˜“åä½™é¢ |
| `source_type` | VARCHAR(50) | NOT NULL | - | æ¥æºç±»å‹ï¼šlottery/task/purchase/adminç­‰ |
| `source_id` | VARCHAR(50) | NULL | - | æ¥æºè®°å½•ID |
| `description` | VARCHAR(255) | NULL | - | äº¤æ˜“æè¿° |
| `metadata` | JSON | NULL | - | äº¤æ˜“å…ƒæ•°æ® |
| `status` | ENUM | NOT NULL | 'completed' | çŠ¶æ€ï¼špending/completed/failed/cancelled |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `transaction_id` | ä¸»é”®ç´¢å¼• |
| `idx_account_time` | æ™®é€š | `account_id`, `created_at` | è´¦æˆ·æ—¶é—´ç´¢å¼• |
| `idx_user_type` | æ™®é€š | `user_id`, `transaction_type` | ç”¨æˆ·ç±»å‹ç´¢å¼• |
| `idx_source` | æ™®é€š | `source_type`, `source_id` | æ¥æºç´¢å¼• |

### 3. trade_records - äº¤æ˜“è®°å½•è¡¨

**è¡¨å**: `trade_records`  
**æ¨¡å‹**: `TradeRecord`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç”¨æˆ·çš„å„ç±»äº¤æ˜“è¡Œä¸ºå’Œç»“æœ

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `trade_id` | VARCHAR(50) | PRIMARY KEY | - | äº¤æ˜“å”¯ä¸€æ ‡è¯† |
| `user_id` | INTEGER | NOT NULL | - | äº¤æ˜“ç”¨æˆ·ID |
| `trade_type` | ENUM | NOT NULL | - | äº¤æ˜“ç±»å‹ï¼šlottery/exchange/reward/penalty |
| `amount` | DECIMAL(15,2) | NOT NULL | - | äº¤æ˜“é‡‘é¢ |
| `currency_type` | ENUM | NOT NULL | 'points' | è´§å¸ç±»å‹ï¼špoints/virtual_currency |
| `related_id` | VARCHAR(50) | NULL | - | å…³è”ä¸šåŠ¡ID |
| `trade_status` | ENUM | NOT NULL | 'pending' | äº¤æ˜“çŠ¶æ€ï¼špending/completed/failed/cancelled |
| `is_successful` | BOOLEAN | NOT NULL | false | **äº¤æ˜“æ˜¯å¦æˆåŠŸï¼ˆæ ¸å¿ƒä¸šåŠ¡å­—æ®µï¼‰** |
| `description` | VARCHAR(255) | NULL | - | äº¤æ˜“æè¿° |
| `metadata` | JSON | NULL | - | äº¤æ˜“å…ƒæ•°æ® |
| `processed_at` | DATETIME | NULL | - | å¤„ç†å®Œæˆæ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `trade_id` | ä¸»é”®ç´¢å¼• |
| `idx_user_type` | æ™®é€š | `user_id`, `trade_type` | ç”¨æˆ·äº¤æ˜“ç±»å‹ç´¢å¼• |
| `idx_status_success` | æ™®é€š | `trade_status`, `is_successful` | çŠ¶æ€æˆåŠŸç´¢å¼• |

---

## ğŸ“¦ ä¸šåŠ¡åŠŸèƒ½æ¨¡å—

### 1. user_inventory - ç”¨æˆ·åº“å­˜è¡¨

**è¡¨å**: `user_inventory`  
**æ¨¡å‹**: `UserInventory`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç”¨æˆ·è·å¾—çš„å¥–å“ã€å•†å“å’Œä¼˜æƒ åˆ¸

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | VARCHAR(32) | PRIMARY KEY | - | åº“å­˜ç‰©å“å”¯ä¸€æ ‡è¯† |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `name` | VARCHAR(100) | NOT NULL | - | ç‰©å“åç§° |
| `description` | TEXT | NULL | - | ç‰©å“æè¿° |
| `type` | ENUM | NOT NULL | - | ç‰©å“ç±»å‹ï¼švoucher/product/service |
| `value` | INTEGER | NOT NULL | 0 | ç‰©å“ä»·å€¼ï¼ˆç§¯åˆ†ç­‰ä»·å€¼ï¼‰ |
| `status` | ENUM | NOT NULL | 'available' | çŠ¶æ€ï¼šavailable/pending/used/expired/transferred |
| `source_type` | VARCHAR(50) | NOT NULL | - | è·å¾—æ¥æºç±»å‹ |
| `source_id` | VARCHAR(32) | NULL | - | æ¥æºè®°å½•ID |
| `acquired_at` | DATETIME | NOT NULL | NOW() | è·å¾—æ—¶é—´ |
| `expires_at` | DATETIME | NULL | - | è¿‡æœŸæ—¶é—´ |
| `used_at` | DATETIME | NULL | - | ä½¿ç”¨æ—¶é—´ |
| `verification_code` | VARCHAR(32) | NULL | - | æ ¸é”€ç  |
| `transfer_info` | JSON | NULL | - | è½¬è®©ä¿¡æ¯ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_user_status` | æ™®é€š | `user_id`, `status` | ç”¨æˆ·çŠ¶æ€ç´¢å¼• |
| `idx_verification` | æ™®é€š | `verification_code` | æ ¸é”€ç ç´¢å¼• |
| `idx_expires` | æ™®é€š | `expires_at` | è¿‡æœŸæ—¶é—´ç´¢å¼• |

#### å…³è”å…³ç³»

- **å±äº**: `User` (ç‰©å“æ‹¥æœ‰è€…)

### 2. products - å•†å“ç®¡ç†è¡¨

**è¡¨å**: `products`  
**æ¨¡å‹**: `Product`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç³»ç»Ÿä¸­çš„å•†å“ä¿¡æ¯å’Œå…‘æ¢é…ç½®

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `product_id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | å•†å“ID |
| `name` | VARCHAR(255) | NOT NULL | - | å•†å“åç§° |
| `description` | TEXT | NULL | - | å•†å“æè¿° |
| `category` | VARCHAR(100) | NOT NULL | - | å•†å“åˆ†ç±» |
| `points_required` | INTEGER | NOT NULL | - | å…‘æ¢æ‰€éœ€ç§¯åˆ† |
| `stock_quantity` | INTEGER | NULL | - | åº“å­˜æ•°é‡ |
| `image_url` | VARCHAR(500) | NULL | - | å•†å“å›¾ç‰‡ |
| `status` | ENUM | NOT NULL | 'active' | çŠ¶æ€ï¼šactive/inactive/out_of_stock |
| `sort_order` | INTEGER | NOT NULL | 0 | æ’åºæƒé‡ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `product_id` | ä¸»é”®ç´¢å¼• |
| `idx_category_status` | æ™®é€š | `category`, `status` | åˆ†ç±»çŠ¶æ€ç´¢å¼• |
| `idx_points` | æ™®é€š | `points_required` | ç§¯åˆ†éœ€æ±‚ç´¢å¼• |

### 3. exchange_records - å…‘æ¢è®°å½•è¡¨

**è¡¨å**: `exchange_records`  
**æ¨¡å‹**: `ExchangeRecords`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç”¨æˆ·ä½¿ç”¨ç§¯åˆ†å…‘æ¢å•†å“çš„è¯¦ç»†ä¿¡æ¯

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | å…‘æ¢è®°å½•ID |
| `exchange_id` | VARCHAR(50) | NOT NULL, UNIQUE | - | å…‘æ¢è®°å½•ä¸šåŠ¡ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `product_id` | INTEGER | NOT NULL | - | å•†å“ID |
| `product_snapshot` | JSON | NOT NULL | - | å•†å“ä¿¡æ¯å¿«ç…§ |
| `quantity` | INTEGER | NOT NULL | 1 | å…‘æ¢æ•°é‡ |
| `total_points` | INTEGER | NOT NULL | - | æ€»æ¶ˆè€—ç§¯åˆ† |
| `exchange_code` | VARCHAR(50) | NOT NULL, UNIQUE | - | å…‘æ¢ç  |
| `status` | ENUM | NOT NULL | 'distributed' | çŠ¶æ€ï¼špending/distributed/used/expired/cancelled |
| `is_successful` | BOOLEAN | NOT NULL | false | **å…‘æ¢æ˜¯å¦æˆåŠŸï¼ˆæ ¸å¿ƒä¸šåŠ¡å­—æ®µï¼‰** |
| `used_at` | DATETIME | NULL | - | ä½¿ç”¨æ—¶é—´ |
| `expires_at` | DATETIME | NULL | - | è¿‡æœŸæ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `exchange_id` | å”¯ä¸€ | `exchange_id` | ä¸šåŠ¡IDå”¯ä¸€ç´¢å¼• |
| `exchange_code` | å”¯ä¸€ | `exchange_code` | å…‘æ¢ç å”¯ä¸€ç´¢å¼• |
| `idx_user_status` | æ™®é€š | `user_id`, `status` | ç”¨æˆ·çŠ¶æ€ç´¢å¼• |

### 4. business_events - ä¸šåŠ¡äº‹ä»¶è¡¨

**è¡¨å**: `business_events`  
**æ¨¡å‹**: `BusinessEvent`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç³»ç»Ÿä¸­çš„é‡è¦ä¸šåŠ¡äº‹ä»¶å’Œæ“ä½œ

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `event_id` | VARCHAR(50) | PRIMARY KEY | - | äº‹ä»¶å”¯ä¸€æ ‡è¯† |
| `event_type` | VARCHAR(100) | NOT NULL | - | äº‹ä»¶ç±»å‹ |
| `user_id` | INTEGER | NULL | - | å…³è”ç”¨æˆ·ID |
| `entity_type` | VARCHAR(50) | NULL | - | å®ä½“ç±»å‹ |
| `entity_id` | VARCHAR(50) | NULL | - | å®ä½“ID |
| `event_data` | JSON | NULL | - | äº‹ä»¶æ•°æ® |
| `severity` | ENUM | NOT NULL | 'info' | ä¸¥é‡ç¨‹åº¦ï¼šdebug/info/warning/error/critical |
| `status` | ENUM | NOT NULL | 'active' | çŠ¶æ€ï¼šactive/archived/deleted |
| `created_at` | TIMESTAMP | NOT NULL | - | äº‹ä»¶å‘ç”Ÿæ—¶é—´ |

### 5. image_resources - å›¾ç‰‡èµ„æºè¡¨

**è¡¨å**: `image_resources`  
**æ¨¡å‹**: `ImageResources`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç³»ç»Ÿä¸­ä½¿ç”¨çš„å›¾ç‰‡èµ„æº

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `image_id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | å›¾ç‰‡èµ„æºID |
| `original_name` | VARCHAR(255) | NOT NULL | - | åŸå§‹æ–‡ä»¶å |
| `stored_name` | VARCHAR(255) | NOT NULL | - | å­˜å‚¨æ–‡ä»¶å |
| `file_path` | VARCHAR(500) | NOT NULL | - | æ–‡ä»¶è·¯å¾„ |
| `file_size` | INTEGER | NOT NULL | - | æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `mime_type` | VARCHAR(100) | NOT NULL | - | MIMEç±»å‹ |
| `width` | INTEGER | NULL | - | å›¾ç‰‡å®½åº¦ |
| `height` | INTEGER | NULL | - | å›¾ç‰‡é«˜åº¦ |
| `upload_user_id` | INTEGER | NULL | - | ä¸Šä¼ ç”¨æˆ·ID |
| `usage_type` | ENUM | NOT NULL | 'general' | ç”¨é€”ç±»å‹ï¼šgeneral/avatar/prize/product/banner |
| `status` | ENUM | NOT NULL | 'active' | çŠ¶æ€ï¼šactive/deleted/processing |
| `created_at` | TIMESTAMP | NOT NULL | - | ä¸Šä¼ æ—¶é—´ |

### 6. upload_review - å›¾ç‰‡ä¸Šä¼ å®¡æ ¸è¡¨

**è¡¨å**: `upload_review`  
**æ¨¡å‹**: `UploadReview`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç”¨æˆ·ä¸Šä¼ å›¾ç‰‡çš„å®¡æ ¸æµç¨‹å’ŒçŠ¶æ€

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | å®¡æ ¸è®°å½•å”¯ä¸€ID |
| `user_id` | INTEGER | NOT NULL | - | ä¸Šä¼ ç”¨æˆ·ID |
| `image_id` | INTEGER | NOT NULL | - | å›¾ç‰‡èµ„æºID |
| `review_status` | ENUM | NOT NULL | 'pending' | å®¡æ ¸çŠ¶æ€ï¼špending/approved/rejected/reviewing |
| `reviewer_id` | INTEGER | NULL | - | å®¡æ ¸å‘˜ç”¨æˆ·ID |
| `review_time` | DATETIME | NULL | - | å®¡æ ¸æ—¶é—´ |
| `review_notes` | TEXT | NULL | - | å®¡æ ¸å¤‡æ³¨ |
| `image_url` | VARCHAR(500) | NOT NULL | - | å›¾ç‰‡URL |
| `image_type` | ENUM | NOT NULL | 'photo' | å›¾ç‰‡ç±»å‹ï¼šphoto/document/other |
| `file_size` | INTEGER | NULL | - | æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `file_hash` | VARCHAR(64) | NULL | - | æ–‡ä»¶å“ˆå¸Œå€¼ï¼ˆé˜²é‡å¤ï¼‰ |
| `points_awarded` | INTEGER | NOT NULL | 0 | å¥–åŠ±ç§¯åˆ† |
| `reject_reason` | ENUM | NULL | - | æ‹’ç»åŸå› ï¼šinappropriate/duplicate/quality/spam/other |
| `auto_review` | BOOLEAN | NOT NULL | false | æ˜¯å¦è‡ªåŠ¨å®¡æ ¸ |
| `client_info` | VARCHAR(200) | NULL | - | å®¢æˆ·ç«¯ä¿¡æ¯ |
| `metadata` | JSON | NULL | - | å®¡æ ¸å…ƒæ•°æ® |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_user_status` | æ™®é€š | `user_id`, `review_status` | ç”¨æˆ·çŠ¶æ€ç´¢å¼• |
| `idx_reviewer` | æ™®é€š | `reviewer_id` | å®¡æ ¸å‘˜ç´¢å¼• |
| `idx_review_time` | æ™®é€š | `review_time` | å®¡æ ¸æ—¶é—´ç´¢å¼• |
| `idx_file_hash` | æ™®é€š | `file_hash` | æ–‡ä»¶å“ˆå¸Œç´¢å¼• |

#### å…³è”å…³ç³»

- **å±äº**: `User` (ä¸Šä¼ ç”¨æˆ·)
- **å±äº**: `ImageResources` (å›¾ç‰‡èµ„æº)
- **å±äº**: `AdminUser` (å®¡æ ¸å‘˜)

### 7. business_configs - ä¸šåŠ¡é…ç½®è¡¨

**è¡¨å**: `business_configs`  
**æ¨¡å‹**: `BusinessConfigs`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç³»ç»Ÿå„ä¸šåŠ¡æ¨¡å—çš„é…ç½®å‚æ•°

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | é…ç½®ID |
| `business_type` | ENUM | NOT NULL, UNIQUE | - | ä¸šåŠ¡ç±»å‹ï¼šlottery/exchange/trade/uploads |
| `storage_policy` | JSON | NOT NULL | å­˜å‚¨ç­–ç•¥é»˜è®¤å€¼ | å­˜å‚¨ç­–ç•¥é…ç½® |
| `file_rules` | JSON | NOT NULL | æ–‡ä»¶è§„åˆ™é»˜è®¤å€¼ | æ–‡ä»¶è§„åˆ™é…ç½® |
| `cache_config` | JSON | NULL | - | ç¼“å­˜é…ç½® |
| `extended_config` | JSON | NULL | - | æ‰©å±•é…ç½® |
| `status` | ENUM | NOT NULL | 'active' | é…ç½®çŠ¶æ€ï¼šactive/inactive |
| `created_at` | TIMESTAMP | NOT NULL | NOW() | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | NOW() | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_business_type` | å”¯ä¸€ | `business_type` | ä¸šåŠ¡ç±»å‹å”¯ä¸€ç´¢å¼• |
| `idx_status` | æ™®é€š | `status` | çŠ¶æ€ç´¢å¼• |

#### ä¸šåŠ¡é…ç½®è¯´æ˜

- **å­˜å‚¨ç­–ç•¥**: çƒ­æ•°æ®30å¤©ï¼Œæ ‡å‡†æ•°æ®365å¤©ï¼Œå½’æ¡£æ•°æ®1095å¤©
- **æ–‡ä»¶è§„åˆ™**: æœ€å¤§10MBï¼Œæ”¯æŒjpg/jpeg/png/webpæ ¼å¼
- **ç¼“å­˜é…ç½®**: TTL 5åˆ†é’Ÿï¼Œæœ€å¤§1000æ¡è®°å½•
- **æ‰©å±•é…ç½®**: ä¸šåŠ¡ç‰¹å®šçš„å…¶ä»–é…ç½®å‚æ•°

---

## ğŸ’¬ å®¢æœèŠå¤©æ¨¡å—

### 1. customer_sessions - å®¢æœä¼šè¯è¡¨

**è¡¨å**: `customer_sessions`  
**æ¨¡å‹**: `CustomerSession`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç”¨æˆ·ä¸å®¢æœçš„ä¼šè¯çŠ¶æ€

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `session_id` | VARCHAR(50) | PRIMARY KEY | - | ä¼šè¯å”¯ä¸€æ ‡è¯† |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `admin_id` | INTEGER | NULL | - | å¤„ç†çš„ç®¡ç†å‘˜ID |
| `status` | ENUM | NOT NULL | 'pending' | ä¼šè¯çŠ¶æ€ï¼špending/active/resolved/closed |
| `priority` | ENUM | NOT NULL | 'normal' | ä¼˜å…ˆçº§ï¼šlow/normal/high/urgent |
| `subject` | VARCHAR(255) | NULL | - | ä¼šè¯ä¸»é¢˜ |
| `initial_message` | TEXT | NULL | - | åˆå§‹æ¶ˆæ¯ |
| `resolution_notes` | TEXT | NULL | - | è§£å†³æ–¹æ¡ˆå¤‡æ³¨ |
| `satisfaction_rating` | INTEGER | NULL | - | æ»¡æ„åº¦è¯„åˆ†ï¼ˆ1-5ï¼‰ |
| `started_at` | DATETIME | NOT NULL | NOW() | ä¼šè¯å¼€å§‹æ—¶é—´ |
| `ended_at` | DATETIME | NULL | - | ä¼šè¯ç»“æŸæ—¶é—´ |
| `last_activity_at` | DATETIME | NOT NULL | NOW() | æœ€åæ´»åŠ¨æ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `session_id` | ä¸»é”®ç´¢å¼• |
| `idx_user_status` | æ™®é€š | `user_id`, `status` | ç”¨æˆ·çŠ¶æ€ç´¢å¼• |
| `idx_admin_active` | æ™®é€š | `admin_id`, `status` | ç®¡ç†å‘˜çŠ¶æ€ç´¢å¼• |
| `idx_priority_time` | æ™®é€š | `priority`, `started_at` | ä¼˜å…ˆçº§æ—¶é—´ç´¢å¼• |

### 2. chat_messages - èŠå¤©æ¶ˆæ¯è¡¨

**è¡¨å**: `chat_messages`  
**æ¨¡å‹**: `ChatMessage`  
**ä¸»è¦åŠŸèƒ½**: å­˜å‚¨èŠå¤©ä¼šè¯ä¸­çš„æ‰€æœ‰æ¶ˆæ¯

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `message_id` | VARCHAR(50) | PRIMARY KEY | - | æ¶ˆæ¯å”¯ä¸€æ ‡è¯† |
| `session_id` | VARCHAR(50) | NOT NULL | - | æ‰€å±ä¼šè¯ID |
| `sender_id` | INTEGER | NOT NULL | - | å‘é€è€…ID |
| `sender_type` | ENUM | NOT NULL | - | å‘é€è€…ç±»å‹ï¼šuser/admin/system |
| `message_type` | ENUM | NOT NULL | 'text' | æ¶ˆæ¯ç±»å‹ï¼štext/image/file/system |
| `content` | TEXT | NOT NULL | - | æ¶ˆæ¯å†…å®¹ |
| `attachments` | JSON | NULL | - | é™„ä»¶ä¿¡æ¯ |
| `metadata` | JSON | NULL | - | æ¶ˆæ¯å…ƒæ•°æ® |
| `is_read` | BOOLEAN | NOT NULL | false | æ˜¯å¦å·²è¯» |
| `read_at` | DATETIME | NULL | - | å·²è¯»æ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | å‘é€æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `message_id` | ä¸»é”®ç´¢å¼• |
| `idx_session_time` | æ™®é€š | `session_id`, `created_at` | ä¼šè¯æ—¶é—´ç´¢å¼• |
| `idx_sender` | æ™®é€š | `sender_id`, `sender_type` | å‘é€è€…ç´¢å¼• |

### 3. quick_replies - å¿«é€Ÿå›å¤æ¨¡æ¿è¡¨

**è¡¨å**: `quick_replies`  
**æ¨¡å‹**: `QuickReply`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†å®¢æœå¿«é€Ÿå›å¤æ¨¡æ¿

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | æ¨¡æ¿ID |
| `admin_id` | INTEGER | NULL | - | ç®¡ç†å‘˜ID(NULLè¡¨ç¤ºå…¬å…±æ¨¡æ¿) |
| `title` | VARCHAR(100) | NOT NULL | - | æ¨¡æ¿æ ‡é¢˜ |
| `content` | TEXT | NOT NULL | - | å›å¤å†…å®¹ |
| `category` | VARCHAR(50) | NULL | - | åˆ†ç±» |
| `usage_count` | INTEGER | NOT NULL | 0 | ä½¿ç”¨æ¬¡æ•° |
| `is_active` | BOOLEAN | NOT NULL | true | æ˜¯å¦å¯ç”¨ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_admin_id` | æ™®é€š | `admin_id` | ç®¡ç†å‘˜ç´¢å¼• |
| `idx_category` | æ™®é€š | `category` | åˆ†ç±»ç´¢å¼• |
| `idx_is_active` | æ™®é€š | `is_active` | å¯ç”¨çŠ¶æ€ç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **æƒé™æ£€æŸ¥**: `isPublic()`, `belongsToAdmin()`
- **ä½¿ç”¨ç»Ÿè®¡**: `incrementUsage()`
- **çŠ¶æ€ç®¡ç†**: `toggleActive()`

#### å…³è”å…³ç³»

- **å±äº**: `AdminUser` (æ¨¡æ¿åˆ›å»ºè€…)

### 4. admin_status - ç®¡ç†å‘˜çŠ¶æ€è¡¨

**è¡¨å**: `admin_status`  
**æ¨¡å‹**: `AdminStatus`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†å®¢æœç®¡ç†å‘˜çš„åœ¨çº¿çŠ¶æ€å’Œä¼šè¯è´Ÿè½½

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | çŠ¶æ€è®°å½•ID |
| `admin_id` | INTEGER | NOT NULL, UNIQUE | - | ç®¡ç†å‘˜ID |
| `status` | ENUM | NOT NULL | 'offline' | çŠ¶æ€ï¼šonline/busy/offline |
| `current_sessions` | INTEGER | NOT NULL | 0 | å½“å‰å¤„ç†ä¼šè¯æ•° |
| `max_sessions` | INTEGER | NOT NULL | 9999999 | æœ€å¤§å¤„ç†ä¼šè¯æ•° |
| `last_active_at` | DATETIME | NOT NULL | NOW() | æœ€åæ´»è·ƒæ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_admin_id` | å”¯ä¸€ | `admin_id` | ç®¡ç†å‘˜IDå”¯ä¸€ç´¢å¼• |
| `idx_status` | æ™®é€š | `status` | çŠ¶æ€ç´¢å¼• |
| `idx_last_active_at` | æ™®é€š | `last_active_at` | æœ€åæ´»è·ƒæ—¶é—´ç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **çŠ¶æ€æ£€æŸ¥**: `isOnline()`, `isBusy()`, `isAvailable()`
- **ä¼šè¯ç®¡ç†**: `canTakeNewSession()`
- **æ´»è·ƒåº¦æ›´æ–°**: `updateActivity()`

#### å…³è”å…³ç³»

- **å±äº**: `AdminUser` (ç®¡ç†å‘˜)

---

## ğŸ“‹ ä»»åŠ¡ç³»ç»Ÿæ¨¡å—

### 1. user_tasks - ç”¨æˆ·ä»»åŠ¡è¡¨

**è¡¨å**: `user_tasks`  
**æ¨¡å‹**: `UserTask`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç”¨æˆ·çš„ä»»åŠ¡è¿›åº¦å’Œå®ŒæˆçŠ¶æ€

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `task_id` | VARCHAR(50) | PRIMARY KEY | - | ä»»åŠ¡å®ä¾‹ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `template_id` | VARCHAR(50) | NOT NULL | - | ä»»åŠ¡æ¨¡æ¿ID |
| `task_name` | VARCHAR(255) | NOT NULL | - | ä»»åŠ¡åç§° |
| `task_type` | ENUM | NOT NULL | - | ä»»åŠ¡ç±»å‹ï¼šdaily/weekly/achievement/special |
| `description` | TEXT | NULL | - | ä»»åŠ¡æè¿° |
| `target_value` | INTEGER | NOT NULL | - | ç›®æ ‡å€¼ |
| `current_progress` | INTEGER | NOT NULL | 0 | å½“å‰è¿›åº¦ |
| `status` | ENUM | NOT NULL | 'active' | çŠ¶æ€ï¼šactive/completed/expired/cancelled |
| `reward_points` | INTEGER | NOT NULL | 0 | å¥–åŠ±ç§¯åˆ† |
| `reward_items` | JSON | NULL | - | å¥–åŠ±ç‰©å“ |
| `started_at` | DATETIME | NOT NULL | NOW() | å¼€å§‹æ—¶é—´ |
| `expires_at` | DATETIME | NULL | - | è¿‡æœŸæ—¶é—´ |
| `completed_at` | DATETIME | NULL | - | å®Œæˆæ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `task_id` | ä¸»é”®ç´¢å¼• |
| `idx_user_status` | æ™®é€š | `user_id`, `status` | ç”¨æˆ·çŠ¶æ€ç´¢å¼• |
| `idx_template_type` | æ™®é€š | `template_id`, `task_type` | æ¨¡æ¿ç±»å‹ç´¢å¼• |
| `idx_expires` | æ™®é€š | `expires_at` | è¿‡æœŸæ—¶é—´ç´¢å¼• |

### 2. task_templates - ä»»åŠ¡æ¨¡æ¿è¡¨

**è¡¨å**: `task_templates`  
**æ¨¡å‹**: `TaskTemplate`  
**ä¸»è¦åŠŸèƒ½**: å®šä¹‰ä»»åŠ¡çš„æ¨¡æ¿é…ç½®å’Œè§„åˆ™

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `template_id` | VARCHAR(50) | PRIMARY KEY | - | ä»»åŠ¡æ¨¡æ¿ID |
| `template_name` | VARCHAR(255) | NOT NULL | - | æ¨¡æ¿åç§° |
| `task_type` | ENUM | NOT NULL | - | ä»»åŠ¡ç±»å‹ï¼šdaily/weekly/achievement/special |
| `description` | TEXT | NULL | - | ä»»åŠ¡æè¿° |
| `target_value` | INTEGER | NOT NULL | - | ç›®æ ‡å€¼ |
| `reward_points` | INTEGER | NOT NULL | 0 | å¥–åŠ±ç§¯åˆ† |
| `reward_items` | JSON | NULL | - | å¥–åŠ±ç‰©å“é…ç½® |
| `conditions` | JSON | NULL | - | å®Œæˆæ¡ä»¶é…ç½® |
| `duration_days` | INTEGER | NULL | - | ä»»åŠ¡æŒç»­å¤©æ•° |
| `is_repeatable` | BOOLEAN | NOT NULL | false | æ˜¯å¦å¯é‡å¤ |
| `is_active` | BOOLEAN | NOT NULL | true | æ˜¯å¦æ¿€æ´» |
| `sort_order` | INTEGER | NOT NULL | 0 | æ’åºæƒé‡ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

### 3. scheduled_tasks - å®šæ—¶ä»»åŠ¡è¡¨

**è¡¨å**: `scheduled_tasks`  
**æ¨¡å‹**: `ScheduledTask`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†ç³»ç»Ÿçš„å®šæ—¶ä»»åŠ¡é…ç½®å’Œæ‰§è¡ŒçŠ¶æ€

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `task_id` | VARCHAR(50) | PRIMARY KEY | - | å®šæ—¶ä»»åŠ¡ID |
| `task_name` | VARCHAR(255) | NOT NULL | - | ä»»åŠ¡åç§° |
| `task_type` | ENUM | NOT NULL | - | ä»»åŠ¡ç±»å‹ï¼šcron/interval/once |
| `schedule_expression` | VARCHAR(100) | NOT NULL | - | è°ƒåº¦è¡¨è¾¾å¼ |
| `handler_name` | VARCHAR(255) | NOT NULL | - | å¤„ç†å™¨åç§° |
| `parameters` | JSON | NULL | - | ä»»åŠ¡å‚æ•° |
| `status` | ENUM | NOT NULL | 'active' | çŠ¶æ€ï¼šactive/paused/disabled |
| `last_execution` | DATETIME | NULL | - | æœ€åæ‰§è¡Œæ—¶é—´ |
| `next_execution` | DATETIME | NULL | - | ä¸‹æ¬¡æ‰§è¡Œæ—¶é—´ |
| `execution_count` | INTEGER | NOT NULL | 0 | æ‰§è¡Œæ¬¡æ•° |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

---

## ğŸ”§ ç³»ç»Ÿç®¡ç†æ¨¡å—

### 1. login_logs - ç™»å½•æ—¥å¿—è¡¨

**è¡¨å**: `login_logs`  
**æ¨¡å‹**: `LoginLog`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç”¨æˆ·å’Œç®¡ç†å‘˜çš„ç™»å½•å†å²

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `log_id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | æ—¥å¿—ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `user_type` | ENUM | NOT NULL | 'user' | ç”¨æˆ·ç±»å‹ï¼šuser/admin |
| `login_type` | ENUM | NOT NULL | 'mobile' | ç™»å½•æ–¹å¼ï¼šmobile/password/sms |
| `ip_address` | VARCHAR(45) | NULL | - | ç™»å½•IP |
| `user_agent` | TEXT | NULL | - | ç”¨æˆ·ä»£ç† |
| `login_status` | ENUM | NOT NULL | 'success' | ç™»å½•çŠ¶æ€ï¼šsuccess/failed/blocked |
| `failure_reason` | VARCHAR(255) | NULL | - | å¤±è´¥åŸå›  |
| `session_id` | VARCHAR(128) | NULL | - | ä¼šè¯ID |
| `login_time` | DATETIME | NOT NULL | NOW() | ç™»å½•æ—¶é—´ |
| `logout_time` | DATETIME | NULL | - | ç™»å‡ºæ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | è®°å½•åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `log_id` | ä¸»é”®ç´¢å¼• |
| `idx_user_time` | æ™®é€š | `user_id`, `login_time` | ç”¨æˆ·æ—¶é—´ç´¢å¼• |
| `idx_ip_status` | æ™®é€š | `ip_address`, `login_status` | IPçŠ¶æ€ç´¢å¼• |
| `idx_session` | æ™®é€š | `session_id` | ä¼šè¯ç´¢å¼• |

### 2. user_specific_prize_queues - ç”¨æˆ·ä¸“å±å¥–å“é˜Ÿåˆ—è¡¨

**è¡¨å**: `user_specific_prize_queues`  
**æ¨¡å‹**: `UserSpecificPrizeQueue`  
**ä¸»è¦åŠŸèƒ½**: æ”¯æŒç®¡ç†å‘˜ä¸ºç‰¹å®šç”¨æˆ·è®¾ç½®é¢„å®šä¹‰çš„å¥–å“åºåˆ—

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `queue_id` | VARCHAR(50) | PRIMARY KEY | è‡ªåŠ¨ç”Ÿæˆ | é˜Ÿåˆ—è®°å½•å”¯ä¸€ID |
| `user_id` | INTEGER | NOT NULL | - | ç›®æ ‡ç”¨æˆ·ID |
| `campaign_id` | INTEGER | NOT NULL | - | å…³è”çš„æŠ½å¥–æ´»åŠ¨ID |
| `prize_id` | INTEGER | NOT NULL | - | é¢„è®¾å¥–å“ID |
| `prize_number` | INTEGER | NOT NULL | - | å¥–å“ç¼–å·ï¼ˆ1-10å·ï¼‰ |
| `queue_order` | INTEGER | NOT NULL | - | åœ¨ç”¨æˆ·é˜Ÿåˆ—ä¸­çš„é¡ºåº |
| `status` | ENUM | NOT NULL | 'pending' | é˜Ÿåˆ—çŠ¶æ€ï¼špending/distributed/expired/cancelled |
| `distributed_at` | DATETIME | NULL | - | å®é™…åˆ†å‘æ—¶é—´ |
| `admin_id` | INTEGER | NOT NULL | - | åˆ›å»ºç®¡ç†å‘˜ID |
| `admin_notes` | TEXT | NULL | - | ç®¡ç†å‘˜å¤‡æ³¨ |
| `priority_level` | INTEGER | NOT NULL | 1 | ä¼˜å…ˆçº§ç­‰çº§ï¼ˆ1-10ï¼‰ |
| `expires_at` | DATETIME | NULL | - | è¿‡æœŸæ—¶é—´ |
| `metadata` | JSON | NULL | - | é˜Ÿåˆ—å…ƒæ•°æ® |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `queue_id` | ä¸»é”®ç´¢å¼• |
| `idx_user_order` | æ™®é€š | `user_id`, `queue_order` | ç”¨æˆ·é˜Ÿåˆ—é¡ºåºç´¢å¼• |
| `idx_campaign_status` | æ™®é€š | `campaign_id`, `status` | æ´»åŠ¨çŠ¶æ€ç´¢å¼• |
| `idx_admin_created` | æ™®é€š | `admin_id`, `created_at` | ç®¡ç†å‘˜åˆ›å»ºæ—¶é—´ç´¢å¼• |
| `idx_expires_at` | æ™®é€š | `expires_at` | è¿‡æœŸæ—¶é—´ç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **é˜Ÿåˆ—ç®¡ç†**: `getNextInQueue()`, `markAsDistributed()`
- **çŠ¶æ€æ£€æŸ¥**: `isExpired()`, `isPending()`
- **ä¼˜å…ˆçº§ç®¡ç†**: `updatePriority()`

#### å…³è”å…³ç³»

- **å±äº**: `User` (ç›®æ ‡ç”¨æˆ·)
- **å±äº**: `LotteryCampaign` (æŠ½å¥–æ´»åŠ¨)
- **å±äº**: `LotteryPrize` (é¢„è®¾å¥–å“)
- **å±äº**: `AdminUser` (åˆ›å»ºç®¡ç†å‘˜)

### 3. user_pool_access - ç”¨æˆ·æ± è®¿é—®è®°å½•è¡¨

**è¡¨å**: `user_pool_access`  
**æ¨¡å‹**: `UserPoolAccess`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç”¨æˆ·å¯¹å¥–å“æ± çš„è®¿é—®å’Œä½¿ç”¨æƒ…å†µ

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | è®¿é—®è®°å½•ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `pool_id` | VARCHAR(50) | NOT NULL | - | æ± ID |
| `access_date` | DATE | NOT NULL | - | è®¿é—®æ—¥æœŸ |
| `daily_draws` | INTEGER | NOT NULL | 0 | å½“æ—¥æŠ½å–æ¬¡æ•° |
| `total_draws` | INTEGER | NOT NULL | 0 | æ€»æŠ½å–æ¬¡æ•° |
| `total_spent` | INTEGER | NOT NULL | 0 | æ€»æ¶ˆè€—ç§¯åˆ† |
| `total_rewards` | INTEGER | NOT NULL | 0 | æ€»è·å¾—å¥–åŠ± |
| `last_draw_time` | DATETIME | NULL | - | æœ€åæŠ½å–æ—¶é—´ |
| `access_level` | ENUM | NOT NULL | 'basic' | è®¿é—®ç­‰çº§ï¼šbasic/premium/vip/unlimited |
| `created_at` | TIMESTAMP | NOT NULL | NOW() | é¦–æ¬¡è®¿é—®æ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | NOW() | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_user_date` | æ™®é€š | `user_id`, `access_date` | ç”¨æˆ·æ—¥æœŸç´¢å¼• |
| `idx_pool_level` | æ™®é€š | `pool_id`, `access_level` | æ± ç­‰çº§ç´¢å¼• |
| `idx_last_draw` | æ™®é€š | `last_draw_time` | æœ€åæŠ½å–æ—¶é—´ç´¢å¼• |

#### å…³è”å…³ç³»

- **å±äº**: `User` (ç”¨æˆ·)

### 4. task_progress_logs - ä»»åŠ¡è¿›åº¦è®°å½•è¡¨

**è¡¨å**: `task_progress_logs`  
**æ¨¡å‹**: `TaskProgressLog`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç”¨æˆ·ä»»åŠ¡è¿›åº¦çš„å˜åŒ–å†å²

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | è¿›åº¦è®°å½•ID |
| `task_id` | VARCHAR(50) | NOT NULL | - | ä»»åŠ¡ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `action_type` | ENUM | NOT NULL | - | æ“ä½œç±»å‹ï¼šprogress/bonus/penalty/reset/complete |
| `progress_before` | INTEGER | NOT NULL | - | æ“ä½œå‰è¿›åº¦ |
| `progress_after` | INTEGER | NOT NULL | - | æ“ä½œåè¿›åº¦ |
| `change_amount` | INTEGER | NOT NULL | - | å˜åŒ–é‡ |
| `trigger_source` | VARCHAR(100) | NULL | - | è§¦å‘æ¥æº |
| `description` | TEXT | NULL | - | å˜åŒ–æè¿° |
| `metadata` | JSON | NULL | - | ç›¸å…³å…ƒæ•°æ® |
| `created_at` | TIMESTAMP | NOT NULL | NOW() | è®°å½•æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_task_time` | æ™®é€š | `task_id`, `created_at` | ä»»åŠ¡æ—¶é—´ç´¢å¼• |
| `idx_user_action` | æ™®é€š | `user_id`, `action_type` | ç”¨æˆ·æ“ä½œç´¢å¼• |
| `idx_trigger_source` | æ™®é€š | `trigger_source` | è§¦å‘æ¥æºç´¢å¼• |

#### å…³è”å…³ç³»

- **å±äº**: `UserTask` (ç”¨æˆ·ä»»åŠ¡)
- **å±äº**: `User` (ç”¨æˆ·)

---

## ğŸ” ç»Ÿä¸€å¼•æ“æ¨¡å—

### 1. lottery_execution_logs - æŠ½å¥–æ‰§è¡Œæ—¥å¿—è¡¨

**è¡¨å**: `lottery_execution_logs`  
**æ¨¡å‹**: `LotteryExecutionLog`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•æŠ½å¥–å¼•æ“çš„è¯¦ç»†æ‰§è¡Œæ—¥å¿—

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `log_id` | BIGINT | PRIMARY KEY, AUTO_INCREMENT | - | æ—¥å¿—ID |
| `execution_id` | VARCHAR(50) | NOT NULL | - | æ‰§è¡Œæ‰¹æ¬¡ID |
| `user_id` | INTEGER | NOT NULL | - | ç”¨æˆ·ID |
| `campaign_id` | INTEGER | NOT NULL | - | æ´»åŠ¨ID |
| `engine_version` | VARCHAR(20) | NOT NULL | - | å¼•æ“ç‰ˆæœ¬ |
| `execution_type` | ENUM | NOT NULL | - | æ‰§è¡Œç±»å‹ï¼šsingle/batch/test |
| `input_parameters` | JSON | NOT NULL | - | è¾“å…¥å‚æ•° |
| `algorithm_used` | VARCHAR(100) | NOT NULL | - | ä½¿ç”¨çš„ç®—æ³• |
| `probability_data` | JSON | NULL | - | æ¦‚ç‡æ•°æ® |
| `decision_process` | JSON | NULL | - | å†³ç­–è¿‡ç¨‹ |
| `execution_result` | JSON | NOT NULL | - | æ‰§è¡Œç»“æœ |
| `performance_metrics` | JSON | NULL | - | æ€§èƒ½æŒ‡æ ‡ |
| `execution_time_ms` | INTEGER | NOT NULL | - | æ‰§è¡Œæ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ |
| `status` | ENUM | NOT NULL | 'completed' | çŠ¶æ€ï¼špending/running/completed/failed |
| `error_details` | JSON | NULL | - | é”™è¯¯è¯¦æƒ… |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `log_id` | ä¸»é”®ç´¢å¼• |
| `idx_execution_id` | æ™®é€š | `execution_id` | æ‰§è¡ŒIDç´¢å¼• |
| `idx_user_campaign` | æ™®é€š | `user_id`, `campaign_id` | ç”¨æˆ·æ´»åŠ¨ç´¢å¼• |
| `idx_created_at` | æ™®é€š | `created_at` | åˆ›å»ºæ—¶é—´ç´¢å¼• |

### 2. lottery_engine_configs - æŠ½å¥–å¼•æ“é…ç½®è¡¨

**è¡¨å**: `lottery_engine_configs`  
**æ¨¡å‹**: `LotteryEngineConfig`  
**ä¸»è¦åŠŸèƒ½**: ç®¡ç†æŠ½å¥–å¼•æ“çš„é…ç½®å‚æ•°å’Œç®—æ³•è®¾ç½®

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | é…ç½®ID |
| `config_name` | VARCHAR(100) | NOT NULL, UNIQUE | - | é…ç½®åç§° |
| `config_type` | ENUM | NOT NULL | - | é…ç½®ç±»å‹ï¼šalgorithm/probability/performance/validation |
| `engine_version` | VARCHAR(20) | NOT NULL | - | å¼•æ“ç‰ˆæœ¬ |
| `algorithm_config` | JSON | NOT NULL | - | ç®—æ³•é…ç½®å‚æ•° |
| `probability_settings` | JSON | NOT NULL | - | æ¦‚ç‡è®¾ç½® |
| `performance_limits` | JSON | NOT NULL | - | æ€§èƒ½é™åˆ¶é…ç½® |
| `validation_rules` | JSON | NOT NULL | - | éªŒè¯è§„åˆ™é…ç½® |
| `fallback_config` | JSON | NULL | - | é™çº§é…ç½® |
| `is_active` | BOOLEAN | NOT NULL | true | æ˜¯å¦å¯ç”¨ |
| `priority_level` | INTEGER | NOT NULL | 1 | ä¼˜å…ˆçº§ç­‰çº§ |
| `environment` | ENUM | NOT NULL | 'production' | ç¯å¢ƒï¼šdevelopment/testing/production |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |
| `updated_at` | TIMESTAMP | NOT NULL | - | æ›´æ–°æ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_config_name` | å”¯ä¸€ | `config_name` | é…ç½®åç§°å”¯ä¸€ç´¢å¼• |
| `idx_type_active` | æ™®é€š | `config_type`, `is_active` | ç±»å‹çŠ¶æ€ç´¢å¼• |
| `idx_version_env` | æ™®é€š | `engine_version`, `environment` | ç‰ˆæœ¬ç¯å¢ƒç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **é…ç½®éªŒè¯**: `validateConfig()`, `testAlgorithm()`
- **é…ç½®åˆ‡æ¢**: `switchConfig()`, `rollbackConfig()`
- **æ€§èƒ½ç›‘æ§**: `getPerformanceStats()`

### 3. decision_records - å†³ç­–è®°å½•è¡¨

**è¡¨å**: `decision_records`  
**æ¨¡å‹**: `DecisionRecord`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•æŠ½å¥–å¼•æ“çš„å†³ç­–è¿‡ç¨‹å’Œç†ç”±

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | å†³ç­–è®°å½•ID |
| `execution_id` | VARCHAR(50) | NOT NULL | - | æ‰§è¡Œæ‰¹æ¬¡ID |
| `decision_point` | VARCHAR(100) | NOT NULL | - | å†³ç­–ç‚¹ |
| `decision_type` | ENUM | NOT NULL | - | å†³ç­–ç±»å‹ï¼šalgorithm_choice/probability_calc/prize_selection/validation_check |
| `input_data` | JSON | NOT NULL | - | è¾“å…¥æ•°æ® |
| `decision_logic` | JSON | NOT NULL | - | å†³ç­–é€»è¾‘ |
| `decision_result` | JSON | NOT NULL | - | å†³ç­–ç»“æœ |
| `confidence_score` | DECIMAL(5,3) | NOT NULL | 1.000 | ç½®ä¿¡åº¦åˆ†æ•°ï¼ˆ0-1ï¼‰ |
| `execution_time_ms` | INTEGER | NOT NULL | - | å†³ç­–è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰ |
| `alternative_options` | JSON | NULL | - | å¤‡é€‰æ–¹æ¡ˆ |
| `decision_reason` | TEXT | NULL | - | å†³ç­–ç†ç”± |
| `metadata` | JSON | NULL | - | å†³ç­–å…ƒæ•°æ® |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_execution_point` | æ™®é€š | `execution_id`, `decision_point` | æ‰§è¡Œå†³ç­–ç‚¹ç´¢å¼• |
| `idx_decision_type` | æ™®é€š | `decision_type` | å†³ç­–ç±»å‹ç´¢å¼• |
| `idx_confidence` | æ™®é€š | `confidence_score` | ç½®ä¿¡åº¦ç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **å†³ç­–åˆ†æ**: `analyzeDecision()`, `getDecisionTree()`
- **æ€§èƒ½è¯„ä¼°**: `evaluatePerformance()`
- **å†³ç­–å›æ”¾**: `replayDecision()`

### 4. probability_logs - æ¦‚ç‡æ—¥å¿—è¡¨

**è¡¨å**: `probability_logs`  
**æ¨¡å‹**: `ProbabilityLog`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•æ¦‚ç‡è®¡ç®—çš„è¯¦ç»†è¿‡ç¨‹å’Œç»“æœ

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | æ¦‚ç‡æ—¥å¿—ID |
| `execution_id` | VARCHAR(50) | NOT NULL | - | æ‰§è¡Œæ‰¹æ¬¡ID |
| `calculation_step` | VARCHAR(100) | NOT NULL | - | è®¡ç®—æ­¥éª¤ |
| `calculation_type` | ENUM | NOT NULL | - | è®¡ç®—ç±»å‹ï¼šbase_probability/weighted_probability/adjusted_probability/final_probability |
| `input_probabilities` | JSON | NOT NULL | - | è¾“å…¥æ¦‚ç‡æ•°æ® |
| `calculation_method` | VARCHAR(100) | NOT NULL | - | è®¡ç®—æ–¹æ³• |
| `adjustment_factors` | JSON | NULL | - | è°ƒæ•´å› å­ |
| `calculation_result` | JSON | NOT NULL | - | è®¡ç®—ç»“æœ |
| `probability_distribution` | JSON | NOT NULL | - | æ¦‚ç‡åˆ†å¸ƒ |
| `normalization_factor` | DECIMAL(10,6) | NULL | - | å½’ä¸€åŒ–å› å­ |
| `validation_status` | ENUM | NOT NULL | 'valid' | éªŒè¯çŠ¶æ€ï¼švalid/invalid/warning |
| `validation_errors` | JSON | NULL | - | éªŒè¯é”™è¯¯ |
| `calculation_time_ms` | INTEGER | NOT NULL | - | è®¡ç®—è€—æ—¶ï¼ˆæ¯«ç§’ï¼‰ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_execution_step` | æ™®é€š | `execution_id`, `calculation_step` | æ‰§è¡Œæ­¥éª¤ç´¢å¼• |
| `idx_calculation_type` | æ™®é€š | `calculation_type` | è®¡ç®—ç±»å‹ç´¢å¼• |
| `idx_validation_status` | æ™®é€š | `validation_status` | éªŒè¯çŠ¶æ€ç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **æ¦‚ç‡éªŒè¯**: `validateProbabilities()`, `checkDistribution()`
- **åˆ†å¸ƒåˆ†æ**: `analyzeProbabilityDistribution()`
- **è¶‹åŠ¿ç›‘æ§**: `trackProbabilityTrends()`

### 5. system_metrics - ç³»ç»ŸæŒ‡æ ‡è¡¨

**è¡¨å**: `system_metrics`  
**æ¨¡å‹**: `SystemMetrics`  
**ä¸»è¦åŠŸèƒ½**: è®°å½•ç³»ç»Ÿè¿è¡Œçš„å…³é”®æ€§èƒ½æŒ‡æ ‡

#### å­—æ®µç»“æ„

| å­—æ®µå | æ•°æ®ç±»å‹ | çº¦æŸ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|---------|-----|-------|------|
| `id` | INTEGER | PRIMARY KEY, AUTO_INCREMENT | - | æŒ‡æ ‡è®°å½•ID |
| `metric_name` | VARCHAR(100) | NOT NULL | - | æŒ‡æ ‡åç§° |
| `metric_category` | ENUM | NOT NULL | - | æŒ‡æ ‡åˆ†ç±»ï¼šperformance/business/system/security |
| `metric_type` | ENUM | NOT NULL | - | æŒ‡æ ‡ç±»å‹ï¼šcounter/gauge/histogram/timer |
| `metric_value` | DECIMAL(15,6) | NOT NULL | - | æŒ‡æ ‡å€¼ |
| `metric_unit` | VARCHAR(20) | NOT NULL | - | æŒ‡æ ‡å•ä½ |
| `aggregation_period` | ENUM | NOT NULL | 'realtime' | èšåˆå‘¨æœŸï¼šrealtime/minute/hour/day |
| `dimensions` | JSON | NULL | - | æŒ‡æ ‡ç»´åº¦ |
| `tags` | JSON | NULL | - | æŒ‡æ ‡æ ‡ç­¾ |
| `threshold_config` | JSON | NULL | - | é˜ˆå€¼é…ç½® |
| `alert_level` | ENUM | NOT NULL | 'normal' | å‘Šè­¦çº§åˆ«ï¼šnormal/warning/critical |
| `source_system` | VARCHAR(50) | NOT NULL | - | æ¥æºç³»ç»Ÿ |
| `collection_time` | DATETIME | NOT NULL | - | é‡‡é›†æ—¶é—´ |
| `created_at` | TIMESTAMP | NOT NULL | - | åˆ›å»ºæ—¶é—´ |

#### ç´¢å¼•è®¾è®¡

| ç´¢å¼•å | ç±»å‹ | å­—æ®µ | è¯´æ˜ |
|--------|-----|------|------|
| PRIMARY | ä¸»é”® | `id` | ä¸»é”®ç´¢å¼• |
| `idx_metric_category` | æ™®é€š | `metric_category`, `metric_name` | åˆ†ç±»åç§°ç´¢å¼• |
| `idx_collection_time` | æ™®é€š | `collection_time` | é‡‡é›†æ—¶é—´ç´¢å¼• |
| `idx_alert_level` | æ™®é€š | `alert_level` | å‘Šè­¦çº§åˆ«ç´¢å¼• |
| `idx_source_period` | æ™®é€š | `source_system`, `aggregation_period` | æ¥æºå‘¨æœŸç´¢å¼• |

#### ä¸šåŠ¡æ–¹æ³•

- **æŒ‡æ ‡èšåˆ**: `aggregateMetrics()`, `calculateTrends()`
- **å‘Šè­¦æ£€æŸ¥**: `checkThresholds()`, `triggerAlerts()`
- **æ€§èƒ½åˆ†æ**: `analyzePerformance()`, `generateReports()`

#### å…³è”å…³ç³»

- **å…³è”**: `LotteryExecutionLog` (ç³»ç»Ÿæ‰§è¡Œæ—¥å¿—)
- **å…³è”**: `DecisionRecord` (å†³ç­–è®°å½•)

---

## ğŸ”— æ•°æ®åº“å…³ç³»æ€»ç»“

### æ ¸å¿ƒå®ä½“å…³ç³»å›¾

```
User (ç”¨æˆ·)
â”œâ”€â”€ UserPointsAccount (ä¸€å¯¹ä¸€: ç§¯åˆ†è´¦æˆ·)
â”œâ”€â”€ UserInventory (ä¸€å¯¹å¤š: ç”¨æˆ·åº“å­˜)
â”œâ”€â”€ LotteryRecord (ä¸€å¯¹å¤š: æŠ½å¥–è®°å½•)
â”œâ”€â”€ UserTask (ä¸€å¯¹å¤š: ç”¨æˆ·ä»»åŠ¡)
â”œâ”€â”€ LoginLog (ä¸€å¯¹å¤š: ç™»å½•æ—¥å¿—)
â””â”€â”€ CustomerSession (ä¸€å¯¹å¤š: å®¢æœä¼šè¯)

LotteryCampaign (æŠ½å¥–æ´»åŠ¨)
â”œâ”€â”€ LotteryPrize (ä¸€å¯¹å¤š: æ´»åŠ¨å¥–å“)
â”œâ”€â”€ LotteryRecord (ä¸€å¯¹å¤š: æŠ½å¥–è®°å½•)
â””â”€â”€ LotteryExecutionLog (ä¸€å¯¹å¤š: æ‰§è¡Œæ—¥å¿—)

AdminUser (ç®¡ç†å‘˜)
â”œâ”€â”€ AdminStatus (ä¸€å¯¹ä¸€: ç®¡ç†å‘˜çŠ¶æ€)
â”œâ”€â”€ CustomerSession (ä¸€å¯¹å¤š: å¤„ç†çš„ä¼šè¯)
â””â”€â”€ ChatMessage (ä¸€å¯¹å¤š: å‘é€çš„æ¶ˆæ¯)
```

### ä¸šåŠ¡æµç¨‹å…³ç³»

1. **ç”¨æˆ·æ³¨å†Œæµç¨‹**: `User` â†’ `UserPointsAccount` â†’ `UserSession`
2. **æŠ½å¥–æµç¨‹**: `LotteryCampaign` â†’ `LotteryRecord` â†’ `PrizeDistribution` â†’ `UserInventory`
3. **ç§¯åˆ†æµç¨‹**: `PointsTransaction` â†’ `UserPointsAccount` â†’ `User.history_total_points`
4. **å®¢æœæµç¨‹**: `CustomerSession` â†’ `ChatMessage` â†’ `AdminUser`
5. **ä»»åŠ¡æµç¨‹**: `TaskTemplate` â†’ `UserTask` â†’ `PointsTransaction`

### ç´¢å¼•ä¼˜åŒ–ç­–ç•¥

1. **æ—¶é—´èŒƒå›´æŸ¥è¯¢**: æ‰€æœ‰åŒ…å«æ—¶é—´å­—æ®µçš„è¡¨éƒ½å»ºç«‹æ—¶é—´ç´¢å¼•
2. **ç”¨æˆ·å…³è”æŸ¥è¯¢**: æ‰€æœ‰ç”¨æˆ·ç›¸å…³è¡¨å»ºç«‹ `user_id` ç´¢å¼•
3. **çŠ¶æ€ç­›é€‰æŸ¥è¯¢**: çŠ¶æ€å­—æ®µä¸å…¶ä»–å¸¸ç”¨å­—æ®µçš„ç»„åˆç´¢å¼•
4. **ä¸šåŠ¡å…³è”æŸ¥è¯¢**: å¤–é”®å­—æ®µçš„ç´¢å¼•ä¼˜åŒ–
5. **ç»Ÿè®¡åˆ†ææŸ¥è¯¢**: æ”¯æŒæŠ¥è¡¨å’Œåˆ†æçš„ç»„åˆç´¢å¼•

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **åˆ†è¡¨ç­–ç•¥**: æ—¥å¿—ç±»è¡¨è€ƒè™‘æŒ‰æœˆåˆ†è¡¨
2. **ç¼“å­˜ç­–ç•¥**: çƒ­ç‚¹æ•°æ®ä½¿ç”¨Redisç¼“å­˜
3. **è¯»å†™åˆ†ç¦»**: è¯»å¤šå†™å°‘çš„è¡¨ä½¿ç”¨è¯»å†™åˆ†ç¦»
4. **å½’æ¡£ç­–ç•¥**: å†å²æ•°æ®å®šæœŸå½’æ¡£
5. **ç´¢å¼•ç›‘æ§**: å®šæœŸåˆ†ææ…¢æŸ¥è¯¢å’Œç´¢å¼•ä½¿ç”¨æƒ…å†µ

---

## ğŸ“ ç»´æŠ¤å’Œæ‰©å±•

### æ•°æ®åº“ç»´æŠ¤

1. **å®šæœŸå¤‡ä»½**: æ¯æ—¥å…¨é‡å¤‡ä»½ï¼Œæ¯å°æ—¶å¢é‡å¤‡ä»½
2. **æ€§èƒ½ç›‘æ§**: æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æå’Œç´¢å¼•ä¼˜åŒ–
3. **ç©ºé—´ç®¡ç†**: å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®å’Œæ— ç”¨ç´¢å¼•
4. **ç‰ˆæœ¬æ§åˆ¶**: æ•°æ®åº“ç»“æ„å˜æ›´é€šè¿‡Migrationç®¡ç†

### æ‰©å±•è§„åˆ’

1. **æ°´å¹³æ‰©å±•**: æ”¯æŒåˆ†åº“åˆ†è¡¨
2. **å‚ç›´æ‰©å±•**: ç¡¬ä»¶èµ„æºå‡çº§
3. **åŠŸèƒ½æ‰©å±•**: æ–°ä¸šåŠ¡æ¨¡å—çš„è¡¨è®¾è®¡
4. **æ€§èƒ½æ‰©å±•**: æŸ¥è¯¢ä¼˜åŒ–å’Œç¼“å­˜ç­–ç•¥

### å®‰å…¨ç®¡ç†

1. **è®¿é—®æ§åˆ¶**: æ•°æ®åº“ç”¨æˆ·æƒé™ç®¡ç†
2. **æ•°æ®åŠ å¯†**: æ•æ„Ÿå­—æ®µåŠ å¯†å­˜å‚¨
3. **å®¡è®¡æ—¥å¿—**: é‡è¦æ“ä½œå®¡è®¡è·Ÿè¸ª
4. **å¤‡ä»½å®‰å…¨**: å¤‡ä»½æ•°æ®åŠ å¯†å’Œå¼‚åœ°å­˜å‚¨

---

**æ–‡æ¡£å®Œæˆæ—¶é—´**: 2025å¹´09æœˆ19æ—¥ 20:19:01 UTC  
**æ•°æ®åº“è®¾è®¡ç‰ˆæœ¬**: v2.0  
**æŠ€æœ¯æ ˆ**: MySQL 8.0 + Sequelize ORM + Node.js 